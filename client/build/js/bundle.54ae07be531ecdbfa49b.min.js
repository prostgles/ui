/*! For license information please see bundle.54ae07be531ecdbfa49b.min.js.LICENSE.txt */
!function(){var e={7914:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},1873:function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},5886:function(e){"use strict";e.exports=n,e.exports.default=n;var t=1e20;function n(e,t,n,r,i,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(e,t,n,r,o,s){for(var a=0;a<t;a++)i(e,a,t,n,r,o,s);for(var l=0;l<n;l++)i(e,l*t,1,t,r,o,s)}function i(e,n,r,i,o,s,a){var l,c,u,h;for(s[0]=0,a[0]=-t,a[1]=t,l=0;l<i;l++)o[l]=e[n+l*r];for(l=1,c=0,u=0;l<i;l++){do{h=s[c],u=(o[l]-o[h]+l*l-h*h)/(l-h)/2}while(u<=a[c]&&--c>-1);s[++c]=l,a[c]=u,a[c+1]=t}for(l=0,c=0;l<i;l++){for(;a[c+1]<l;)c++;h=s[c],e[n+l*r]=o[h]+(l-h)*(l-h)}}n.prototype._draw=function(e,n){var i,o,s,a,l,c,u,h,d,f=this.ctx.measureText(e),p=f.width,m=2*this.buffer;n&&this.useMetrics?(l=Math.floor(f.actualBoundingBoxAscent),h=this.buffer+Math.ceil(f.actualBoundingBoxAscent),c=this.buffer,u=this.buffer,i=(o=Math.min(this.size,Math.ceil(f.actualBoundingBoxRight-f.actualBoundingBoxLeft)))+m,s=(a=Math.min(this.size-c,Math.ceil(f.actualBoundingBoxAscent+f.actualBoundingBoxDescent)))+m,this.ctx.textBaseline="alphabetic"):(i=o=this.size,s=a=this.size,l=19*this.fontSize/24,c=u=0,h=this.middle,this.ctx.textBaseline="middle"),o&&a&&(this.ctx.clearRect(u,c,o,a),this.ctx.fillText(e,this.buffer,h),d=this.ctx.getImageData(u,c,o,a));var g=new Uint8ClampedArray(i*s);return function(e,n,r,i,o,s,a){s.fill(t,0,n*r),a.fill(0,0,n*r);for(var l=(n-i)/2,c=0;c<o;c++)for(var u=0;u<i;u++){var h=(c+l)*n+u+l,d=e.data[4*(c*i+u)+3]/255;if(1===d)s[h]=0,a[h]=t;else if(0===d)s[h]=t,a[h]=0;else{var f=Math.max(0,.5-d),p=Math.max(0,d-.5);s[h]=f*f,a[h]=p*p}}}(d,i,s,o,a,this.gridOuter,this.gridInner),r(this.gridOuter,i,s,this.f,this.v,this.z),r(this.gridInner,i,s,this.f,this.v,this.z),function(e,t,n,r,i,o,s){for(var a=0;a<t*n;a++){var l=Math.sqrt(r[a])-Math.sqrt(i[a]);e[a]=Math.round(255-255*(l/o+s))}}(g,i,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:g,metrics:{width:o,height:a,sdfWidth:i,sdfHeight:s,top:l,left:0,advance:p}}},n.prototype.draw=function(e){return this._draw(e,!1).data},n.prototype.drawWithMetrics=function(e){return this._draw(e,!0)}},9823:function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=n(3615)},function(e,t){e.exports=n(7378)},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(0),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=0,a=r.forwardRef((function(e,t){var n=e.title,i=void 0===n?null:n,a=e.description,l=void 0===a?null:a,c=e.size,u=void 0===c?null:c,h=e.color,d=void 0===h?"currentColor":h,f=e.horizontal,p=void 0===f?null:f,m=e.vertical,g=void 0===m?null:m,y=e.rotate,v=void 0===y?null:y,b=e.spin,w=void 0===b?null:b,x=e.style,E=void 0===x?{}:x,_=e.children,S=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["title","description","size","color","horizontal","vertical","rotate","spin","style","children"]);s++;var C,T=null!==w&&w,O=r.Children.map(_,(function(e){var t=e;!0!==T&&(T=!0===(null===w?t.props.spin:w));var n=t.props.size;"number"==typeof u&&"number"==typeof t.props.size&&(n=t.props.size/u);var i={size:n,color:null===d?t.props.color:d,horizontal:null===p?t.props.horizontal:p,vertical:null===g?t.props.vertical:g,rotate:null===v?t.props.rotate:v,spin:null===w?t.props.spin:w,inStack:!0};return r.cloneElement(t,i)}));null!==u&&(E.width="string"==typeof u?u:1.5*u+"rem");var P,A="stack_labelledby_"+s,k="stack_describedby_"+s;if(i)C=l?A+" "+k:A;else if(P="presentation",l)throw new Error("title attribute required when description is set");return r.createElement("svg",o({ref:t,viewBox:"0 0 24 24",style:E,role:P,"aria-labelledby":C},S),i&&r.createElement("title",{id:A},i),l&&r.createElement("desc",{id:k},l),T&&r.createElement("style",null,"@keyframes spin { to { transform: rotate(360deg) } }","@keyframes spin-inverse { to { transform: rotate(-360deg) } }"),O)}));a.displayName="Stack",a.propTypes={size:i.oneOfType([i.number,i.string]),color:i.string,horizontal:i.bool,vertical:i.bool,rotate:i.number,spin:i.oneOfType([i.bool,i.number]),children:i.oneOfType([i.arrayOf(i.node),i.node]).isRequired,className:i.string,style:i.object},a.defaultProps={size:null,color:null,horizontal:null,vertical:null,rotate:null,spin:null};var l=a;n.d(t,"Icon",(function(){return h})),n.d(t,"Stack",(function(){return l}));var c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=0,h=r.forwardRef((function(e,t){var n=e.path,i=e.id,o=void 0===i?++u:i,s=e.title,a=void 0===s?null:s,l=e.description,h=void 0===l?null:l,d=e.size,f=void 0===d?null:d,p=e.color,m=void 0===p?"currentColor":p,g=e.horizontal,y=void 0!==g&&g,v=e.vertical,b=void 0!==v&&v,w=e.rotate,x=void 0===w?0:w,E=e.spin,_=void 0!==E&&E,S=e.style,C=void 0===S?{}:S,T=e.inStack,O=void 0!==T&&T,P=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["path","id","title","description","size","color","horizontal","vertical","rotate","spin","style","inStack"]),A={},k=[];null!==f&&(O?k.push("scale("+f+")"):(C.width="string"==typeof f?f:1.5*f+"rem",C.height=C.width)),y&&k.push("scaleX(-1)"),b&&k.push("scaleY(-1)"),0!==x&&k.push("rotate("+x+"deg)"),null!==m&&(A.fill=m);var M=r.createElement("path",c({d:n,style:A},O?P:{})),N=M;k.length>0&&(C.transform=k.join(" "),C.transformOrigin="center",O&&(N=r.createElement("g",{style:C},M,r.createElement("rect",{width:"24",height:"24",fill:"transparent"}))));var L,R=N,I=!0===_||"number"!=typeof _?2:_,D=!O&&(y||b);if(I<0&&(D=!D),_&&(R=r.createElement("g",{style:{animation:"spin"+(D?"-inverse":"")+" linear "+Math.abs(I)+"s infinite",transformOrigin:"center"}},N,!(y||b||0!==x)&&r.createElement("rect",{width:"24",height:"24",fill:"transparent"}))),O)return R;var j,F="icon_labelledby_"+o,z="icon_describedby_"+o;if(a)L=h?F+" "+z:F;else if(j="presentation",h)throw new Error("title attribute required when description is set");return r.createElement("svg",c({ref:t,viewBox:"0 0 24 24",style:C,role:j,"aria-labelledby":L},P),a&&r.createElement("title",{id:F},a),h&&r.createElement("desc",{id:z},h),!O&&_&&(D?r.createElement("style",null,"@keyframes spin-inverse { to { transform: rotate(-360deg) } }"):r.createElement("style",null,"@keyframes spin { to { transform: rotate(360deg) } }")),R)}));h.displayName="Icon",h.propTypes={path:i.string.isRequired,size:i.oneOfType([i.number,i.string]),color:i.string,horizontal:i.bool,vertical:i.bool,rotate:i.number,spin:i.oneOfType([i.bool,i.number]),style:i.object,inStack:i.bool,className:i.string},h.defaultProps={size:null,color:"currentColor",horizontal:!1,vertical:!1,rotate:0,spin:!1},t.default=h}])},2307:function(e){function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},8718:function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(t){var n,r,i,o,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(n=0;n<l;n+=4)r=e.indexOf(t[n]),i=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),h[c++]=r<<2|i>>4,h[c++]=(15&i)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},4398:function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},6292:function(e,t,n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(9374)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},9374:function(e,t,n){e.exports=function(e){function t(e){let n,i=null;function o(...e){if(!o.enabled)return;const r=o,i=Number(new Date),s=i-(n||i);r.diff=s,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null===i?t.enabled(e):i,set:e=>{i=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(8628),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},1857:function(e){"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function s(e,t){try{return t in e}catch(e){return!1}}function a(e,n,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=r;var c=Array.isArray(n);return c===Array.isArray(e)?c?l.arrayMerge(e,n,l):function(e,t,n){var i={};return n.isMergeableObject(e)&&o(e).forEach((function(t){i[t]=r(e[t],n)})),o(t).forEach((function(o){(function(e,t){return s(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(s(e,o)&&n.isMergeableObject(t[o])?i[o]=function(e,t){if(!t.customMerge)return a;var n=t.customMerge(e);return"function"==typeof n?n:a}(o,n)(e[o],t[o],n):i[o]=r(t[o],n))})),i}(e,n,l):r(n,l)}a.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return a(e,n,t)}),{})};var l=a;e.exports=l},6722:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.DomHandler=void 0;var o=n(7294),s=n(1901);i(n(1901),t);var a=/\s+/g,l={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1},c=function(){function e(e,t,n){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,"function"==typeof t&&(n=t,t=l),"object"==typeof e&&(t=e,e=void 0),this.callback=null!=e?e:null,this.options=null!=t?t:l,this.elementCB=null!=n?n:null}return e.prototype.onparserinit=function(e){this.parser=e},e.prototype.onreset=function(){var e;this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null!==(e=this.parser)&&void 0!==e?e:null},e.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},e.prototype.onerror=function(e){this.handleCallback(e)},e.prototype.onclosetag=function(){this.lastNode=null;var e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)},e.prototype.onopentag=function(e,t){var n=this.options.xmlMode?o.ElementType.Tag:void 0,r=new s.Element(e,t,void 0,n);this.addNode(r),this.tagStack.push(r)},e.prototype.ontext=function(e){var t=this.options.normalizeWhitespace,n=this.lastNode;if(n&&n.type===o.ElementType.Text)t?n.data=(n.data+e).replace(a," "):n.data+=e;else{t&&(e=e.replace(a," "));var r=new s.Text(e);this.addNode(r),this.lastNode=r}},e.prototype.oncomment=function(e){if(this.lastNode&&this.lastNode.type===o.ElementType.Comment)this.lastNode.data+=e;else{var t=new s.Comment(e);this.addNode(t),this.lastNode=t}},e.prototype.oncommentend=function(){this.lastNode=null},e.prototype.oncdatastart=function(){var e=new s.Text(""),t=new s.NodeWithChildren(o.ElementType.CDATA,[e]);this.addNode(t),e.parent=t,this.lastNode=e},e.prototype.oncdataend=function(){this.lastNode=null},e.prototype.onprocessinginstruction=function(e,t){var n=new s.ProcessingInstruction(e,t);this.addNode(n)},e.prototype.handleCallback=function(e){if("function"==typeof this.callback)this.callback(e,this.dom);else if(e)throw e},e.prototype.addNode=function(e){var t=this.tagStack[this.tagStack.length-1],n=t.children[t.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),t.children.push(e),n&&(e.prev=n,n.next=e),e.parent=t,this.lastNode=null},e}();t.DomHandler=c,t.default=c},1901:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.cloneNode=t.hasChildren=t.isDocument=t.isDirective=t.isComment=t.isText=t.isCDATA=t.isTag=t.Element=t.Document=t.NodeWithChildren=t.ProcessingInstruction=t.Comment=t.Text=t.DataNode=t.Node=void 0;var s=n(7294),a=new Map([[s.ElementType.Tag,1],[s.ElementType.Script,1],[s.ElementType.Style,1],[s.ElementType.Directive,1],[s.ElementType.Text,3],[s.ElementType.CDATA,4],[s.ElementType.Comment,8],[s.ElementType.Root,9]]),l=function(){function e(e){this.type=e,this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){var e;return null!==(e=a.get(this.type))&&void 0!==e?e:1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(e){this.parent=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(e){this.prev=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(e){this.next=e},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(e){return void 0===e&&(e=!1),E(this,e)},e}();t.Node=l;var c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.data=n,r}return i(t,e),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t}(l);t.DataNode=c;var u=function(e){function t(t){return e.call(this,s.ElementType.Text,t)||this}return i(t,e),t}(c);t.Text=u;var h=function(e){function t(t){return e.call(this,s.ElementType.Comment,t)||this}return i(t,e),t}(c);t.Comment=h;var d=function(e){function t(t,n){var r=e.call(this,s.ElementType.Directive,n)||this;return r.name=t,r}return i(t,e),t}(c);t.ProcessingInstruction=d;var f=function(e){function t(t,n){var r=e.call(this,t)||this;return r.children=n,r}return i(t,e),Object.defineProperty(t.prototype,"firstChild",{get:function(){var e;return null!==(e=this.children[0])&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(e){this.children=e},enumerable:!1,configurable:!0}),t}(l);t.NodeWithChildren=f;var p=function(e){function t(t){return e.call(this,s.ElementType.Root,t)||this}return i(t,e),t}(f);t.Document=p;var m=function(e){function t(t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i="script"===t?s.ElementType.Script:"style"===t?s.ElementType.Style:s.ElementType.Tag);var o=e.call(this,i,r)||this;return o.name=t,o.attribs=n,o}return i(t,e),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var e=this;return Object.keys(this.attribs).map((function(t){var n,r;return{name:t,value:e.attribs[t],namespace:null===(n=e["x-attribsNamespace"])||void 0===n?void 0:n[t],prefix:null===(r=e["x-attribsPrefix"])||void 0===r?void 0:r[t]}}))},enumerable:!1,configurable:!0}),t}(f);function g(e){return s.isTag(e)}function y(e){return e.type===s.ElementType.CDATA}function v(e){return e.type===s.ElementType.Text}function b(e){return e.type===s.ElementType.Comment}function w(e){return e.type===s.ElementType.Directive}function x(e){return e.type===s.ElementType.Root}function E(e,t){var n;if(void 0===t&&(t=!1),v(e))n=new u(e.data);else if(b(e))n=new h(e.data);else if(g(e)){var r=t?_(e.children):[],i=new m(e.name,o({},e.attribs),r);r.forEach((function(e){return e.parent=i})),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]=o({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]=o({},e["x-attribsPrefix"])),n=i}else if(y(e)){r=t?_(e.children):[];var a=new f(s.ElementType.CDATA,r);r.forEach((function(e){return e.parent=a})),n=a}else if(x(e)){r=t?_(e.children):[];var l=new p(r);r.forEach((function(e){return e.parent=l})),e["x-mode"]&&(l["x-mode"]=e["x-mode"]),n=l}else{if(!w(e))throw new Error("Not implemented yet: "+e.type);var c=new d(e.name,e.data);null!=e["x-name"]&&(c["x-name"]=e["x-name"],c["x-publicId"]=e["x-publicId"],c["x-systemId"]=e["x-systemId"]),n=c}return n.startIndex=e.startIndex,n.endIndex=e.endIndex,n}function _(e){for(var t=e.map((function(e){return E(e,!0)})),n=1;n<t.length;n++)t[n].prev=t[n-1],t[n-1].next=t[n];return t}t.Element=m,t.isTag=g,t.isCDATA=y,t.isText=v,t.isComment=b,t.isDirective=w,t.isDocument=x,t.hasChildren=function(e){return Object.prototype.hasOwnProperty.call(e,"children")},t.cloneNode=E},7294:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(n=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===n.Tag||e.type===n.Script||e.type===n.Style},t.Root=n.Root,t.Text=n.Text,t.Directive=n.Directive,t.Comment=n.Comment,t.Script=n.Script,t.Style=n.Style,t.Tag=n.Tag,t.CDATA=n.CDATA,t.Doctype=n.Doctype},1106:function(e){"use strict";function t(e,t,o){o=o||2;var s,a,l,h,d,p,m,g=t&&t.length,y=g?t[0]*o:e.length,v=n(e,0,y,o,!0),b=[];if(!v||v.next===v.prev)return b;if(g&&(v=function(e,t,i,o){var s,a,l,h=[];for(s=0,a=t.length;s<a;s++)(l=n(e,t[s]*o,s<a-1?t[s+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),h.push(f(l));for(h.sort(c),s=0;s<h.length;s++)i=r(i=u(h[s],i),i.next);return i}(e,t,v,o)),e.length>80*o){s=l=e[0],a=h=e[1];for(var w=o;w<y;w+=o)(d=e[w])<s&&(s=d),(p=e[w+1])<a&&(a=p),d>l&&(l=d),p>h&&(h=p);m=0!==(m=Math.max(l-s,h-a))?1/m:0}return i(v,b,o,s,a,m),b}function n(e,t,n,r,i){var o,s;if(i===T(e,t,n,r)>0)for(o=t;o<n;o+=r)s=_(o,e[o],e[o+1],s);else for(o=n-r;o>=t;o-=r)s=_(o,e[o],e[o+1],s);return s&&y(s,s.next)&&(S(s),s=s.next),s}function r(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(S(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,c,u,h,f){if(e){!f&&h&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=d(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,s,a,l,c=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(e,c,u,h);for(var p,m,g=e;e.prev!==e.next;)if(p=e.prev,m=e.next,h?s(e,c,u,h):o(e))t.push(p.i/n),t.push(e.i/n),t.push(m.i/n),S(e),e=m.next,g=m.next;else if((e=m)===g){f?1===f?i(e=a(r(e),t,n),t,n,c,u,h,2):2===f&&l(e,t,n,c,u,h):i(r(e),t,n,c,u,h,1);break}}}function o(e){var t=e.prev,n=e,r=e.next;if(g(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(p(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(e,t,n,r){var i=e.prev,o=e,s=e.next;if(g(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,u=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=d(a,l,t,n,r),f=d(c,u,t,n,r),m=e.prevZ,y=e.nextZ;m&&m.z>=h&&y&&y.z<=f;){if(m!==e.prev&&m!==e.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,y!==e.prev&&y!==e.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;m&&m.z>=h;){if(m!==e.prev&&m!==e.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;y&&y.z<=f;){if(y!==e.prev&&y!==e.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(e,t,n){var i=e;do{var o=i.prev,s=i.next.next;!y(o,s)&&v(o,i,i.next,s)&&x(o,s)&&x(s,o)&&(t.push(o.i/n),t.push(i.i/n),t.push(s.i/n),S(i),S(i.next),i=e=s),i=i.next}while(i!==e);return r(i)}function l(e,t,n,o,s,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&m(l,c)){var u=E(l,c);return l=r(l,l.next),u=r(u,u.next),i(l,t,n,o,s,a),void i(u,t,n,o,s,a)}c=c.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function u(e,t){var n=function(e,t){var n,r=t,i=e.x,o=e.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===s)return n;var l,c=n,u=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=u&&i!==r.x&&p(o<d?i:s,o,u,d,o<d?s:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),x(r,e)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=l)),r=r.next}while(r!==c);return n}(e,t);if(!n)return t;var i=E(n,e),o=r(n,n.next);return r(i,i.next),t===n?o:t}function h(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function d(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,r,i,o,s,a){return(i-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(r-a)-(n-s)*(t-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,n,r){var i=w(g(e,t,n)),o=w(g(e,t,r)),s=w(g(n,r,e)),a=w(g(n,r,t));return i!==o&&s!==a||!(0!==i||!b(e,n,t))||!(0!==o||!b(e,r,t))||!(0!==s||!b(n,e,r))||!(0!==a||!b(n,t,r))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function w(e){return e>0?1:e<0?-1:0}function x(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function E(e,t){var n=new C(e.i,e.x,e.y),r=new C(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function _(e,t,n,r){var i=new C(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,n,r){for(var i=0,o=t,s=n-r;o<n;o+=r)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,s=Math.abs(T(e,0,o,n));if(i)for(var a=0,l=t.length;a<l;a++){var c=t[a]*n,u=a<l-1?t[a+1]*n:e.length;s-=Math.abs(T(e,c,u,n))}var h=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var s=0;s<t;s++)n.vertices.push(e[i][o][s]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},8475:function(e){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},6306:function(e,t,n){const r=n(4684);e.exports=(e,t)=>new r(e,t),e.exports.Socket=r,e.exports.protocol=r.protocol,e.exports.Transport=n(7753),e.exports.transports=n(1492),e.exports.parser=n(8686)},4684:function(e,t,n){const r=n(1492),i=n(4398),o=n(6292)("engine.io-client:socket"),s=n(8686),a=n(5649),l=n(8370);class c extends i{constructor(e,t={}){super(),e&&"object"==typeof e&&(t=e,e=null),e?(e=a(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=l.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){o('creating transport "%s"',e);const t=function(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.opts.query);t.EIO=s.protocol,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return o("options: %j",n),new r[e](n)}open(){let e;if(this.opts.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){const e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return o("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){o("setting transport %s",e.name);const t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))}probe(e){o('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),n=!1;const r=this;function i(){if(r.onlyBinaryUpgrades){const e=!this.supportsBinary&&r.transport.supportsBinary;n=n||e}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;c.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),d(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{o('probe transport "%s" failed',e);const n=new Error("probe error");n.transport=t.name,r.emit("upgradeError",n)}})))}function s(){n||(n=!0,d(),t.close(),t=null)}function a(n){const i=new Error("probe error: "+n);i.transport=t.name,s(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function l(){a("transport closed")}function u(){a("socket closed")}function h(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),s())}function d(){t.removeListener("open",i),t.removeListener("error",a),t.removeListener("close",l),r.removeListener("close",u),r.removeListener("upgrading",h)}c.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",a),t.once("close",l),this.once("close",u),this.once("upgrading",h),t.open()}onOpen(){if(o("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){o("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=this;function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()),this}onError(e){o("socket error %j",e),c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);const n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}c.priorWebsocketSuccess=!1,c.protocol=s.protocol,e.exports=c},7753:function(e,t,n){const r=n(8686),i=n(4398),o=n(6292)("engine.io-client:transport");e.exports=class extends i{constructor(e){super(),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){const n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):o("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){const t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}}},1492:function(e,t,n){const r=n(5016),i=n(344),o=n(9642),s=n(3133);t.polling=function(e){let t,n=!1,s=!1;const a=!1!==e.jsonp;if("undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?443:80),n=e.hostname!==location.hostname||r!==e.port,s=e.secure!==t}if(e.xdomain=n,e.xscheme=s,t=new r(e),"open"in t&&!e.forceJSONP)return new i(e);if(!a)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},9642:function(e,t,n){const r=n(260),i=n(8475),o=/\n/g,s=/\\n/g;let a;e.exports=class extends r{constructor(e){super(e),this.query=this.query||{},a||(a=i.___eio=i.___eio||[]),this.index=a.length;const t=this;a.push((function(e){t.onData(e)})),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};const n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){const e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)}doWrite(e,t){const n=this;let r;if(!this.form){const e=document.createElement("form"),t=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;e.className="socketio",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.target=n,e.method="POST",e.setAttribute("accept-charset","utf-8"),t.name="d",e.appendChild(t),document.body.appendChild(e),this.form=e,this.area=t}function i(){a(),t()}function a(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{const e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){r=document.createElement("iframe"),r.name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),a(),e=e.replace(s,"\\\n"),this.area.value=e.replace(o,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&i()}:this.iframe.onload=i}}},344:function(e,t,n){const r=n(5016),i=n(260),o=n(4398),{pick:s}=n(7492),a=n(8475),l=n(6292)("engine.io-client:polling-xhr");function c(){}const u=null!=new r({xdomain:!1}).responseType;class h extends o{constructor(e,t){super(),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=s(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new r(e),n=this;try{l("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},l("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete h.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&this.onData(e)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}function d(){for(let e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}h.requestsCount=0,h.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",d):"function"==typeof addEventListener&&addEventListener("onpagehide"in a?"pagehide":"unload",d,!1)),e.exports=class extends i{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=u&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new h(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e}),r=this;n.on("success",t),n.on("error",(function(e){r.onError("xhr post error",e)}))}doPoll(){l("xhr poll");const e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e}},e.exports.Request=h},260:function(e,t,n){const r=n(7753),i=n(8370),o=n(8686),s=n(327),a=n(6292)("engine.io-client:polling");e.exports=class extends r{get name(){return"polling"}doOpen(){this.poll()}pause(e){const t=this;function n(){a("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){let e=0;this.polling&&(a("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){a("pre-pause polling complete"),--e||n()}))),this.writable||(a("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){a("pre-pause writing complete"),--e||n()})))}else n()}poll(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){const t=this;a("polling got data %s",e),o.decodePayload(e,this.socket.binaryType).forEach((function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=this;function t(){a("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))}write(e){this.writable=!1,o.encodePayload(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),e.length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}}},4286:function(e,t,n){const r=n(8475);e.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},3133:function(e,t,n){const r=n(7753),i=n(8686),o=n(8370),s=n(327),{pick:a}=n(7492),{WebSocket:l,usingBrowserWebSocket:c,defaultBinaryType:u}=n(4286),h=n(6292)("engine.io-client:websocket"),d="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class f extends r{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=d?{}:a(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c&&!d?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||u,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){const t=this;this.writable=!1;let n=e.length,r=0;const o=n;for(;r<o;r++)!function(e){i.encodePacket(e,t.supportsBinary,(function(r){const i={};!c&&(e.options&&(i.compress=e.options.compress),t.opts.perMessageDeflate)&&("string"==typeof r?Buffer.byteLength(r):r.length)<t.opts.perMessageDeflate.threshold&&(i.compress=!1);try{c?t.ws.send(r):t.ws.send(r,i)}catch(e){h("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0))}))}(e[r])}onClose(){r.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";return this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=s()),this.supportsBinary||(e.b64=1),e=o.encode(e),e.length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}check(){return!(!l||"__initialize"in l&&this.name===f.prototype.name)}}e.exports=f},7492:function(e){e.exports.pick=(e,...t)=>t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})},5016:function(e,t,n){const r=n(6048),i=n(8475);e.exports=function(e){const t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},3167:function(e){const t=Object.create(null);t.open="0",t.close="1",t.ping="2",t.pong="3",t.message="4",t.upgrade="5",t.noop="6";const n=Object.create(null);Object.keys(t).forEach((e=>{n[t[e]]=e})),e.exports={PACKET_TYPES:t,PACKET_TYPES_REVERSE:n,ERROR_PACKET:{type:"error",data:"parser error"}}},6948:function(e,t,n){const{PACKET_TYPES_REVERSE:r,ERROR_PACKET:i}=n(3167);let o;"function"==typeof ArrayBuffer&&(o=n(8718));const s=(e,t)=>{if(o){const n=o.decode(e);return a(n,t)}return{base64:!0,data:e}},a=(e,t)=>"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e;e.exports=(e,t)=>{if("string"!=typeof e)return{type:"message",data:a(e,t)};const n=e.charAt(0);return"b"===n?{type:"message",data:s(e.substring(1),t)}:r[n]?e.length>1?{type:r[n],data:e.substring(1)}:{type:r[n]}:i}},3867:function(e,t,n){const{PACKET_TYPES:r}=n(3167),i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"==typeof ArrayBuffer,s=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)};e.exports=({type:e,data:t},n,a)=>{return i&&t instanceof Blob?n?a(t):s(t,a):o&&(t instanceof ArrayBuffer||(l=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(l):l&&l.buffer instanceof ArrayBuffer))?n?a(t instanceof ArrayBuffer?t:t.buffer):s(new Blob([t]),a):a(r[e]+(t||""));var l}},8686:function(e,t,n){const r=n(3867),i=n(6948),o=String.fromCharCode(30);e.exports={protocol:4,encodePacket:r,encodePayload:(e,t)=>{const n=e.length,i=new Array(n);let s=0;e.forEach(((e,a)=>{r(e,!1,(e=>{i[a]=e,++s===n&&t(i.join(o))}))}))},decodePacket:i,decodePayload:(e,t)=>{const n=e.split(o),r=[];for(let e=0;e<n.length;e++){const o=i(n[e],t);if(r.push(o),"error"===o.type)break}return r}}},9529:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeHTML=t.decodeHTMLStrict=t.decodeXML=void 0;var i=r(n(2834)),o=r(n(2061)),s=r(n(5529)),a=r(n(8787)),l=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;function c(e){var t=h(e);return function(e){return String(e).replace(l,t)}}t.decodeXML=c(s.default),t.decodeHTMLStrict=c(i.default);var u=function(e,t){return e<t?1:-1};function h(e){return function(t){if("#"===t.charAt(1)){var n=t.charAt(2);return"X"===n||"x"===n?a.default(parseInt(t.substr(3),16)):a.default(parseInt(t.substr(2),10))}return e[t.slice(1,-1)]||t}}t.decodeHTML=function(){for(var e=Object.keys(o.default).sort(u),t=Object.keys(i.default).sort(u),n=0,r=0;n<t.length;n++)e[r]===t[n]?(t[n]+=";?",r++):t[n]+=";";var s=new RegExp("&(?:"+t.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),a=h(i.default);function l(e){return";"!==e.substr(-1)&&(e+=";"),a(e)}return function(e){return String(e).replace(s,l)}}()},8787:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(8124)),o=String.fromCodePoint||function(e){var t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+String.fromCharCode(e)};t.default=function(e){return e>=55296&&e<=57343||e>1114111?"":(e in i.default&&(e=i.default[e]),o(e))}},6336:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.escapeUTF8=t.escape=t.encodeNonAsciiHTML=t.encodeHTML=t.encodeXML=void 0;var i=u(r(n(5529)).default),o=h(i);t.encodeXML=g(i);var s,a,l=u(r(n(2834)).default),c=h(l);function u(e){return Object.keys(e).sort().reduce((function(t,n){return t[e[n]]="&"+n+";",t}),{})}function h(e){for(var t=[],n=[],r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];1===o.length?t.push("\\"+o):n.push(o)}t.sort();for(var s=0;s<t.length-1;s++){for(var a=s;a<t.length-1&&t[a].charCodeAt(1)+1===t[a+1].charCodeAt(1);)a+=1;var l=1+a-s;l<3||t.splice(s,l,t[s]+"-"+t[a])}return n.unshift("["+t.join("")+"]"),new RegExp(n.join("|"),"g")}t.encodeHTML=(s=l,a=c,function(e){return e.replace(a,(function(e){return s[e]})).replace(d,p)}),t.encodeNonAsciiHTML=g(l);var d=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,f=null!=String.prototype.codePointAt?function(e){return e.codePointAt(0)}:function(e){return 1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)-56320+65536};function p(e){return"&#x"+(e.length>1?f(e):e.charCodeAt(0)).toString(16).toUpperCase()+";"}var m=new RegExp(o.source+"|"+d.source,"g");function g(e){return function(t){return t.replace(m,(function(t){return e[t]||p(t)}))}}t.escape=function(e){return e.replace(m,p)},t.escapeUTF8=function(e){return e.replace(o,p)}},9625:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXMLStrict=t.decodeHTML5Strict=t.decodeHTML4Strict=t.decodeHTML5=t.decodeHTML4=t.decodeHTMLStrict=t.decodeHTML=t.decodeXML=t.encodeHTML5=t.encodeHTML4=t.escapeUTF8=t.escape=t.encodeNonAsciiHTML=t.encodeHTML=t.encodeXML=t.encode=t.decodeStrict=t.decode=void 0;var r=n(9529),i=n(6336);t.decode=function(e,t){return(!t||t<=0?r.decodeXML:r.decodeHTML)(e)},t.decodeStrict=function(e,t){return(!t||t<=0?r.decodeXML:r.decodeHTMLStrict)(e)},t.encode=function(e,t){return(!t||t<=0?i.encodeXML:i.encodeHTML)(e)};var o=n(6336);Object.defineProperty(t,"encodeXML",{enumerable:!0,get:function(){return o.encodeXML}}),Object.defineProperty(t,"encodeHTML",{enumerable:!0,get:function(){return o.encodeHTML}}),Object.defineProperty(t,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return o.encodeNonAsciiHTML}}),Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return o.escape}}),Object.defineProperty(t,"escapeUTF8",{enumerable:!0,get:function(){return o.escapeUTF8}}),Object.defineProperty(t,"encodeHTML4",{enumerable:!0,get:function(){return o.encodeHTML}}),Object.defineProperty(t,"encodeHTML5",{enumerable:!0,get:function(){return o.encodeHTML}});var s=n(9529);Object.defineProperty(t,"decodeXML",{enumerable:!0,get:function(){return s.decodeXML}}),Object.defineProperty(t,"decodeHTML",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTMLStrict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML4",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTML5",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTML4Strict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML5Strict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeXMLStrict",{enumerable:!0,get:function(){return s.decodeXML}})},1272:function(e,t,n){var r;!function(i,o,s,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(x(e,n),t)}function m(e,t,n){return!!Array.isArray(e)&&(g(e,n[t],n),!0)}function g(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var v=y((function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===a)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),b=y((function(e,t){return v(e,t,!0)}),"merge","Use `assign`.");function w(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&l(r,n)}function x(e,t){return function(){return e.apply(t,arguments)}}function E(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function _(e,t){return e===a?t:e}function S(e,t,n){g(P(t),(function(t){e.addEventListener(t,n,!1)}))}function C(e,t,n){g(P(t),(function(t){e.removeEventListener(t,n,!1)}))}function T(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function O(e,t){return e.indexOf(t)>-1}function P(e){return e.trim().split(/\s+/g)}function A(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function k(e){return Array.prototype.slice.call(e,0)}function M(e,t,n){for(var r=[],i=[],o=0;o<e.length;){var s=t?e[o][t]:e[o];A(i,s)<0&&r.push(e[o]),i[o]=s,o++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function N(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:t)in e)return r;o++}return a}var L=1;function R(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var I="ontouchstart"in i,D=N(i,"PointerEvent")!==a,j=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F="touch",z="mouse",B=["x","y"],U=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){E(e.options.enable,[e])&&n.handler(t)},this.init()}function H(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&t&&r-i==0,s=12&t&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=q(t)),i>1&&!n.firstMultiple?n.firstMultiple=q(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,c=t.center=W(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=X(l,c),t.distance=Y(l,c),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=$(t.deltaX,t.deltaY);var u,h,p=G(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=p.x,t.overallVelocityY=p.y,t.overallVelocity=d(p.x)>d(p.y)?p.x:p.y,t.scale=s?(u=s.pointers,Y((h=r)[0],h[1],U)/Y(u[0],u[1],U)):1,t.rotation=s?function(e,t){return X(t[1],t[0],U)+X(e[1],e[0],U)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,o,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(l>25||s.velocity===a)){var c=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,h=G(l,c,u);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=$(c,u),e.lastInterval=t}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}(n,t);var m=e.element;T(t.srcEvent.target,m)&&(m=t.srcEvent.target),t.target=m}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function q(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:W(t),deltaX:e.deltaX,deltaY:e.deltaY}}function W(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:h(n/t),y:h(r/t)}}function G(e,t,n){return{x:t/e||0,y:n/e||0}}function $(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Y(e,t,n){n||(n=B);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function X(e,t,n){n||(n=B);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(R(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4},Z="mousedown",J="mousemove mouseup";function Q(){this.evEl=Z,this.evWin=J,this.pressed=!1,V.apply(this,arguments)}w(Q,V,{handler:function(e){var t=K[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:z,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:F,3:"pen",4:z,5:"kinect"},ne="pointerdown",re="pointermove pointerup pointercancel";function ie(){this.evEl=ne,this.evWin=re,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),w(ie,V,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=ee[r],o=te[e.pointerType]||e.pointerType,s=o==F,a=A(t,e.pointerId,"pointerId");1&i&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):12&i&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(a,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",ae="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.evWin=ae,this.started=!1,V.apply(this,arguments)}function ce(e,t){var n=k(e.touches),r=k(e.changedTouches);return 12&t&&(n=M(n.concat(r),"identifier",!0)),[n,r]}w(le,V,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=ce.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}});var ue={touchstart:1,touchmove:2,touchend:4,touchcancel:8},he="touchstart touchmove touchend touchcancel";function de(){this.evTarget=he,this.targetIds={},V.apply(this,arguments)}function fe(e,t){var n=k(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=k(e.changedTouches),a=[],l=this.target;if(o=n.filter((function(e){return T(e.target,l)})),1===t)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&t&&delete r[s[i].identifier],i++;return a.length?[M(o.concat(a),"identifier",!0),a]:void 0}function pe(){V.apply(this,arguments);var e=x(this.handler,this);this.touch=new de(this.manager,e),this.mouse=new Q(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function me(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ge.call(this,t)):12&e&&ge.call(this,t)}function ge(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function ye(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}w(de,V,{handler:function(e){var t=ue[e.type],n=fe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}),w(pe,V,{handler:function(e,t,n){var r=n.pointerType==F,i=n.pointerType==z;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)me.call(this,t,n);else if(i&&ye.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ve=N(u.style,"touchAction"),be=ve!==a,we="compute",xe="auto",Ee="manipulation",_e="none",Se="pan-x",Ce="pan-y",Te=function(){if(!be)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||i.CSS.supports("touch-action",n)})),e}();function Oe(e,t){this.manager=e,this.set(t)}Oe.prototype={set:function(e){e==we&&(e=this.compute()),be&&this.manager.element.style&&Te[e]&&(this.manager.element.style[ve]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){E(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(O(e,_e))return _e;var t=O(e,Se),n=O(e,Ce);return t&&n?_e:t||n?t?Se:Ce:O(e,Ee)?Ee:xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=O(r,_e)&&!Te.none,o=O(r,Ce)&&!Te["pan-y"],s=O(r,Se)&&!Te["pan-x"];if(i){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!s||!o)return i||o&&6&n||s&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Pe=32;function Ae(e){this.options=l({},this.defaults,e||{}),this.id=L++,this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ke(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Me(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ne(e,t){var n=t.manager;return n?n.get(e):e}function Le(){Ae.apply(this,arguments)}function Re(){Le.apply(this,arguments),this.pX=null,this.pY=null}function Ie(){Le.apply(this,arguments)}function De(){Ae.apply(this,arguments),this._timer=null,this._input=null}function je(){Le.apply(this,arguments)}function Fe(){Le.apply(this,arguments)}function ze(){Ae.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Be(e,t){return(t=t||{}).recognizers=_(t.recognizers,Be.defaults.preset),new Ue(e,t)}function Ue(e,t){this.options=l({},Be.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(D?ie:j?de:I?pe:Q))(this,H),this.touchAction=new Oe(this,this.options.touchAction),Ve(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ve(e,t){var n,r=e.element;r.style&&(g(e.options.cssProps,(function(i,o){n=N(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ae.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ne(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=Ne(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===A(t,e=Ne(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=Ne(e,this);var t=A(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+ke(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+ke(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Pe},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!E(this.options.enable,[this,t]))return this.reset(),void(this.state=Pe);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},w(Le,Ae,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Pe}}),w(Re,Le,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ce),24&e&&t.push(Se),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,o=e.deltaX,s=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(e.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Le.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Me(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),w(Ie,Le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),w(De,Ae,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Pe},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),w(je,Le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),w(Fe,Le,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Re.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Me(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),w(ze,Ae,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ee]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||Y(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Pe},failTimeout:function(){return this._timer=p((function(){this.state=Pe}),this.options.interval,this),Pe},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Be.VERSION="2.0.7",Be.defaults={domEvents:!1,touchAction:we,enable:!0,inputTarget:null,inputClass:null,preset:[[je,{enable:!1}],[Ie,{enable:!1},["rotate"]],[Fe,{direction:6}],[Re,{direction:6},["swipe"]],[ze],[ze,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ue.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ae)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=A(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return g(P(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==a){var n=this.handlers;return g(P(e),(function(e){t?n[e]&&n[e].splice(A(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ve(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Be,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Pe,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ue,Input:V,TouchAction:Oe,TouchInput:de,MouseInput:Q,PointerEventInput:ie,TouchMouseInput:pe,SingleTouchInput:le,Recognizer:Ae,AttrRecognizer:Le,Tap:ze,Pan:Re,Swipe:Fe,Pinch:Ie,Rotate:je,Press:De,on:S,off:C,each:g,merge:b,extend:v,assign:l,inherit:w,bindFn:x,prefixed:N}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Be,(r=function(){return Be}.call(t,n,t,e))===a||(e.exports=r)}(window,document)},6048:function(e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},5839:function(e,t,n){"use strict";var r=n(9185),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(p){var i=f(n);i&&i!==p&&e(t,i,r)}var s=u(n);h&&(s=s.concat(h(n)));for(var a=l(t),m=l(n),g=0;g<s.length;++g){var y=s[g];if(!(o[y]||r&&r[y]||m&&m[y]||a&&a[y])){var v=d(n,y);try{c(t,y,v)}catch(e){}}}}return t}},7848:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFeed=t.FeedHandler=void 0;var c,u,h=l(n(6722)),d=a(n(3114)),f=n(4418);!function(e){e[e.image=0]="image",e[e.audio=1]="audio",e[e.video=2]="video",e[e.document=3]="document",e[e.executable=4]="executable"}(c||(c={})),function(e){e[e.sample=0]="sample",e[e.full=1]="full",e[e.nonstop=2]="nonstop"}(u||(u={}));var p=function(e){function t(t,n){return"object"==typeof t&&(n=t=void 0),e.call(this,t,n)||this}return i(t,e),t.prototype.onend=function(){var e,t,n=y(x,this.dom);if(n){var r={};if("feed"===n.name){var i=n.children;r.type="atom",w(r,"id","id",i),w(r,"title","title",i);var o=b("href",y("link",i));o&&(r.link=o),w(r,"description","subtitle",i),(s=v("updated",i))&&(r.updated=new Date(s)),w(r,"author","email",i,!0),r.items=g("entry",i).map((function(e){var t={},n=e.children;w(t,"id","id",n),w(t,"title","title",n);var r=b("href",y("link",n));r&&(t.link=r);var i=v("summary",n)||v("content",n);i&&(t.description=i);var o=v("updated",n);return o&&(t.pubDate=new Date(o)),t.media=m(n),t}))}else{var s;i=null!==(t=null===(e=y("channel",n.children))||void 0===e?void 0:e.children)&&void 0!==t?t:[],r.type=n.name.substr(0,3),r.id="",w(r,"title","title",i),w(r,"link","link",i),w(r,"description","description",i),(s=v("lastBuildDate",i))&&(r.updated=new Date(s)),w(r,"author","managingEditor",i,!0),r.items=g("item",n.children).map((function(e){var t={},n=e.children;w(t,"id","guid",n),w(t,"title","title",n),w(t,"link","link",n),w(t,"description","description",n);var r=v("pubDate",n);return r&&(t.pubDate=new Date(r)),t.media=m(n),t}))}this.feed=r,this.handleCallback(null)}else this.handleCallback(new Error("couldn't find root of feed"))},t}(h.default);function m(e){return g("media:content",e).map((function(e){var t={medium:e.attribs.medium,isDefault:!!e.attribs.isDefault};return e.attribs.url&&(t.url=e.attribs.url),e.attribs.fileSize&&(t.fileSize=parseInt(e.attribs.fileSize,10)),e.attribs.type&&(t.type=e.attribs.type),e.attribs.expression&&(t.expression=e.attribs.expression),e.attribs.bitrate&&(t.bitrate=parseInt(e.attribs.bitrate,10)),e.attribs.framerate&&(t.framerate=parseInt(e.attribs.framerate,10)),e.attribs.samplingrate&&(t.samplingrate=parseInt(e.attribs.samplingrate,10)),e.attribs.channels&&(t.channels=parseInt(e.attribs.channels,10)),e.attribs.duration&&(t.duration=parseInt(e.attribs.duration,10)),e.attribs.height&&(t.height=parseInt(e.attribs.height,10)),e.attribs.width&&(t.width=parseInt(e.attribs.width,10)),e.attribs.lang&&(t.lang=e.attribs.lang),t}))}function g(e,t){return d.getElementsByTagName(e,t,!0)}function y(e,t){return d.getElementsByTagName(e,t,!0,1)[0]}function v(e,t,n){return void 0===n&&(n=!1),d.getText(d.getElementsByTagName(e,t,n,1)).trim()}function b(e,t){return t?t.attribs[e]:null}function w(e,t,n,r,i){void 0===i&&(i=!1);var o=v(n,r,i);o&&(e[t]=o)}function x(e){return"rss"===e||"feed"===e||"rdf:RDF"===e}t.FeedHandler=p,t.parseFeed=function(e,t){void 0===t&&(t={xmlMode:!0});var n=new p(t);return new f.Parser(n,t).end(e),n.feed}},4418:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;var i=r(n(4614)),o=new Set(["input","option","optgroup","select","button","datalist","textarea"]),s=new Set(["p"]),a={tr:new Set(["tr","th","td"]),th:new Set(["th"]),td:new Set(["thead","th","td"]),body:new Set(["head","link","script"]),li:new Set(["li"]),p:s,h1:s,h2:s,h3:s,h4:s,h5:s,h6:s,select:o,input:o,output:o,button:o,datalist:o,textarea:o,option:new Set(["option"]),optgroup:new Set(["optgroup","option"]),dd:new Set(["dt","dd"]),dt:new Set(["dt","dd"]),address:s,article:s,aside:s,blockquote:s,details:s,div:s,dl:s,fieldset:s,figcaption:s,figure:s,footer:s,form:s,header:s,hr:s,main:s,nav:s,ol:s,pre:s,section:s,table:s,ul:s,rt:new Set(["rt","rp"]),rp:new Set(["rt","rp"]),tbody:new Set(["thead","tbody"]),tfoot:new Set(["thead","tbody"])},l=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),c=new Set(["math","svg"]),u=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),h=/\s|\//,d=function(){function e(e,t){var n,r,o,s,a;void 0===t&&(t={}),this.startIndex=0,this.endIndex=null,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.options=t,this.cbs=null!=e?e:{},this.lowerCaseTagNames=null!==(n=t.lowerCaseTags)&&void 0!==n?n:!t.xmlMode,this.lowerCaseAttributeNames=null!==(r=t.lowerCaseAttributeNames)&&void 0!==r?r:!t.xmlMode,this.tokenizer=new(null!==(o=t.Tokenizer)&&void 0!==o?o:i.default)(this.options,this),null===(a=(s=this.cbs).onparserinit)||void 0===a||a.call(s,this)}return e.prototype.updatePosition=function(e){null===this.endIndex?this.tokenizer.sectionStart<=e?this.startIndex=0:this.startIndex=this.tokenizer.sectionStart-e:this.startIndex=this.endIndex+1,this.endIndex=this.tokenizer.getAbsoluteIndex()},e.prototype.ontext=function(e){var t,n;this.updatePosition(1),this.endIndex--,null===(n=(t=this.cbs).ontext)||void 0===n||n.call(t,e)},e.prototype.onopentagname=function(e){var t,n;if(this.lowerCaseTagNames&&(e=e.toLowerCase()),this.tagname=e,!this.options.xmlMode&&Object.prototype.hasOwnProperty.call(a,e))for(var r=void 0;this.stack.length>0&&a[e].has(r=this.stack[this.stack.length-1]);)this.onclosetag(r);!this.options.xmlMode&&l.has(e)||(this.stack.push(e),c.has(e)?this.foreignContext.push(!0):u.has(e)&&this.foreignContext.push(!1)),null===(n=(t=this.cbs).onopentagname)||void 0===n||n.call(t,e),this.cbs.onopentag&&(this.attribs={})},e.prototype.onopentagend=function(){var e,t;this.updatePosition(1),this.attribs&&(null===(t=(e=this.cbs).onopentag)||void 0===t||t.call(e,this.tagname,this.attribs),this.attribs=null),!this.options.xmlMode&&this.cbs.onclosetag&&l.has(this.tagname)&&this.cbs.onclosetag(this.tagname),this.tagname=""},e.prototype.onclosetag=function(e){if(this.updatePosition(1),this.lowerCaseTagNames&&(e=e.toLowerCase()),(c.has(e)||u.has(e))&&this.foreignContext.pop(),!this.stack.length||!this.options.xmlMode&&l.has(e))this.options.xmlMode||"br"!==e&&"p"!==e||(this.onopentagname(e),this.closeCurrentTag());else{var t=this.stack.lastIndexOf(e);if(-1!==t)if(this.cbs.onclosetag)for(t=this.stack.length-t;t--;)this.cbs.onclosetag(this.stack.pop());else this.stack.length=t;else"p"!==e||this.options.xmlMode||(this.onopentagname(e),this.closeCurrentTag())}},e.prototype.onselfclosingtag=function(){this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?this.closeCurrentTag():this.onopentagend()},e.prototype.closeCurrentTag=function(){var e,t,n=this.tagname;this.onopentagend(),this.stack[this.stack.length-1]===n&&(null===(t=(e=this.cbs).onclosetag)||void 0===t||t.call(e,n),this.stack.pop())},e.prototype.onattribname=function(e){this.lowerCaseAttributeNames&&(e=e.toLowerCase()),this.attribname=e},e.prototype.onattribdata=function(e){this.attribvalue+=e},e.prototype.onattribend=function(e){var t,n;null===(n=(t=this.cbs).onattribute)||void 0===n||n.call(t,this.attribname,this.attribvalue,e),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribname="",this.attribvalue=""},e.prototype.getInstructionName=function(e){var t=e.search(h),n=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n},e.prototype.ondeclaration=function(e){if(this.cbs.onprocessinginstruction){var t=this.getInstructionName(e);this.cbs.onprocessinginstruction("!"+t,"!"+e)}},e.prototype.onprocessinginstruction=function(e){if(this.cbs.onprocessinginstruction){var t=this.getInstructionName(e);this.cbs.onprocessinginstruction("?"+t,"?"+e)}},e.prototype.oncomment=function(e){var t,n,r,i;this.updatePosition(4),null===(n=(t=this.cbs).oncomment)||void 0===n||n.call(t,e),null===(i=(r=this.cbs).oncommentend)||void 0===i||i.call(r)},e.prototype.oncdata=function(e){var t,n,r,i,o,s;this.updatePosition(1),this.options.xmlMode||this.options.recognizeCDATA?(null===(n=(t=this.cbs).oncdatastart)||void 0===n||n.call(t),null===(i=(r=this.cbs).ontext)||void 0===i||i.call(r,e),null===(s=(o=this.cbs).oncdataend)||void 0===s||s.call(o)):this.oncomment("[CDATA["+e+"]]")},e.prototype.onerror=function(e){var t,n;null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,e)},e.prototype.onend=function(){var e,t;if(this.cbs.onclosetag)for(var n=this.stack.length;n>0;this.cbs.onclosetag(this.stack[--n]));null===(t=(e=this.cbs).onend)||void 0===t||t.call(e)},e.prototype.reset=function(){var e,t,n,r;null===(t=(e=this.cbs).onreset)||void 0===t||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack=[],null===(r=(n=this.cbs).onparserinit)||void 0===r||r.call(n,this)},e.prototype.parseComplete=function(e){this.reset(),this.end(e)},e.prototype.write=function(e){this.tokenizer.write(e)},e.prototype.end=function(e){this.tokenizer.end(e)},e.prototype.pause=function(){this.tokenizer.pause()},e.prototype.resume=function(){this.tokenizer.resume()},e.prototype.parseChunk=function(e){this.write(e)},e.prototype.done=function(e){this.end(e)},e}();t.Parser=d},4614:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(8787)),o=r(n(2834)),s=r(n(2061)),a=r(n(5529));function l(e){return" "===e||"\n"===e||"\t"===e||"\f"===e||"\r"===e}function c(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function u(e,t,n){var r=e.toLowerCase();return e===r?function(e,i){i===r?e._state=t:(e._state=n,e._index--)}:function(i,o){o===r||o===e?i._state=t:(i._state=n,i._index--)}}function h(e,t){var n=e.toLowerCase();return function(r,i){i===n||i===e?r._state=t:(r._state=3,r._index--)}}var d=u("C",24,16),f=u("D",25,16),p=u("A",26,16),m=u("T",27,16),g=u("A",28,16),y=h("R",35),v=h("I",36),b=h("P",37),w=h("T",38),x=u("R",40,1),E=u("I",41,1),_=u("P",42,1),S=u("T",43,1),C=h("Y",45),T=h("L",46),O=h("E",47),P=u("Y",49,1),A=u("L",50,1),k=u("E",51,1),M=h("I",54),N=h("T",55),L=h("L",56),R=h("E",57),I=u("I",58,1),D=u("T",59,1),j=u("L",60,1),F=u("E",61,1),z=u("#",63,64),B=u("X",66,65),U=function(){function e(e,t){var n;this._state=1,this.buffer="",this.sectionStart=0,this._index=0,this.bufferOffset=0,this.baseState=1,this.special=1,this.running=!0,this.ended=!1,this.cbs=t,this.xmlMode=!!(null==e?void 0:e.xmlMode),this.decodeEntities=null===(n=null==e?void 0:e.decodeEntities)||void 0===n||n}return e.prototype.reset=function(){this._state=1,this.buffer="",this.sectionStart=0,this._index=0,this.bufferOffset=0,this.baseState=1,this.special=1,this.running=!0,this.ended=!1},e.prototype.write=function(e){this.ended&&this.cbs.onerror(Error(".write() after done!")),this.buffer+=e,this.parse()},e.prototype.end=function(e){this.ended&&this.cbs.onerror(Error(".end() after done!")),e&&this.write(e),this.ended=!0,this.running&&this.finish()},e.prototype.pause=function(){this.running=!1},e.prototype.resume=function(){this.running=!0,this._index<this.buffer.length&&this.parse(),this.ended&&this.finish()},e.prototype.getAbsoluteIndex=function(){return this.bufferOffset+this._index},e.prototype.stateText=function(e){"<"===e?(this._index>this.sectionStart&&this.cbs.ontext(this.getSection()),this._state=2,this.sectionStart=this._index):!this.decodeEntities||"&"!==e||1!==this.special&&4!==this.special||(this._index>this.sectionStart&&this.cbs.ontext(this.getSection()),this.baseState=1,this._state=62,this.sectionStart=this._index)},e.prototype.isTagStartChar=function(e){return c(e)||this.xmlMode&&!l(e)&&"/"!==e&&">"!==e},e.prototype.stateBeforeTagName=function(e){"/"===e?this._state=5:"<"===e?(this.cbs.ontext(this.getSection()),this.sectionStart=this._index):">"===e||1!==this.special||l(e)?this._state=1:"!"===e?(this._state=15,this.sectionStart=this._index+1):"?"===e?(this._state=17,this.sectionStart=this._index+1):this.isTagStartChar(e)?(this._state=this.xmlMode||"s"!==e&&"S"!==e?this.xmlMode||"t"!==e&&"T"!==e?3:52:32,this.sectionStart=this._index):this._state=1},e.prototype.stateInTagName=function(e){("/"===e||">"===e||l(e))&&(this.emitToken("onopentagname"),this._state=8,this._index--)},e.prototype.stateBeforeClosingTagName=function(e){l(e)||(">"===e?this._state=1:1!==this.special?4===this.special||"s"!==e&&"S"!==e?4!==this.special||"t"!==e&&"T"!==e?(this._state=1,this._index--):this._state=53:this._state=33:this.isTagStartChar(e)?(this._state=6,this.sectionStart=this._index):(this._state=20,this.sectionStart=this._index))},e.prototype.stateInClosingTagName=function(e){(">"===e||l(e))&&(this.emitToken("onclosetag"),this._state=7,this._index--)},e.prototype.stateAfterClosingTagName=function(e){">"===e&&(this._state=1,this.sectionStart=this._index+1)},e.prototype.stateBeforeAttributeName=function(e){">"===e?(this.cbs.onopentagend(),this._state=1,this.sectionStart=this._index+1):"/"===e?this._state=4:l(e)||(this._state=9,this.sectionStart=this._index)},e.prototype.stateInSelfClosingTag=function(e){">"===e?(this.cbs.onselfclosingtag(),this._state=1,this.sectionStart=this._index+1,this.special=1):l(e)||(this._state=8,this._index--)},e.prototype.stateInAttributeName=function(e){("="===e||"/"===e||">"===e||l(e))&&(this.cbs.onattribname(this.getSection()),this.sectionStart=-1,this._state=10,this._index--)},e.prototype.stateAfterAttributeName=function(e){"="===e?this._state=11:"/"===e||">"===e?(this.cbs.onattribend(void 0),this._state=8,this._index--):l(e)||(this.cbs.onattribend(void 0),this._state=9,this.sectionStart=this._index)},e.prototype.stateBeforeAttributeValue=function(e){'"'===e?(this._state=12,this.sectionStart=this._index+1):"'"===e?(this._state=13,this.sectionStart=this._index+1):l(e)||(this._state=14,this.sectionStart=this._index,this._index--)},e.prototype.handleInAttributeValue=function(e,t){e===t?(this.emitToken("onattribdata"),this.cbs.onattribend(t),this._state=8):this.decodeEntities&&"&"===e&&(this.emitToken("onattribdata"),this.baseState=this._state,this._state=62,this.sectionStart=this._index)},e.prototype.stateInAttributeValueDoubleQuotes=function(e){this.handleInAttributeValue(e,'"')},e.prototype.stateInAttributeValueSingleQuotes=function(e){this.handleInAttributeValue(e,"'")},e.prototype.stateInAttributeValueNoQuotes=function(e){l(e)||">"===e?(this.emitToken("onattribdata"),this.cbs.onattribend(null),this._state=8,this._index--):this.decodeEntities&&"&"===e&&(this.emitToken("onattribdata"),this.baseState=this._state,this._state=62,this.sectionStart=this._index)},e.prototype.stateBeforeDeclaration=function(e){this._state="["===e?23:"-"===e?18:16},e.prototype.stateInDeclaration=function(e){">"===e&&(this.cbs.ondeclaration(this.getSection()),this._state=1,this.sectionStart=this._index+1)},e.prototype.stateInProcessingInstruction=function(e){">"===e&&(this.cbs.onprocessinginstruction(this.getSection()),this._state=1,this.sectionStart=this._index+1)},e.prototype.stateBeforeComment=function(e){"-"===e?(this._state=19,this.sectionStart=this._index+1):this._state=16},e.prototype.stateInComment=function(e){"-"===e&&(this._state=21)},e.prototype.stateInSpecialComment=function(e){">"===e&&(this.cbs.oncomment(this.buffer.substring(this.sectionStart,this._index)),this._state=1,this.sectionStart=this._index+1)},e.prototype.stateAfterComment1=function(e){this._state="-"===e?22:19},e.prototype.stateAfterComment2=function(e){">"===e?(this.cbs.oncomment(this.buffer.substring(this.sectionStart,this._index-2)),this._state=1,this.sectionStart=this._index+1):"-"!==e&&(this._state=19)},e.prototype.stateBeforeCdata6=function(e){"["===e?(this._state=29,this.sectionStart=this._index+1):(this._state=16,this._index--)},e.prototype.stateInCdata=function(e){"]"===e&&(this._state=30)},e.prototype.stateAfterCdata1=function(e){this._state="]"===e?31:29},e.prototype.stateAfterCdata2=function(e){">"===e?(this.cbs.oncdata(this.buffer.substring(this.sectionStart,this._index-2)),this._state=1,this.sectionStart=this._index+1):"]"!==e&&(this._state=29)},e.prototype.stateBeforeSpecialS=function(e){"c"===e||"C"===e?this._state=34:"t"===e||"T"===e?this._state=44:(this._state=3,this._index--)},e.prototype.stateBeforeSpecialSEnd=function(e){2!==this.special||"c"!==e&&"C"!==e?3!==this.special||"t"!==e&&"T"!==e?this._state=1:this._state=48:this._state=39},e.prototype.stateBeforeSpecialLast=function(e,t){("/"===e||">"===e||l(e))&&(this.special=t),this._state=3,this._index--},e.prototype.stateAfterSpecialLast=function(e,t){">"===e||l(e)?(this.special=1,this._state=6,this.sectionStart=this._index-t,this._index--):this._state=1},e.prototype.parseFixedEntity=function(e){if(void 0===e&&(e=this.xmlMode?a.default:o.default),this.sectionStart+1<this._index){var t=this.buffer.substring(this.sectionStart+1,this._index);Object.prototype.hasOwnProperty.call(e,t)&&(this.emitPartial(e[t]),this.sectionStart=this._index+1)}},e.prototype.parseLegacyEntity=function(){for(var e=this.sectionStart+1,t=Math.min(this._index-e,6);t>=2;){var n=this.buffer.substr(e,t);if(Object.prototype.hasOwnProperty.call(s.default,n))return this.emitPartial(s.default[n]),void(this.sectionStart+=t+1);t--}},e.prototype.stateInNamedEntity=function(e){";"===e?(this.parseFixedEntity(),1===this.baseState&&this.sectionStart+1<this._index&&!this.xmlMode&&this.parseLegacyEntity(),this._state=this.baseState):(e<"0"||e>"9")&&!c(e)&&(this.xmlMode||this.sectionStart+1===this._index||(1!==this.baseState?"="!==e&&this.parseFixedEntity(s.default):this.parseLegacyEntity()),this._state=this.baseState,this._index--)},e.prototype.decodeNumericEntity=function(e,t,n){var r=this.sectionStart+e;if(r!==this._index){var o=this.buffer.substring(r,this._index),s=parseInt(o,t);this.emitPartial(i.default(s)),this.sectionStart=n?this._index+1:this._index}this._state=this.baseState},e.prototype.stateInNumericEntity=function(e){";"===e?this.decodeNumericEntity(2,10,!0):(e<"0"||e>"9")&&(this.xmlMode?this._state=this.baseState:this.decodeNumericEntity(2,10,!1),this._index--)},e.prototype.stateInHexEntity=function(e){";"===e?this.decodeNumericEntity(3,16,!0):(e<"a"||e>"f")&&(e<"A"||e>"F")&&(e<"0"||e>"9")&&(this.xmlMode?this._state=this.baseState:this.decodeNumericEntity(3,16,!1),this._index--)},e.prototype.cleanup=function(){this.sectionStart<0?(this.buffer="",this.bufferOffset+=this._index,this._index=0):this.running&&(1===this._state?(this.sectionStart!==this._index&&this.cbs.ontext(this.buffer.substr(this.sectionStart)),this.buffer="",this.bufferOffset+=this._index,this._index=0):this.sectionStart===this._index?(this.buffer="",this.bufferOffset+=this._index,this._index=0):(this.buffer=this.buffer.substr(this.sectionStart),this._index-=this.sectionStart,this.bufferOffset+=this.sectionStart),this.sectionStart=0)},e.prototype.parse=function(){for(;this._index<this.buffer.length&&this.running;){var e=this.buffer.charAt(this._index);1===this._state?this.stateText(e):12===this._state?this.stateInAttributeValueDoubleQuotes(e):9===this._state?this.stateInAttributeName(e):19===this._state?this.stateInComment(e):20===this._state?this.stateInSpecialComment(e):8===this._state?this.stateBeforeAttributeName(e):3===this._state?this.stateInTagName(e):6===this._state?this.stateInClosingTagName(e):2===this._state?this.stateBeforeTagName(e):10===this._state?this.stateAfterAttributeName(e):13===this._state?this.stateInAttributeValueSingleQuotes(e):11===this._state?this.stateBeforeAttributeValue(e):5===this._state?this.stateBeforeClosingTagName(e):7===this._state?this.stateAfterClosingTagName(e):32===this._state?this.stateBeforeSpecialS(e):21===this._state?this.stateAfterComment1(e):14===this._state?this.stateInAttributeValueNoQuotes(e):4===this._state?this.stateInSelfClosingTag(e):16===this._state?this.stateInDeclaration(e):15===this._state?this.stateBeforeDeclaration(e):22===this._state?this.stateAfterComment2(e):18===this._state?this.stateBeforeComment(e):33===this._state?this.stateBeforeSpecialSEnd(e):53===this._state?I(this,e):39===this._state?x(this,e):40===this._state?E(this,e):41===this._state?_(this,e):34===this._state?y(this,e):35===this._state?v(this,e):36===this._state?b(this,e):37===this._state?w(this,e):38===this._state?this.stateBeforeSpecialLast(e,2):42===this._state?S(this,e):43===this._state?this.stateAfterSpecialLast(e,6):44===this._state?C(this,e):29===this._state?this.stateInCdata(e):45===this._state?T(this,e):46===this._state?O(this,e):47===this._state?this.stateBeforeSpecialLast(e,3):48===this._state?P(this,e):49===this._state?A(this,e):50===this._state?k(this,e):51===this._state?this.stateAfterSpecialLast(e,5):52===this._state?M(this,e):54===this._state?N(this,e):55===this._state?L(this,e):56===this._state?R(this,e):57===this._state?this.stateBeforeSpecialLast(e,4):58===this._state?D(this,e):59===this._state?j(this,e):60===this._state?F(this,e):61===this._state?this.stateAfterSpecialLast(e,5):17===this._state?this.stateInProcessingInstruction(e):64===this._state?this.stateInNamedEntity(e):23===this._state?d(this,e):62===this._state?z(this,e):24===this._state?f(this,e):25===this._state?p(this,e):30===this._state?this.stateAfterCdata1(e):31===this._state?this.stateAfterCdata2(e):26===this._state?m(this,e):27===this._state?g(this,e):28===this._state?this.stateBeforeCdata6(e):66===this._state?this.stateInHexEntity(e):65===this._state?this.stateInNumericEntity(e):63===this._state?B(this,e):this.cbs.onerror(Error("unknown _state"),this._state),this._index++}this.cleanup()},e.prototype.finish=function(){this.sectionStart<this._index&&this.handleTrailingData(),this.cbs.onend()},e.prototype.handleTrailingData=function(){var e=this.buffer.substr(this.sectionStart);29===this._state||30===this._state||31===this._state?this.cbs.oncdata(e):19===this._state||21===this._state||22===this._state?this.cbs.oncomment(e):64!==this._state||this.xmlMode?65!==this._state||this.xmlMode?66!==this._state||this.xmlMode?3!==this._state&&8!==this._state&&11!==this._state&&10!==this._state&&9!==this._state&&13!==this._state&&12!==this._state&&14!==this._state&&6!==this._state&&this.cbs.ontext(e):(this.decodeNumericEntity(3,16,!1),this.sectionStart<this._index&&(this._state=this.baseState,this.handleTrailingData())):(this.decodeNumericEntity(2,10,!1),this.sectionStart<this._index&&(this._state=this.baseState,this.handleTrailingData())):(this.parseLegacyEntity(),this.sectionStart<this._index&&(this._state=this.baseState,this.handleTrailingData()))},e.prototype.getSection=function(){return this.buffer.substring(this.sectionStart,this._index)},e.prototype.emitToken=function(e){this.cbs[e](this.getSection()),this.sectionStart=-1},e.prototype.emitPartial=function(e){1!==this.baseState?this.cbs.onattribdata(e):this.cbs.ontext(e)},e}();t.default=U},2904:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RssHandler=t.DefaultHandler=t.DomUtils=t.ElementType=t.Tokenizer=t.createDomStream=t.parseDOM=t.parseDocument=t.DomHandler=t.Parser=void 0;var l=n(4418);Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return l.Parser}});var c=n(6722);function u(e,t){var n=new c.DomHandler(void 0,t);return new l.Parser(n,t).end(e),n.root}Object.defineProperty(t,"DomHandler",{enumerable:!0,get:function(){return c.DomHandler}}),Object.defineProperty(t,"DefaultHandler",{enumerable:!0,get:function(){return c.DomHandler}}),t.parseDocument=u,t.parseDOM=function(e,t){return u(e,t).children},t.createDomStream=function(e,t,n){var r=new c.DomHandler(e,t,n);return new l.Parser(r,t)};var h=n(4614);Object.defineProperty(t,"Tokenizer",{enumerable:!0,get:function(){return a(h).default}});var d=o(n(3930));t.ElementType=d,s(n(7848),t),t.DomUtils=o(n(3114));var f=n(7848);Object.defineProperty(t,"RssHandler",{enumerable:!0,get:function(){return f.FeedHandler}})},2573:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attributeNames=t.elementNames=void 0,t.elementNames=new Map([["altglyph","altGlyph"],["altglyphdef","altGlyphDef"],["altglyphitem","altGlyphItem"],["animatecolor","animateColor"],["animatemotion","animateMotion"],["animatetransform","animateTransform"],["clippath","clipPath"],["feblend","feBlend"],["fecolormatrix","feColorMatrix"],["fecomponenttransfer","feComponentTransfer"],["fecomposite","feComposite"],["feconvolvematrix","feConvolveMatrix"],["fediffuselighting","feDiffuseLighting"],["fedisplacementmap","feDisplacementMap"],["fedistantlight","feDistantLight"],["fedropshadow","feDropShadow"],["feflood","feFlood"],["fefunca","feFuncA"],["fefuncb","feFuncB"],["fefuncg","feFuncG"],["fefuncr","feFuncR"],["fegaussianblur","feGaussianBlur"],["feimage","feImage"],["femerge","feMerge"],["femergenode","feMergeNode"],["femorphology","feMorphology"],["feoffset","feOffset"],["fepointlight","fePointLight"],["fespecularlighting","feSpecularLighting"],["fespotlight","feSpotLight"],["fetile","feTile"],["feturbulence","feTurbulence"],["foreignobject","foreignObject"],["glyphref","glyphRef"],["lineargradient","linearGradient"],["radialgradient","radialGradient"],["textpath","textPath"]]),t.attributeNames=new Map([["definitionurl","definitionURL"],["attributename","attributeName"],["attributetype","attributeType"],["basefrequency","baseFrequency"],["baseprofile","baseProfile"],["calcmode","calcMode"],["clippathunits","clipPathUnits"],["diffuseconstant","diffuseConstant"],["edgemode","edgeMode"],["filterunits","filterUnits"],["glyphref","glyphRef"],["gradienttransform","gradientTransform"],["gradientunits","gradientUnits"],["kernelmatrix","kernelMatrix"],["kernelunitlength","kernelUnitLength"],["keypoints","keyPoints"],["keysplines","keySplines"],["keytimes","keyTimes"],["lengthadjust","lengthAdjust"],["limitingconeangle","limitingConeAngle"],["markerheight","markerHeight"],["markerunits","markerUnits"],["markerwidth","markerWidth"],["maskcontentunits","maskContentUnits"],["maskunits","maskUnits"],["numoctaves","numOctaves"],["pathlength","pathLength"],["patterncontentunits","patternContentUnits"],["patterntransform","patternTransform"],["patternunits","patternUnits"],["pointsatx","pointsAtX"],["pointsaty","pointsAtY"],["pointsatz","pointsAtZ"],["preservealpha","preserveAlpha"],["preserveaspectratio","preserveAspectRatio"],["primitiveunits","primitiveUnits"],["refx","refX"],["refy","refY"],["repeatcount","repeatCount"],["repeatdur","repeatDur"],["requiredextensions","requiredExtensions"],["requiredfeatures","requiredFeatures"],["specularconstant","specularConstant"],["specularexponent","specularExponent"],["spreadmethod","spreadMethod"],["startoffset","startOffset"],["stddeviation","stdDeviation"],["stitchtiles","stitchTiles"],["surfacescale","surfaceScale"],["systemlanguage","systemLanguage"],["tablevalues","tableValues"],["targetx","targetX"],["targety","targetY"],["textlength","textLength"],["viewbox","viewBox"],["viewtarget","viewTarget"],["xchannelselector","xChannelSelector"],["ychannelselector","yChannelSelector"],["zoomandpan","zoomAndPan"]])},1236:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3930)),l=n(9625),c=n(2573),u=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]),h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function d(e,t){void 0===t&&(t={});for(var n=("length"in e?e:[e]),r="",i=0;i<n.length;i++)r+=f(n[i],t);return r}function f(e,t){switch(e.type){case a.Root:return d(e.children,t);case a.Directive:case a.Doctype:return"<"+e.data+">";case a.Comment:return"\x3c!--"+e.data+"--\x3e";case a.CDATA:return function(e){return"<![CDATA["+e.children[0].data+"]]>"}(e);case a.Script:case a.Style:case a.Tag:return function(e,t){var n;"foreign"===t.xmlMode&&(e.name=null!==(n=c.elementNames.get(e.name))&&void 0!==n?n:e.name,e.parent&&p.has(e.parent.name)&&(t=r(r({},t),{xmlMode:!1}))),!t.xmlMode&&m.has(e.name)&&(t=r(r({},t),{xmlMode:"foreign"}));var i="<"+e.name,o=function(e,t){if(e)return Object.keys(e).map((function(n){var r,i,o=null!==(r=e[n])&&void 0!==r?r:"";return"foreign"===t.xmlMode&&(n=null!==(i=c.attributeNames.get(n))&&void 0!==i?i:n),t.emptyAttrs||t.xmlMode||""!==o?n+'="'+(!1!==t.decodeEntities?l.encodeXML(o):o.replace(/"/g,"&quot;"))+'"':n})).join(" ")}(e.attribs,t);return o&&(i+=" "+o),0===e.children.length&&(t.xmlMode?!1!==t.selfClosingTags:t.selfClosingTags&&h.has(e.name))?(t.xmlMode||(i+=" "),i+="/>"):(i+=">",e.children.length>0&&(i+=d(e.children,t)),!t.xmlMode&&h.has(e.name)||(i+="</"+e.name+">")),i}(e,t);case a.Text:return function(e,t){var n=e.data||"";return!1===t.decodeEntities||!t.xmlMode&&e.parent&&u.has(e.parent.name)||(n=l.encodeXML(n)),n}(e,t)}}t.default=d;var p=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),m=new Set(["svg","math"])},3930:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(n=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===n.Tag||e.type===n.Script||e.type===n.Style},t.Root=n.Root,t.Text=n.Text,t.Directive=n.Directive,t.Comment=n.Comment,t.Script=n.Script,t.Style=n.Style,t.Tag=n.Tag,t.CDATA=n.CDATA,t.Doctype=n.Doctype},6042:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueSort=t.compareDocumentPosition=t.removeSubsets=void 0;var r=n(6722);function i(e,t){var n=[],i=[];if(e===t)return 0;for(var o=r.hasChildren(e)?e:e.parent;o;)n.unshift(o),o=o.parent;for(o=r.hasChildren(t)?t:t.parent;o;)i.unshift(o),o=o.parent;for(var s=Math.min(n.length,i.length),a=0;a<s&&n[a]===i[a];)a++;if(0===a)return 1;var l=n[a-1],c=l.children,u=n[a],h=i[a];return c.indexOf(u)>c.indexOf(h)?l===t?20:4:l===e?10:2}t.removeSubsets=function(e){for(var t=e.length;--t>=0;){var n=e[t];if(t>0&&e.lastIndexOf(n,t-1)>=0)e.splice(t,1);else for(var r=n.parent;r;r=r.parent)if(e.includes(r)){e.splice(t,1);break}}return e},t.compareDocumentPosition=i,t.uniqueSort=function(e){return(e=e.filter((function(e,t,n){return!n.includes(e,t+1)}))).sort((function(e,t){var n=i(e,t);return 2&n?-1:4&n?1:0})),e}},3114:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.hasChildren=t.isDocument=t.isComment=t.isText=t.isCDATA=t.isTag=void 0,i(n(2553),t),i(n(3434),t),i(n(6470),t),i(n(3636),t),i(n(3754),t),i(n(6042),t);var o=n(6722);Object.defineProperty(t,"isTag",{enumerable:!0,get:function(){return o.isTag}}),Object.defineProperty(t,"isCDATA",{enumerable:!0,get:function(){return o.isCDATA}}),Object.defineProperty(t,"isText",{enumerable:!0,get:function(){return o.isText}}),Object.defineProperty(t,"isComment",{enumerable:!0,get:function(){return o.isComment}}),Object.defineProperty(t,"isDocument",{enumerable:!0,get:function(){return o.isDocument}}),Object.defineProperty(t,"hasChildren",{enumerable:!0,get:function(){return o.hasChildren}})},3754:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementsByTagType=t.getElementsByTagName=t.getElementById=t.getElements=t.testElement=void 0;var r=n(6722),i=n(3636),o={tag_name:function(e){return"function"==typeof e?function(t){return r.isTag(t)&&e(t.name)}:"*"===e?r.isTag:function(t){return r.isTag(t)&&t.name===e}},tag_type:function(e){return"function"==typeof e?function(t){return e(t.type)}:function(t){return t.type===e}},tag_contains:function(e){return"function"==typeof e?function(t){return r.isText(t)&&e(t.data)}:function(t){return r.isText(t)&&t.data===e}}};function s(e,t){return"function"==typeof t?function(n){return r.isTag(n)&&t(n.attribs[e])}:function(n){return r.isTag(n)&&n.attribs[e]===t}}function a(e,t){return function(n){return e(n)||t(n)}}function l(e){var t=Object.keys(e).map((function(t){var n=e[t];return t in o?o[t](n):s(t,n)}));return 0===t.length?null:t.reduce(a)}t.testElement=function(e,t){var n=l(e);return!n||n(t)},t.getElements=function(e,t,n,r){void 0===r&&(r=1/0);var o=l(e);return o?i.filter(o,t,n,r):[]},t.getElementById=function(e,t,n){return void 0===n&&(n=!0),Array.isArray(t)||(t=[t]),i.findOne(s("id",e),t,n)},t.getElementsByTagName=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),i.filter(o.tag_name(e),t,n,r)},t.getElementsByTagType=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),i.filter(o.tag_type(e),t,n,r)}},6470:function(e,t){"use strict";function n(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var t=e.parent.children;t.splice(t.lastIndexOf(e),1)}}Object.defineProperty(t,"__esModule",{value:!0}),t.prepend=t.prependChild=t.append=t.appendChild=t.replaceElement=t.removeElement=void 0,t.removeElement=n,t.replaceElement=function(e,t){var n=t.prev=e.prev;n&&(n.next=t);var r=t.next=e.next;r&&(r.prev=t);var i=t.parent=e.parent;if(i){var o=i.children;o[o.lastIndexOf(e)]=t}},t.appendChild=function(e,t){if(n(t),t.next=null,t.parent=e,e.children.push(t)>1){var r=e.children[e.children.length-2];r.next=t,t.prev=r}else t.prev=null},t.append=function(e,t){n(t);var r=e.parent,i=e.next;if(t.next=i,t.prev=e,e.next=t,t.parent=r,i){if(i.prev=t,r){var o=r.children;o.splice(o.lastIndexOf(i),0,t)}}else r&&r.children.push(t)},t.prependChild=function(e,t){if(n(t),t.parent=e,t.prev=null,1!==e.children.unshift(t)){var r=e.children[1];r.prev=t,t.next=r}else t.next=null},t.prepend=function(e,t){n(t);var r=e.parent;if(r){var i=r.children;i.splice(i.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=r,t.prev=e.prev,t.next=e,e.prev=t}},3636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAll=t.existsOne=t.findOne=t.findOneChild=t.find=t.filter=void 0;var r=n(6722);function i(e,t,n,o){for(var s=[],a=0,l=t;a<l.length;a++){var c=l[a];if(e(c)&&(s.push(c),--o<=0))break;if(n&&r.hasChildren(c)&&c.children.length>0){var u=i(e,c.children,n,o);if(s.push.apply(s,u),(o-=u.length)<=0)break}}return s}t.filter=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),Array.isArray(t)||(t=[t]),i(e,t,n,r)},t.find=i,t.findOneChild=function(e,t){return t.find(e)},t.findOne=function e(t,n,i){void 0===i&&(i=!0);for(var o=null,s=0;s<n.length&&!o;s++){var a=n[s];r.isTag(a)&&(t(a)?o=a:i&&a.children.length>0&&(o=e(t,a.children)))}return o},t.existsOne=function e(t,n){return n.some((function(n){return r.isTag(n)&&(t(n)||n.children.length>0&&e(t,n.children))}))},t.findAll=function(e,t){for(var n,i,o=[],s=t.filter(r.isTag);i=s.shift();){var a=null===(n=i.children)||void 0===n?void 0:n.filter(r.isTag);a&&a.length>0&&s.unshift.apply(s,a),e(i)&&o.push(i)}return o}},2553:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.innerText=t.textContent=t.getText=t.getInnerHTML=t.getOuterHTML=void 0;var i=n(6722),o=r(n(1236)),s=n(3930);function a(e,t){return o.default(e,t)}t.getOuterHTML=a,t.getInnerHTML=function(e,t){return i.hasChildren(e)?e.children.map((function(e){return a(e,t)})).join(""):""},t.getText=function e(t){return Array.isArray(t)?t.map(e).join(""):i.isTag(t)?"br"===t.name?"\n":e(t.children):i.isCDATA(t)?e(t.children):i.isText(t)?t.data:""},t.textContent=function e(t){return Array.isArray(t)?t.map(e).join(""):i.isTag(t)||i.isCDATA(t)?e(t.children):i.isText(t)?t.data:""},t.innerText=function e(t){return Array.isArray(t)?t.map(e).join(""):i.hasChildren(t)&&t.type===s.ElementType.Tag||i.isCDATA(t)?e(t.children):i.isText(t)?t.data:""}},3434:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prevElementSibling=t.nextElementSibling=t.getName=t.hasAttrib=t.getAttributeValue=t.getSiblings=t.getParent=t.getChildren=void 0;var r=n(6722),i=[];function o(e){var t;return null!==(t=e.children)&&void 0!==t?t:i}function s(e){return e.parent||null}t.getChildren=o,t.getParent=s,t.getSiblings=function(e){var t=s(e);if(null!=t)return o(t);for(var n=[e],r=e.prev,i=e.next;null!=r;)n.unshift(r),r=r.prev;for(;null!=i;)n.push(i),i=i.next;return n},t.getAttributeValue=function(e,t){var n;return null===(n=e.attribs)||void 0===n?void 0:n[t]},t.hasAttrib=function(e,t){return null!=e.attribs&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&null!=e.attribs[t]},t.getName=function(e){return e.name},t.nextElementSibling=function(e){for(var t=e.next;null!==t&&!r.isTag(t);)t=t.next;return t},t.prevElementSibling=function(e){for(var t=e.prev;null!==t&&!r.isTag(t);)t=t.prev;return t}},5182:function(e){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},8628:function(e){var t=1e3,n=60*t,r=60*n,i=24*r;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,s){s=s||{};var a,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var s=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===c&&isFinite(e))return s.long?(a=e,(l=Math.abs(a))>=i?o(a,l,i,"day"):l>=r?o(a,l,r,"hour"):l>=n?o(a,l,n,"minute"):l>=t?o(a,l,t,"second"):a+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=r?Math.round(e/r)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2525:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var s,a,l=i(e),c=1;c<arguments.length;c++){for(var u in s=Object(arguments[c]))n.call(s,u)&&(l[u]=s[u]);if(t){a=t(s);for(var h=0;h<a.length;h++)r.call(s,a[h])&&(l[a[h]]=s[a[h]])}}return l}},6381:function(e,t){var n,r;n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,r=n&&/blob:/i.test((t.location||{}).protocol),i={},o=0,s={parse:function(n,r){var a=(r=r||{}).dynamicTyping||!1;if(x(a)&&(r.dynamicTypingFunction=a,a={}),r.dynamicTyping=a,r.transform=!!x(r.transform)&&r.transform,r.worker&&s.WORKERS_SUPPORTED){var l=function(){if(!s.WORKERS_SUPPORTED)return!1;var n,r,a=(n=t.URL||t.webkitURL||null,r=e.toString(),s.BLOB_URL||(s.BLOB_URL=n.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),l=new t.Worker(a);return l.onmessage=g,l.id=o++,i[l.id]=l}();return l.userStep=r.step,l.userChunk=r.chunk,l.userComplete=r.complete,l.userError=r.error,r.step=x(r.step),r.chunk=x(r.chunk),r.complete=x(r.complete),r.error=x(r.error),delete r.worker,void l.postMessage({input:n,config:r,workerId:l.id})}var f=null;return s.NODE_STREAM_INPUT,"string"==typeof n?f=r.download?new c(r):new h(r):!0===n.readable&&x(n.read)&&x(n.on)?f=new d(r):(t.File&&n instanceof File||n instanceof Object)&&(f=new u(r)),f.stream(n)},unparse:function(e,t){var n=!1,r=!0,i=",",o="\r\n",a='"',l=a+a,c=!1,u=null,h=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+a),"boolean"==typeof t.escapeFormulae&&(h=t.escapeFormulae)}}();var d=new RegExp(p(a),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,c);if("object"==typeof e[0])return f(u||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function f(e,t,n){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&0<e.length,l=!Array.isArray(t[0]);if(a&&r){for(var c=0;c<e.length;c++)0<c&&(s+=i),s+=m(e[c],c);0<t.length&&(s+=o)}for(var u=0;u<t.length;u++){var h=a?e.length:t[u].length,d=!1,f=a?0===Object.keys(t[u]).length:0===t[u].length;if(n&&!a&&(d="greedy"===n?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===n&&a){for(var p=[],g=0;g<h;g++){var y=l?e[g]:g;p.push(t[u][y])}d=""===p.join("").trim()}if(!d){for(var v=0;v<h;v++){0<v&&!f&&(s+=i);var b=a&&l?e[v]:v;s+=m(t[u][b],v)}u<t.length-1&&(!n||0<h&&!f)&&(s+=o)}}return s}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===h&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var r=e.toString().replace(d,l),o="boolean"==typeof n&&n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(r,s.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1);return o?a+r+a:r}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=m,s.ParserHandle=f,s.NetworkStreamer=c,s.FileStreamer=u,s.StringStreamer=h,s.ReadableStreamStreamer=d,t.jQuery){var a=t.jQuery;a.fn.parse=function(e){var n=e.config||{},r=[];return this.each((function(e){if("INPUT"!==a(this).prop("tagName").toUpperCase()||"file"!==a(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:a.extend({},n)})})),i(),this;function i(){if(0!==r.length){var t,n,i,l=r[0];if(x(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return"AbortError",t=l.file,n=l.inputElem,i=c.reason,void(x(e.error)&&e.error({name:"AbortError"},t,n,i));if("skip"===c.action)return void o();"object"==typeof c.config&&(l.instanceConfig=a.extend(l.instanceConfig,c.config))}else if("skip"===c)return void o()}var u=l.instanceConfig.complete;l.instanceConfig.complete=function(e){x(u)&&u(e,l.file,l.inputElem),o()},s.parse(l.file,l.instanceConfig)}else x(e.complete)&&e.complete()}function o(){r.splice(0,1),i()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&x(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var a=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=a.meta.cursor;this._finished||(this._partialLine=o.substring(l-this._baseIndex),this._baseIndex=l),a&&a.data&&(this._rowCount+=a.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:a,workerId:s.WORKER_ID,finished:c});else if(x(this._config.chunk)&&!n){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!c||!x(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){x(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),l.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function u(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),l.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,i)}var o=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function h(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function d(e){l.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=w((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=w((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=w((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=w((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,n,r,i=Math.pow(2,53),o=-i,a=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,l=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,c=this,u=0,h=0,d=!1,f=!1,g=[],y={data:[],errors:[],meta:{}};if(x(e.step)){var v=e.step;e.step=function(t){if(y=t,_())E();else{if(E(),0===y.data.length)return;u+=t.data.length,e.preview&&u>e.preview?n.abort():(y.data=y.data[0],v(y,c))}}}function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){if(y&&r&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines)for(var t=0;t<y.data.length;t++)w(y.data[t])&&y.data.splice(t--,1);return _()&&function(){if(y)if(Array.isArray(y.data[0])){for(var t=0;_()&&t<y.data.length;t++)y.data[t].forEach(n);y.data.splice(0,1)}else y.data.forEach(n);function n(t,n){x(e.transformHeader)&&(t=e.transformHeader(t,n)),g.push(t)}}(),function(){if(!y||!e.header&&!e.dynamicTyping&&!e.transform)return y;function t(t,n){var r,i=e.header?{}:[];for(r=0;r<t.length;r++){var o=r,s=t[r];e.header&&(o=r>=g.length?"__parsed_extra":g[r]),e.transform&&(s=e.transform(s,o)),s=S(o,s),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(s)):i[o]=s}return e.header&&(r>g.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+r,h+n):r<g.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+r,h+n)),i}var n=1;return!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(t),n=y.data.length):y.data=t(y.data,0),e.header&&y.meta&&(y.meta.fields=g),h+=n,y}()}function _(){return e.header&&0===g.length}function S(t,n){return r=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[r]&&(e.dynamicTyping[r]=e.dynamicTypingFunction(r)),!0===(e.dynamicTyping[r]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(a.test(e)){var t=parseFloat(e);if(o<t&&t<i)return!0}return!1}(n)?parseFloat(n):l.test(n)?new Date(n):""===n?null:n):n;var r}function C(e,t,n,r){var i={type:e,code:t,message:n};void 0!==r&&(i.row=r),y.errors.push(i)}this.parse=function(i,o,a){var l=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(p(t)+"([^]*?)"+p(t),"gm"),r=(e=e.replace(n,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<r[0].length;if(1===r.length||o)return"\n";for(var s=0,a=0;a<r.length;a++)"\n"===r[a][0]&&s++;return s>=r.length/2?"\r\n":"\r"}(i,l)),r=!1,e.delimiter)x(e.delimiter)&&(e.delimiter=e.delimiter(i),y.meta.delimiter=e.delimiter);else{var c=function(t,n,r,i,o){var a,l,c,u;o=o||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var h=0;h<o.length;h++){var d=o[h],f=0,p=0,g=0;c=void 0;for(var y=new m({comments:i,delimiter:d,newline:n,preview:10}).parse(t),v=0;v<y.data.length;v++)if(r&&w(y.data[v]))g++;else{var b=y.data[v].length;p+=b,void 0!==c?0<b&&(f+=Math.abs(b-c),c=b):c=b}0<y.data.length&&(p/=y.data.length-g),(void 0===l||f<=l)&&(void 0===u||u<p)&&1.99<p&&(l=f,a=d,u=p)}return{successful:!!(e.delimiter=a),bestDelimiter:a}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=s.DefaultDelimiter),y.meta.delimiter=e.delimiter}var u=b(e);return e.preview&&e.header&&u.preview++,t=i,n=new m(u),y=n.parse(t,o,a),E(),d?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,n.abort(),t=x(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){c.streamer._halted?(d=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,n.abort(),y.meta.aborted=!0,x(e.complete)&&e.complete(y),t=""}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,n=(e=e||{}).delimiter,r=e.newline,i=e.comments,o=e.step,a=e.preview,l=e.fastMode,c=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof n||-1<s.BAD_DELIMITERS.indexOf(n))&&(n=","),i===n)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var u=0,h=!1;this.parse=function(e,s,d){if("string"!=typeof e)throw new Error("Input must be a string");var f=e.length,m=n.length,g=r.length,y=i.length,v=x(o),b=[],w=[],E=[],_=u=0;if(!e)return D();if(l||!1!==l&&-1===e.indexOf(t)){for(var S=e.split(r),C=0;C<S.length;C++){if(E=S[C],u+=E.length,C!==S.length-1)u+=r.length;else if(d)return D();if(!i||E.substring(0,y)!==i){if(v){if(b=[],N(E.split(n)),j(),h)return D()}else N(E.split(n));if(a&&a<=C)return b=b.slice(0,a),D(!0)}}return D()}for(var T=e.indexOf(n,u),O=e.indexOf(r,u),P=new RegExp(p(c)+p(t),"g"),A=e.indexOf(t,u);;)if(e[u]!==t)if(i&&0===E.length&&e.substring(u,u+y)===i){if(-1===O)return D();u=O+g,O=e.indexOf(r,u),T=e.indexOf(n,u)}else if(-1!==T&&(T<O||-1===O))E.push(e.substring(u,T)),u=T+m,T=e.indexOf(n,u);else{if(-1===O)break;if(E.push(e.substring(u,O)),I(O+g),v&&(j(),h))return D();if(a&&b.length>=a)return D(!0)}else for(A=u,u++;;){if(-1===(A=e.indexOf(t,A+1)))return d||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:u}),R();if(A===f-1)return R(e.substring(u,A).replace(P,t));if(t!==c||e[A+1]!==c){if(t===c||0===A||e[A-1]!==c){-1!==T&&T<A+1&&(T=e.indexOf(n,A+1)),-1!==O&&O<A+1&&(O=e.indexOf(r,A+1));var k=L(-1===O?T:Math.min(T,O));if(e[A+1+k]===n){E.push(e.substring(u,A).replace(P,t)),e[u=A+1+k+m]!==t&&(A=e.indexOf(t,u)),T=e.indexOf(n,u),O=e.indexOf(r,u);break}var M=L(O);if(e.substring(A+1+M,A+1+M+g)===r){if(E.push(e.substring(u,A).replace(P,t)),I(A+1+M+g),T=e.indexOf(n,u),A=e.indexOf(t,u),v&&(j(),h))return D();if(a&&b.length>=a)return D(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:u}),A++}}else A++}return R();function N(e){b.push(e),_=u}function L(t){var n=0;if(-1!==t){var r=e.substring(A+1,t);r&&""===r.trim()&&(n=r.length)}return n}function R(t){return d||(void 0===t&&(t=e.substring(u)),E.push(t),u=f,N(E),v&&j()),D()}function I(t){u=t,N(E),E=[],O=e.indexOf(r,u)}function D(e){return{data:b,errors:w,meta:{delimiter:n,linebreak:r,aborted:h,truncated:!!e,cursor:_+(s||0)}}}function j(){o(D()),b=[],w=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return u}}function g(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(x(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},o),!r);s++);delete t.results}else x(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var n=i[e];x(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function v(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=b(e[n]);return t}function w(e,t){return function(){e.apply(t,arguments)}}function x(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var n=e.data;if(void 0===s.WORKER_ID&&n&&(s.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:s.WORKER_ID,results:s.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var r=s.parse(n.input,n.config);r&&t.postMessage({workerId:s.WORKER_ID,results:r,finished:!0})}}),(c.prototype=Object.create(l.prototype)).constructor=c,(u.prototype=Object.create(l.prototype)).constructor=u,(h.prototype=Object.create(h.prototype)).constructor=h,(d.prototype=Object.create(l.prototype)).constructor=d,s},void 0===(r=n.apply(t,[]))||(e.exports=r)},8523:function(e,t){var n,r;void 0===(r="function"==typeof(n=function(){return function(e){function t(e){return" "===e||"\t"===e||"\n"===e||"\f"===e||"\r"===e}function n(t){var n,r=t.exec(e.substring(m));if(r)return n=r[0],m+=n.length,n}for(var r,i,o,s,a,l=e.length,c=/^[ \t\n\r\u000c]+/,u=/^[, \t\n\r\u000c]+/,h=/^[^ \t\n\r\u000c]+/,d=/[,]+$/,f=/^\d+$/,p=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,m=0,g=[];;){if(n(u),m>=l)return g;r=n(h),i=[],","===r.slice(-1)?(r=r.replace(d,""),v()):y()}function y(){for(n(c),o="",s="in descriptor";;){if(a=e.charAt(m),"in descriptor"===s)if(t(a))o&&(i.push(o),o="",s="after descriptor");else{if(","===a)return m+=1,o&&i.push(o),void v();if("("===a)o+=a,s="in parens";else{if(""===a)return o&&i.push(o),void v();o+=a}}else if("in parens"===s)if(")"===a)o+=a,s="in descriptor";else{if(""===a)return i.push(o),void v();o+=a}else if("after descriptor"===s)if(t(a));else{if(""===a)return void v();s="in descriptor",m-=1}m+=1}}function v(){var t,n,o,s,a,l,c,u,h,d=!1,m={};for(s=0;s<i.length;s++)l=(a=i[s])[a.length-1],c=a.substring(0,a.length-1),u=parseInt(c,10),h=parseFloat(c),f.test(c)&&"w"===l?((t||n)&&(d=!0),0===u?d=!0:t=u):p.test(c)&&"x"===l?((t||n||o)&&(d=!0),h<0?d=!0:n=h):f.test(c)&&"h"===l?((o||n)&&(d=!0),0===u?d=!0:o=u):d=!0;d?console&&console.log&&console.log("Invalid srcset descriptor found in '"+e+"' at '"+a+"'."):(m.url=r,t&&(m.w=t),n&&(m.d=n),o&&(m.h=o),g.push(m))}}})?n.apply(t,[]):n)||(e.exports=r)},8370:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},5649:function(e){var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var r,i,o=e,s=e.indexOf("["),a=e.indexOf("]");-1!=s&&-1!=a&&(e=e.substring(0,s)+e.substring(s,a).replace(/:/g,";")+e.substring(a,e.length));for(var l,c,u=t.exec(e||""),h={},d=14;d--;)h[n[d]]=u[d]||"";return-1!=s&&-1!=a&&(h.source=o,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=(r=h.path,i=r.replace(/\/{2,9}/g,"/").split("/"),"/"!=r.substr(0,1)&&0!==r.length||i.splice(0,1),"/"==r.substr(r.length-1,1)&&i.splice(i.length-1,1),i),h.queryKey=(l=h.query,c={},l.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(c[t]=n)})),c),h}},405:function(e,t,n){var r=n(5182);e.exports=function e(t,n,i){return r(n)||(i=n||i,n=[]),i=i||{},t instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}(t,n):r(t)?function(t,n,r){for(var i=[],o=0;o<t.length;o++)i.push(e(t[o],n,r).source);return u(new RegExp("(?:"+i.join("|")+")",h(r)),n)}(t,n,i):function(e,t,n){return d(o(e,n),t,n)}(t,n,i)},e.exports.parse=o,e.exports.compile=function(e,t){return a(o(e,t),t)},e.exports.tokensToFunction=a,e.exports.tokensToRegExp=d;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e,t){for(var n,r=[],o=0,s=0,a="",u=t&&t.delimiter||"/";null!=(n=i.exec(e));){var h=n[0],d=n[1],f=n.index;if(a+=e.slice(s,f),s=f+h.length,d)a+=d[1];else{var p=e[s],m=n[2],g=n[3],y=n[4],v=n[5],b=n[6],w=n[7];a&&(r.push(a),a="");var x=null!=m&&null!=p&&p!==m,E="+"===b||"*"===b,_="?"===b||"*"===b,S=n[2]||u,C=y||v;r.push({name:g||o++,prefix:m||"",delimiter:S,optional:_,repeat:E,partial:x,asterisk:!!w,pattern:C?c(C):w?".*":"[^"+l(S)+"]+?"})}}return s<e.length&&(a+=e.substr(s)),a&&r.push(a),r}function s(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function a(e,t){for(var n=new Array(e.length),i=0;i<e.length;i++)"object"==typeof e[i]&&(n[i]=new RegExp("^(?:"+e[i].pattern+")$",h(t)));return function(t,i){for(var o="",a=t||{},l=(i||{}).pretty?s:encodeURIComponent,c=0;c<e.length;c++){var u=e[c];if("string"!=typeof u){var h,d=a[u.name];if(null==d){if(u.optional){u.partial&&(o+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(r(d)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var f=0;f<d.length;f++){if(h=l(d[f]),!n[c].test(h))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(h)+"`");o+=(0===f?u.prefix:u.delimiter)+h}}else{if(h=u.asterisk?encodeURI(d).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):l(d),!n[c].test(h))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+h+'"');o+=u.prefix+h}}else o+=u}return o}}function l(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function c(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function h(e){return e&&e.sensitive?"":"i"}function d(e,t,n){r(t)||(n=t||n,t=[]);for(var i=(n=n||{}).strict,o=!1!==n.end,s="",a=0;a<e.length;a++){var c=e[a];if("string"==typeof c)s+=l(c);else{var d=l(c.prefix),f="(?:"+c.pattern+")";t.push(c),c.repeat&&(f+="(?:"+d+f+")*"),s+=f=c.optional?c.partial?d+"("+f+")?":"(?:"+d+"("+f+"))?":d+"("+f+")"}}var p=l(n.delimiter||"/"),m=s.slice(-p.length)===p;return i||(s=(m?s.slice(0,-p.length):s)+"(?:"+p+"(?=$))?"),s+=o?"$":i&&m?"":"(?="+p+"|$)",u(new RegExp("^"+s,h(n)),t)}},686:function(e){var t=String,n=function(){return{isColorSupported:!1,reset:t,bold:t,dim:t,italic:t,underline:t,inverse:t,hidden:t,strikethrough:t,black:t,red:t,green:t,yellow:t,blue:t,magenta:t,cyan:t,white:t,gray:t,bgBlack:t,bgRed:t,bgGreen:t,bgYellow:t,bgBlue:t,bgMagenta:t,bgCyan:t,bgWhite:t}};e.exports=n(),e.exports.createColors=n},9956:function(e,t,n){"use strict";let r=n(2531);class i extends r{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}}e.exports=i,i.default=i,r.registerAtRule(i)},8321:function(e,t,n){"use strict";let r=n(7067);class i extends r{constructor(e){super(e),this.type="comment"}}e.exports=i,i.default=i},2531:function(e,t,n){"use strict";let r,i,o,{isClean:s,my:a}=n(2899),l=n(9560),c=n(8321),u=n(7067);function h(e){return e.map((e=>(e.nodes&&(e.nodes=h(e.nodes)),delete e.source,e)))}function d(e){if(e[s]=!1,e.proxyOf.nodes)for(let t of e.proxyOf.nodes)d(t)}class f extends u{push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}each(e){if(!this.proxyOf.nodes)return;let t,n,r=this.getIterator();for(;this.indexes[r]<this.proxyOf.nodes.length&&(t=this.indexes[r],n=e(this.proxyOf.nodes[t],t),!1!==n);)this.indexes[r]+=1;return delete this.indexes[r],n}walk(e){return this.each(((t,n)=>{let r;try{r=e(t,n)}catch(e){throw t.addToError(e)}return!1!==r&&t.walk&&(r=t.walk(e)),r}))}walkDecls(e,t){return t?e instanceof RegExp?this.walk(((n,r)=>{if("decl"===n.type&&e.test(n.prop))return t(n,r)})):this.walk(((n,r)=>{if("decl"===n.type&&n.prop===e)return t(n,r)})):(t=e,this.walk(((e,n)=>{if("decl"===e.type)return t(e,n)})))}walkRules(e,t){return t?e instanceof RegExp?this.walk(((n,r)=>{if("rule"===n.type&&e.test(n.selector))return t(n,r)})):this.walk(((n,r)=>{if("rule"===n.type&&n.selector===e)return t(n,r)})):(t=e,this.walk(((e,n)=>{if("rule"===e.type)return t(e,n)})))}walkAtRules(e,t){return t?e instanceof RegExp?this.walk(((n,r)=>{if("atrule"===n.type&&e.test(n.name))return t(n,r)})):this.walk(((n,r)=>{if("atrule"===n.type&&n.name===e)return t(n,r)})):(t=e,this.walk(((e,n)=>{if("atrule"===e.type)return t(e,n)})))}walkComments(e){return this.walk(((t,n)=>{if("comment"===t.type)return e(t,n)}))}append(...e){for(let t of e){let e=this.normalize(t,this.last);for(let t of e)this.proxyOf.nodes.push(t)}return this.markDirty(),this}prepend(...e){e=e.reverse();for(let t of e){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}insertBefore(e,t){let n,r=0===(e=this.index(e))&&"prepend",i=this.normalize(t,this.proxyOf.nodes[e],r).reverse();for(let t of i)this.proxyOf.nodes.splice(e,0,t);for(let t in this.indexes)n=this.indexes[t],e<=n&&(this.indexes[t]=n+i.length);return this.markDirty(),this}insertAfter(e,t){e=this.index(e);let n,r=this.normalize(t,this.proxyOf.nodes[e]).reverse();for(let t of r)this.proxyOf.nodes.splice(e+1,0,t);for(let t in this.indexes)n=this.indexes[t],e<n&&(this.indexes[t]=n+r.length);return this.markDirty(),this}removeChild(e){let t;e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);for(let n in this.indexes)t=this.indexes[n],t>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls((r=>{t.props&&!t.props.includes(r.prop)||t.fast&&!r.value.includes(t.fast)||(r.value=r.value.replace(e,n))})),this.markDirty(),this}every(e){return this.nodes.every(e)}some(e){return this.nodes.some(e)}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}normalize(e,t){if("string"==typeof e)e=h(r(e).nodes);else if(Array.isArray(e)){e=e.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if("root"===e.type&&"document"!==this.type){e=e.nodes.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if(e.type)e=[e];else if(e.prop){if(void 0===e.value)throw new Error("Value field is missed in node creation");"string"!=typeof e.value&&(e.value=String(e.value)),e=[new l(e)]}else if(e.selector)e=[new i(e)];else if(e.name)e=[new o(e)];else{if(!e.text)throw new Error("Unknown node type in node creation");e=[new c(e)]}return e.map((e=>(e[a]||f.rebuild(e),(e=e.proxyOf).parent&&e.parent.removeChild(e),e[s]&&d(e),void 0===e.raws.before&&t&&void 0!==t.raws.before&&(e.raws.before=t.raws.before.replace(/\S/g,"")),e.parent=this,e)))}getProxyProcessor(){return{set:(e,t,n)=>(e[t]===n||(e[t]=n,"name"!==t&&"params"!==t&&"selector"!==t||e.markDirty()),!0),get:(e,t)=>"proxyOf"===t?e:e[t]?"each"===t||"string"==typeof t&&t.startsWith("walk")?(...n)=>e[t](...n.map((e=>"function"==typeof e?(t,n)=>e(t.toProxy(),n):e))):"every"===t||"some"===t?n=>e[t](((e,...t)=>n(e.toProxy(),...t))):"root"===t?()=>e.root().toProxy():"nodes"===t?e.nodes.map((e=>e.toProxy())):"first"===t||"last"===t?e[t].toProxy():e[t]:e[t]}}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}}f.registerParse=e=>{r=e},f.registerRule=e=>{i=e},f.registerAtRule=e=>{o=e},e.exports=f,f.default=f,f.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,o.prototype):"rule"===e.type?Object.setPrototypeOf(e,i.prototype):"decl"===e.type?Object.setPrototypeOf(e,l.prototype):"comment"===e.type&&Object.setPrototypeOf(e,c.prototype),e[a]=!0,e.nodes&&e.nodes.forEach((e=>{f.rebuild(e)}))}},5723:function(e,t,n){"use strict";let r=n(686),i=n(5219);class o extends Error{constructor(e,t,n,r,i,s){super(e),this.name="CssSyntaxError",this.reason=e,i&&(this.file=i),r&&(this.source=r),s&&(this.plugin=s),void 0!==t&&void 0!==n&&("number"==typeof t?(this.line=t,this.column=n):(this.line=t.line,this.column=t.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,o)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;null==e&&(e=r.isColorSupported),i&&e&&(t=i(t));let n,o,s=t.split(/\r?\n/),a=Math.max(this.line-3,0),l=Math.min(this.line+2,s.length),c=String(l).length;if(e){let{bold:e,red:t,gray:i}=r.createColors(!0);n=n=>e(t(n)),o=e=>i(e)}else n=o=e=>e;return s.slice(a,l).map(((e,t)=>{let r=a+1+t,i=" "+(" "+r).slice(-c)+" | ";if(r===this.line){let t=o(i.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return n(">")+o(i)+e+"\n "+t+n("^")}return" "+o(i)+e})).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}}e.exports=o,o.default=o},9560:function(e,t,n){"use strict";let r=n(7067);class i extends r{constructor(e){e&&void 0!==e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}}e.exports=i,i.default=i},815:function(e,t,n){"use strict";let r,i,o=n(2531);class s extends o{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new r(new i,this,e).stringify()}}s.registerLazyResult=e=>{r=e},s.registerProcessor=e=>{i=e},e.exports=s,s.default=s},6027:function(e,t,n){"use strict";let r=n(9560),i=n(3086),o=n(8321),s=n(9956),a=n(8313),l=n(8973),c=n(1854);function u(e,t){if(Array.isArray(e))return e.map((e=>u(e)));let{inputs:n,...h}=e;if(n){t=[];for(let e of n){let n={...e,__proto__:a.prototype};n.map&&(n.map={...n.map,__proto__:i.prototype}),t.push(n)}}if(h.nodes&&(h.nodes=e.nodes.map((e=>u(e,t)))),h.source){let{inputId:e,...n}=h.source;h.source=n,null!=e&&(h.source.input=t[e])}if("root"===h.type)return new l(h);if("decl"===h.type)return new r(h);if("rule"===h.type)return new c(h);if("comment"===h.type)return new o(h);if("atrule"===h.type)return new s(h);throw new Error("Unknown node type: "+e.type)}e.exports=u,u.default=u},8313:function(e,t,n){"use strict";let{SourceMapConsumer:r,SourceMapGenerator:i}=n(1305),{fileURLToPath:o,pathToFileURL:s}=n(6659),{resolve:a,isAbsolute:l}=n(4029),{nanoid:c}=n(8773),u=n(5219),h=n(5723),d=n(3086),f=Symbol("fromOffsetCache"),p=Boolean(r&&i),m=Boolean(a&&l);class g{constructor(e,t={}){if(null==e||"object"==typeof e&&!e.toString)throw new Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\ufeff"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!m||/^\w+:\/\//.test(t.from)||l(t.from)?this.file=t.from:this.file=a(t.from)),m&&p){let e=new d(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+c(6)+">"),this.map&&(this.map.file=this.from)}fromOffset(e){let t,n;if(this[f])n=this[f];else{let e=this.css.split("\n");n=new Array(e.length);let t=0;for(let r=0,i=e.length;r<i;r++)n[r]=t,t+=e[r].length+1;this[f]=n}t=n[n.length-1];let r=0;if(e>=t)r=n.length-1;else{let t,i=n.length-2;for(;r<i;)if(t=r+(i-r>>1),e<n[t])i=t-1;else{if(!(e>=n[t+1])){r=t;break}r=t+1}}return{line:r+1,col:e-n[r]+1}}error(e,t,n,r={}){let i,o,a;if(t&&"object"==typeof t){let e=t,r=n;if("number"==typeof t.offset){let r=this.fromOffset(e.offset);t=r.line,n=r.col}else t=e.line,n=e.column;if("number"==typeof r.offset){let e=this.fromOffset(r.offset);o=e.line,a=e.col}else o=r.line,a=r.column}else if(!n){let e=this.fromOffset(t);t=e.line,n=e.col}let l=this.origin(t,n,o,a);return i=l?new h(e,void 0===l.endLine?l.line:{line:l.line,column:l.column},void 0===l.endLine?l.column:{line:l.endLine,column:l.endColumn},l.source,l.file,r.plugin):new h(e,void 0===o?t:{line:t,column:n},void 0===o?n:{line:o,column:a},this.css,this.file,r.plugin),i.input={line:t,column:n,endLine:o,endColumn:a,source:this.css},this.file&&(s&&(i.input.url=s(this.file).toString()),i.input.file=this.file),i}origin(e,t,n,r){if(!this.map)return!1;let i,a,c=this.map.consumer(),u=c.originalPositionFor({line:e,column:t});if(!u.source)return!1;"number"==typeof n&&(i=c.originalPositionFor({line:n,column:r})),a=l(u.source)?s(u.source):new URL(u.source,this.map.consumer().sourceRoot||s(this.map.mapFile));let h={url:a.toString(),line:u.line,column:u.column,endLine:i&&i.line,endColumn:i&&i.column};if("file:"===a.protocol){if(!o)throw new Error("file: protocol is not available in this PostCSS build");h.file=o(a)}let d=c.sourceContentFor(u.source);return d&&(h.source=d),h}mapResolve(e){return/^\w+:\/\//.test(e)?e:a(this.map.consumer().sourceRoot||this.map.root||".",e)}get from(){return this.file||this.id}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}}e.exports=g,g.default=g,u&&u.registerInput&&u.registerInput(g)},3521:function(e,t,n){"use strict";let{isClean:r,my:i}=n(2899),o=n(7157),s=n(4414),a=n(2531),l=n(815),c=(n(3098),n(7282)),u=n(8561),h=n(8973);const d={document:"Document",root:"Root",atrule:"AtRule",rule:"Rule",decl:"Declaration",comment:"Comment"},f={postcssPlugin:!0,prepare:!0,Once:!0,Document:!0,Root:!0,Declaration:!0,Rule:!0,AtRule:!0,Comment:!0,DeclarationExit:!0,RuleExit:!0,AtRuleExit:!0,CommentExit:!0,RootExit:!0,DocumentExit:!0,OnceExit:!0},p={postcssPlugin:!0,prepare:!0,Once:!0};function m(e){return"object"==typeof e&&"function"==typeof e.then}function g(e){let t=!1,n=d[e.type];return"decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append?[n,n+"-"+t,0,n+"Exit",n+"Exit-"+t]:t?[n,n+"-"+t,n+"Exit",n+"Exit-"+t]:e.append?[n,0,n+"Exit"]:[n,n+"Exit"]}function y(e){let t;return t="document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:g(e),{node:e,events:t,eventIndex:0,visitors:[],visitorIndex:0,iterator:0}}function v(e){return e[r]=!1,e.nodes&&e.nodes.forEach((e=>v(e))),e}let b={};class w{constructor(e,t,n){let r;if(this.stringified=!1,this.processed=!1,"object"!=typeof t||null===t||"root"!==t.type&&"document"!==t.type)if(t instanceof w||t instanceof c)r=v(t.root),t.map&&(void 0===n.map&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=t.map);else{let e=u;n.syntax&&(e=n.syntax.parse),n.parser&&(e=n.parser),e.parse&&(e=e.parse);try{r=e(t,n)}catch(e){this.processed=!0,this.error=e}r&&!r[i]&&a.rebuild(r)}else r=v(t);this.result=new c(e,r,n),this.helpers={...b,result:this.result,postcss:b},this.plugins=this.processor.plugins.map((e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e))}get[Symbol.toStringTag](){return"LazyResult"}get processor(){return this.result.processor}get opts(){return this.result.opts}get css(){return this.stringify().css}get content(){return this.stringify().content}get map(){return this.stringify().map}get root(){return this.sync().root}get messages(){return this.sync().messages}warnings(){return this.sync().warnings()}toString(){return this.css}then(e,t){return this.async().then(e,t)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins)if(m(this.runOnRoot(e)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[r];)e[r]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=s;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let n=new o(t,this.result.root,this.result.opts).generate();return this.result.css=n[0],this.result.map=n[1],this.result}walkSync(e){e[r]=!0;let t=g(e);for(let n of t)if(0===n)e.nodes&&e.each((e=>{e[r]||this.walkSync(e)}));else{let t=this.listeners[n];if(t&&this.visitSync(t,e.toProxy()))return}}visitSync(e,t){for(let[n,r]of e){let e;this.result.lastPlugin=n;try{e=r(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(m(e))throw this.getAsyncError()}}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map((t=>e.Once(t,this.helpers)));return m(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin?n.postcssVersion:(e.plugin=n.postcssPlugin,e.setMessage())}catch(e){console&&console.error&&console.error(e)}return e}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(m(n))try{await n}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[r];){e[r]=!0;let t=[y(e)];for(;t.length>0;){let e=this.visitTick(t);if(m(e))try{await e}catch(e){let n=t[t.length-1].node;throw this.handleError(e,n)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map((e=>n(e,this.helpers)));await Promise.all(t)}else await n(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}prepareVisitors(){this.listeners={};let e=(e,t,n)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,n])};for(let t of this.plugins)if("object"==typeof t)for(let n in t){if(!f[n]&&/^[A-Z]/.test(n))throw new Error(`Unknown event ${n} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!p[n])if("object"==typeof t[n])for(let r in t[n])e(t,"*"===r?n:n+"-"+r.toLowerCase(),t[n][r]);else"function"==typeof t[n]&&e(t,n,t[n])}this.hasListener=Object.keys(this.listeners).length>0}visitTick(e){let t=e[e.length-1],{node:n,visitors:i}=t;if("root"!==n.type&&"document"!==n.type&&!n.parent)return void e.pop();if(i.length>0&&t.visitorIndex<i.length){let[e,r]=i[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===i.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return r(n.toProxy(),this.helpers)}catch(e){throw this.handleError(e,n)}}if(0!==t.iterator){let i,o=t.iterator;for(;i=n.nodes[n.indexes[o]];)if(n.indexes[o]+=1,!i[r])return i[r]=!0,void e.push(y(i));t.iterator=0,delete n.indexes[o]}let o=t.events;for(;t.eventIndex<o.length;){let e=o[t.eventIndex];if(t.eventIndex+=1,0===e)return void(n.nodes&&n.nodes.length&&(n[r]=!0,t.iterator=n.getIterator()));if(this.listeners[e])return void(t.visitors=this.listeners[e])}e.pop()}}w.registerPostcss=e=>{b=e},e.exports=w,w.default=w,h.registerLazyResult(w),l.registerLazyResult(w)},4436:function(e){"use strict";let t={split(e,t,n){let r=[],i="",o=!1,s=0,a=!1,l=!1;for(let n of e)l?l=!1:"\\"===n?l=!0:a?n===a&&(a=!1):'"'===n||"'"===n?a=n:"("===n?s+=1:")"===n?s>0&&(s-=1):0===s&&t.includes(n)&&(o=!0),o?(""!==i&&r.push(i.trim()),i="",o=!1):i+=n;return(n||""!==i)&&r.push(i.trim()),r},space:e=>t.split(e,[" ","\n","\t"]),comma:e=>t.split(e,[","],!0)};e.exports=t,t.default=t},7157:function(e,t,n){"use strict";let{SourceMapConsumer:r,SourceMapGenerator:i}=n(1305),{dirname:o,resolve:s,relative:a,sep:l}=n(4029),{pathToFileURL:c}=n(6659),u=n(8313),h=Boolean(r&&i),d=Boolean(o&&s&&a&&l);e.exports=class{constructor(e,t,n,r){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=r}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk((e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}}));else{let e=new u(this.css,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(void 0===e||!0===e)&&(!this.previous().length||this.previous().some((e=>e.inline)))}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some((e=>e.withContent()))}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],"comment"===e.type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/(\n)?\/\*#[\S\s]*?\*\/$/gm,""))}setSourcesContent(){let e={};if(this.root)this.root.walk((t=>{if(t.source){let n=t.source.input.from;n&&!e[n]&&(e[n]=!0,this.map.setSourceContent(this.toUrl(this.path(n)),t.source.input.css))}}));else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}applyPrevMaps(){for(let e of this.previous()){let t,n=this.toUrl(this.path(e.file)),i=e.root||o(e.file);!1===this.mapOpts.sourcesContent?(t=new r(e.text),t.sourcesContent&&(t.sourcesContent=t.sourcesContent.map((()=>null)))):t=e.consumer(),this.map.applySourceMap(t,n,this.toUrl(this.path(i)))}}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some((e=>e.annotation)))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=i.fromSourceMap(e)}else this.map=new i({file:this.outputFile()}),this.map.addMapping({source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>",generated:{line:1,column:0},original:{line:1,column:0}});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}path(e){if(0===e.indexOf("<"))return e;if(/^\w+:\/\//.test(e))return e;if(this.mapOpts.absolute)return e;let t=this.opts.to?o(this.opts.to):".";return"string"==typeof this.mapOpts.annotation&&(t=o(s(t,this.mapOpts.annotation))),a(t,e)}toUrl(e){return"\\"===l&&(e=e.replace(/\\/g,"/")),encodeURI(e).replace(/[#?]/g,encodeURIComponent)}sourcePath(e){if(this.mapOpts.from)return this.toUrl(this.mapOpts.from);if(this.mapOpts.absolute){if(c)return c(e.source.input.from).toString();throw new Error("`map.absolute` option is not available in this PostCSS build")}return this.toUrl(this.path(e.source.input.from))}generateString(){this.css="",this.map=new i({file:this.outputFile()});let e,t,n=1,r=1,o="<no source>",s={source:"",generated:{line:0,column:0},original:{line:0,column:0}};this.stringify(this.root,((i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(s.generated.line=n,s.generated.column=r-1,a.source&&a.source.start?(s.source=this.sourcePath(a),s.original.line=a.source.start.line,s.original.column=a.source.start.column-1,this.map.addMapping(s)):(s.source=o,s.original.line=1,s.original.column=0,this.map.addMapping(s))),e=i.match(/\n/g),e?(n+=e.length,t=i.lastIndexOf("\n"),r=i.length-t):r+=i.length,a&&"start"!==l){let e=a.parent||{raws:{}};("decl"!==a.type||a!==e.last||e.raws.semicolon)&&(a.source&&a.source.end?(s.source=this.sourcePath(a),s.original.line=a.source.end.line,s.original.column=a.source.end.column-1,s.generated.line=n,s.generated.column=r-2,this.map.addMapping(s)):(s.source=o,s.original.line=1,s.original.column=0,s.generated.line=n,s.generated.column=r-1,this.map.addMapping(s)))}}))}generate(){if(this.clearAnnotation(),d&&h&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,(t=>{e+=t})),[e]}}}},3614:function(e,t,n){"use strict";let r=n(7157),i=n(4414),o=(n(3098),n(8561));const s=n(7282);class a{constructor(e,t,n){let o;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=n,this._map=void 0;let a=i;this.result=new s(this._processor,o,this._opts),this.result.css=t;let l=this;Object.defineProperty(this.result,"root",{get:()=>l.root});let c=new r(a,o,this._opts,t);if(c.isMap()){let[e,t]=c.generate();e&&(this.result.css=e),t&&(this.result.map=t)}}get[Symbol.toStringTag](){return"NoWorkResult"}get processor(){return this.result.processor}get opts(){return this.result.opts}get css(){return this.result.css}get content(){return this.result.css}get map(){return this.result.map}get root(){if(this._root)return this._root;let e,t=o;try{e=t(this._css,this._opts)}catch(e){this.error=e}return this._root=e,e}get messages(){return[]}warnings(){return[]}toString(){return this._css}then(e,t){return this.async().then(e,t)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}sync(){if(this.error)throw this.error;return this.result}}e.exports=a,a.default=a},7067:function(e,t,n){"use strict";let{isClean:r,my:i}=n(2899),o=n(5723),s=n(9101),a=n(4414);function l(e,t){let n=new e.constructor;for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;if("proxyCache"===r)continue;let i=e[r],o=typeof i;"parent"===r&&"object"===o?t&&(n[r]=t):"source"===r?n[r]=i:Array.isArray(i)?n[r]=i.map((e=>l(e,n))):("object"===o&&null!==i&&(i=l(i)),n[r]=i)}return n}class c{constructor(e={}){this.raws={},this[r]=!1,this[i]=!0;for(let t in e)if("nodes"===t){this.nodes=[];for(let n of e[t])"function"==typeof n.clone?this.append(n.clone()):this.append(n)}else this[t]=e[t]}error(e,t={}){if(this.source){let{start:n,end:r}=this.rangeBy(t);return this.source.input.error(e,{line:n.line,column:n.column},{line:r.line,column:r.column},t)}return new o(e)}warn(e,t,n){let r={node:this};for(let e in n)r[e]=n[e];return e.warn(t,r)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}toString(e=a){e.stringify&&(e=e.stringify);let t="";return e(this,(e=>{t+=e})),t}assign(e={}){for(let t in e)this[t]=e[t];return this}clone(e={}){let t=l(this);for(let n in e)t[n]=e[n];return t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}replaceWith(...e){if(this.parent){let t=this,n=!1;for(let r of e)r===this?n=!0:n?(this.parent.insertAfter(t,r),t=r):this.parent.insertBefore(t,r);n||this.remove()}return this}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}before(e){return this.parent.insertBefore(this,e),this}after(e){return this.parent.insertAfter(this,e),this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}raw(e,t){return(new s).raw(this,e,t)}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}toJSON(e,t){let n={},r=null==t;t=t||new Map;let i=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e))continue;if("parent"===e||"proxyCache"===e)continue;let r=this[e];if(Array.isArray(r))n[e]=r.map((e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e));else if("object"==typeof r&&r.toJSON)n[e]=r.toJSON(null,t);else if("source"===e){let o=t.get(r.input);null==o&&(o=i,t.set(r.input,i),i++),n[e]={inputId:o,start:r.start,end:r.end}}else n[e]=r}return r&&(n.inputs=[...t.keys()].map((e=>e.toJSON()))),n}positionInside(e){let t=this.toString(),n=this.source.start.column,r=this.source.start.line;for(let i=0;i<e;i++)"\n"===t[i]?(n=1,r+=1):n+=1;return{line:r,column:n}}positionBy(e){let t=this.source.start;if(e.index)t=this.positionInside(e.index);else if(e.word){let n=this.toString().indexOf(e.word);-1!==n&&(t=this.positionInside(n))}return t}rangeBy(e){let t={line:this.source.start.line,column:this.source.start.column},n=this.source.end?{line:this.source.end.line,column:this.source.end.column+1}:{line:t.line,column:t.column+1};if(e.word){let r=this.toString().indexOf(e.word);-1!==r&&(t=this.positionInside(r),n=this.positionInside(r+e.word.length))}else e.start?t={line:e.start.line,column:e.start.column}:e.index&&(t=this.positionInside(e.index)),e.end?n={line:e.end.line,column:e.end.column}:e.endIndex?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={line:t.line,column:t.column+1}),{start:t,end:n}}getProxyProcessor(){return{set:(e,t,n)=>(e[t]===n||(e[t]=n,"prop"!==t&&"value"!==t&&"name"!==t&&"params"!==t&&"important"!==t&&"text"!==t||e.markDirty()),!0),get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t]}}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}markDirty(){if(this[r]){this[r]=!1;let e=this;for(;e=e.parent;)e[r]=!1}}get proxyOf(){return this}}e.exports=c,c.default=c},8561:function(e,t,n){"use strict";let r=n(2531),i=n(8935),o=n(8313);function s(e,t){let n=new o(e,t),r=new i(n);try{r.parse()}catch(e){throw e}return r.root}e.exports=s,s.default=s,r.registerParse(s)},8935:function(e,t,n){"use strict";let r=n(9560),i=n(2132),o=n(8321),s=n(9956),a=n(8973),l=n(1854);e.exports=class{constructor(e){this.input=e,this.root=new a,this.current=this.root,this.spaces="",this.semicolon=!1,this.customProperty=!1,this.createTokenizer(),this.root.source={input:e,start:{offset:0,line:1,column:1}}}createTokenizer(){this.tokenizer=i(this.input)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}comment(e){let t=new o;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]);let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let e=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}emptyRule(e){let t=new l;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}other(e){let t=!1,n=null,r=!1,i=null,o=[],s=e[1].startsWith("--"),a=[],l=e;for(;l;){if(n=l[0],a.push(l),"("===n||"["===n)i||(i=l),o.push("("===n?")":"]");else if(s&&r&&"{"===n)i||(i=l),o.push("}");else if(0===o.length){if(";"===n){if(r)return void this.decl(a,s);break}if("{"===n)return void this.rule(a);if("}"===n){this.tokenizer.back(a.pop()),t=!0;break}":"===n&&(r=!0)}else n===o[o.length-1]&&(o.pop(),0===o.length&&(i=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(i),t&&r){for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,s)}else this.unknownWord(a)}rule(e){e.pop();let t=new l;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}decl(e,t){let n=new r;this.init(n,e[0][2]);let i,o=e[e.length-1];for(";"===o[0]&&(this.semicolon=!0,e.pop()),n.source.end=this.getPosition(o[3]||o[2]);"word"!==e[0][0];)1===e.length&&this.unknownWord(e),n.raws.before+=e.shift()[1];for(n.source.start=this.getPosition(e[0][2]),n.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;n.prop+=e.shift()[1]}for(n.raws.between="";e.length;){if(i=e.shift(),":"===i[0]){n.raws.between+=i[1];break}"word"===i[0]&&/\w/.test(i[1])&&this.unknownWord([i]),n.raws.between+=i[1]}"_"!==n.prop[0]&&"*"!==n.prop[0]||(n.raws.before+=n.prop[0],n.prop=n.prop.slice(1));let s=this.spacesAndCommentsFromStart(e);this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if(i=e[t],"!important"===i[1].toLowerCase()){n.important=!0;let r=this.stringFrom(e,t);r=this.spacesFromEnd(e)+r," !important"!==r&&(n.raws.important=r);break}if("important"===i[1].toLowerCase()){let r=e.slice(0),i="";for(let e=t;e>0;e--){let t=r[e][0];if(0===i.trim().indexOf("!")&&"space"!==t)break;i=r.pop()[1]+i}0===i.trim().indexOf("!")&&(n.important=!0,n.raws.important=i,e=r)}if("space"!==i[0]&&"comment"!==i[0])break}let a=e.some((e=>"space"!==e[0]&&"comment"!==e[0]));this.raw(n,"value",e),a?n.raws.between+=s:n.value=s+n.value,n.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}atrule(e){let t,n,r,i=new s;i.name=e[1].slice(1),""===i.name&&this.unnamedAtrule(i,e),this.init(i,e[2]);let o=!1,a=!1,l=[],c=[];for(;!this.tokenizer.endOfFile();){if(t=(e=this.tokenizer.nextToken())[0],"("===t||"["===t?c.push("("===t?")":"]"):"{"===t&&c.length>0?c.push("}"):t===c[c.length-1]&&c.pop(),0===c.length){if(";"===t){i.source.end=this.getPosition(e[2]),this.semicolon=!0;break}if("{"===t){a=!0;break}if("}"===t){if(l.length>0){for(r=l.length-1,n=l[r];n&&"space"===n[0];)n=l[--r];n&&(i.source.end=this.getPosition(n[3]||n[2]))}this.end(e);break}l.push(e)}else l.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}i.raws.between=this.spacesAndCommentsFromEnd(l),l.length?(i.raws.afterName=this.spacesAndCommentsFromStart(l),this.raw(i,"params",l),o&&(e=l[l.length-1],i.source.end=this.getPosition(e[3]||e[2]),this.spaces=i.raws.between,i.raws.between="")):(i.raws.afterName="",i.params=""),a&&(i.nodes=[],this.current=i)}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{offset:e,line:t.line,column:t.col}}init(e,t){this.current.push(e),e.source={start:this.getPosition(t),input:this.input},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}raw(e,t,n){let r,i,o,s,a=n.length,l="",c=!0,u=/^([#.|])?(\w)+/i;for(let t=0;t<a;t+=1)r=n[t],i=r[0],"comment"!==i||"rule"!==e.type?"comment"===i||"space"===i&&t===a-1?c=!1:l+=r[1]:(s=n[t-1],o=n[t+1],"space"!==s[0]&&"space"!==o[0]&&u.test(s[1])&&u.test(o[1])?l+=r[1]:c=!1);if(!c){let r=n.reduce(((e,t)=>e+t[1]),"");e.raws[t]={value:l,raw:r}}e[t]=l}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t||"comment"===t);)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&(t=e[0][0],"space"===t||"comment"===t);)n+=e.shift()[1];return n}spacesFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t);)n=e.pop()[1]+n;return n}stringFrom(e,t){let n="";for(let r=t;r<e.length;r++)n+=e[r][1];return e.splice(t,e.length-t),n}colon(e){let t,n,r,i=0;for(let[o,s]of e.entries()){if(t=s,n=t[0],"("===n&&(i+=1),")"===n&&(i-=1),0===i&&":"===n){if(r){if("word"===r[0]&&"progid"===r[1])continue;return o}this.doubleColon(t)}r=t}return!1}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}precheckMissedSemicolon(){}checkMissedSemicolon(e){let t=this.colon(e);if(!1===t)return;let n,r=0;for(let i=t-1;i>=0&&(n=e[i],"space"===n[0]||(r+=1,2!==r));i--);throw this.input.error("Missed semicolon","word"===n[0]?n[3]+1:n[2])}}},1722:function(e,t,n){"use strict";let r=n(5723),i=n(9560),o=n(3521),s=n(2531),a=n(7231),l=n(4414),c=n(6027),u=n(815),h=n(846),d=n(8321),f=n(9956),p=n(7282),m=n(8313),g=n(8561),y=n(4436),v=n(1854),b=n(8973),w=n(7067);function x(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new a(e)}x.plugin=function(e,t){function n(...n){let r=t(...n);return r.postcssPlugin=e,r.postcssVersion=(new a).version,r}let r;return console&&console.warn&&(console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(e+":  postcss.plugin . :\nhttps://www.w3ctech.com/topic/2226")),Object.defineProperty(n,"postcss",{get:()=>(r||(r=n()),r)}),n.process=function(e,t,r){return x([n(r)]).process(e,t)},n},x.stringify=l,x.parse=g,x.fromJSON=c,x.list=y,x.comment=e=>new d(e),x.atRule=e=>new f(e),x.decl=e=>new i(e),x.rule=e=>new v(e),x.root=e=>new b(e),x.document=e=>new u(e),x.CssSyntaxError=r,x.Declaration=i,x.Container=s,x.Processor=a,x.Document=u,x.Comment=d,x.Warning=h,x.AtRule=f,x.Result=p,x.Input=m,x.Rule=v,x.Root=b,x.Node=w,o.registerPostcss(x),e.exports=x,x.default=x},3086:function(e,t,n){"use strict";let{SourceMapConsumer:r,SourceMapGenerator:i}=n(1305),{existsSync:o,readFileSync:s}=n(9550),{dirname:a,join:l}=n(4029);class c{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,r=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=a(this.mapFile)),r&&(this.text=r)}consumer(){return this.consumerCache||(this.consumerCache=new r(this.text)),this.consumerCache}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}startWith(e,t){return!!e&&e.substr(0,t.length)===t}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let n=e.lastIndexOf(t.pop()),r=e.indexOf("*/",n);n>-1&&r>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,r)))}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e))return t=e.substr(RegExp.lastMatch.length),Buffer?Buffer.from(t,"base64").toString():window.atob(t);var t;let n=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+n)}loadFile(e){if(this.root=a(e),o(e))return this.mapFile=e,s(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t){if("string"==typeof t)return t;if("function"!=typeof t){if(t instanceof r)return i.fromSourceMap(t).toString();if(t instanceof i)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}{let n=t(e);if(n){let e=this.loadFile(n);if(!e)throw new Error("Unable to load previous source map: "+n.toString());return e}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let t=this.annotation;return e&&(t=l(a(e),t)),this.loadFile(t)}}}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}}e.exports=c,c.default=c},7231:function(e,t,n){"use strict";let r=n(3614),i=n(3521),o=n(815),s=n(8973);class a{constructor(e=[]){this.version="8.4.4",this.plugins=this.normalize(e)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}process(e,t={}){return 0===this.plugins.length&&void 0===t.parser&&void 0===t.stringifier&&void 0===t.syntax?new r(this,e,t):new i(this,e,t)}normalize(e){let t=[];for(let n of e)if(!0===n.postcss?n=n():n.postcss&&(n=n.postcss),"object"==typeof n&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if("object"==typeof n&&n.postcssPlugin)t.push(n);else if("function"==typeof n)t.push(n);else if("object"!=typeof n||!n.parse&&!n.stringify)throw new Error(n+" is not a PostCSS plugin");return t}}e.exports=a,a.default=a,s.registerProcessor(a),o.registerProcessor(a)},7282:function(e,t,n){"use strict";let r=n(846);class i{constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let n=new r(e,t);return this.messages.push(n),n}warnings(){return this.messages.filter((e=>"warning"===e.type))}get content(){return this.css}}e.exports=i,i.default=i},8973:function(e,t,n){"use strict";let r,i,o=n(2531);class s extends o{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}removeChild(e,t){let n=this.index(e);return!t&&0===n&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}normalize(e,t,n){let r=super.normalize(e);if(t)if("prepend"===n)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of r)e.raws.before=t.raws.before;return r}toResult(e={}){return new r(new i,this,e).stringify()}}s.registerLazyResult=e=>{r=e},s.registerProcessor=e=>{i=e},e.exports=s,s.default=s},1854:function(e,t,n){"use strict";let r=n(2531),i=n(4436);class o extends r{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return i.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}}e.exports=o,o.default=o,r.registerRule(o)},9101:function(e){"use strict";const t={colon:": ",indent:"    ",beforeDecl:"\n",beforeRule:"\n",beforeOpen:" ",beforeClose:"\n",beforeComment:"\n",after:"\n",emptyBody:"",commentLeft:" ",commentRight:" ",semicolon:!1};class n{constructor(e){this.builder=e}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}document(e){this.body(e)}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),r=e.prop+n+this.rawValue(e,"value");e.important&&(r+=e.raws.important||" !important"),t&&(r+=";"),this.builder(r,e)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}atrule(e,t){let n="@"+e.name,r=e.params?this.rawValue(e,"params"):"";if(void 0!==e.raws.afterName?n+=e.raws.afterName:r&&(n+=" "),e.nodes)this.block(e,n+r);else{let i=(e.raws.between||"")+(t?";":"");this.builder(n+r+i,e)}}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let n=this.raw(e,"semicolon");for(let r=0;r<e.nodes.length;r++){let i=e.nodes[r],o=this.raw(i,"before");o&&this.builder(o),this.stringify(i,t!==r||n)}}block(e,t){let n,r=this.raw(e,"between","beforeOpen");this.builder(t+r+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),n=this.raw(e,"after")):n=this.raw(e,"after","emptyBody"),n&&this.builder(n),this.builder("}",e,"end")}raw(e,n,r){let i;if(r||(r=n),n&&(i=e.raws[n],void 0!==i))return i;let o=e.parent;if("before"===r){if(!o||"root"===o.type&&o.first===e)return"";if(o&&"document"===o.type)return""}if(!o)return t[r];let s=e.root();if(s.rawCache||(s.rawCache={}),void 0!==s.rawCache[r])return s.rawCache[r];if("before"===r||"after"===r)return this.beforeAfter(e,r);{let t="raw"+((a=r)[0].toUpperCase()+a.slice(1));this[t]?i=this[t](s,e):s.walk((e=>{if(i=e.raws[n],void 0!==i)return!1}))}var a;return void 0===i&&(i=t[r]),s.rawCache[r]=i,i}rawSemicolon(e){let t;return e.walk((e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&(t=e.raws.semicolon,void 0!==t))return!1})),t}rawEmptyBody(e){let t;return e.walk((e=>{if(e.nodes&&0===e.nodes.length&&(t=e.raws.after,void 0!==t))return!1})),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk((n=>{let r=n.parent;if(r&&r!==e&&r.parent&&r.parent===e&&void 0!==n.raws.before){let e=n.raws.before.split("\n");return t=e[e.length-1],t=t.replace(/\S/g,""),!1}})),t}rawBeforeComment(e,t){let n;return e.walkComments((e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1})),void 0===n?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls((e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1})),void 0===n?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeRule(e){let t;return e.walk((n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&void 0!==n.raws.before)return t=n.raws.before,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1})),t&&(t=t.replace(/\S/g,"")),t}rawBeforeClose(e){let t;return e.walk((e=>{if(e.nodes&&e.nodes.length>0&&void 0!==e.raws.after)return t=e.raws.after,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1})),t&&(t=t.replace(/\S/g,"")),t}rawBeforeOpen(e){let t;return e.walk((e=>{if("decl"!==e.type&&(t=e.raws.between,void 0!==t))return!1})),t}rawColon(e){let t;return e.walkDecls((e=>{if(void 0!==e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1})),t}beforeAfter(e,t){let n;n="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let r=e.parent,i=0;for(;r&&"root"!==r.type;)i+=1,r=r.parent;if(n.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<i;e++)n+=t}return n}rawValue(e,t){let n=e[t],r=e.raws[t];return r&&r.value===n?r.raw:n}}e.exports=n,n.default=n},4414:function(e,t,n){"use strict";let r=n(9101);function i(e,t){new r(t).stringify(e)}e.exports=i,i.default=i},2899:function(e){"use strict";e.exports.isClean=Symbol("isClean"),e.exports.my=Symbol("my")},2132:function(e){"use strict";const t="'".charCodeAt(0),n='"'.charCodeAt(0),r="\\".charCodeAt(0),i="/".charCodeAt(0),o="\n".charCodeAt(0),s=" ".charCodeAt(0),a="\f".charCodeAt(0),l="\t".charCodeAt(0),c="\r".charCodeAt(0),u="[".charCodeAt(0),h="]".charCodeAt(0),d="(".charCodeAt(0),f=")".charCodeAt(0),p="{".charCodeAt(0),m="}".charCodeAt(0),g=";".charCodeAt(0),y="*".charCodeAt(0),v=":".charCodeAt(0),b="@".charCodeAt(0),w=/[\t\n\f\r "#'()/;[\\\]{}]/g,x=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,E=/.[\n"'(/\\]/,_=/[\da-f]/i;e.exports=function(e,S={}){let C,T,O,P,A,k,M,N,L,R,I=e.css.valueOf(),D=S.ignoreErrors,j=I.length,F=0,z=[],B=[];function U(t){throw e.error("Unclosed "+t,F)}return{back:function(e){B.push(e)},nextToken:function(e){if(B.length)return B.pop();if(F>=j)return;let S=!!e&&e.ignoreUnclosed;switch(C=I.charCodeAt(F),C){case o:case s:case l:case c:case a:T=F;do{T+=1,C=I.charCodeAt(T)}while(C===s||C===o||C===l||C===c||C===a);R=["space",I.slice(F,T)],F=T-1;break;case u:case h:case p:case m:case v:case g:case f:{let e=String.fromCharCode(C);R=[e,e,F];break}case d:if(N=z.length?z.pop()[1]:"",L=I.charCodeAt(F+1),"url"===N&&L!==t&&L!==n&&L!==s&&L!==o&&L!==l&&L!==a&&L!==c){T=F;do{if(k=!1,T=I.indexOf(")",T+1),-1===T){if(D||S){T=F;break}U("bracket")}for(M=T;I.charCodeAt(M-1)===r;)M-=1,k=!k}while(k);R=["brackets",I.slice(F,T+1),F,T],F=T}else T=I.indexOf(")",F+1),P=I.slice(F,T+1),-1===T||E.test(P)?R=["(","(",F]:(R=["brackets",P,F,T],F=T);break;case t:case n:O=C===t?"'":'"',T=F;do{if(k=!1,T=I.indexOf(O,T+1),-1===T){if(D||S){T=F+1;break}U("string")}for(M=T;I.charCodeAt(M-1)===r;)M-=1,k=!k}while(k);R=["string",I.slice(F,T+1),F,T],F=T;break;case b:w.lastIndex=F+1,w.test(I),T=0===w.lastIndex?I.length-1:w.lastIndex-2,R=["at-word",I.slice(F,T+1),F,T],F=T;break;case r:for(T=F,A=!0;I.charCodeAt(T+1)===r;)T+=1,A=!A;if(C=I.charCodeAt(T+1),A&&C!==i&&C!==s&&C!==o&&C!==l&&C!==c&&C!==a&&(T+=1,_.test(I.charAt(T)))){for(;_.test(I.charAt(T+1));)T+=1;I.charCodeAt(T+1)===s&&(T+=1)}R=["word",I.slice(F,T+1),F,T],F=T;break;default:C===i&&I.charCodeAt(F+1)===y?(T=I.indexOf("*/",F+2)+1,0===T&&(D||S?T=I.length:U("comment")),R=["comment",I.slice(F,T+1),F,T],F=T):(x.lastIndex=F+1,x.test(I),T=0===x.lastIndex?I.length-1:x.lastIndex-2,R=["word",I.slice(F,T+1),F,T],z.push(R),F=T)}return F++,R},endOfFile:function(){return 0===B.length&&F>=j},position:function(){return F}}}},3098:function(e){"use strict";let t={};e.exports=function(e){t[e]||(t[e]=!0,"undefined"!=typeof console&&console.warn&&console.warn(e))}},846:function(e){"use strict";class t{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{plugin:this.plugin,index:this.index,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}e.exports=t,t.default=t},9961:function(e,t,n){"use strict";var r=n(7914);Object.defineProperty(t,"__esModule",{value:!0}),t.isMobile=function(){return void 0!==i.window.orientation},t.default=function(e){if(!e&&!(0,o.default)())return"Node";if((0,s.default)(e))return"Electron";var t="undefined"!=typeof navigator?navigator:{},n=e||t.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"};var i=n(8521),o=r(n(1781)),s=r(n(1988))},8521:function(e,t,n){"use strict";var r=n(7914);Object.defineProperty(t,"__esModule",{value:!0}),t.console=t.process=t.document=t.global=t.window=t.self=void 0;var i=r(n(1873)),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&process},s=o.self||o.window||o.global;t.self=s;var a=o.window||o.self||o.global;t.window=a;var l=o.global||o.self||o.window;t.global=l;var c=o.document||{};t.document=c;var u=o.process||{};t.process=u;var h=console;t.console=h},5231:function(e,t,n){"use strict";var r=n(7914),i=n(1873);Object.defineProperty(t,"CO",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(t,"jU",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"qs",{enumerable:!0,get:function(){return a.default}});var o=n(8521),s=c(n(1781)),a=c(n(9961));r(n(1988));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}},1781:function(e,t,n){"use strict";var r=n(7914);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s,t.isBrowserMainThread=function(){return s()&&"undefined"!=typeof document};var i=r(n(1873)),o=r(n(1988));function s(){return!("object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,o.default)()}},1988:function(e,t,n){"use strict";var r=n(7914);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!=typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===(0,i.default)(process.versions)&&Boolean(process.versions.electron))return!0;var t="object"===("undefined"==typeof navigator?"undefined":(0,i.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)};var i=r(n(1873))},8772:function(e,t,n){"use strict";var r=n(331);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},3615:function(e,t,n){e.exports=n(8772)()},331:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeDeep=t.isObject=t.SyncedTable=t.debug=void 0;const r=n(2040),i="DEBUG_SYNCEDTABLE",o="undefined"!=typeof window;t.debug=function(...e){o&&window[i]&&window[i](...e)};const s={array:"array",localStorage:"localStorage",object:"object"};class a{constructor({name:e,filter:n,onChange:i,onReady:a,db:l,skipFirstTrigger:u=!1,select:h="*",storageType:d="object",patchText:f=!1,patchJSON:p=!1,onError:m}){if(this.throttle=100,this.batch_size=50,this.skipFirstTrigger=!1,this.columns=[],this._multiSubscriptions=[],this._singleSubscriptions=[],this.items=[],this.itemsObj={},this.isSynced=!1,this.updatePatches=async e=>{let t=e.map((e=>e.current)),n=[],i=[];if(this.columns&&this.columns.length&&this.db[this.name].updateBatch&&(this.patchText||this.patchJSON)){const o=this.columns.filter((e=>"text"===e.data_type));if(this.patchText&&o.length){t=[];const s=[this.synced_field,...this.id_fields];await Promise.all(e.slice(0).map((async(e,a)=>{const{current:l,initial:c}={...e};let u;c&&(o.map((e=>{!s.includes(e.name)&&e.name in l&&(u=u||{...l},u[e.name]=r.getTextPatch(c[e.name],l[e.name]))})),u&&(i.push(u),n.push([this.wal.getIdObj(u),this.wal.getDeltaObj(u)]))),u||t.push(l)})))}}if(n.length)try{await this.db[this.name].updateBatch(n)}catch(e){console.log("failed to patch update",e),t=t.concat(i)}return t.filter((e=>e))},this.notifySubscribers=(e=[])=>{if(!this.isSynced)return;let t=[],n=[],r=[];e.map((({idObj:e,newItem:i,delta:o})=>{this.singleSubscriptions.filter((t=>this.matchesIdObj(t.idObj,e))).map((async e=>{try{await e.notify(i,o)}catch(e){console.error("SyncedTable failed to notify: ",e)}})),this.matchesFilter(i)&&(t.push(i),n.push(o),r.push(e))}));let i=[],o=[];if(this.getItems().map((e=>{i.push({...e});const r=t.findIndex((t=>this.matchesIdObj(e,t)));o.push(n[r])})),this.onChange)try{this.onChange(i,o)}catch(e){console.error("SyncedTable failed to notify onChange: ",e)}this.multiSubscriptions.map((async e=>{try{await e.notify(i,o)}catch(e){console.error("SyncedTable failed to notify: ",e)}}))},this.unsubscribe=e=>(this.singleSubscriptions=this.singleSubscriptions.filter((t=>t._onChange!==e)),this.multiSubscriptions=this.multiSubscriptions.filter((t=>t._onChange!==e)),t.debug("unsubscribe",this),"ok"),this.unsync=()=>{this.dbSync&&this.dbSync.unsync&&this.dbSync.unsync()},this.destroy=()=>{this.unsync(),this.multiSubscriptions=[],this.singleSubscriptions=[],this.itemsObj={},this.items=[],this.onChange=null},this.delete=async(e,t=!1)=>{const n=this.getIdObj(e);return this.setItem(n,null,!0,!0),t||await this.db[this.name].delete(n),this.notifySubscribers(),!0},this.checkItemCols=e=>{if(this.columns&&this.columns.length){const t=Object.keys({...e}).filter((e=>!this.columns.find((t=>t.name===e))));if(t.length)throw"Unexpected columns in sync item update: "+t.join(", ")}},this.upsert=async(e,t=!1)=>{if(!(e&&e.length||t))throw"No data provided for upsert";let n,i=[],o=[];await Promise.all(e.map((async(e,s)=>{var a;let l={...e.idObj},u={...e.delta};Object.keys(u).map((e=>{void 0===u[e]&&(u[e]=null)})),t||this.checkItemCols({...e.delta,...e.idObj});let h=this.getItem(l),d=h.index,f=h.data;!t&&!r.isEmpty(u)||r.isEmpty(f)||(u=this.getDelta(f||{},u)),t||(u[this.synced_field]=Date.now());let p={...f,...u,...l};f&&!t&&(null===(a=e.opts)||void 0===a?void 0:a.deepMerge)&&(p=c({...f,...l},{...u})),f&&f[this.synced_field]<p[this.synced_field]?n="updated":f||(n="inserted"),this.setItem(p,d);let m={idObj:l,delta:u,oldItem:f,newItem:p,status:n,from_server:t};return t||o.push({initial:f,current:{...p}}),m.delta&&!r.isEmpty(m.delta)&&i.push(m),!0}))).catch((e=>{console.error("SyncedTable failed upsert: ",e)})),this.notifySubscribers(i),!t&&o.length&&this.wal.addData(o)},this.setItems=e=>{if(this.storageType===s.localStorage){if(!o)throw"Cannot access window object. Choose another storage method (array OR object)";window.localStorage.setItem(this.name,JSON.stringify(e))}else this.storageType===s.array?this.items=e:this.itemsObj=e.reduce(((e,t)=>({...e,[this.getIdStr(t)]:{...t}})),{})},this.getItems=()=>{let e=[];if(this.storageType===s.localStorage){if(!o)throw"Cannot access window object. Choose another storage method (array OR object)";let t=window.localStorage.getItem(this.name);if(t)try{e=JSON.parse(t)}catch(e){console.error(e)}}else e=this.storageType===s.array?this.items.map((e=>({...e}))):Object.values({...this.itemsObj});if(!this.id_fields||!this.synced_field)throw"id_fields AND/OR synced_field missing";{const t=[this.synced_field,...this.id_fields.sort()];e=e.filter((e=>!this.filter||!Object.keys(this.filter).find((t=>e[t]!==this.filter[t])))).sort(((e,n)=>t.map((t=>e[t]<n[t]?-1:e[t]>n[t]?1:0)).find((e=>e))))}return e.map((e=>({...e})))},this.getBatch=({from_synced:e,to_synced:t,offset:n,limit:r}={offset:0,limit:null})=>{let i=this.getItems().map((e=>({...e}))).filter((n=>(!Number.isFinite(e)||+n[this.synced_field]>=+e)&&(!Number.isFinite(t)||+n[this.synced_field]<=+t)));return(n||r)&&(i=i.splice(n,r||i.length)),i},this.name=e,this.filter=n,this.select=h,this.onChange=i,!s[d])throw"Invalid storage type. Expecting one of: "+Object.keys(s).join(", ");if(o||d!==s.localStorage||(console.warn("Could not set storageType to localStorage: window object missing\nStorage changed to object"),d="object"),this.storageType=d,this.patchText=f,this.patchJSON=p,!l)throw"db missing";this.db=l;const{id_fields:g,synced_field:y,throttle:v=100,batch_size:b=50}=l[this.name]._syncInfo;if(!g||!y)throw"id_fields/synced_field missing";this.id_fields=g,this.synced_field=y,this.batch_size=b,this.throttle=v,this.skipFirstTrigger=u,this.multiSubscriptions=[],this.singleSubscriptions=[],this.onError=m||function(e){console.error("Sync internal error: ",e)},l[this.name]._sync(n,{select:h},{onSyncRequest:e=>{let t={c_lr:null,c_fr:null,c_count:0},n=this.getBatch(e);return n.length&&(t={c_fr:this.getRowSyncObj(n[0])||null,c_lr:this.getRowSyncObj(n[n.length-1])||null,c_count:n.length}),t},onPullRequest:async e=>this.getBatch(e),onUpdates:async e=>{if("err"in e&&e.err)this.onError(e.err);else if("isSynced"in e&&e.isSynced&&!this.isSynced){this.isSynced=e.isSynced;let t=this.getItems().map((e=>({...e})));this.setItems([]);const n=t.map((e=>({idObj:this.getIdObj(e),delta:{...e}})));await this.upsert(n,!0)}else if("data"in e){let t=e.data.map((e=>({idObj:this.getIdObj(e),delta:e})));await this.upsert(t,!0)}else console.error("Unexpected onUpdates");return!0}}).then((e=>{function t(){return"Data may be lost. Are you sure?"}this.dbSync=e,this.wal=new r.WAL({id_fields:g,synced_field:y,throttle:v,batch_size:b,onSendStart:()=>{o&&(window.onbeforeunload=t)},onSend:async(e,t)=>(await this.updatePatches(t)).length?this.dbSync.syncData(e):[],onSendEnd:()=>{o&&(window.onbeforeunload=null)}}),a()})),l[this.name].getColumns&&l[this.name].getColumns().then((e=>{this.columns=e})),this.onChange&&!this.skipFirstTrigger&&setTimeout(this.onChange,0),t.debug(this)}set multiSubscriptions(e){t.debug(e,this._multiSubscriptions),this._multiSubscriptions=e.slice(0)}get multiSubscriptions(){return this._multiSubscriptions}set singleSubscriptions(e){t.debug(e,this._singleSubscriptions),this._singleSubscriptions=e.slice(0)}get singleSubscriptions(){return this._singleSubscriptions}static create(e){return new Promise(((t,n)=>{try{const n=new a({...e,onReady:()=>{setTimeout((()=>{t(n)}),0)}})}catch(e){n(e)}}))}sync(e,t=!0){const n={$unsync:()=>this.unsubscribe(e),$upsert:e=>{if(e){const t=e=>({idObj:this.getIdObj(e),delta:e});Array.isArray(e)?this.upsert(e.map((e=>t(e)))):this.upsert([t(e)])}}},r={_onChange:e,handlesOnData:t,handles:n,notify:(n,r)=>{let i=[...n],o=[...r];return t&&(i=i.map(((n,r)=>{const i=(n,r)=>({...n,...this.makeSingleSyncHandles(r,e),$get:()=>i(this.getItem(r).data,r),$find:e=>i(this.getItem(e).data,e),$update:(e,t)=>this.upsert([{idObj:r,delta:e,opts:t}]).then((e=>!0)),$delete:async()=>this.delete(r),$cloneMultiSync:e=>this.sync(e,t)}),o=this.wal.getIdObj(n);return i(n,o)}))),e(i,o)}};return this.multiSubscriptions.push(r),this.skipFirstTrigger||setTimeout((()=>{let e=this.getItems();r.notify(e,e)}),0),Object.freeze({...n})}makeSingleSyncHandles(e,n){if(!e||!n)throw"syncOne(idObj, onChange) -> MISSING idObj or onChange";const r={$get:()=>this.getItem(e).data,$find:e=>this.getItem(e).data,$unsync:()=>this.unsubscribe(n),$delete:()=>this.delete(e),$update:(n,r)=>{this.singleSubscriptions.length||this.multiSubscriptions.length||(console.warn("No sync listeners"),t.debug("nosync",this._singleSubscriptions,this._multiSubscriptions)),this.upsert([{idObj:e,delta:n,opts:r}])},$cloneSync:t=>this.syncOne(e,t),$cloneMultiSync:e=>this.sync(e,!0)};return r}syncOne(e,t,n=!0){const r=this.makeSingleSyncHandles(e,t),i={_onChange:t,idObj:e,handlesOnData:n,handles:r,notify:(e,i)=>{let o={...e};return n&&(o.$get=r.$get,o.$find=r.$find,o.$update=r.$update,o.$delete=r.$delete,o.$unsync=r.$unsync,o.$cloneSync=r.$cloneSync),t(o,i)}};return this.singleSubscriptions.push(i),setTimeout((()=>{let e=r.$get();e&&i.notify(e,e)}),0),Object.freeze({...r})}getIdStr(e){return this.id_fields.sort().map((t=>`${e[t]||""}`)).join(".")}getIdObj(e){let t={};return this.id_fields.sort().map((n=>{t[n]=e[n]})),t}getRowSyncObj(e){let t={};return[this.synced_field,...this.id_fields].sort().map((n=>{t[n]=e[n]})),t}matchesFilter(e){return Boolean(e&&(!this.filter||r.isEmpty(this.filter)||!Object.keys(this.filter).find((t=>this.filter[t]!==e[t]))))}matchesIdObj(e,t){return Boolean(e&&t&&!this.id_fields.sort().find((n=>e[n]!==t[n])))}getDelta(e,t){return r.isEmpty(e)?{...t}:Object.keys({...e,...t}).filter((e=>!this.id_fields.includes(e))).reduce(((n,r)=>{let i={};if(r in t&&t[r]!==e[r]){let n={[r]:t[r]};t[r]&&e[r]&&"object"==typeof e[r]?JSON.stringify(t[r])!==JSON.stringify(e[r])&&(i=n):i=n}return{...n,...i}}),{})}deleteAll(){this.getItems().map((e=>this.delete(e)))}getItem(e){let t;return this.storageType===s.localStorage?t=this.getItems().find((t=>this.matchesIdObj(t,e))):this.storageType===s.array?t=this.items.find((t=>this.matchesIdObj(t,e))):(this.itemsObj=this.itemsObj||{},t={...this.itemsObj}[this.getIdStr(e)]),{data:t?{...t}:t,index:-1}}setItem(e,t,n=!1,r=!1){if(this.storageType===s.localStorage){let i=this.getItems();if(r)i=i.filter((t=>!this.matchesIdObj(t,e)));else{let r=t;i[r]?i[r]=n?{...e}:{...i[r],...e}:i.push(e)}o&&window.localStorage.setItem(this.name,JSON.stringify(i))}else if(this.storageType===s.array)r?this.items=this.items.filter((t=>!this.matchesIdObj(t,e))):this.items[t]?this.items[t]=n?{...e}:{...this.items[t],...e}:this.items.push(e);else if(this.itemsObj=this.itemsObj||{},r)delete this.itemsObj[this.getIdStr(e)];else{let t=this.itemsObj[this.getIdStr(e)]||{};this.itemsObj[this.getIdStr(e)]=n?{...e}:{...t,...e}}}}function l(e){return e&&"object"==typeof e&&!Array.isArray(e)}function c(e,...t){if(!t.length)return e;const n=t.shift();if(l(e)&&l(n))for(const t in n)l(n[t])?(e[t]||Object.assign(e,{[t]:{}}),c(e[t],n[t])):Object.assign(e,{[t]:n[t]});return c(e,...t)}t.SyncedTable=a,t.isObject=l,t.mergeDeep=c},9139:function(e,t,n){"use strict";const r=n(2330),i=n(3215);function o(e){return r.prostgles(e,i.SyncedTable)}o.SyncedTable=i.SyncedTable,e.exports=o},2330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prostgles=t.debug=void 0;const r=n(2040),i="DEBUG_SYNCEDTABLE",o="undefined"!=typeof window;t.debug=function(...e){o&&window[i]&&window[i](...e)},t.prostgles=function(e,n){const{socket:i,onReady:o,onDisconnect:s,onReconnect:a,onSchemaChange:l=!0}=e;if(t.debug("prostgles",{initOpts:e}),l){let e;"function"==typeof l&&(e=l),i.removeAllListeners(r.CHANNELS.SCHEMA_CHANGED),e&&i.on(r.CHANNELS.SCHEMA_CHANGED,e)}const c=r.CHANNELS._preffix;let u,h={},d={},f={},p={},m=!1;function g(e,n){return t.debug("_unsubscribe",{channelName:e,handler:n}),new Promise(((t,r)=>{h[e]?(h[e].handlers=h[e].handlers.filter((e=>e!==n)),h[e].handlers.length||(i.emit(e+"unsubscribe",{},((e,t)=>{e&&console.error(e)})),i.removeListener(e,h[e].onCall),delete h[e]),t(!0)):t(!0)}))}function y({tableName:e,command:t,param1:n,param2:r},o){return new Promise(((s,a)=>{i.emit(c,{tableName:e,command:t,param1:n,param2:r},((e,t)=>{if(e)console.error(e),a(e);else if(t){const{id_fields:e,synced_field:n,channelName:r}=t;i.emit(r,{onSyncRequest:o({},t)},(e=>{console.log(e)})),s({id_fields:e,synced_field:n,channelName:r})}}))}))}function v({tableName:e,command:t,param1:n,param2:r}){return new Promise(((o,s)=>{i.emit(c,{tableName:e,command:t,param1:n,param2:r},((e,t)=>{e?(console.error(e),s(e)):t&&o(t.channelName)}))}))}async function b(e,{tableName:t,command:n,param1:r,param2:o},s,a){function l(n){let i={unsubscribe:function(){return g(n,s)},filter:{...r}};return e[t].update&&(i={...i,update:function(n,i){return e[t].update(r,n,i)}}),e[t].delete&&(i={...i,delete:function(n){return e[t].delete(r,n)}}),Object.freeze(i)}const c=Object.keys(h).find((e=>{let i=h[e];return i.tableName===t&&i.command===n&&JSON.stringify(i.param1||{})===JSON.stringify(r||{})&&JSON.stringify(i.param2||{})===JSON.stringify(o||{})}));if(c)return h[c].handlers.push(s),setTimeout((()=>{s&&(null==h?void 0:h[c].lastData)&&s(null==h?void 0:h[c].lastData)}),10),l(c);{const e=await v({tableName:t,command:n,param1:r,param2:o});let c=function(t,n){h[e]?t.data?(h[e].lastData=t.data,h[e].handlers.map((e=>{e(t.data)}))):t.err?h[e].errorHandlers.map((e=>{e(t.err)})):console.error("INTERNAL ERROR: Unexpected data format from subscription: ",t):console.warn("Orphaned subscription: ",e)},u=a||function(t){console.error(`Uncaught error within running subscription \n ${e}`,t)};return i.on(e,c),h[e]={lastData:void 0,tableName:t,command:n,param1:r,param2:o,onCall:c,handlers:[s],errorHandlers:[u],destroy:()=>{h[e]&&(Object.values(h[e]).map((t=>{t&&t.handlers&&t.handlers.map((t=>g(e,t)))})),delete h[e])}},l(e)}}return new Promise(((e,l)=>{s&&i.on("disconnect",s),i.on(r.CHANNELS.SCHEMA,(({schema:s,methods:g,fullSchema:w,auth:x,rawSQL:E,joinTables:_=[],err:S})=>{if(S)throw l(S),S;t.debug("destroySyncs",{subscriptions:h,syncedTables:d}),Object.values(h).map((e=>e.destroy())),h={},f={},Object.values(d).map((e=>{e&&e.destroy&&e.destroy()})),d={},m&&a&&a(i),m=!0;let C=JSON.parse(JSON.stringify(s)),T=JSON.parse(JSON.stringify(g)),O={},P={};if(x){if(x.pathGuard){const e=e=>{var t,n;(null==e?void 0:e.shouldReload)&&"undefined"!=typeof window&&(null===(n=null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.reload)||void 0===n||n.call(t))};i.emit(r.CHANNELS.AUTHGUARD,JSON.stringify(window.location),((t,n)=>{e(n)})),i.removeAllListeners(r.CHANNELS.AUTHGUARD),i.on(r.CHANNELS.AUTHGUARD,(t=>{e(t)}))}P={...x},[r.CHANNELS.LOGIN,r.CHANNELS.LOGOUT,r.CHANNELS.REGISTER].map((e=>{x[e]&&(P[e]=function(t){return new Promise(((n,r)=>{i.emit(c+e,t,((e,t)=>{e?r(e):n(t)}))}))})}))}T.map((e=>{O[e]=function(...t){return new Promise(((n,o)=>{i.emit(r.CHANNELS.METHOD,{method:e,params:t},((e,t)=>{e?o(e):n(t)}))}))}})),O=Object.freeze(O),E&&(C.sql=function(e,t,n){return new Promise(((o,s)=>{i.emit(r.CHANNELS.SQL,{query:e,params:t,options:n},((e,t)=>{if(e)s(e);else if(n&&"noticeSubscription"===n.returnType&&t&&Object.keys(t).sort().join()===["socketChannel","socketUnsubChannel"].sort().join()&&!Object.values(t).find((e=>"string"!=typeof e))){const e=t,n=t=>(((e,t)=>{u=u||{config:t,listeners:[]},u.listeners.length||(i.removeAllListeners(t.socketChannel),i.on(t.socketChannel,(e=>{u&&u.listeners&&u.listeners.length?u.listeners.map((t=>{t(e)})):i.emit(t.socketUnsubChannel,{})}))),u.listeners.push(e)})(t,e),{...e,removeListener:()=>(e=>{u&&(u.listeners=u.listeners.filter((t=>t!==e)),!u.listeners.length&&u.config&&u.config.socketUnsubChannel&&i&&i.emit(u.config.socketUnsubChannel,{}))})(t)}),r={...e,addListener:n};o(r)}else if(n&&n.returnType&&"statement"===n.returnType||!t||Object.keys(t).sort().join()!==["socketChannel","socketUnsubChannel","notifChannel"].sort().join()||Object.values(t).find((e=>"string"!=typeof e)))o(t);else{const e=e=>(((e,t)=>{p=p||{},p[t.notifChannel]?p[t.notifChannel].listeners.push(e):(p[t.notifChannel]={config:t,listeners:[e]},i.removeAllListeners(t.socketChannel),i.on(t.socketChannel,(e=>{p[t.notifChannel]&&p[t.notifChannel].listeners&&p[t.notifChannel].listeners.length?p[t.notifChannel].listeners.map((t=>{t(e)})):i.emit(p[t.notifChannel].config.socketUnsubChannel,{})})))})(e,t),{...t,removeListener:()=>((e,t)=>{p&&p[t.notifChannel]&&(p[t.notifChannel].listeners=p[t.notifChannel].listeners.filter((t=>t!==e)),!p[t.notifChannel].listeners.length&&p[t.notifChannel].config&&p[t.notifChannel].config.socketUnsubChannel&&i&&(i.emit(p[t.notifChannel].config.socketUnsubChannel,{}),delete p[t.notifChannel]))})(e,t)}),n={...t,addListener:e};o(n)}}))}))});const A=e=>"[object Object]"===Object.prototype.toString.call(e),k=(e,t,n,r)=>{if(!A(e)||!A(t)||"function"!=typeof n||r&&"function"!=typeof r)throw"Expecting: ( basicFilter<object>, options<object>, onChange<function> , onError?<function>) but got something else"},M=["subscribe","subscribeOne"];Object.keys(C).forEach((e=>{Object.keys(C[e]).sort(((e,t)=>M.includes(e)-M.includes(t))).forEach((r=>{if(["find","findOne"].includes(r)&&(C[e].getJoinedTables=function(){return(_||[]).filter((t=>Array.isArray(t)&&t.includes(e))).flat().filter((t=>t!==e))}),"sync"===r){if(C[e]._syncInfo={...C[e][r]},n){C[e].getSync=(t,r={})=>n.create({name:e,filter:t,db:C,...r});const t=async(t={},r={},i)=>{const o=`${e}.${JSON.stringify(t)}.${JSON.stringify(r)}`;return d[o]||(d[o]=await n.create({...r,name:e,filter:t,db:C,onError:i})),d[o]};C[e].sync=async(e,n={handlesOnData:!0,select:"*"},r,i)=>{k(e,n,r,i);const o=await t(e,n,i);return await o.sync(r,n.handlesOnData)},C[e].syncOne=async(e,n={handlesOnData:!0},r,i)=>{k(e,n,r,i);const o=await t(e,n,i);return await o.syncOne(e,r,n.handlesOnData)}}C[e]._sync=function(n,o,s){return async function({tableName:e,command:n,param1:r,param2:o},s){const{onPullRequest:a,onSyncRequest:l,onUpdates:c}=s;function u(e,n){return Object.freeze({unsync:function(){!function(e,n){t.debug("_unsync",{channelName:e,triggers:n}),new Promise(((t,r)=>{f[e]&&(f[e].triggers=f[e].triggers.filter((e=>e.onPullRequest!==n.onPullRequest&&e.onSyncRequest!==n.onSyncRequest&&e.onUpdates!==n.onUpdates)),f[e].triggers.length||(i.emit(e+"unsync",{},((e,n)=>{e?r(e):t(n)})),i.removeListener(e,f[e].onCall),delete f[e]))}))}(e,s)},syncData:function(t,n,r){i.emit(e,{onSyncRequest:{...l({}),...{data:t}||{},...{deleted:n}||{}}},r?e=>{r(e)}:null)}})}const h=Object.keys(f).find((t=>{let i=f[t];return i.tableName===e&&i.command===n&&JSON.stringify(i.param1||{})===JSON.stringify(r||{})&&JSON.stringify(i.param2||{})===JSON.stringify(o||{})}));if(h)return f[h].triggers.push(s),u(h,f[h].syncInfo);{const t=await y({tableName:e,command:n,param1:r,param2:o},l),{channelName:a,synced_field:c,id_fields:h}=t;function d(t,n){t&&f[a]&&f[a].triggers.map((({onUpdates:r,onSyncRequest:i,onPullRequest:o})=>{t.data?Promise.resolve(r(t)).then((()=>{n&&n({ok:!0})})).catch((t=>{n?n({err:t}):console.error(e+" onUpdates error",t)})):t.onSyncRequest?Promise.resolve(i(t.onSyncRequest)).then((e=>n({onSyncRequest:e}))).catch((t=>{n?n({err:t}):console.error(e+" onSyncRequest error",t)})):t.onPullRequest?Promise.resolve(o(t.onPullRequest)).then((e=>{n({data:e})})).catch((t=>{n?n({err:t}):console.error(e+" onPullRequest error",t)})):console.log("unexpected response")}))}return f[a]={tableName:e,command:n,param1:r,param2:o,triggers:[s],syncInfo:t,onCall:d},i.on(a,d),u(a)}}({tableName:e,command:r,param1:n,param2:o},s)}}else if(M.includes(r)){C[e][r]=function(t,n,i,o){return k(t,n,i,o),b(C,{tableName:e,command:r,param1:t,param2:n},i,o)};const t="subscribeOne";r!==t&&M.includes(t)||(C[e][t]=function(t,n,i,o){return k(t,n,i,o),b(C,{tableName:e,command:r,param1:t,param2:n},(e=>{i(e[0])}),o)})}else C[e][r]=function(t,n,o){return new Promise(((s,a)=>{i.emit(c,{tableName:e,command:r,param1:t,param2:n,param3:o},((e,t)=>{e?a(e):s(t)}))}))}}))})),h&&Object.keys(h).length&&Object.keys(h).map((async e=>{try{let t=h[e];await v(t),i.on(e,t.onCall)}catch(e){console.error("There was an issue reconnecting old subscriptions",e)}})),f&&Object.keys(f).length&&Object.keys(f).filter((e=>f[e].triggers&&f[e].triggers.length)).map((async e=>{try{let t=f[e];await y(t,t.triggers[0].onSyncRequest),i.on(e,t.onCall)}catch(e){console.error("There was an issue reconnecting olf subscriptions",e)}})),_.flat().map((e=>{function t(t=!0,n,r,i){return{[t?"$leftJoin":"$innerJoin"]:e,filter:n,select:r,...i}}C.innerJoin=C.innerJoin||{},C.leftJoin=C.leftJoin||{},C.innerJoinOne=C.innerJoinOne||{},C.leftJoinOne=C.leftJoinOne||{},C.leftJoin[e]=(e,n,r={})=>t(!0,e,n,r),C.innerJoin[e]=(e,n,r={})=>t(!1,e,n,r),C.leftJoinOne[e]=(e,n,r={})=>t(!0,e,n,{...r,limit:1}),C.innerJoinOne[e]=(e,n,r={})=>t(!1,e,n,{...r,limit:1})})),(async()=>{try{await o(C,O,w,P)}catch(e){console.error("Prostgles: Error within onReady: \n",e),l(e)}e(C)})()}))}))}},2040:function(e){this||window,e.exports=(()=>{"use strict";var e={444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EXISTS_KEYS=t.GeomFilter_Funcs=t.GeomFilterKeys=t.TextFilterFTSKeys=t.TextFilter_FullTextSearchFilterKeys=t.CompareInFilterKeys=t.CompareFilterKeys=void 0,t.CompareFilterKeys=["=","$eq","<>",">",">=","<=","$eq","$ne","$gt","$gte","$lte"],t.CompareInFilterKeys=["$in","$nin"],t.TextFilter_FullTextSearchFilterKeys=["to_tsquery","plainto_tsquery","phraseto_tsquery","websearch_to_tsquery"],t.TextFilterFTSKeys=["@@","@>","<@","$contains","$containedBy"],t.GeomFilterKeys=["~","~=","@","|&>","|>>",">>","=","<<|","<<","&>","&<|","&<","&&&","&&"];const n=["ST_MakeEnvelope","ST_MakePolygon"];t.GeomFilter_Funcs=n.concat(n.map((e=>e.toLowerCase()))),t.EXISTS_KEYS=["$exists","$notExists","$existsJoined","$notExistsJoined"]},590:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.get=t.WAL=t.unpatchText=t.stableStringify=t.isEmpty=t.getTextPatch=t.asName=t.CHANNELS=t.TS_PG_Types=t._PG_postgis=t._PG_date=t._PG_bool=t._PG_json=t._PG_numbers=t._PG_strings=void 0,t._PG_strings=["bpchar","char","varchar","text","citext","uuid","bytea","inet","time","timetz","interval","name"],t._PG_numbers=["int2","int4","int8","float4","float8","numeric","money","oid"],t._PG_json=["json","jsonb"],t._PG_bool=["bool"],t._PG_date=["date","timestamp","timestamptz"],t._PG_postgis=["geometry","geography"],t.TS_PG_Types={string:t._PG_strings,number:t._PG_numbers,boolean:t._PG_bool,Object:t._PG_json,Date:t._PG_date,"Array<number>":t._PG_numbers.map((e=>`_${e}`)),"Array<boolean>":t._PG_bool.map((e=>`_${e}`)),"Array<string>":t._PG_strings.map((e=>`_${e}`)),"Array<Object>":t._PG_json.map((e=>`_${e}`)),"Array<Date>":t._PG_date.map((e=>`_${e}`)),any:[]};const o="_psqlWS_.";t.CHANNELS={SCHEMA_CHANGED:o+"schema-changed",SCHEMA:o+"schema",DEFAULT:o,SQL:"_psqlWS_.sql",METHOD:"_psqlWS_.method",NOTICE_EV:"_psqlWS_.notice",LISTEN_EV:"_psqlWS_.listen",REGISTER:"_psqlWS_.register",LOGIN:"_psqlWS_.login",LOGOUT:"_psqlWS_.logout",AUTHGUARD:"_psqlWS_.authguard",_preffix:o};var s=n(128);Object.defineProperty(t,"asName",{enumerable:!0,get:function(){return s.asName}}),Object.defineProperty(t,"getTextPatch",{enumerable:!0,get:function(){return s.getTextPatch}}),Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return s.isEmpty}}),Object.defineProperty(t,"stableStringify",{enumerable:!0,get:function(){return s.stableStringify}}),Object.defineProperty(t,"unpatchText",{enumerable:!0,get:function(){return s.unpatchText}}),Object.defineProperty(t,"WAL",{enumerable:!0,get:function(){return s.WAL}}),Object.defineProperty(t,"get",{enumerable:!0,get:function(){return s.get}}),i(n(444),t)},899:(e,t)=>{function n(e,t){var n=e[0],r=e[1],l=e[2],c=e[3];n=i(n,r,l,c,t[0],7,-680876936),c=i(c,n,r,l,t[1],12,-389564586),l=i(l,c,n,r,t[2],17,606105819),r=i(r,l,c,n,t[3],22,-1044525330),n=i(n,r,l,c,t[4],7,-176418897),c=i(c,n,r,l,t[5],12,1200080426),l=i(l,c,n,r,t[6],17,-1473231341),r=i(r,l,c,n,t[7],22,-45705983),n=i(n,r,l,c,t[8],7,1770035416),c=i(c,n,r,l,t[9],12,-1958414417),l=i(l,c,n,r,t[10],17,-42063),r=i(r,l,c,n,t[11],22,-1990404162),n=i(n,r,l,c,t[12],7,1804603682),c=i(c,n,r,l,t[13],12,-40341101),l=i(l,c,n,r,t[14],17,-1502002290),n=o(n,r=i(r,l,c,n,t[15],22,1236535329),l,c,t[1],5,-165796510),c=o(c,n,r,l,t[6],9,-1069501632),l=o(l,c,n,r,t[11],14,643717713),r=o(r,l,c,n,t[0],20,-373897302),n=o(n,r,l,c,t[5],5,-701558691),c=o(c,n,r,l,t[10],9,38016083),l=o(l,c,n,r,t[15],14,-660478335),r=o(r,l,c,n,t[4],20,-405537848),n=o(n,r,l,c,t[9],5,568446438),c=o(c,n,r,l,t[14],9,-1019803690),l=o(l,c,n,r,t[3],14,-187363961),r=o(r,l,c,n,t[8],20,1163531501),n=o(n,r,l,c,t[13],5,-1444681467),c=o(c,n,r,l,t[2],9,-51403784),l=o(l,c,n,r,t[7],14,1735328473),n=s(n,r=o(r,l,c,n,t[12],20,-1926607734),l,c,t[5],4,-378558),c=s(c,n,r,l,t[8],11,-2022574463),l=s(l,c,n,r,t[11],16,1839030562),r=s(r,l,c,n,t[14],23,-35309556),n=s(n,r,l,c,t[1],4,-1530992060),c=s(c,n,r,l,t[4],11,1272893353),l=s(l,c,n,r,t[7],16,-155497632),r=s(r,l,c,n,t[10],23,-1094730640),n=s(n,r,l,c,t[13],4,681279174),c=s(c,n,r,l,t[0],11,-358537222),l=s(l,c,n,r,t[3],16,-722521979),r=s(r,l,c,n,t[6],23,76029189),n=s(n,r,l,c,t[9],4,-640364487),c=s(c,n,r,l,t[12],11,-421815835),l=s(l,c,n,r,t[15],16,530742520),n=a(n,r=s(r,l,c,n,t[2],23,-995338651),l,c,t[0],6,-198630844),c=a(c,n,r,l,t[7],10,1126891415),l=a(l,c,n,r,t[14],15,-1416354905),r=a(r,l,c,n,t[5],21,-57434055),n=a(n,r,l,c,t[12],6,1700485571),c=a(c,n,r,l,t[3],10,-1894986606),l=a(l,c,n,r,t[10],15,-1051523),r=a(r,l,c,n,t[1],21,-2054922799),n=a(n,r,l,c,t[8],6,1873313359),c=a(c,n,r,l,t[15],10,-30611744),l=a(l,c,n,r,t[6],15,-1560198380),r=a(r,l,c,n,t[13],21,1309151649),n=a(n,r,l,c,t[4],6,-145523070),c=a(c,n,r,l,t[11],10,-1120210379),l=a(l,c,n,r,t[2],15,718787259),r=a(r,l,c,n,t[9],21,-343485551),e[0]=d(n,e[0]),e[1]=d(r,e[1]),e[2]=d(l,e[2]),e[3]=d(c,e[3])}function r(e,t,n,r,i,o){return t=d(d(t,e),d(r,o)),d(t<<i|t>>>32-i,n)}function i(e,t,n,i,o,s,a){return r(t&n|~t&i,e,t,o,s,a)}function o(e,t,n,i,o,s,a){return r(t&i|n&~i,e,t,o,s,a)}function s(e,t,n,i,o,s,a){return r(t^n^i,e,t,o,s,a)}function a(e,t,n,i,o,s,a){return r(n^(t|~i),e,t,o,s,a)}function l(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.md5=t.md5cycle=void 0,t.md5cycle=n;var c="0123456789abcdef".split("");function u(e){for(var t="",n=0;n<4;n++)t+=c[e>>8*n+4&15]+c[e>>8*n&15];return t}function h(e){return function(e){for(var t=0;t<e.length;t++)e[t]=u(e[t]);return e.join("")}(function(e){var t,r=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)n(i,l(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*r,n(i,o),i}(e))}function d(e,t){return e+t&4294967295}t.md5=h,h("hello")},128:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.get=t.isEmpty=t.WAL=t.unpatchText=t.getTextPatch=t.stableStringify=t.asName=void 0;const i=n(899);function o(e){for(var t in e)return!1;return!0}t.asName=function(e){if(null==e||!e.toString||!e.toString())throw"Expecting a non empty string";return`"${e.toString().replace(/"/g,'""')}"`},t.stableStringify=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},o={key:r,value:e[r]};return n(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,s;if(Array.isArray(t)){for(s="[",n=0;n<t.length;n++)n&&(s+=","),s+=e(t[n])||"null";return s+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=o.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(s="",n=0;n<l.length;n++){var c=l[n],u=e(t[c]);u&&(s&&(s+=","),s+=JSON.stringify(c)+":"+u)}return o.splice(a,1),"{"+s+"}"}}(e)},t.getTextPatch=function(e,t){if(!(e&&t&&e.trim().length&&t.trim().length))return t;if(e===t)return{from:0,to:0,text:"",md5:i.md5(t)};function n(n=1){let r=n<1?-1:0,i=!1;for(;!i&&Math.abs(r)<=t.length;){const o=n<1?[r]:[0,r];e.slice(...o)!==t.slice(...o)?i=!0:r+=1*Math.sign(n)}return r}let r=n()-1,o=e.length+n(-1)+1,s=t.length+n(-1)+1;return{from:r,to:o,text:t.slice(r,s),md5:i.md5(t)}},t.unpatchText=function(e,t){if(!t||"string"==typeof t)return t;const{from:n,to:r,text:o,md5:s}=t;if(null===o||null===e)return o;let a=e.slice(0,n)+o+e.slice(r);if(s&&i.md5(a)!==s)throw"Patch text error: Could not match md5 hash: (original/result) \n"+e+"\n"+a;return a},t.WAL=class{constructor(e){if(this.changed={},this.sending={},this.sentHistory={},this.callbacks=[],this.sort=(e,t)=>{const{orderBy:n}=this.options;return n&&e&&t&&n.map((n=>{if(!(n.fieldName in e)||!(n.fieldName in t))throw"Replication error: \n   some orderBy fields missing from data";let r=n.asc?e[n.fieldName]:t[n.fieldName],i=n.asc?t[n.fieldName]:e[n.fieldName],o=+r-+i,s=r<i?-1:r==i?0:1;return"number"===n.tsDataType&&Number.isFinite(o)?o:s})).find((e=>e))||0},this.isInHistory=e=>{if(!e)throw"Provide item";const t=e[this.options.synced_field];if(!Number.isFinite(+t))throw"Provided item Synced field value is missing/invalid ";const n=this.sentHistory[this.getIdStr(e)],r=null==n?void 0:n[this.options.synced_field];if(n){if(!Number.isFinite(+r))throw"Provided historic item Synced field value is missing/invalid";if(+r==+t)return!0}return!1},this.addData=e=>{o(this.changed)&&this.options.onSendStart&&this.options.onSendStart(),e.map((e=>{const{initial:t,current:n}=Object.assign({},e);if(!n)throw"Expecting { current: object, initial?: object }";const r=this.getIdStr(n);this.changed=this.changed||{},this.changed[r]=this.changed[r]||{initial:t,current:n},this.changed[r].current=Object.assign(Object.assign({},this.changed[r].current),n)})),this.sendItems()},this.isOnSending=!1,this.isSendingTimeout=void 0,this.willDeleteHistory=void 0,this.sendItems=()=>r(this,void 0,void 0,(function*(){const{DEBUG_MODE:e,onSend:t,onSendEnd:n,batch_size:r,throttle:i,historyAgeSeconds:s=2}=this.options;if(this.isSendingTimeout||this.sending&&!o(this.sending))return;if(!this.changed||o(this.changed))return;let a,l=[],c=[],u={};Object.keys(this.changed).sort(((e,t)=>this.sort(this.changed[e].current,this.changed[t].current))).slice(0,r).map((e=>{let t=Object.assign({},this.changed[e]);this.sending[e]=Object.assign({},t),c.push(Object.assign({},t)),u[e]=Object.assign({},t.current),delete this.changed[e]})),l=c.map((e=>e.current)),e&&console.log(this.options.id," SENDING lr->",l[l.length-1]),this.isSendingTimeout||(this.isSendingTimeout=setTimeout((()=>{this.isSendingTimeout=void 0,o(this.changed)||this.sendItems()}),i)),this.isOnSending=!0;try{yield t(l,c),s&&(this.sentHistory=Object.assign(Object.assign({},this.sentHistory),u),this.willDeleteHistory||(this.willDeleteHistory=setTimeout((()=>{this.willDeleteHistory=void 0,this.sentHistory={}}),1e3*s)))}catch(e){a=e,console.error("WAL onSend failed:",e,l,c)}if(this.isOnSending=!1,this.callbacks.length){const e=Object.keys(this.sending);this.callbacks.forEach(((t,n)=>{t.idStrs=t.idStrs.filter((t=>e.includes(t))),t.idStrs.length||t.cb(a)})),this.callbacks=this.callbacks.filter((e=>e.idStrs.length))}this.sending={},e&&console.log(this.options.id," SENT lr->",l[l.length-1]),o(this.changed)?n&&n(l,c,a):this.sendItems()})),this.options=Object.assign({},e),!this.options.orderBy){const{synced_field:t,id_fields:n}=e;this.options.orderBy=[t,...n.sort()].map((e=>({fieldName:e,tsDataType:e===t?"number":"string",asc:!0})))}}isSending(){const e=this.isOnSending||!(o(this.sending)&&o(this.changed));return this.options.DEBUG_MODE&&console.log(this.options.id," CHECKING isSending ->",e),e}getIdStr(e){return this.options.id_fields.sort().map((t=>`${e[t]||""}`)).join(".")}getIdObj(e){let t={};return this.options.id_fields.sort().map((n=>{t[n]=e[n]})),t}getDeltaObj(e){let t={};return Object.keys(e).map((n=>{this.options.id_fields.includes(n)||(t[n]=e[n])})),t}},t.isEmpty=o,t.get=function(e,t){let n=t,r=e;return e?("string"==typeof n&&(n=n.split(".")),n.reduce(((e,t)=>e&&e[t]?e[t]:void 0),r)):e}}},t={};return function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(590)})()},3577:function(e,t,n){"use strict";var r=n(7378),i=n(2525),o=n(1102);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));function a(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var l=!1,c=null,u=!1,h=null,d={onError:function(e){l=!0,c=e}};function f(e,t,n,r,i,o,s,u,h){l=!1,c=null,a.apply(d,arguments)}var p=null,m=null,g=null;function y(e,t,n){var r=e.type||"unknown-event";e.currentTarget=g(n),function(e,t,n,r,i,o,a,d,p){if(f.apply(this,arguments),l){if(!l)throw Error(s(198));var m=c;l=!1,c=null,u||(u=!0,h=m)}}(r,t,void 0,e),e.currentTarget=null}var v=null,b={};function w(){if(v)for(var e in b){var t=b[e],n=v.indexOf(e);if(!(-1<n))throw Error(s(96,e));if(!E[n]){if(!t.extractEvents)throw Error(s(97,e));for(var r in E[n]=t,n=t.eventTypes){var i=void 0,o=n[r],a=t,l=r;if(_.hasOwnProperty(l))throw Error(s(99,l));_[l]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&x(c[i],a,l);i=!0}else o.registrationName?(x(o.registrationName,a,l),i=!0):i=!1;if(!i)throw Error(s(98,r,e))}}}}function x(e,t,n){if(S[e])throw Error(s(100,e));S[e]=t,C[e]=t.eventTypes[n].dependencies}var E=[],_={},S={},C={};function T(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(s(102,t));b[t]=r,n=!0}}n&&w()}var O=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),P=null,A=null,k=null;function M(e){if(e=m(e)){if("function"!=typeof P)throw Error(s(280));var t=e.stateNode;t&&(t=p(t),P(e.stateNode,e.type,t))}}function N(e){A?k?k.push(e):k=[e]:A=e}function L(){if(A){var e=A,t=k;if(k=A=null,M(e),t)for(e=0;e<t.length;e++)M(t[e])}}function R(e,t){return e(t)}function I(e,t,n,r,i){return e(t,n,r,i)}function D(){}var j=R,F=!1,z=!1;function B(){null===A&&null===k||(D(),L())}function U(e,t,n){if(z)return e(t,n);z=!0;try{return j(e,t,n)}finally{z=!1,B()}}var V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,q={},W={};function G(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var $={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){$[e]=new G(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];$[t]=new G(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){$[e]=new G(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){$[e]=new G(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){$[e]=new G(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){$[e]=new G(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){$[e]=new G(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){$[e]=new G(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){$[e]=new G(e,5,!1,e.toLowerCase(),null,!1)}));var Y=/[\-:]([a-z])/g;function X(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Y,X);$[t]=new G(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Y,X);$[t]=new G(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Y,X);$[t]=new G(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){$[e]=new G(e,1,!1,e.toLowerCase(),null,!1)})),$.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){$[e]=new G(e,1,!1,e.toLowerCase(),null,!0)}));var K=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Z(e,t,n,r){var i=$.hasOwnProperty(t)?$[t]:null;(null!==i?0===i.type:!r&&2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!H.call(W,e)||!H.call(q,e)&&(V.test(e)?W[e]=!0:(q[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}K.hasOwnProperty("ReactCurrentDispatcher")||(K.ReactCurrentDispatcher={current:null}),K.hasOwnProperty("ReactCurrentBatchConfig")||(K.ReactCurrentBatchConfig={suspense:null});var J=/^(.*)[\\\/]/,Q="function"==typeof Symbol&&Symbol.for,ee=Q?Symbol.for("react.element"):60103,te=Q?Symbol.for("react.portal"):60106,ne=Q?Symbol.for("react.fragment"):60107,re=Q?Symbol.for("react.strict_mode"):60108,ie=Q?Symbol.for("react.profiler"):60114,oe=Q?Symbol.for("react.provider"):60109,se=Q?Symbol.for("react.context"):60110,ae=Q?Symbol.for("react.concurrent_mode"):60111,le=Q?Symbol.for("react.forward_ref"):60112,ce=Q?Symbol.for("react.suspense"):60113,ue=Q?Symbol.for("react.suspense_list"):60120,he=Q?Symbol.for("react.memo"):60115,de=Q?Symbol.for("react.lazy"):60116,fe=Q?Symbol.for("react.block"):60121,pe="function"==typeof Symbol&&Symbol.iterator;function me(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=pe&&e[pe]||e["@@iterator"])?e:null}function ge(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case ce:return"Suspense";case ue:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case se:return"Context.Consumer";case oe:return"Context.Provider";case le:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case he:return ge(e.type);case fe:return ge(e.render);case de:if(e=1===e._status?e._result:null)return ge(e)}return null}function ye(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=ge(e.type);n=null,r&&(n=ge(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(J,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ve(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function we(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function xe(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Ee(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function _e(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ve(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Se(e,t){null!=(t=t.checked)&&Z(e,"checked",t,!1)}function Ce(e,t){Se(e,t);var n=ve(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Oe(e,t.type,n):t.hasOwnProperty("defaultValue")&&Oe(e,t.type,ve(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Te(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Oe(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Pe(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Ae(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ve(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ke(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Me(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ve(n)}}function Ne(e,t){var n=ve(t.value),r=ve(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function Re(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ie(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Re(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var De,je,Fe=(je=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((De=De||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=De.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return je(e,t)}))}:je);function ze(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Be(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ue={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},Ve={},He={};function qe(e){if(Ve[e])return Ve[e];if(!Ue[e])return e;var t,n=Ue[e];for(t in n)if(n.hasOwnProperty(t)&&t in He)return Ve[e]=n[t];return e}O&&(He=document.createElement("div").style,"AnimationEvent"in window||(delete Ue.animationend.animation,delete Ue.animationiteration.animation,delete Ue.animationstart.animation),"TransitionEvent"in window||delete Ue.transitionend.transition);var We=qe("animationend"),Ge=qe("animationiteration"),$e=qe("animationstart"),Ye=qe("transitionend"),Xe="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ke=new("function"==typeof WeakMap?WeakMap:Map);function Ze(e){var t=Ke.get(e);return void 0===t&&(t=new Map,Ke.set(e,t)),t}function Je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function et(e){if(Je(e)!==e)throw Error(s(188))}function tt(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Je(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return et(i),e;if(o===r)return et(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function nt(e,t){if(null==t)throw Error(s(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function rt(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var it=null;function ot(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)y(e,t[r],n[r]);else t&&y(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function st(e){if(null!==e&&(it=nt(it,e)),e=it,it=null,e){if(rt(e,ot),it)throw Error(s(95));if(u)throw e=h,u=!1,h=null,e}}function at(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function lt(e){if(!O)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var ct=[];function ut(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>ct.length&&ct.push(e)}function ht(e,t,n,r){if(ct.length){var i=ct.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function dt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=An(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=at(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,s=e.eventSystemFlags;0===n&&(s|=64);for(var a=null,l=0;l<E.length;l++){var c=E[l];c&&(c=c.extractEvents(r,t,o,i,s))&&(a=nt(a,c))}st(a)}}function ft(e,t,n){if(!n.has(e)){switch(e){case"scroll":$t(t,"scroll",!0);break;case"focus":case"blur":$t(t,"focus",!0),$t(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":lt(e)&&$t(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Xe.indexOf(e)&&Gt(e,t)}n.set(e,null)}}var pt,mt,gt,yt=!1,vt=[],bt=null,wt=null,xt=null,Et=new Map,_t=new Map,St=[],Ct="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Tt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Ot(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Pt(e,t){switch(e){case"focus":case"blur":bt=null;break;case"dragenter":case"dragleave":wt=null;break;case"mouseover":case"mouseout":xt=null;break;case"pointerover":case"pointerout":Et.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(t.pointerId)}}function At(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=Ot(t,n,r,i,o),null!==t&&null!==(t=kn(t))&&mt(t),e):(e.eventSystemFlags|=r,e)}function kt(e){var t=An(e.target);if(null!==t){var n=Je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Qe(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){gt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=kn(t);return null!==n&&mt(n),e.blockedOn=t,!1}return!0}function Nt(e,t,n){Mt(e)&&n.delete(t)}function Lt(){for(yt=!1;0<vt.length;){var e=vt[0];if(null!==e.blockedOn){null!==(e=kn(e.blockedOn))&&pt(e);break}var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:vt.shift()}null!==bt&&Mt(bt)&&(bt=null),null!==wt&&Mt(wt)&&(wt=null),null!==xt&&Mt(xt)&&(xt=null),Et.forEach(Nt),_t.forEach(Nt)}function Rt(e,t){e.blockedOn===t&&(e.blockedOn=null,yt||(yt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Lt)))}function It(e){function t(t){return Rt(t,e)}if(0<vt.length){Rt(vt[0],e);for(var n=1;n<vt.length;n++){var r=vt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==bt&&Rt(bt,e),null!==wt&&Rt(wt,e),null!==xt&&Rt(xt,e),Et.forEach(t),_t.forEach(t),n=0;n<St.length;n++)(r=St[n]).blockedOn===e&&(r.blockedOn=null);for(;0<St.length&&null===(n=St[0]).blockedOn;)kt(n),null===n.blockedOn&&St.shift()}var Dt={},jt=new Map,Ft=new Map,zt=["abort","abort",We,"animationEnd",Ge,"animationIteration",$e,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ye,"transitionEnd","waiting","waiting"];function Bt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},Ft.set(r,t),jt.set(r,o),Dt[i]=o}}Bt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Bt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Bt(zt,2);for(var Ut="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Vt=0;Vt<Ut.length;Vt++)Ft.set(Ut[Vt],0);var Ht=o.unstable_UserBlockingPriority,qt=o.unstable_runWithPriority,Wt=!0;function Gt(e,t){$t(t,e,!1)}function $t(e,t,n){var r=Ft.get(t);switch(void 0===r?2:r){case 0:r=Yt.bind(null,t,1,e);break;case 1:r=Xt.bind(null,t,1,e);break;default:r=Kt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Yt(e,t,n,r){F||D();var i=Kt,o=F;F=!0;try{I(i,e,t,n,r)}finally{(F=o)||B()}}function Xt(e,t,n,r){qt(Ht,Kt.bind(null,e,t,n,r))}function Kt(e,t,n,r){if(Wt)if(0<vt.length&&-1<Ct.indexOf(e))e=Ot(null,e,t,n,r),vt.push(e);else{var i=Zt(e,t,n,r);if(null===i)Pt(e,r);else if(-1<Ct.indexOf(e))e=Ot(i,e,t,n,r),vt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return bt=At(bt,e,t,n,r,i),!0;case"dragenter":return wt=At(wt,e,t,n,r,i),!0;case"mouseover":return xt=At(xt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Et.set(o,At(Et.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,_t.set(o,At(_t.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){Pt(e,r),e=ht(e,r,null,t);try{U(dt,e)}finally{ut(e)}}}}function Zt(e,t,n,r){if(null!==(n=An(n=at(r)))){var i=Je(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=Qe(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=ht(e,r,n,t);try{U(dt,e)}finally{ut(e)}return null}var Jt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qt=["Webkit","ms","Moz","O"];function en(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Jt.hasOwnProperty(e)&&Jt[e]?(""+t).trim():t+"px"}function tn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=en(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Jt).forEach((function(e){Qt.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Jt[t]=Jt[e]}))}));var nn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rn(e,t){if(t){if(nn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62,""))}}function on(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn="http://www.w3.org/1999/xhtml";function an(e,t){var n=Ze(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=C[t];for(var r=0;r<t.length;r++)ft(t[r],e,n)}function ln(){}function cn(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hn(e,t){var n,r=un(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=un(r)}}function dn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=cn();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=cn((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mn="$?",gn="$!",yn=null,vn=null;function bn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function wn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xn="function"==typeof setTimeout?setTimeout:void 0,En="function"==typeof clearTimeout?clearTimeout:void 0;function _n(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Sn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||n===gn||n===mn){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Cn=Math.random().toString(36).slice(2),Tn="__reactInternalInstance$"+Cn,On="__reactEventHandlers$"+Cn,Pn="__reactContainere$"+Cn;function An(e){var t=e[Tn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Pn]||n[Tn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Sn(e);null!==e;){if(n=e[Tn])return n;e=Sn(e)}return t}n=(e=n).parentNode}return null}function kn(e){return!(e=e[Tn]||e[Pn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Mn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Nn(e){return e[On]||null}function Ln(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Rn(e,t){var n=e.stateNode;if(!n)return null;var r=p(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}function In(e,t,n){(t=Rn(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=nt(n._dispatchListeners,t),n._dispatchInstances=nt(n._dispatchInstances,e))}function Dn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Ln(t);for(t=n.length;0<t--;)In(n[t],"captured",e);for(t=0;t<n.length;t++)In(n[t],"bubbled",e)}}function jn(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Rn(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=nt(n._dispatchListeners,t),n._dispatchInstances=nt(n._dispatchInstances,e))}function Fn(e){e&&e.dispatchConfig.registrationName&&jn(e._targetInst,null,e)}function zn(e){rt(e,Dn)}var Bn=null,Un=null,Vn=null;function Hn(){if(Vn)return Vn;var e,t,n=Un,r=n.length,i="value"in Bn?Bn.value:Bn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Vn=i.slice(e,1<t?1-t:void 0)}function qn(){return!0}function Wn(){return!1}function Gn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?qn:Wn,this.isPropagationStopped=Wn,this}function $n(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Yn(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Xn(e){e.eventPool=[],e.getPooled=$n,e.release=Yn}i(Gn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qn)},persist:function(){this.isPersistent=qn},isPersistent:Wn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Wn,this._dispatchInstances=this._dispatchListeners=null}}),Gn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Gn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,Xn(n),n},Xn(Gn);var Kn=Gn.extend({data:null}),Zn=Gn.extend({data:null}),Jn=[9,13,27,32],Qn=O&&"CompositionEvent"in window,er=null;O&&"documentMode"in document&&(er=document.documentMode);var tr=O&&"TextEvent"in window&&!er,nr=O&&(!Qn||er&&8<er&&11>=er),rr=String.fromCharCode(32),ir={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},or=!1;function sr(e,t){switch(e){case"keyup":return-1!==Jn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function ar(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var lr=!1,cr={eventTypes:ir,extractEvents:function(e,t,n,r){var i;if(Qn)e:{switch(e){case"compositionstart":var o=ir.compositionStart;break e;case"compositionend":o=ir.compositionEnd;break e;case"compositionupdate":o=ir.compositionUpdate;break e}o=void 0}else lr?sr(e,n)&&(o=ir.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=ir.compositionStart);return o?(nr&&"ko"!==n.locale&&(lr||o!==ir.compositionStart?o===ir.compositionEnd&&lr&&(i=Hn()):(Un="value"in(Bn=r)?Bn.value:Bn.textContent,lr=!0)),o=Kn.getPooled(o,t,n,r),(i||null!==(i=ar(n)))&&(o.data=i),zn(o),i=o):i=null,(e=tr?function(e,t){switch(e){case"compositionend":return ar(t);case"keypress":return 32!==t.which?null:(or=!0,rr);case"textInput":return(e=t.data)===rr&&or?null:e;default:return null}}(e,n):function(e,t){if(lr)return"compositionend"===e||!Qn&&sr(e,t)?(e=Hn(),Vn=Un=Bn=null,lr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nr&&"ko"!==t.locale?null:t.data}}(e,n))?((t=Zn.getPooled(ir.beforeInput,t,n,r)).data=e,zn(t)):t=null,null===i?t:null===t?i:[i,t]}},ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!ur[e.type]:"textarea"===t}var dr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function fr(e,t,n){return(e=Gn.getPooled(dr.change,e,t,n)).type="change",N(n),zn(e),e}var pr=null,mr=null;function gr(e){st(e)}function yr(e){if(xe(Mn(e)))return e}function vr(e,t){if("change"===e)return t}var br=!1;function wr(){pr&&(pr.detachEvent("onpropertychange",xr),mr=pr=null)}function xr(e){if("value"===e.propertyName&&yr(mr))if(e=fr(mr,e,at(e)),F)st(e);else{F=!0;try{R(gr,e)}finally{F=!1,B()}}}function Er(e,t,n){"focus"===e?(wr(),mr=n,(pr=t).attachEvent("onpropertychange",xr)):"blur"===e&&wr()}function _r(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return yr(mr)}function Sr(e,t){if("click"===e)return yr(t)}function Cr(e,t){if("input"===e||"change"===e)return yr(t)}O&&(br=lt("input")&&(!document.documentMode||9<document.documentMode));var Tr={eventTypes:dr,_isInputEventSupported:br,extractEvents:function(e,t,n,r){var i=t?Mn(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var s=vr;else if(hr(i))if(br)s=Cr;else{s=_r;var a=Er}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(s=Sr);if(s&&(s=s(e,t)))return fr(s,n,r);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Oe(i,"number",i.value)}},Or=Gn.extend({view:null,detail:null}),Pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ar(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Pr[e])&&!!t[e]}function kr(){return Ar}var Mr=0,Nr=0,Lr=!1,Rr=!1,Ir=Or.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:kr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Mr;return Mr=e.screenX,Lr?"mousemove"===e.type?e.screenX-t:0:(Lr=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Nr;return Nr=e.screenY,Rr?"mousemove"===e.type?e.screenY-t:0:(Rr=!0,0)}}),Dr=Ir.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),jr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Fr={eventTypes:jr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,s="mouseout"===e||"pointerout"===e;if(o&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!s&&!o)return null;if(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,s?(s=t,null!==(t=(t=n.relatedTarget||n.toElement)?An(t):null)&&(t!==Je(t)||5!==t.tag&&6!==t.tag)&&(t=null)):s=null,s===t)return null;if("mouseout"===e||"mouseover"===e)var a=Ir,l=jr.mouseLeave,c=jr.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(a=Dr,l=jr.pointerLeave,c=jr.pointerEnter,u="pointer");if(e=null==s?o:Mn(s),o=null==t?o:Mn(t),(l=a.getPooled(l,s,n,r)).type=u+"leave",l.target=e,l.relatedTarget=o,(n=a.getPooled(c,t,n,r)).type=u+"enter",n.target=o,n.relatedTarget=e,u=t,(r=s)&&u)e:{for(c=u,s=0,e=a=r;e;e=Ln(e))s++;for(e=0,t=c;t;t=Ln(t))e++;for(;0<s-e;)a=Ln(a),s--;for(;0<e-s;)c=Ln(c),e--;for(;s--;){if(a===c||a===c.alternate)break e;a=Ln(a),c=Ln(c)}a=null}else a=null;for(c=a,a=[];r&&r!==c&&(null===(s=r.alternate)||s!==c);)a.push(r),r=Ln(r);for(r=[];u&&u!==c&&(null===(s=u.alternate)||s!==c);)r.push(u),u=Ln(u);for(u=0;u<a.length;u++)jn(a[u],"bubbled",l);for(u=r.length;0<u--;)jn(r[u],"captured",n);return 0==(64&i)?[l]:[l,n]}},zr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Br=Object.prototype.hasOwnProperty;function Ur(e,t){if(zr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Br.call(t,n[r])||!zr(e[n[r]],t[n[r]]))return!1;return!0}var Vr=O&&"documentMode"in document&&11>=document.documentMode,Hr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},qr=null,Wr=null,Gr=null,$r=!1;function Yr(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return $r||null==qr||qr!==cn(n)?null:(n="selectionStart"in(n=qr)&&pn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Gr&&Ur(Gr,n)?null:(Gr=n,(e=Gn.getPooled(Hr.select,Wr,e,t)).type="select",e.target=qr,zn(e),e))}var Xr={eventTypes:Hr,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=Ze(i),o=C.onSelect;for(var s=0;s<o.length;s++)if(!i.has(o[s])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?Mn(t):window,e){case"focus":(hr(i)||"true"===i.contentEditable)&&(qr=i,Wr=t,Gr=null);break;case"blur":Gr=Wr=qr=null;break;case"mousedown":$r=!0;break;case"contextmenu":case"mouseup":case"dragend":return $r=!1,Yr(n,r);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return Yr(n,r)}return null}},Kr=Gn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Zr=Gn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jr=Or.extend({relatedTarget:null});function Qr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var ei={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ti={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ni=Or.extend({key:function(e){if(e.key){var t=ei[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ti[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:kr,charCode:function(e){return"keypress"===e.type?Qr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ri=Ir.extend({dataTransfer:null}),ii=Or.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:kr}),oi=Gn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),si=Ir.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),ai={eventTypes:Dt,extractEvents:function(e,t,n,r){var i=jt.get(e);if(!i)return null;switch(e){case"keypress":if(0===Qr(n))return null;case"keydown":case"keyup":e=ni;break;case"blur":case"focus":e=Jr;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ri;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ii;break;case We:case Ge:case $e:e=Kr;break;case Ye:e=oi;break;case"scroll":e=Or;break;case"wheel":e=si;break;case"copy":case"cut":case"paste":e=Zr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Dr;break;default:e=Gn}return zn(t=e.getPooled(i,t,n,r)),t}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),p=Nn,m=kn,g=Mn,T({SimpleEventPlugin:ai,EnterLeaveEventPlugin:Fr,ChangeEventPlugin:Tr,SelectEventPlugin:Xr,BeforeInputEventPlugin:cr});var li=[],ci=-1;function ui(e){0>ci||(e.current=li[ci],li[ci]=null,ci--)}function hi(e,t){ci++,li[ci]=e.current,e.current=t}var di={},fi={current:di},pi={current:!1},mi=di;function gi(e,t){var n=e.type.contextTypes;if(!n)return di;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function yi(e){return null!=e.childContextTypes}function vi(){ui(pi),ui(fi)}function bi(e,t,n){if(fi.current!==di)throw Error(s(168));hi(fi,t),hi(pi,n)}function wi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(s(108,ge(t)||"Unknown",o));return i({},n,{},r)}function xi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||di,mi=fi.current,hi(fi,e),hi(pi,pi.current),!0}function Ei(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=wi(e,t,mi),r.__reactInternalMemoizedMergedChildContext=e,ui(pi),ui(fi),hi(fi,e)):ui(pi),hi(pi,n)}var _i=o.unstable_runWithPriority,Si=o.unstable_scheduleCallback,Ci=o.unstable_cancelCallback,Ti=o.unstable_requestPaint,Oi=o.unstable_now,Pi=o.unstable_getCurrentPriorityLevel,Ai=o.unstable_ImmediatePriority,ki=o.unstable_UserBlockingPriority,Mi=o.unstable_NormalPriority,Ni=o.unstable_LowPriority,Li=o.unstable_IdlePriority,Ri={},Ii=o.unstable_shouldYield,Di=void 0!==Ti?Ti:function(){},ji=null,Fi=null,zi=!1,Bi=Oi(),Ui=1e4>Bi?Oi:function(){return Oi()-Bi};function Vi(){switch(Pi()){case Ai:return 99;case ki:return 98;case Mi:return 97;case Ni:return 96;case Li:return 95;default:throw Error(s(332))}}function Hi(e){switch(e){case 99:return Ai;case 98:return ki;case 97:return Mi;case 96:return Ni;case 95:return Li;default:throw Error(s(332))}}function qi(e,t){return e=Hi(e),_i(e,t)}function Wi(e,t,n){return e=Hi(e),Si(e,t,n)}function Gi(e){return null===ji?(ji=[e],Fi=Si(Ai,Yi)):ji.push(e),Ri}function $i(){if(null!==Fi){var e=Fi;Fi=null,Ci(e)}Yi()}function Yi(){if(!zi&&null!==ji){zi=!0;var e=0;try{var t=ji;qi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),ji=null}catch(t){throw null!==ji&&(ji=ji.slice(e+1)),Si(Ai,$i),t}finally{zi=!1}}}function Xi(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function Ki(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Zi={current:null},Ji=null,Qi=null,eo=null;function to(){eo=Qi=Ji=null}function no(e){var t=Zi.current;ui(Zi),e.type._context._currentValue=t}function ro(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function io(e,t){Ji=e,eo=Qi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Ns=!0),e.firstContext=null)}function oo(e,t){if(eo!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(eo=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Qi){if(null===Ji)throw Error(s(308));Qi=t,Ji.dependencies={expirationTime:0,firstContext:t,responders:null}}else Qi=Qi.next=t;return e._currentValue}var so=!1;function ao(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function lo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function co(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function uo(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function ho(e,t){var n=e.alternate;null!==n&&lo(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function fo(e,t,n,r){var o=e.updateQueue;so=!1;var s=o.baseQueue,a=o.shared.pending;if(null!==a){if(null!==s){var l=s.next;s.next=a.next,a.next=l}s=a,o.shared.pending=null,null!==(l=e.alternate)&&null!==(l=l.updateQueue)&&(l.baseQueue=a)}if(null!==s){l=s.next;var c=o.baseState,u=0,h=null,d=null,f=null;if(null!==l)for(var p=l;;){if((a=p.expirationTime)<r){var m={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===f?(d=f=m,h=c):f=f.next=m,a>u&&(u=a)}else{null!==f&&(f=f.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null}),cl(a,p.suspenseConfig);e:{var g=e,y=p;switch(a=t,m=n,y.tag){case 1:if("function"==typeof(g=y.payload)){c=g.call(m,c,a);break e}c=g;break e;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null==(a="function"==typeof(g=y.payload)?g.call(m,c,a):g))break e;c=i({},c,a);break e;case 2:so=!0}}null!==p.callback&&(e.effectTag|=32,null===(a=o.effects)?o.effects=[p]:a.push(p))}if(null===(p=p.next)||p===l){if(null===(a=o.shared.pending))break;p=s.next=a.next,a.next=l,o.baseQueue=s=a,o.shared.pending=null}}null===f?h=c:f.next=d,o.baseState=h,o.baseQueue=f,ul(u),e.expirationTime=u,e.memoizedState=c}}function po(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!=typeof r)throw Error(s(191,r));r.call(i)}}}var mo=K.ReactCurrentBatchConfig,go=(new r.Component).refs;function yo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var vo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=Ka(),i=mo.suspense;(i=co(r=Za(r,e,i),i)).payload=t,null!=n&&(i.callback=n),uo(e,i),Ja(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=Ka(),i=mo.suspense;(i=co(r=Za(r,e,i),i)).tag=1,i.payload=t,null!=n&&(i.callback=n),uo(e,i),Ja(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=Ka(),r=mo.suspense;(r=co(n=Za(n,e,r),r)).tag=2,null!=t&&(r.callback=t),uo(e,r),Ja(e,n)}};function bo(e,t,n,r,i,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!(t.prototype&&t.prototype.isPureReactComponent&&Ur(n,r)&&Ur(i,o))}function wo(e,t,n){var r=!1,i=di,o=t.contextType;return"object"==typeof o&&null!==o?o=oo(o):(i=yi(t)?mi:fi.current,o=(r=null!=(r=t.contextTypes))?gi(e,i):di),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=vo,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function xo(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vo.enqueueReplaceState(t,t.state,null)}function Eo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=go,ao(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=oo(o):(o=yi(t)?mi:fi.current,i.context=gi(e,o)),fo(e,n,i,r),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(yo(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&vo.enqueueReplaceState(i,i.state,null),fo(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.effectTag|=4)}var _o=Array.isArray;function So(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===go&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Co(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function To(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=kl(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=So(e,t,n),r.return=e,r):((r=Ml(n.type,n.key,n.props,null,e.mode,r)).ref=So(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Rl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Nl(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=Ml(t.type,t.key,t.props,null,e.mode,n)).ref=So(e,null,t),n.return=e,n;case te:return(t=Rl(t,e.mode,n)).return=e,t}if(_o(t)||me(t))return(t=Nl(t,e.mode,n,null)).return=e,t;Co(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?h(e,t,n.props.children,r,i):c(e,t,n,r):null;case te:return n.key===i?u(e,t,n,r):null}if(_o(n)||me(n))return null!==i?null:h(e,t,n,r,null);Co(e,n)}return null}function p(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?h(t,e,r.props.children,i,r.key):c(t,e,r,i);case te:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(_o(r)||me(r))return h(t,e=e.get(n)||null,r,i,null);Co(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(i,h),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return c}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),c}function g(i,a,l,c){var u=me(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(i,m),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),u}return function(e,r,o,l){var c="object"==typeof o&&null!==o&&o.type===ne&&null===o.key;c&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case ee:e:{for(u=o.key,c=r;null!==c;){if(c.key===u){if(7===c.tag){if(o.type===ne){n(e,c.sibling),(r=i(c,o.props.children)).return=e,e=r;break e}}else if(c.elementType===o.type){n(e,c.sibling),(r=i(c,o.props)).ref=So(e,c,o),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}o.type===ne?((r=Nl(o.props.children,e.mode,l,o.key)).return=e,e=r):((l=Ml(o.type,o.key,o.props,null,e.mode,l)).ref=So(e,r,o),l.return=e,e=l)}return a(e);case te:e:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Rl(o,e.mode,l)).return=e,e=r}return a(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Ll(o,e.mode,l)).return=e,e=r),a(e);if(_o(o))return m(e,r,o,l);if(me(o))return g(e,r,o,l);if(u&&Co(e,o),void 0===o&&!c)switch(e.tag){case 1:case 0:throw e=e.type,Error(s(152,e.displayName||e.name||"Component"))}return n(e,r)}}var Oo=To(!0),Po=To(!1),Ao={},ko={current:Ao},Mo={current:Ao},No={current:Ao};function Lo(e){if(e===Ao)throw Error(s(174));return e}function Ro(e,t){switch(hi(No,t),hi(Mo,e),hi(ko,Ao),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ie(null,"");break;default:t=Ie(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ui(ko),hi(ko,t)}function Io(){ui(ko),ui(Mo),ui(No)}function Do(e){Lo(No.current);var t=Lo(ko.current),n=Ie(t,e.type);t!==n&&(hi(Mo,e),hi(ko,n))}function jo(e){Mo.current===e&&(ui(ko),ui(Mo))}var Fo={current:0};function zo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===mn||n.data===gn))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Bo(e,t){return{responder:e,props:t}}var Uo=K.ReactCurrentDispatcher,Vo=K.ReactCurrentBatchConfig,Ho=0,qo=null,Wo=null,Go=null,$o=!1;function Yo(){throw Error(s(321))}function Xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zr(e[n],t[n]))return!1;return!0}function Ko(e,t,n,r,i,o){if(Ho=o,qo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Uo.current=null===e||null===e.memoizedState?bs:ws,e=n(r,i),t.expirationTime===Ho){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(s(301));o+=1,Go=Wo=null,t.updateQueue=null,Uo.current=xs,e=n(r,i)}while(t.expirationTime===Ho)}if(Uo.current=vs,t=null!==Wo&&null!==Wo.next,Ho=0,Go=Wo=qo=null,$o=!1,t)throw Error(s(300));return e}function Zo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Go?qo.memoizedState=Go=e:Go=Go.next=e,Go}function Jo(){if(null===Wo){var e=qo.alternate;e=null!==e?e.memoizedState:null}else e=Wo.next;var t=null===Go?qo.memoizedState:Go.next;if(null!==t)Go=t,Wo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(Wo=e).memoizedState,baseState:Wo.baseState,baseQueue:Wo.baseQueue,queue:Wo.queue,next:null},null===Go?qo.memoizedState=Go=e:Go=Go.next=e}return Go}function Qo(e,t){return"function"==typeof t?t(e):t}function es(e){var t=Jo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=Wo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=a=o=null,c=i;do{var u=c.expirationTime;if(u<Ho){var h={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(a=l=h,o=r):l=l.next=h,u>qo.expirationTime&&(qo.expirationTime=u,ul(u))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),cl(u,c.suspenseConfig),r=c.eagerReducer===e?c.eagerState:e(r,c.action);c=c.next}while(null!==c&&c!==i);null===l?o=r:l.next=a,zr(r,t.memoizedState)||(Ns=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ts(e){var t=Jo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);zr(o,t.memoizedState)||(Ns=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ns(e){var t=Zo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:e}).dispatch=ys.bind(null,qo,e),[t.memoizedState,e]}function rs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=qo.updateQueue)?(t={lastEffect:null},qo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function is(){return Jo().memoizedState}function os(e,t,n,r){var i=Zo();qo.effectTag|=e,i.memoizedState=rs(1|t,n,void 0,void 0===r?null:r)}function ss(e,t,n,r){var i=Jo();r=void 0===r?null:r;var o=void 0;if(null!==Wo){var s=Wo.memoizedState;if(o=s.destroy,null!==r&&Xo(r,s.deps))return void rs(t,n,o,r)}qo.effectTag|=e,i.memoizedState=rs(1|t,n,o,r)}function as(e,t){return os(516,4,e,t)}function ls(e,t){return ss(516,4,e,t)}function cs(e,t){return ss(4,2,e,t)}function us(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function hs(e,t,n){return n=null!=n?n.concat([e]):null,ss(4,2,us.bind(null,t,e),n)}function ds(){}function fs(e,t){return Zo().memoizedState=[e,void 0===t?null:t],e}function ps(e,t){var n=Jo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Xo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ms(e,t){var n=Jo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Xo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function gs(e,t,n){var r=Vi();qi(98>r?98:r,(function(){e(!0)})),qi(97<r?97:r,(function(){var r=Vo.suspense;Vo.suspense=void 0===t?null:t;try{e(!1),n()}finally{Vo.suspense=r}}))}function ys(e,t,n){var r=Ka(),i=mo.suspense;i={expirationTime:r=Za(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===qo||null!==o&&o===qo)$o=!0,i.expirationTime=Ho,qo.expirationTime=Ho;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.eagerReducer=o,i.eagerState=a,zr(a,s))return}catch(e){}Ja(e,r)}}var vs={readContext:oo,useCallback:Yo,useContext:Yo,useEffect:Yo,useImperativeHandle:Yo,useLayoutEffect:Yo,useMemo:Yo,useReducer:Yo,useRef:Yo,useState:Yo,useDebugValue:Yo,useResponder:Yo,useDeferredValue:Yo,useTransition:Yo},bs={readContext:oo,useCallback:fs,useContext:oo,useEffect:as,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,os(4,2,us.bind(null,t,e),n)},useLayoutEffect:function(e,t){return os(4,2,e,t)},useMemo:function(e,t){var n=Zo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Zo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=ys.bind(null,qo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Zo().memoizedState=e},useState:ns,useDebugValue:ds,useResponder:Bo,useDeferredValue:function(e,t){var n=ns(e),r=n[0],i=n[1];return as((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ns(!1),n=t[0];return t=t[1],[fs(gs.bind(null,t,e),[t,e]),n]}},ws={readContext:oo,useCallback:ps,useContext:oo,useEffect:ls,useImperativeHandle:hs,useLayoutEffect:cs,useMemo:ms,useReducer:es,useRef:is,useState:function(){return es(Qo)},useDebugValue:ds,useResponder:Bo,useDeferredValue:function(e,t){var n=es(Qo),r=n[0],i=n[1];return ls((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=es(Qo),n=t[0];return t=t[1],[ps(gs.bind(null,t,e),[t,e]),n]}},xs={readContext:oo,useCallback:ps,useContext:oo,useEffect:ls,useImperativeHandle:hs,useLayoutEffect:cs,useMemo:ms,useReducer:ts,useRef:is,useState:function(){return ts(Qo)},useDebugValue:ds,useResponder:Bo,useDeferredValue:function(e,t){var n=ts(Qo),r=n[0],i=n[1];return ls((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ts(Qo),n=t[0];return t=t[1],[ps(gs.bind(null,t,e),[t,e]),n]}},Es=null,_s=null,Ss=!1;function Cs(e,t){var n=Pl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ts(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Os(e){if(Ss){var t=_s;if(t){var n=t;if(!Ts(e,t)){if(!(t=_n(n.nextSibling))||!Ts(e,t))return e.effectTag=-1025&e.effectTag|2,Ss=!1,void(Es=e);Cs(Es,n)}Es=e,_s=_n(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,Ss=!1,Es=e}}function Ps(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Es=e}function As(e){if(e!==Es)return!1;if(!Ss)return Ps(e),Ss=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!wn(t,e.memoizedProps))for(t=_s;t;)Cs(e,t),t=_n(t.nextSibling);if(Ps(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){_s=_n(e.nextSibling);break e}t--}else"$"!==n&&n!==gn&&n!==mn||t++}e=e.nextSibling}_s=null}}else _s=Es?_n(e.stateNode.nextSibling):null;return!0}function ks(){_s=Es=null,Ss=!1}var Ms=K.ReactCurrentOwner,Ns=!1;function Ls(e,t,n,r){t.child=null===e?Po(t,null,n,r):Oo(t,e.child,n,r)}function Rs(e,t,n,r,i){n=n.render;var o=t.ref;return io(t,i),r=Ko(e,t,n,r,o,i),null===e||Ns?(t.effectTag|=1,Ls(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ks(e,t,i))}function Is(e,t,n,r,i,o){if(null===e){var s=n.type;return"function"!=typeof s||Al(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ml(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ds(e,t,s,r,i,o))}return s=e.child,i<o&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:Ur)(i,r)&&e.ref===t.ref)?Ks(e,t,o):(t.effectTag|=1,(e=kl(s,r)).ref=t.ref,e.return=t,t.child=e)}function Ds(e,t,n,r,i,o){return null!==e&&Ur(e.memoizedProps,r)&&e.ref===t.ref&&(Ns=!1,i<o)?(t.expirationTime=e.expirationTime,Ks(e,t,o)):Fs(e,t,n,r,o)}function js(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Fs(e,t,n,r,i){var o=yi(n)?mi:fi.current;return o=gi(t,o),io(t,i),n=Ko(e,t,n,r,o,i),null===e||Ns?(t.effectTag|=1,Ls(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ks(e,t,i))}function zs(e,t,n,r,i){if(yi(n)){var o=!0;xi(t)}else o=!1;if(io(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),wo(t,n,r),Eo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;c="object"==typeof c&&null!==c?oo(c):gi(t,c=yi(n)?mi:fi.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&xo(t,s,r,c),so=!1;var d=t.memoizedState;s.state=d,fo(t,r,s,i),l=t.memoizedState,a!==r||d!==l||pi.current||so?("function"==typeof u&&(yo(t,n,u,r),l=t.memoizedState),(a=so||bo(t,n,a,r,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.effectTag|=4)):("function"==typeof s.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"==typeof s.componentDidMount&&(t.effectTag|=4),r=!1)}else s=t.stateNode,lo(e,t),a=t.memoizedProps,s.props=t.type===t.elementType?a:Ki(t.type,a),l=s.context,c="object"==typeof(c=n.contextType)&&null!==c?oo(c):gi(t,c=yi(n)?mi:fi.current),(h="function"==typeof(u=n.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&xo(t,s,r,c),so=!1,l=t.memoizedState,s.state=l,fo(t,r,s,i),d=t.memoizedState,a!==r||l!==d||pi.current||so?("function"==typeof u&&(yo(t,n,u,r),d=t.memoizedState),(u=so||bo(t,n,a,r,l,d,c))?(h||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,c)),"function"==typeof s.componentDidUpdate&&(t.effectTag|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=d),s.props=r,s.state=d,s.context=c,r=u):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),r=!1);return Bs(e,t,n,r,o,i)}function Bs(e,t,n,r,i,o){js(e,t);var s=0!=(64&t.effectTag);if(!r&&!s)return i&&Ei(t,n,!1),Ks(e,t,o);r=t.stateNode,Ms.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&s?(t.child=Oo(t,e.child,null,o),t.child=Oo(t,null,a,o)):Ls(e,t,a,o),t.memoizedState=r.state,i&&Ei(t,n,!0),t.child}function Us(e){var t=e.stateNode;t.pendingContext?bi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&bi(0,t.context,!1),Ro(e,t.containerInfo)}var Vs,Hs,qs,Ws={dehydrated:null,retryTime:0};function Gs(e,t,n){var r,i=t.mode,o=t.pendingProps,s=Fo.current,a=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&s)&&(null===e||null!==e.memoizedState)),r?(a=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(s|=1),hi(Fo,1&s),null===e){if(void 0!==o.fallback&&Os(t),a){if(a=o.fallback,(o=Nl(null,i,0,null)).return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Nl(a,i,n,null)).return=t,o.sibling=n,t.memoizedState=Ws,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=Po(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,a){if(o=o.fallback,(n=kl(e,e.pendingProps)).return=t,0==(2&t.mode)&&(a=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(i=kl(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=Ws,t.child=n,i}return n=Oo(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,a){if(a=o.fallback,(o=Nl(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Nl(a,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Ws,t.child=o,n}return t.memoizedState=null,t.child=Oo(t,e,o.children,n)}function $s(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),ro(e.return,t)}function Ys(e,t,n,r,i,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailExpiration=0,s.tailMode=i,s.lastEffect=o)}function Xs(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ls(e,t,r.children,n),0!=(2&(r=Fo.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$s(e,n);else if(19===e.tag)$s(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(hi(Fo,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===zo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ys(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===zo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ys(t,!0,n,null,o,t.lastEffect);break;case"together":Ys(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ks(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&ul(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=kl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=kl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Zs(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Js(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return yi(t.type)&&vi(),null;case 3:return Io(),ui(pi),ui(fi),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!As(t)||(t.effectTag|=4),null;case 5:jo(t),n=Lo(No.current);var o=t.type;if(null!==e&&null!=t.stateNode)Hs(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Lo(ko.current),As(t)){r=t.stateNode,o=t.type;var a=t.memoizedProps;switch(r[Tn]=t,r[On]=a,o){case"iframe":case"object":case"embed":Gt("load",r);break;case"video":case"audio":for(e=0;e<Xe.length;e++)Gt(Xe[e],r);break;case"source":Gt("error",r);break;case"img":case"image":case"link":Gt("error",r),Gt("load",r);break;case"form":Gt("reset",r),Gt("submit",r);break;case"details":Gt("toggle",r);break;case"input":_e(r,a),Gt("invalid",r),an(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Gt("invalid",r),an(n,"onChange");break;case"textarea":Me(r,a),Gt("invalid",r),an(n,"onChange")}for(var l in rn(o,a),e=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?r.textContent!==c&&(e=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(e=["children",""+c]):S.hasOwnProperty(l)&&null!=c&&an(n,l)}switch(o){case"input":we(r),Te(r,a,!0);break;case"textarea":we(r),Le(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=ln)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,e===sn&&(e=Re(o)),e===sn?"script"===o?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(o,{is:r.is}):(e=l.createElement(o),"select"===o&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,o),e[Tn]=t,e[On]=r,Vs(e,t),t.stateNode=e,l=on(o,r),o){case"iframe":case"object":case"embed":Gt("load",e),c=r;break;case"video":case"audio":for(c=0;c<Xe.length;c++)Gt(Xe[c],e);c=r;break;case"source":Gt("error",e),c=r;break;case"img":case"image":case"link":Gt("error",e),Gt("load",e),c=r;break;case"form":Gt("reset",e),Gt("submit",e),c=r;break;case"details":Gt("toggle",e),c=r;break;case"input":_e(e,r),c=Ee(e,r),Gt("invalid",e),an(n,"onChange");break;case"option":c=Pe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},c=i({},r,{value:void 0}),Gt("invalid",e),an(n,"onChange");break;case"textarea":Me(e,r),c=ke(e,r),Gt("invalid",e),an(n,"onChange");break;default:c=r}rn(o,c);var u=c;for(a in u)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?tn(e,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&Fe(e,h):"children"===a?"string"==typeof h?("textarea"!==o||""!==h)&&ze(e,h):"number"==typeof h&&ze(e,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(S.hasOwnProperty(a)?null!=h&&an(n,a):null!=h&&Z(e,a,h,l))}switch(o){case"input":we(e),Te(e,r,!1);break;case"textarea":we(e),Le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ve(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Ae(e,!!r.multiple,n,!1):null!=r.defaultValue&&Ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof c.onClick&&(e.onclick=ln)}bn(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)qs(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));n=Lo(No.current),Lo(ko.current),As(t)?(n=t.stateNode,r=t.memoizedProps,n[Tn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Tn]=t,t.stateNode=n)}return null;case 13:return ui(Fo),r=t.memoizedState,0!=(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&As(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(a=t.firstEffect)?(t.firstEffect=o,o.nextEffect=a):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&Fo.current)?Ma===Sa&&(Ma=Ca):(Ma!==Sa&&Ma!==Ca||(Ma=Ta),0!==Da&&null!==Pa&&(jl(Pa,ka),Fl(Pa,Da)))),(n||r)&&(t.effectTag|=4),null);case 4:return Io(),null;case 10:return no(t),null;case 19:if(ui(Fo),null===(r=t.memoizedState))return null;if(o=0!=(64&t.effectTag),null===(a=r.rendering)){if(o)Zs(r,!1);else if(Ma!==Sa||null!==e&&0!=(64&e.effectTag))for(a=t.child;null!==a;){if(null!==(e=zo(a))){for(t.effectTag|=64,Zs(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)a=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=a,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,a=e.dependencies,o.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),r=r.sibling;return hi(Fo,1&Fo.current|2),t.child}a=a.sibling}}else{if(!o)if(null!==(e=zo(a))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),Zs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ui()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,Zs(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=r.last)?n.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Ui()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ui(),n.sibling=null,t=Fo.current,hi(Fo,o?1&t|2:1&t),n):null}throw Error(s(156,t.tag))}function Qs(e){switch(e.tag){case 1:yi(e.type)&&vi();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(Io(),ui(pi),ui(fi),0!=(64&(t=e.effectTag)))throw Error(s(285));return e.effectTag=-4097&t|64,e;case 5:return jo(e),null;case 13:return ui(Fo),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return ui(Fo),null;case 4:return Io(),null;case 10:return no(e),null;default:return null}}function ea(e,t){return{value:e,source:t,stack:ye(t)}}Vs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Hs=function(e,t,n,r,o){var s=e.memoizedProps;if(s!==r){var a,l,c=t.stateNode;switch(Lo(ko.current),e=null,n){case"input":s=Ee(c,s),r=Ee(c,r),e=[];break;case"option":s=Pe(c,s),r=Pe(c,r),e=[];break;case"select":s=i({},s,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":s=ke(c,s),r=ke(c,r),e=[];break;default:"function"!=typeof s.onClick&&"function"==typeof r.onClick&&(c.onclick=ln)}for(a in rn(n,r),n=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(l in c=s[a])c.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(S.hasOwnProperty(a)?e||(e=[]):(e=e||[]).push(a,null));for(a in r){var u=r[a];if(c=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&u!==c&&(null!=u||null!=c))if("style"===a)if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(e||(e=[]),e.push(a,n)),n=u;else"dangerouslySetInnerHTML"===a?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(e=e||[]).push(a,u)):"children"===a?c===u||"string"!=typeof u&&"number"!=typeof u||(e=e||[]).push(a,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(S.hasOwnProperty(a)?(null!=u&&an(o,a),e||c===u||(e=[])):(e=e||[]).push(a,u))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},qs=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var ta="function"==typeof WeakSet?WeakSet:Set;function na(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=ye(n)),null!==n&&ge(n.type),t=t.value,null!==e&&1===e.tag&&ge(e.type);try{console.error(t)}catch(e){setTimeout((function(){throw e}))}}function ra(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){El(e,t)}else t.current=null}function ia(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Ki(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(s(163))}function oa(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function sa(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function aa(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void sa(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:Ki(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&po(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}po(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&bn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&It(n)))))}throw Error(s(163))}function la(e,t,n){switch("function"==typeof Tl&&Tl(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;qi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(e){El(i,e)}}e=e.next}while(e!==r)}))}break;case 1:ra(t),"function"==typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){El(e,t)}}(t,n);break;case 5:ra(t);break;case 4:pa(e,t,n)}}function ca(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&ca(t)}function ua(e){return 5===e.tag||3===e.tag||4===e.tag}function ha(e){e:{for(var t=e.return;null!==t;){if(ua(t)){var n=t;break e}t=t.return}throw Error(s(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.effectTag&&(ze(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ua(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?da(e,n,t):fa(e,n,t)}function da(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=ln));else if(4!==r&&null!==(e=e.child))for(da(e,t,n),e=e.sibling;null!==e;)da(e,t,n),e=e.sibling}function fa(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(fa(e,t,n),e=e.sibling;null!==e;)fa(e,t,n),e=e.sibling}function pa(e,t,n){for(var r,i,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag){e:for(var l=e,c=o,u=n,h=c;;)if(la(l,h,u),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===c)break e;for(;null===h.sibling;){if(null===h.return||h.return===c)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}i?(l=r,c=o.stateNode,8===l.nodeType?l.parentNode.removeChild(c):l.removeChild(c)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(la(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function ma(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void oa(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[On]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Se(n,r),on(e,i),t=on(e,r),i=0;i<o.length;i+=2){var a=o[i],l=o[i+1];"style"===a?tn(n,l):"dangerouslySetInnerHTML"===a?Fe(n,l):"children"===a?ze(n,l):Z(n,a,l,t)}switch(e){case"input":Ce(n,r);break;case"textarea":Ne(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Ae(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Ae(n,!!r.multiple,r.defaultValue,!0):Ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,It(t.containerInfo)));case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Fa=Ui()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=null!=(i=e.memoizedProps.style)&&i.hasOwnProperty("display")?i.display:null,o.style.display=en("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void ga(t);case 19:return void ga(t)}throw Error(s(163))}function ga(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ta),t.forEach((function(t){var r=Sl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var ya="function"==typeof WeakMap?WeakMap:Map;function va(e,t,n){(n=co(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ba||(Ba=!0,Ua=r),na(e,t)},n}function ba(e,t,n){(n=co(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return na(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Va?Va=new Set([this]):Va.add(this),na(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var wa,xa=Math.ceil,Ea=K.ReactCurrentDispatcher,_a=K.ReactCurrentOwner,Sa=0,Ca=3,Ta=4,Oa=0,Pa=null,Aa=null,ka=0,Ma=Sa,Na=null,La=1073741823,Ra=1073741823,Ia=null,Da=0,ja=!1,Fa=0,za=null,Ba=!1,Ua=null,Va=null,Ha=!1,qa=null,Wa=90,Ga=null,$a=0,Ya=null,Xa=0;function Ka(){return 0!=(48&Oa)?1073741821-(Ui()/10|0):0!==Xa?Xa:Xa=1073741821-(Ui()/10|0)}function Za(e,t,n){if(0==(2&(t=t.mode)))return 1073741823;var r=Vi();if(0==(4&t))return 99===r?1073741823:1073741822;if(0!=(16&Oa))return ka;if(null!==n)e=Xi(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=Xi(e,150,100);break;case 97:case 96:e=Xi(e,5e3,250);break;case 95:e=2;break;default:throw Error(s(326))}return null!==Pa&&e===ka&&--e,e}function Ja(e,t){if(50<$a)throw $a=0,Ya=null,Error(s(185));if(null!==(e=Qa(e,t))){var n=Vi();1073741823===t?0!=(8&Oa)&&0==(48&Oa)?rl(e):(tl(e),0===Oa&&$i()):tl(e),0==(4&Oa)||98!==n&&99!==n||(null===Ga?Ga=new Map([[e,t]]):(void 0===(n=Ga.get(e))||n>t)&&Ga.set(e,t))}}function Qa(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Pa===i&&(ul(t),Ma===Ta&&jl(i,ka)),Fl(i,t)),i}function el(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Dl(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function tl(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Gi(rl.bind(null,e));else{var t=el(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=Ka();if(r=1073741823===t?99:1===t||2===t?95:0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Ri&&Ci(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Gi(rl.bind(null,e)):Wi(r,nl.bind(null,e),{timeout:10*(1073741821-t)-Ui()}),e.callbackNode=t}}}function nl(e,t){if(Xa=0,t)return zl(e,t=Ka()),tl(e),null;var n=el(e);if(0!==n){if(t=e.callbackNode,0!=(48&Oa))throw Error(s(327));if(bl(),e===Pa&&n===ka||sl(e,n),null!==Aa){var r=Oa;Oa|=16;for(var i=ll();;)try{dl();break}catch(t){al(e,t)}if(to(),Oa=r,Ea.current=i,1===Ma)throw t=Na,sl(e,n),jl(e,n),tl(e),t;if(null===Aa)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=Ma,Pa=null,r){case Sa:case 1:throw Error(s(345));case 2:zl(e,2<n?2:n);break;case Ca:if(jl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=ml(i)),1073741823===La&&10<(i=Fa+500-Ui())){if(ja){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,sl(e,n);break}}if(0!==(o=el(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=xn(gl.bind(null,e),i);break}gl(e);break;case Ta:if(jl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=ml(i)),ja&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,sl(e,n);break}if(0!==(i=el(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==Ra?r=10*(1073741821-Ra)-Ui():1073741823===La?r=0:(r=10*(1073741821-La)-5e3,0>(r=(i=Ui())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xa(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=xn(gl.bind(null,e),r);break}gl(e);break;case 5:if(1073741823!==La&&null!==Ia){o=La;var a=Ia;if(0>=(r=0|a.busyMinDurationMs)?r=0:(i=0|a.busyDelayMs,r=(o=Ui()-(10*(1073741821-o)-(0|a.timeoutMs||5e3)))<=i?0:i+r-o),10<r){jl(e,n),e.timeoutHandle=xn(gl.bind(null,e),r);break}}gl(e);break;default:throw Error(s(329))}if(tl(e),e.callbackNode===t)return nl.bind(null,e)}}return null}function rl(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,0!=(48&Oa))throw Error(s(327));if(bl(),e===Pa&&t===ka||sl(e,t),null!==Aa){var n=Oa;Oa|=16;for(var r=ll();;)try{hl();break}catch(t){al(e,t)}if(to(),Oa=n,Ea.current=r,1===Ma)throw n=Na,sl(e,t),jl(e,t),tl(e),n;if(null!==Aa)throw Error(s(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Pa=null,gl(e),tl(e)}return null}function il(e,t){var n=Oa;Oa|=1;try{return e(t)}finally{0===(Oa=n)&&$i()}}function ol(e,t){var n=Oa;Oa&=-2,Oa|=8;try{return e(t)}finally{0===(Oa=n)&&$i()}}function sl(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,En(n)),null!==Aa)for(n=Aa.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&vi();break;case 3:Io(),ui(pi),ui(fi);break;case 5:jo(r);break;case 4:Io();break;case 13:case 19:ui(Fo);break;case 10:no(r)}n=n.return}Pa=e,Aa=kl(e.current,null),ka=t,Ma=Sa,Na=null,Ra=La=1073741823,Ia=null,Da=0,ja=!1}function al(e,t){for(;;){try{if(to(),Uo.current=vs,$o)for(var n=qo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Ho=0,Go=Wo=qo=null,$o=!1,null===Aa||null===Aa.return)return Ma=1,Na=t,Aa=null;e:{var i=e,o=Aa.return,s=Aa,a=t;if(t=ka,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var l=a;if(0==(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.expirationTime=c.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var u=0!=(1&Fo.current),h=o;do{var d;if(d=13===h.tag){var f=h.memoizedState;if(null!==f)d=null!==f.dehydrated;else{var p=h.memoizedProps;d=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!u)}}if(d){var m=h.updateQueue;if(null===m){var g=new Set;g.add(l),h.updateQueue=g}else m.add(l);if(0==(2&h.mode)){if(h.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=co(1073741823,null);y.tag=2,uo(s,y)}s.expirationTime=1073741823;break e}a=void 0,s=t;var v=i.pingCache;if(null===v?(v=i.pingCache=new ya,a=new Set,v.set(l,a)):void 0===(a=v.get(l))&&(a=new Set,v.set(l,a)),!a.has(s)){a.add(s);var b=_l.bind(null,i,l,s);l.then(b,b)}h.effectTag|=4096,h.expirationTime=t;break e}h=h.return}while(null!==h);a=Error((ge(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ye(s))}5!==Ma&&(Ma=2),a=ea(a,s),h=o;do{switch(h.tag){case 3:l=a,h.effectTag|=4096,h.expirationTime=t,ho(h,va(h,l,t));break e;case 1:l=a;var w=h.type,x=h.stateNode;if(0==(64&h.effectTag)&&("function"==typeof w.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===Va||!Va.has(x)))){h.effectTag|=4096,h.expirationTime=t,ho(h,ba(h,l,t));break e}}h=h.return}while(null!==h)}Aa=pl(Aa)}catch(e){t=e;continue}break}}function ll(){var e=Ea.current;return Ea.current=vs,null===e?vs:e}function cl(e,t){e<La&&2<e&&(La=e),null!==t&&e<Ra&&2<e&&(Ra=e,Ia=t)}function ul(e){e>Da&&(Da=e)}function hl(){for(;null!==Aa;)Aa=fl(Aa)}function dl(){for(;null!==Aa&&!Ii();)Aa=fl(Aa)}function fl(e){var t=wa(e.alternate,e,ka);return e.memoizedProps=e.pendingProps,null===t&&(t=pl(e)),_a.current=null,t}function pl(e){Aa=e;do{var t=Aa.alternate;if(e=Aa.return,0==(2048&Aa.effectTag)){if(t=Js(t,Aa,ka),1===ka||1!==Aa.childExpirationTime){for(var n=0,r=Aa.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}Aa.childExpirationTime=n}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=Aa.firstEffect),null!==Aa.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=Aa.firstEffect),e.lastEffect=Aa.lastEffect),1<Aa.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=Aa:e.firstEffect=Aa,e.lastEffect=Aa))}else{if(null!==(t=Qs(Aa)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=Aa.sibling))return t;Aa=e}while(null!==Aa);return Ma===Sa&&(Ma=5),null}function ml(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function gl(e){var t=Vi();return qi(99,yl.bind(null,e,t)),null}function yl(e,t){do{bl()}while(null!==qa);if(0!=(48&Oa))throw Error(s(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=ml(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Pa&&(Aa=Pa=null,ka=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Oa;Oa|=32,_a.current=null,yn=Wt;var a=fn();if(pn(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{var c=(l=(l=a.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(c&&0!==c.rangeCount){l=c.anchorNode;var u=c.anchorOffset,h=c.focusNode;c=c.focusOffset;try{l.nodeType,h.nodeType}catch(e){l=null;break e}var d=0,f=-1,p=-1,m=0,g=0,y=a,v=null;t:for(;;){for(var b;y!==l||0!==u&&3!==y.nodeType||(f=d+u),y!==h||0!==c&&3!==y.nodeType||(p=d+c),3===y.nodeType&&(d+=y.nodeValue.length),null!==(b=y.firstChild);)v=y,y=b;for(;;){if(y===a)break t;if(v===l&&++m===u&&(f=d),v===h&&++g===c&&(p=d),null!==(b=y.nextSibling))break;v=(y=v).parentNode}y=b}l=-1===f||-1===p?null:{start:f,end:p}}else l=null}l=l||{start:0,end:0}}else l=null;vn={activeElementDetached:null,focusedElem:a,selectionRange:l},Wt=!1,za=i;do{try{vl()}catch(e){if(null===za)throw Error(s(330));El(za,e),za=za.nextEffect}}while(null!==za);za=i;do{try{for(a=e,l=t;null!==za;){var w=za.effectTag;if(16&w&&ze(za.stateNode,""),128&w){var x=za.alternate;if(null!==x){var E=x.ref;null!==E&&("function"==typeof E?E(null):E.current=null)}}switch(1038&w){case 2:ha(za),za.effectTag&=-3;break;case 6:ha(za),za.effectTag&=-3,ma(za.alternate,za);break;case 1024:za.effectTag&=-1025;break;case 1028:za.effectTag&=-1025,ma(za.alternate,za);break;case 4:ma(za.alternate,za);break;case 8:pa(a,u=za,l),ca(u)}za=za.nextEffect}}catch(e){if(null===za)throw Error(s(330));El(za,e),za=za.nextEffect}}while(null!==za);if(E=vn,x=fn(),w=E.focusedElem,l=E.selectionRange,x!==w&&w&&w.ownerDocument&&dn(w.ownerDocument.documentElement,w)){null!==l&&pn(w)&&(x=l.start,void 0===(E=l.end)&&(E=x),"selectionStart"in w?(w.selectionStart=x,w.selectionEnd=Math.min(E,w.value.length)):(E=(x=w.ownerDocument||document)&&x.defaultView||window).getSelection&&(E=E.getSelection(),u=w.textContent.length,a=Math.min(l.start,u),l=void 0===l.end?a:Math.min(l.end,u),!E.extend&&a>l&&(u=l,l=a,a=u),u=hn(w,a),h=hn(w,l),u&&h&&(1!==E.rangeCount||E.anchorNode!==u.node||E.anchorOffset!==u.offset||E.focusNode!==h.node||E.focusOffset!==h.offset)&&((x=x.createRange()).setStart(u.node,u.offset),E.removeAllRanges(),a>l?(E.addRange(x),E.extend(h.node,h.offset)):(x.setEnd(h.node,h.offset),E.addRange(x))))),x=[];for(E=w;E=E.parentNode;)1===E.nodeType&&x.push({element:E,left:E.scrollLeft,top:E.scrollTop});for("function"==typeof w.focus&&w.focus(),w=0;w<x.length;w++)(E=x[w]).element.scrollLeft=E.left,E.element.scrollTop=E.top}Wt=!!yn,vn=yn=null,e.current=n,za=i;do{try{for(w=e;null!==za;){var _=za.effectTag;if(36&_&&aa(w,za.alternate,za),128&_){x=void 0;var S=za.ref;if(null!==S){var C=za.stateNode;za.tag,x=C,"function"==typeof S?S(x):S.current=x}}za=za.nextEffect}}catch(e){if(null===za)throw Error(s(330));El(za,e),za=za.nextEffect}}while(null!==za);za=null,Di(),Oa=o}else e.current=n;if(Ha)Ha=!1,qa=e,Wa=t;else for(za=i;null!==za;)t=za.nextEffect,za.nextEffect=null,za=t;if(0===(t=e.firstPendingTime)&&(Va=null),1073741823===t?e===Ya?$a++:($a=0,Ya=e):$a=0,"function"==typeof Cl&&Cl(n.stateNode,r),tl(e),Ba)throw Ba=!1,e=Ua,Ua=null,e;return 0!=(8&Oa)||$i(),null}function vl(){for(;null!==za;){var e=za.effectTag;0!=(256&e)&&ia(za.alternate,za),0==(512&e)||Ha||(Ha=!0,Wi(97,(function(){return bl(),null}))),za=za.nextEffect}}function bl(){if(90!==Wa){var e=97<Wa?97:Wa;return Wa=90,qi(e,wl)}}function wl(){if(null===qa)return!1;var e=qa;if(qa=null,0!=(48&Oa))throw Error(s(331));var t=Oa;for(Oa|=32,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:oa(5,n),sa(5,n)}}catch(t){if(null===e)throw Error(s(330));El(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return Oa=t,$i(),!0}function xl(e,t,n){uo(e,t=va(e,t=ea(n,t),1073741823)),null!==(e=Qa(e,1073741823))&&tl(e)}function El(e,t){if(3===e.tag)xl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){xl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Va||!Va.has(r))){uo(n,e=ba(n,e=ea(t,e),1073741823)),null!==(n=Qa(n,1073741823))&&tl(n);break}}n=n.return}}function _l(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),Pa===e&&ka===n?Ma===Ta||Ma===Ca&&1073741823===La&&Ui()-Fa<500?sl(e,ka):ja=!0:Dl(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,tl(e)))}function Sl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0==(t=0)&&(t=Za(t=Ka(),e,null)),null!==(e=Qa(e,t))&&tl(e)}wa=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||pi.current)Ns=!0;else{if(r<n){switch(Ns=!1,t.tag){case 3:Us(t),ks();break;case 5:if(Do(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:yi(t.type)&&xi(t);break;case 4:Ro(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,hi(Zi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?Gs(e,t,n):(hi(Fo,1&Fo.current),null!==(t=Ks(e,t,n))?t.sibling:null);hi(Fo,1&Fo.current);break;case 19:if(r=t.childExpirationTime>=n,0!=(64&e.effectTag)){if(r)return Xs(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),hi(Fo,Fo.current),!r)return null}return Ks(e,t,n)}Ns=!1}}else Ns=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=gi(t,fi.current),io(t,n),i=Ko(null,t,r,e,i,n),t.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,yi(r)){var o=!0;xi(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ao(t);var a=r.getDerivedStateFromProps;"function"==typeof a&&yo(t,r,a,e),i.updater=vo,t.stateNode=i,i._reactInternalFiber=t,Eo(t,r,e,n),t=Bs(null,t,r,!0,o,n)}else t.tag=0,Ls(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"==typeof e)return Al(e)?1:0;if(null!=e){if((e=e.$$typeof)===le)return 11;if(e===he)return 14}return 2}(i),e=Ki(i,e),o){case 0:t=Fs(null,t,i,e,n);break e;case 1:t=zs(null,t,i,e,n);break e;case 11:t=Rs(null,t,i,e,n);break e;case 14:t=Is(null,t,i,Ki(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Fs(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 1:return r=t.type,i=t.pendingProps,zs(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 3:if(Us(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,lo(e,t),fo(t,r,null,n),(r=t.memoizedState.element)===i)ks(),t=Ks(e,t,n);else{if((i=t.stateNode.hydrate)&&(_s=_n(t.stateNode.containerInfo.firstChild),Es=t,i=Ss=!0),i)for(n=Po(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Ls(e,t,r,n),ks();t=t.child}return t;case 5:return Do(t),null===e&&Os(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,wn(r,i)?a=null:null!==o&&wn(r,o)&&(t.effectTag|=16),js(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Ls(e,t,a,n),t=t.child),t;case 6:return null===e&&Os(t),null;case 13:return Gs(e,t,n);case 4:return Ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Oo(t,null,r,n):Ls(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Rs(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 7:return Ls(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ls(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value;var l=t.type._context;if(hi(Zi,l._currentValue),l._currentValue=o,null!==a)if(l=a.value,0==(o=zr(l,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(a.children===i.children&&!pi.current){t=Ks(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){a=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&0!=(u.observedBits&o)){1===l.tag&&((u=co(n,null)).tag=2,uo(l,u)),l.expirationTime<n&&(l.expirationTime=n),null!==(u=l.alternate)&&u.expirationTime<n&&(u.expirationTime=n),ro(l.return,n),c.expirationTime<n&&(c.expirationTime=n);break}u=u.next}}else a=10===l.tag&&l.type===t.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===t){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Ls(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,io(t,n),r=r(i=oo(i,o.unstable_observedBits)),t.effectTag|=1,Ls(e,t,r,n),t.child;case 14:return o=Ki(i=t.type,t.pendingProps),Is(e,t,i,o=Ki(i.type,o),r,n);case 15:return Ds(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ki(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,yi(r)?(e=!0,xi(t)):e=!1,io(t,n),wo(t,r,i),Eo(t,r,i,n),Bs(null,t,r,!0,e,n);case 19:return Xs(e,t,n)}throw Error(s(156,t.tag))};var Cl=null,Tl=null;function Ol(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Pl(e,t,n,r){return new Ol(e,t,n,r)}function Al(e){return!(!(e=e.prototype)||!e.isReactComponent)}function kl(e,t){var n=e.alternate;return null===n?((n=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,r,i,o){var a=2;if(r=e,"function"==typeof e)Al(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case ne:return Nl(n.children,i,o,t);case ae:a=8,i|=7;break;case re:a=8,i|=1;break;case ie:return(e=Pl(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case ce:return(e=Pl(13,n,t,i)).type=ce,e.elementType=ce,e.expirationTime=o,e;case ue:return(e=Pl(19,n,t,i)).elementType=ue,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case oe:a=10;break e;case se:a=9;break e;case le:a=11;break e;case he:a=14;break e;case de:a=16,r=null;break e;case fe:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pl(a,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Nl(e,t,n,r){return(e=Pl(7,e,r,t)).expirationTime=n,e}function Ll(e,t,n){return(e=Pl(6,e,null,t)).expirationTime=n,e}function Rl(e,t,n){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Il(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Dl(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function jl(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Fl(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function zl(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function Bl(e,t,n,r){var i=t.current,o=Ka(),a=mo.suspense;o=Za(o,i,a);e:if(n){t:{if(Je(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(yi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var c=n.type;if(yi(c)){n=wi(n,c,l);break e}}n=l}else n=di;return null===t.context?t.context=n:t.pendingContext=n,(t=co(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),uo(i,t),Ja(i,o),o}function Ul(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vl(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Hl(e,t){Vl(e,t),(e=e.alternate)&&Vl(e,t)}function ql(e,t,n){var r=new Il(e,t,n=null!=n&&!0===n.hydrate),i=Pl(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,ao(i),e[Pn]=r.current,n&&0!==t&&function(e,t){var n=Ze(t);Ct.forEach((function(e){ft(e,t,n)})),Tt.forEach((function(e){ft(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Wl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Gl(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"==typeof i){var a=i;i=function(){var e=Ul(s);a.call(e)}}Bl(t,s,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new ql(e,0,t?{hydrate:!0}:void 0)}(n,r),s=o._internalRoot,"function"==typeof i){var l=i;i=function(){var e=Ul(s);l.call(e)}}ol((function(){Bl(t,s,e,i)}))}return Ul(s)}function $l(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Yl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Wl(t))throw Error(s(200));return $l(e,t,null,n)}ql.prototype.render=function(e){Bl(e,this._internalRoot,null,null)},ql.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Bl(null,e,null,(function(){t[Pn]=null}))},pt=function(e){if(13===e.tag){var t=Xi(Ka(),150,100);Ja(e,t),Hl(e,t)}},mt=function(e){13===e.tag&&(Ja(e,3),Hl(e,3))},gt=function(e){if(13===e.tag){var t=Ka();Ja(e,t=Za(t,e,null)),Hl(e,t)}},P=function(e,t,n){switch(t){case"input":if(Ce(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Nn(r);if(!i)throw Error(s(90));xe(r),Ce(r,i)}}}break;case"textarea":Ne(e,n);break;case"select":null!=(t=n.value)&&Ae(e,!!n.multiple,t,!1)}},R=il,I=function(e,t,n,r,i){var o=Oa;Oa|=4;try{return qi(98,e.bind(null,t,n,r,i))}finally{0===(Oa=o)&&$i()}},D=function(){0==(49&Oa)&&(function(){if(null!==Ga){var e=Ga;Ga=null,e.forEach((function(e,t){zl(t,e),tl(t)})),$i()}}(),bl())},j=function(e,t){var n=Oa;Oa|=2;try{return e(t)}finally{0===(Oa=n)&&$i()}};var Xl={Events:[kn,Mn,Nn,T,_,zn,function(e){rt(e,Fn)},N,L,Kt,st,bl,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;!function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Cl=function(e){try{t.onCommitFiberRoot(n,e,void 0,64==(64&e.current.effectTag))}catch(e){}},Tl=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}}(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:K.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=tt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:An,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xl,t.createPortal=Yl,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return null===(e=tt(t))?null:e.stateNode},t.flushSync=function(e,t){if(0!=(48&Oa))throw Error(s(187));var n=Oa;Oa|=1;try{return qi(99,e.bind(null,t))}finally{Oa=n,$i()}},t.hydrate=function(e,t,n){if(!Wl(t))throw Error(s(200));return Gl(null,e,t,!0,n)},t.render=function(e,t,n){if(!Wl(t))throw Error(s(200));return Gl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Wl(e))throw Error(s(40));return!!e._reactRootContainer&&(ol((function(){Gl(null,null,e,!1,(function(){e._reactRootContainer=null,e[Pn]=null}))})),!0)},t.unstable_batchedUpdates=il,t.unstable_createPortal=function(e,t){return Yl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Wl(n))throw Error(s(200));if(null==e||void 0===e._reactInternalFiber)throw Error(s(38));return Gl(e,t,n,!1,r)},t.version="16.14.0"},1542:function(e,t,n){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(3577)},8702:function(e,t){"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case h:case o:case a:case s:case f:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case i:return t}}}function E(e){return x(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=o,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return E(e)||x(e)===u},t.isConcurrentMode=E,t.isContextConsumer=function(e){return x(e)===c},t.isContextProvider=function(e){return x(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return x(e)===d},t.isFragment=function(e){return x(e)===o},t.isLazy=function(e){return x(e)===g},t.isMemo=function(e){return x(e)===m},t.isPortal=function(e){return x(e)===i},t.isProfiler=function(e){return x(e)===a},t.isStrictMode=function(e){return x(e)===s},t.isSuspense=function(e){return x(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===h||e===a||e===s||e===f||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===v||e.$$typeof===b||e.$$typeof===w||e.$$typeof===y)},t.typeOf=x},9185:function(e,t,n){"use strict";e.exports=n(8702)},1535:function(e,t,n){"use strict";var r=n(2525),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,s=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}function x(){}function E(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(y(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=w.prototype;var _=E.prototype=new x;_.constructor=E,r(_,w.prototype),_.isPureReactComponent=!0;var S={current:null},C=Object.prototype.hasOwnProperty,T={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var r,i={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,r)&&!T.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:o,type:e,key:s,ref:a,props:i,_owner:S.current}}function P(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var A=/\/+/g,k=[];function M(e,t,n,r){if(k.length){var i=k.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function N(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>k.length&&k.push(e)}function L(e,t,n,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var a=!1;if(null===e)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case o:case s:a=!0}}if(a)return n(r,e,""===t?"."+I(e,0):t),1;if(a=0,t=""===t?".":t+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=t+I(i=e[l],l);a+=L(i,c,n,r)}else if("function"==typeof(c=null===e||"object"!=typeof e?null:"function"==typeof(c=g&&e[g]||e["@@iterator"])?c:null))for(e=c.call(e),l=0;!(i=e.next()).done;)a+=L(i=i.value,c=t+I(i,l++),n,r);else if("object"===i)throw n=""+e,Error(y(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return a}function R(e,t,n){return null==e?0:L(e,"",t,n)}function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function D(e,t){e.func.call(e.context,t,e.count++)}function j(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?F(e,r,n,(function(e){return e})):null!=e&&(P(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+n)),r.push(e))}function F(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(A,"$&/")+"/"),R(e,j,t=M(t,o,r,i)),N(t)}var z={current:null};function B(){var e=z.current;if(null===e)throw Error(y(321));return e}var U={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return F(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;R(e,D,t=M(null,null,t,n)),N(t)},count:function(e){return R(e,(function(){return null}),null)},toArray:function(e){var t=[];return F(e,t,null,(function(e){return e})),t},only:function(e){if(!P(e))throw Error(y(143));return e}},t.Component=w,t.Fragment=a,t.Profiler=c,t.PureComponent=E,t.StrictMode=l,t.Suspense=f,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,t.cloneElement=function(e,t,n){if(null==e)throw Error(y(267,e));var i=r({},e.props),s=e.key,a=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,l=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)C.call(t,u)&&!T.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];i.children=c}return{$$typeof:o,type:e.type,key:s,ref:a,props:i,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=O,t.createFactory=function(e){var t=O.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return B().useCallback(e,t)},t.useContext=function(e,t){return B().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return B().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return B().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return B().useLayoutEffect(e,t)},t.useMemo=function(e,t){return B().useMemo(e,t)},t.useReducer=function(e,t,n){return B().useReducer(e,t,n)},t.useRef=function(e){return B().useRef(e)},t.useState=function(e){return B().useState(e)},t.version="16.14.0"},7378:function(e,t,n){"use strict";e.exports=n(1535)},4926:function(e,t,n){const r=n(2904),i=n(8281),{isPlainObject:o}=n(1288),s=n(1857),a=n(8523),{parse:l}=n(1722),c=["img","audio","video","picture","svg","object","map","iframe","embed"],u=["script","style"];function h(e,t){e&&Object.keys(e).forEach((function(n){t(e[n],n)}))}function d(e,t){return{}.hasOwnProperty.call(e,t)}function f(e,t){const n=[];return h(e,(function(e){t(e)&&n.push(e)})),n}e.exports=m;const p=/^[^\0\t\n\f\r /<=>]+$/;function m(e,t,n){if(null==e)return"";let y="",v="";function b(e,t){const n=this;this.tag=e,this.attribs=t||{},this.tagPosition=y.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){A.length&&(A[A.length-1].text+=n.text)},this.updateParentNodeMediaChildren=function(){A.length&&c.includes(this.tag)&&A[A.length-1].mediaChildren.push(this.tag)}}(t=Object.assign({},m.defaults,t)).parser=Object.assign({},g,t.parser),u.forEach((function(e){t.allowedTags&&t.allowedTags.indexOf(e)>-1&&!t.allowVulnerableTags&&console.warn(`\n\n Your \`allowedTags\` option includes, \`${e}\`, which is inherently\nvulnerable to XSS attacks. Please remove it from \`allowedTags\`.\nOr, to disable this warning, add the \`allowVulnerableTags\` option\nand ensure you are accounting for this risk.\n\n`)}));const w=t.nonTextTags||["script","style","textarea","option"];let x,E;t.allowedAttributes&&(x={},E={},h(t.allowedAttributes,(function(e,t){x[t]=[];const n=[];e.forEach((function(e){"string"==typeof e&&e.indexOf("*")>=0?n.push(i(e).replace(/\\\*/g,".*")):x[t].push(e)})),n.length&&(E[t]=new RegExp("^("+n.join("|")+")$"))})));const _={},S={},C={};h(t.allowedClasses,(function(e,t){x&&(d(x,t)||(x[t]=[]),x[t].push("class")),_[t]=[],C[t]=[];const n=[];e.forEach((function(e){"string"==typeof e&&e.indexOf("*")>=0?n.push(i(e).replace(/\\\*/g,".*")):e instanceof RegExp?C[t].push(e):_[t].push(e)})),n.length&&(S[t]=new RegExp("^("+n.join("|")+")$"))}));const T={};let O,P,A,k,M,N,L;h(t.transformTags,(function(e,t){let n;"function"==typeof e?n=e:"string"==typeof e&&(n=m.simpleTransform(e)),"*"===t?O=n:T[t]=n}));let R=!1;D();const I=new r.Parser({onopentag:function(e,n){if(t.enforceHtmlBoundary&&"html"===e&&D(),N)return void L++;const r=new b(e,n);A.push(r);let i=!1;const c=!!r.text;let u;if(d(T,e)&&(u=T[e](e,n),r.attribs=n=u.attribs,void 0!==u.text&&(r.innerText=u.text),e!==u.tagName&&(r.name=e=u.tagName,M[P]=u.tagName)),O&&(u=O(e,n),r.attribs=n=u.attribs,e!==u.tagName&&(r.name=e=u.tagName,M[P]=u.tagName)),(t.allowedTags&&-1===t.allowedTags.indexOf(e)||"recursiveEscape"===t.disallowedTagsMode&&!function(e){for(const t in e)if(d(e,t))return!1;return!0}(k)||null!=t.nestingLimit&&P>=t.nestingLimit)&&(i=!0,k[P]=!0,"discard"===t.disallowedTagsMode&&-1!==w.indexOf(e)&&(N=!0,L=1),k[P]=!0),P++,i){if("discard"===t.disallowedTagsMode)return;v=y,y=""}y+="<"+e,"script"===e&&(t.allowedScriptHostnames||t.allowedScriptDomains)&&(r.innerText=""),(!x||d(x,e)||x["*"])&&h(n,(function(n,i){if(!p.test(i))return void delete r.attribs[i];let c,u=!1;if(!x||d(x,e)&&-1!==x[e].indexOf(i)||x["*"]&&-1!==x["*"].indexOf(i)||d(E,e)&&E[e].test(i)||E["*"]&&E["*"].test(i))u=!0;else if(x&&x[e])for(const t of x[e])if(o(t)&&t.name&&t.name===i){u=!0;let e="";if(!0===t.multiple){const r=n.split(" ");for(const n of r)-1!==t.values.indexOf(n)&&(""===e?e=n:e+=" "+n)}else t.values.indexOf(n)>=0&&(e=n);n=e}if(u){if(-1!==t.allowedSchemesAppliedToAttributes.indexOf(i)&&F(e,n))return void delete r.attribs[i];if("script"===e&&"src"===i){let e=!0;try{const r=new URL(n);if(t.allowedScriptHostnames||t.allowedScriptDomains){const n=(t.allowedScriptHostnames||[]).find((function(e){return e===r.hostname})),i=(t.allowedScriptDomains||[]).find((function(e){return r.hostname===e||r.hostname.endsWith(`.${e}`)}));e=n||i}}catch(t){e=!1}if(!e)return void delete r.attribs[i]}if("iframe"===e&&"src"===i){let e=!0;try{if((n=n.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//")).startsWith("relative:"))throw new Error("relative: exploit attempt");let r="relative://relative-site";for(let e=0;e<100;e++)r+=`/${e}`;const i=new URL(n,r);if(i&&"relative-site"===i.hostname&&"relative:"===i.protocol)e=d(t,"allowIframeRelativeUrls")?t.allowIframeRelativeUrls:!t.allowedIframeHostnames&&!t.allowedIframeDomains;else if(t.allowedIframeHostnames||t.allowedIframeDomains){const n=(t.allowedIframeHostnames||[]).find((function(e){return e===i.hostname})),r=(t.allowedIframeDomains||[]).find((function(e){return i.hostname===e||i.hostname.endsWith(`.${e}`)}));e=n||r}}catch(t){e=!1}if(!e)return void delete r.attribs[i]}if("srcset"===i)try{if(c=a(n),c.forEach((function(e){F("srcset",e.url)&&(e.evil=!0)})),c=f(c,(function(e){return!e.evil})),!c.length)return void delete r.attribs[i];n=f(c,(function(e){return!e.evil})).map((function(e){if(!e.url)throw new Error("URL missing");return e.url+(e.w?` ${e.w}w`:"")+(e.h?` ${e.h}h`:"")+(e.d?` ${e.d}x`:"")})).join(", "),r.attribs[i]=n}catch(e){return void delete r.attribs[i]}if("class"===i){const t=_[e],o=_["*"],a=S[e],l=C[e],c=[a,S["*"]].concat(l).filter((function(e){return e}));if(!(h=n,m=t&&o?s(t,o):t||o,g=c,n=m?(h=h.split(/\s+/)).filter((function(e){return-1!==m.indexOf(e)||g.some((function(t){return t.test(e)}))})).join(" "):h).length)return void delete r.attribs[i]}if("style"===i)try{if(0===(n=function(e){return e.nodes[0].nodes.reduce((function(e,t){return e.push(`${t.prop}:${t.value}${t.important?" !important":""}`),e}),[]).join(";")}(function(e,t){if(!t)return e;const n=e.nodes[0];let r;return r=t[n.selector]&&t["*"]?s(t[n.selector],t["*"]):t[n.selector]||t["*"],r&&(e.nodes[0].nodes=n.nodes.reduce(function(e){return function(t,n){return d(e,n.prop)&&e[n.prop].some((function(e){return e.test(n.value)}))&&t.push(n),t}}(r),[])),e}(l(e+" {"+n+"}"),t.allowedStyles))).length)return void delete r.attribs[i]}catch(e){return void delete r.attribs[i]}y+=" "+i,n&&n.length&&(y+='="'+j(n,!0)+'"')}else delete r.attribs[i];var h,m,g})),-1!==t.selfClosing.indexOf(e)?y+=" />":(y+=">",!r.innerText||c||t.textFilter||(y+=j(r.innerText),R=!0)),i&&(y=v+j(y),v="")},ontext:function(e){if(N)return;const n=A[A.length-1];let r;if(n&&(r=n.tag,e=void 0!==n.innerText?n.innerText:e),"discard"!==t.disallowedTagsMode||"script"!==r&&"style"!==r){const n=j(e,!1);t.textFilter&&!R?y+=t.textFilter(n,r):R||(y+=n)}else y+=e;A.length&&(A[A.length-1].text+=e)},onclosetag:function(e){if(N){if(L--,L)return;N=!1}const n=A.pop();if(!n)return;N=!!t.enforceHtmlBoundary&&"html"===e,P--;const r=k[P];if(r){if(delete k[P],"discard"===t.disallowedTagsMode)return void n.updateParentNodeText();v=y,y=""}M[P]&&(e=M[P],delete M[P]),t.exclusiveFilter&&t.exclusiveFilter(n)?y=y.substr(0,n.tagPosition):(n.updateParentNodeMediaChildren(),n.updateParentNodeText(),-1===t.selfClosing.indexOf(e)?(y+="</"+e+">",r&&(y=v+j(y),v=""),R=!1):r&&(y=v,v=""))}},t.parser);return I.write(e),I.end(),y;function D(){y="",P=0,A=[],k={},M={},N=!1,L=0}function j(e,n){return"string"!=typeof e&&(e+=""),t.parser.decodeEntities&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n&&(e=e.replace(/"/g,"&quot;"))),e=e.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n&&(e=e.replace(/"/g,"&quot;")),e}function F(e,n){const r=(n=(n=n.replace(/[\x00-\x20]+/g,"")).replace(/<!--.*?-->/g,"")).match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!r)return!!n.match(/^[/\\]{2}/)&&!t.allowProtocolRelative;const i=r[1].toLowerCase();return d(t.allowedSchemesByTag,e)?-1===t.allowedSchemesByTag[e].indexOf(i):!t.allowedSchemes||-1===t.allowedSchemes.indexOf(i)}}const g={decodeEntities:!0};m.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1},m.simpleTransform=function(e,t,n){return n=void 0===n||n,t=t||{},function(r,i){let o;if(n)for(o in t)i[o]=t[o];else i=t;return{tagName:e,attribs:i}}}},8281:function(e){"use strict";e.exports=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},1288:function(e,t){"use strict";function n(e){return"[object Object]"===Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isPlainObject=function(e){var t,r;return!1!==n(e)&&(void 0===(t=e.constructor)||!1!==n(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf"))}},3323:function(e,t){"use strict";var n,r,i,o,s;if("undefined"==typeof window||"function"!=typeof MessageChannel){var a=null,l=null,c=function(){if(null!==a)try{var e=t.unstable_now();a(!0,e),a=null}catch(e){throw setTimeout(c,0),e}},u=Date.now();t.unstable_now=function(){return Date.now()-u},n=function(e){null!==a?setTimeout(n,0,e):(a=e,setTimeout(c,0))},r=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},o=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var h=window.performance,d=window.Date,f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var m=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof h&&"function"==typeof h.now)t.unstable_now=function(){return h.now()};else{var g=d.now();t.unstable_now=function(){return d.now()-g}}var y=!1,v=null,b=-1,w=5,x=0;o=function(){return t.unstable_now()>=x},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):w=0<e?Math.floor(1e3/e):5};var E=new MessageChannel,_=E.port2;E.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();x=e+w;try{v(!0,e)?_.postMessage(null):(y=!1,v=null)}catch(e){throw _.postMessage(null),e}}else y=!1},n=function(e){v=e,y||(y=!0,_.postMessage(null))},r=function(e,n){b=f((function(){e(t.unstable_now())}),n)},i=function(){p(b),b=-1}}function S(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<O(i,t)))break e;e[r]=t,e[n]=i,n=r}}function C(e){return void 0===(e=e[0])?null:e}function T(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,s=e[o],a=o+1,l=e[a];if(void 0!==s&&0>O(s,n))void 0!==l&&0>O(l,s)?(e[r]=l,e[a]=n,r=a):(e[r]=s,e[o]=n,r=o);else{if(!(void 0!==l&&0>O(l,n)))break e;e[r]=l,e[a]=n,r=a}}}return t}return null}function O(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var P=[],A=[],k=1,M=null,N=3,L=!1,R=!1,I=!1;function D(e){for(var t=C(A);null!==t;){if(null===t.callback)T(A);else{if(!(t.startTime<=e))break;T(A),t.sortIndex=t.expirationTime,S(P,t)}t=C(A)}}function j(e){if(I=!1,D(e),!R)if(null!==C(P))R=!0,n(F);else{var t=C(A);null!==t&&r(j,t.startTime-e)}}function F(e,n){R=!1,I&&(I=!1,i()),L=!0;var s=N;try{for(D(n),M=C(P);null!==M&&(!(M.expirationTime>n)||e&&!o());){var a=M.callback;if(null!==a){M.callback=null,N=M.priorityLevel;var l=a(M.expirationTime<=n);n=t.unstable_now(),"function"==typeof l?M.callback=l:M===C(P)&&T(P),D(n)}else T(P);M=C(P)}if(null!==M)var c=!0;else{var u=C(A);null!==u&&r(j,u.startTime-n),c=!1}return c}finally{M=null,N=s,L=!1}}function z(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var B=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){R||L||(R=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return C(P)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var n=N;N=t;try{return e()}finally{N=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=B,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=N;N=e;try{return t()}finally{N=n}},t.unstable_scheduleCallback=function(e,o,s){var a=t.unstable_now();if("object"==typeof s&&null!==s){var l=s.delay;l="number"==typeof l&&0<l?a+l:a,s="number"==typeof s.timeout?s.timeout:z(e)}else s=z(e),l=a;return e={id:k++,callback:o,priorityLevel:e,startTime:l,expirationTime:s=l+s,sortIndex:-1},l>a?(e.sortIndex=l,S(A,e),null===C(P)&&e===C(A)&&(I?i():I=!0,r(j,l-a))):(e.sortIndex=s,S(P,e),R||L||(R=!0,n(F))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();D(e);var n=C(P);return n!==M&&null!==M&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<M.expirationTime||o()},t.unstable_wrapCallback=function(e){var t=N;return function(){var n=N;N=t;try{return e.apply(this,arguments)}finally{N=n}}}},1102:function(e,t,n){"use strict";e.exports=n(3323)},2475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;const r=n(7306);function i(e,t){if(!e)return e;if(r.isBinary(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=i(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=i(e[r],t));return n}return e}function o(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=o(e[n],t);else if("object"==typeof e)for(const n in e)e.hasOwnProperty(n)&&(e[n]=o(e[n],t));return e}t.deconstructPacket=function(e){const t=[],n=e.data,r=e;return r.data=i(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=o(e.data,t),e.attachments=void 0,e}},8552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;const r=n(4398),i=n(2475),o=n(7306),s=n(6292)("socket.io-parser");var a;t.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(a=t.PacketType||(t.PacketType={})),t.Encoder=class{encode(e){return s("encoding packet %j",e),e.type!==a.EVENT&&e.type!==a.ACK||!o.hasBinary(e)?[this.encodeAsString(e)]:(e.type=e.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==a.BINARY_EVENT&&e.type!==a.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),s("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=i.deconstructPacket(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}};class l extends r{constructor(){super()}add(e){let t;if("string"==typeof e)t=this.decodeString(e),t.type===a.BINARY_EVENT||t.type===a.BINARY_ACK?(this.reconstructor=new c(t),0===t.attachments&&super.emit("decoded",t)):super.emit("decoded",t);else{if(!o.isBinary(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===a[n.type])throw new Error("unknown packet type "+n.type);if(n.type===a.BINARY_EVENT||n.type===a.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!l.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return s("decoded %s as %j",e,n),n}static isPayloadValid(e,t){switch(e){case a.CONNECT:return"object"==typeof t;case a.DISCONNECT:return void 0===t;case a.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}t.Decoder=l;class c{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},7306:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;const n="function"==typeof ArrayBuffer,r=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);function s(e){return n&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||i&&e instanceof Blob||o&&e instanceof File}t.isBinary=s,t.hasBinary=function e(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if(s(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return!0;return!1}},327:function(e){"use strict";var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r={},i=0,o=0;function s(e){var t="";do{t=n[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function a(){var e=s(+new Date);return e!==t?(i=0,t=e):e+"."+s(i++)}for(;o<64;o++)r[n[o]]=o;a.encode=s,a.decode=function(e){var t=0;for(o=0;o<e.length;o++)t=64*t+r[e.charAt(o)];return t},e.exports=a},6070:function(){},5219:function(){},9550:function(){},4029:function(){},1305:function(){},6659:function(){},1835:function(){},8773:function(e){e.exports={nanoid:(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t},customAlphabet:(e,t)=>()=>{let n="",r=t;for(;r--;)n+=e[Math.random()*e.length|0];return n}}},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=t.io=t.Manager=t.protocol=void 0;const r=n(8303),i=n(6907),o=n(6899);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return o.Socket}});const s=n(6292)("socket.io-client");e.exports=t=l;const a=t.managers={};function l(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};const n=r.url(e,t.path),o=n.source,l=n.id,c=n.path,u=a[l]&&c in a[l].nsps;let h;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(s("ignoring socket cache for %s",o),h=new i.Manager(o,t)):(a[l]||(s("new io instance for %s",o),a[l]=new i.Manager(o,t)),h=a[l]),n.query&&!t.query&&(t.query=n.queryKey),h.socket(n.path,t)}t.io=l;var c=n(8552);Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return c.protocol}}),t.connect=l;var u=n(6907);Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return u.Manager}}),t.default=l},6907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const r=n(6306),i=n(6899),o=n(8552),s=n(8666),a=n(2307),l=n(6452),c=n(6292)("socket.io-client:manager");class u extends l.StrictEventEmitter{constructor(e,t){super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||o;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(c("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=s.on(t,"open",(function(){n.onopen(),e&&e()})),o=s.on(t,"error",(t=>{c("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",t),e?e(t):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;c("connect attempt will timeout after %d",e),0===e&&i();const n=setTimeout((()=>{c("connect attempt timed out after %d",e),i(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){c("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(s.on(e,"ping",this.onping.bind(this)),s.on(e,"data",this.ondata.bind(this)),s.on(e,"error",this.onerror.bind(this)),s.on(e,"close",this.onclose.bind(this)),s.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){c("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n||(n=new i.Socket(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return void c("socket %s is still active, skipping close",e);this._close()}_packet(e){c("writing packet %j",e);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){c("cleanup"),this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){c("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){c("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=setTimeout((()=>{e.skipReconnect||(c("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(c("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(c("reconnect success"),e.onreconnect())})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}t.Manager=u},8666:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=function(e,t,n){return e.on(t,n),function(){e.off(t,n)}}},6899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const r=n(8552),i=n(8666),o=n(6452),s=n(6292)("socket.io-client:socket"),a=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class l extends o.StrictEventEmitter{constructor(e,t,n){super(),this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const e=this.io;this.subs=[i.on(e,"open",this.onopen.bind(this)),i.on(e,"packet",this.onpacket.bind(this)),i.on(e,"error",this.onerror.bind(this)),i.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(a.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);const n={type:r.PacketType.EVENT,data:t,options:{}};n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(s("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++);const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||i&&this.connected?this.connected?this.packet(n):this.sendBuffer.push(n):s("discard packet as the transport is not currently writable"),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){s("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this.packet({type:r.PacketType.CONNECT,data:e})})):this.packet({type:r.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){s("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case r.PacketType.CONNECT:if(e.data&&e.data.sid){const t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case r.PacketType.EVENT:case r.PacketType.BINARY_EVENT:this.onevent(e);break;case r.PacketType.ACK:case r.PacketType.BINARY_ACK:this.onack(e);break;case r.PacketType.DISCONNECT:this.ondisconnect();break;case r.PacketType.CONNECT_ERROR:const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];s("emitting event %j",t),null!=e.id&&(s("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let n=!1;return function(...i){n||(n=!0,s("sending ack %j",i),t.packet({type:r.PacketType.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(s("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):s("bad ack %s",e.id)}onconnect(e){s("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitReserved("connect"),this.emitBuffered()}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>this.packet(e))),this.sendBuffer=[]}ondisconnect(){s("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(s("performing disconnect (%s)",this.nsp),this.packet({type:r.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}t.Socket=l},6452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StrictEventEmitter=void 0;const r=n(4398);t.StrictEventEmitter=class extends r{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t),this}emitReserved(e,...t){return super.emit(e,...t),this}listeners(e){return super.listeners(e)}}},8303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;const r=n(5649),i=n(6292)("socket.io-client:url");t.url=function(e,t="",n){let o=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),i("parse %s",e),o=r(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";const s=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port+t,o.href=o.protocol+"://"+s+(n&&n.port===o.port?"":":"+o.port),o}},8124:function(e){"use strict";e.exports=JSON.parse('{"0":65533,"128":8364,"130":8218,"131":402,"132":8222,"133":8230,"134":8224,"135":8225,"136":710,"137":8240,"138":352,"139":8249,"140":338,"142":381,"145":8216,"146":8217,"147":8220,"148":8221,"149":8226,"150":8211,"151":8212,"152":732,"153":8482,"154":353,"155":8250,"156":339,"158":382,"159":376}')},2834:function(e){"use strict";e.exports=JSON.parse('{"Aacute":"","aacute":"","Abreve":"","abreve":"","ac":"","acd":"","acE":"","Acirc":"","acirc":"","acute":"","Acy":"","acy":"","AElig":"","aelig":"","af":"","Afr":"","afr":"","Agrave":"","agrave":"","alefsym":"","aleph":"","Alpha":"","alpha":"","Amacr":"","amacr":"","amalg":"","amp":"&","AMP":"&","andand":"","And":"","and":"","andd":"","andslope":"","andv":"","ang":"","ange":"","angle":"","angmsdaa":"","angmsdab":"","angmsdac":"","angmsdad":"","angmsdae":"","angmsdaf":"","angmsdag":"","angmsdah":"","angmsd":"","angrt":"","angrtvb":"","angrtvbd":"","angsph":"","angst":"","angzarr":"","Aogon":"","aogon":"","Aopf":"","aopf":"","apacir":"","ap":"","apE":"","ape":"","apid":"","apos":"\'","ApplyFunction":"","approx":"","approxeq":"","Aring":"","aring":"","Ascr":"","ascr":"","Assign":"","ast":"*","asymp":"","asympeq":"","Atilde":"","atilde":"","Auml":"","auml":"","awconint":"","awint":"","backcong":"","backepsilon":"","backprime":"","backsim":"","backsimeq":"","Backslash":"","Barv":"","barvee":"","barwed":"","Barwed":"","barwedge":"","bbrk":"","bbrktbrk":"","bcong":"","Bcy":"","bcy":"","bdquo":"","becaus":"","because":"","Because":"","bemptyv":"","bepsi":"","bernou":"","Bernoullis":"","Beta":"","beta":"","beth":"","between":"","Bfr":"","bfr":"","bigcap":"","bigcirc":"","bigcup":"","bigodot":"","bigoplus":"","bigotimes":"","bigsqcup":"","bigstar":"","bigtriangledown":"","bigtriangleup":"","biguplus":"","bigvee":"","bigwedge":"","bkarow":"","blacklozenge":"","blacksquare":"","blacktriangle":"","blacktriangledown":"","blacktriangleleft":"","blacktriangleright":"","blank":"","blk12":"","blk14":"","blk34":"","block":"","bne":"=","bnequiv":"","bNot":"","bnot":"","Bopf":"","bopf":"","bot":"","bottom":"","bowtie":"","boxbox":"","boxdl":"","boxdL":"","boxDl":"","boxDL":"","boxdr":"","boxdR":"","boxDr":"","boxDR":"","boxh":"","boxH":"","boxhd":"","boxHd":"","boxhD":"","boxHD":"","boxhu":"","boxHu":"","boxhU":"","boxHU":"","boxminus":"","boxplus":"","boxtimes":"","boxul":"","boxuL":"","boxUl":"","boxUL":"","boxur":"","boxuR":"","boxUr":"","boxUR":"","boxv":"","boxV":"","boxvh":"","boxvH":"","boxVh":"","boxVH":"","boxvl":"","boxvL":"","boxVl":"","boxVL":"","boxvr":"","boxvR":"","boxVr":"","boxVR":"","bprime":"","breve":"","Breve":"","brvbar":"","bscr":"","Bscr":"","bsemi":"","bsim":"","bsime":"","bsolb":"","bsol":"\\\\","bsolhsub":"","bull":"","bullet":"","bump":"","bumpE":"","bumpe":"","Bumpeq":"","bumpeq":"","Cacute":"","cacute":"","capand":"","capbrcup":"","capcap":"","cap":"","Cap":"","capcup":"","capdot":"","CapitalDifferentialD":"","caps":"","caret":"","caron":"","Cayleys":"","ccaps":"","Ccaron":"","ccaron":"","Ccedil":"","ccedil":"","Ccirc":"","ccirc":"","Cconint":"","ccups":"","ccupssm":"","Cdot":"","cdot":"","cedil":"","Cedilla":"","cemptyv":"","cent":"","centerdot":"","CenterDot":"","cfr":"","Cfr":"","CHcy":"","chcy":"","check":"","checkmark":"","Chi":"","chi":"","circ":"","circeq":"","circlearrowleft":"","circlearrowright":"","circledast":"","circledcirc":"","circleddash":"","CircleDot":"","circledR":"","circledS":"","CircleMinus":"","CirclePlus":"","CircleTimes":"","cir":"","cirE":"","cire":"","cirfnint":"","cirmid":"","cirscir":"","ClockwiseContourIntegral":"","CloseCurlyDoubleQuote":"","CloseCurlyQuote":"","clubs":"","clubsuit":"","colon":":","Colon":"","Colone":"","colone":"","coloneq":"","comma":",","commat":"@","comp":"","compfn":"","complement":"","complexes":"","cong":"","congdot":"","Congruent":"","conint":"","Conint":"","ContourIntegral":"","copf":"","Copf":"","coprod":"","Coproduct":"","copy":"","COPY":"","copysr":"","CounterClockwiseContourIntegral":"","crarr":"","cross":"","Cross":"","Cscr":"","cscr":"","csub":"","csube":"","csup":"","csupe":"","ctdot":"","cudarrl":"","cudarrr":"","cuepr":"","cuesc":"","cularr":"","cularrp":"","cupbrcap":"","cupcap":"","CupCap":"","cup":"","Cup":"","cupcup":"","cupdot":"","cupor":"","cups":"","curarr":"","curarrm":"","curlyeqprec":"","curlyeqsucc":"","curlyvee":"","curlywedge":"","curren":"","curvearrowleft":"","curvearrowright":"","cuvee":"","cuwed":"","cwconint":"","cwint":"","cylcty":"","dagger":"","Dagger":"","daleth":"","darr":"","Darr":"","dArr":"","dash":"","Dashv":"","dashv":"","dbkarow":"","dblac":"","Dcaron":"","dcaron":"","Dcy":"","dcy":"","ddagger":"","ddarr":"","DD":"","dd":"","DDotrahd":"","ddotseq":"","deg":"","Del":"","Delta":"","delta":"","demptyv":"","dfisht":"","Dfr":"","dfr":"","dHar":"","dharl":"","dharr":"","DiacriticalAcute":"","DiacriticalDot":"","DiacriticalDoubleAcute":"","DiacriticalGrave":"`","DiacriticalTilde":"","diam":"","diamond":"","Diamond":"","diamondsuit":"","diams":"","die":"","DifferentialD":"","digamma":"","disin":"","div":"","divide":"","divideontimes":"","divonx":"","DJcy":"","djcy":"","dlcorn":"","dlcrop":"","dollar":"$","Dopf":"","dopf":"","Dot":"","dot":"","DotDot":"","doteq":"","doteqdot":"","DotEqual":"","dotminus":"","dotplus":"","dotsquare":"","doublebarwedge":"","DoubleContourIntegral":"","DoubleDot":"","DoubleDownArrow":"","DoubleLeftArrow":"","DoubleLeftRightArrow":"","DoubleLeftTee":"","DoubleLongLeftArrow":"","DoubleLongLeftRightArrow":"","DoubleLongRightArrow":"","DoubleRightArrow":"","DoubleRightTee":"","DoubleUpArrow":"","DoubleUpDownArrow":"","DoubleVerticalBar":"","DownArrowBar":"","downarrow":"","DownArrow":"","Downarrow":"","DownArrowUpArrow":"","DownBreve":"","downdownarrows":"","downharpoonleft":"","downharpoonright":"","DownLeftRightVector":"","DownLeftTeeVector":"","DownLeftVectorBar":"","DownLeftVector":"","DownRightTeeVector":"","DownRightVectorBar":"","DownRightVector":"","DownTeeArrow":"","DownTee":"","drbkarow":"","drcorn":"","drcrop":"","Dscr":"","dscr":"","DScy":"","dscy":"","dsol":"","Dstrok":"","dstrok":"","dtdot":"","dtri":"","dtrif":"","duarr":"","duhar":"","dwangle":"","DZcy":"","dzcy":"","dzigrarr":"","Eacute":"","eacute":"","easter":"","Ecaron":"","ecaron":"","Ecirc":"","ecirc":"","ecir":"","ecolon":"","Ecy":"","ecy":"","eDDot":"","Edot":"","edot":"","eDot":"","ee":"","efDot":"","Efr":"","efr":"","eg":"","Egrave":"","egrave":"","egs":"","egsdot":"","el":"","Element":"","elinters":"","ell":"","els":"","elsdot":"","Emacr":"","emacr":"","empty":"","emptyset":"","EmptySmallSquare":"","emptyv":"","EmptyVerySmallSquare":"","emsp13":"","emsp14":"","emsp":"","ENG":"","eng":"","ensp":"","Eogon":"","eogon":"","Eopf":"","eopf":"","epar":"","eparsl":"","eplus":"","epsi":"","Epsilon":"","epsilon":"","epsiv":"","eqcirc":"","eqcolon":"","eqsim":"","eqslantgtr":"","eqslantless":"","Equal":"","equals":"=","EqualTilde":"","equest":"","Equilibrium":"","equiv":"","equivDD":"","eqvparsl":"","erarr":"","erDot":"","escr":"","Escr":"","esdot":"","Esim":"","esim":"","Eta":"","eta":"","ETH":"","eth":"","Euml":"","euml":"","euro":"","excl":"!","exist":"","Exists":"","expectation":"","exponentiale":"","ExponentialE":"","fallingdotseq":"","Fcy":"","fcy":"","female":"","ffilig":"","fflig":"","ffllig":"","Ffr":"","ffr":"","filig":"","FilledSmallSquare":"","FilledVerySmallSquare":"","fjlig":"fj","flat":"","fllig":"","fltns":"","fnof":"","Fopf":"","fopf":"","forall":"","ForAll":"","fork":"","forkv":"","Fouriertrf":"","fpartint":"","frac12":"","frac13":"","frac14":"","frac15":"","frac16":"","frac18":"","frac23":"","frac25":"","frac34":"","frac35":"","frac38":"","frac45":"","frac56":"","frac58":"","frac78":"","frasl":"","frown":"","fscr":"","Fscr":"","gacute":"","Gamma":"","gamma":"","Gammad":"","gammad":"","gap":"","Gbreve":"","gbreve":"","Gcedil":"","Gcirc":"","gcirc":"","Gcy":"","gcy":"","Gdot":"","gdot":"","ge":"","gE":"","gEl":"","gel":"","geq":"","geqq":"","geqslant":"","gescc":"","ges":"","gesdot":"","gesdoto":"","gesdotol":"","gesl":"","gesles":"","Gfr":"","gfr":"","gg":"","Gg":"","ggg":"","gimel":"","GJcy":"","gjcy":"","gla":"","gl":"","glE":"","glj":"","gnap":"","gnapprox":"","gne":"","gnE":"","gneq":"","gneqq":"","gnsim":"","Gopf":"","gopf":"","grave":"`","GreaterEqual":"","GreaterEqualLess":"","GreaterFullEqual":"","GreaterGreater":"","GreaterLess":"","GreaterSlantEqual":"","GreaterTilde":"","Gscr":"","gscr":"","gsim":"","gsime":"","gsiml":"","gtcc":"","gtcir":"","gt":">","GT":">","Gt":"","gtdot":"","gtlPar":"","gtquest":"","gtrapprox":"","gtrarr":"","gtrdot":"","gtreqless":"","gtreqqless":"","gtrless":"","gtrsim":"","gvertneqq":"","gvnE":"","Hacek":"","hairsp":"","half":"","hamilt":"","HARDcy":"","hardcy":"","harrcir":"","harr":"","hArr":"","harrw":"","Hat":"^","hbar":"","Hcirc":"","hcirc":"","hearts":"","heartsuit":"","hellip":"","hercon":"","hfr":"","Hfr":"","HilbertSpace":"","hksearow":"","hkswarow":"","hoarr":"","homtht":"","hookleftarrow":"","hookrightarrow":"","hopf":"","Hopf":"","horbar":"","HorizontalLine":"","hscr":"","Hscr":"","hslash":"","Hstrok":"","hstrok":"","HumpDownHump":"","HumpEqual":"","hybull":"","hyphen":"","Iacute":"","iacute":"","ic":"","Icirc":"","icirc":"","Icy":"","icy":"","Idot":"","IEcy":"","iecy":"","iexcl":"","iff":"","ifr":"","Ifr":"","Igrave":"","igrave":"","ii":"","iiiint":"","iiint":"","iinfin":"","iiota":"","IJlig":"","ijlig":"","Imacr":"","imacr":"","image":"","ImaginaryI":"","imagline":"","imagpart":"","imath":"","Im":"","imof":"","imped":"","Implies":"","incare":"","in":"","infin":"","infintie":"","inodot":"","intcal":"","int":"","Int":"","integers":"","Integral":"","intercal":"","Intersection":"","intlarhk":"","intprod":"","InvisibleComma":"","InvisibleTimes":"","IOcy":"","iocy":"","Iogon":"","iogon":"","Iopf":"","iopf":"","Iota":"","iota":"","iprod":"","iquest":"","iscr":"","Iscr":"","isin":"","isindot":"","isinE":"","isins":"","isinsv":"","isinv":"","it":"","Itilde":"","itilde":"","Iukcy":"","iukcy":"","Iuml":"","iuml":"","Jcirc":"","jcirc":"","Jcy":"","jcy":"","Jfr":"","jfr":"","jmath":"","Jopf":"","jopf":"","Jscr":"","jscr":"","Jsercy":"","jsercy":"","Jukcy":"","jukcy":"","Kappa":"","kappa":"","kappav":"","Kcedil":"","kcedil":"","Kcy":"","kcy":"","Kfr":"","kfr":"","kgreen":"","KHcy":"","khcy":"","KJcy":"","kjcy":"","Kopf":"","kopf":"","Kscr":"","kscr":"","lAarr":"","Lacute":"","lacute":"","laemptyv":"","lagran":"","Lambda":"","lambda":"","lang":"","Lang":"","langd":"","langle":"","lap":"","Laplacetrf":"","laquo":"","larrb":"","larrbfs":"","larr":"","Larr":"","lArr":"","larrfs":"","larrhk":"","larrlp":"","larrpl":"","larrsim":"","larrtl":"","latail":"","lAtail":"","lat":"","late":"","lates":"","lbarr":"","lBarr":"","lbbrk":"","lbrace":"{","lbrack":"[","lbrke":"","lbrksld":"","lbrkslu":"","Lcaron":"","lcaron":"","Lcedil":"","lcedil":"","lceil":"","lcub":"{","Lcy":"","lcy":"","ldca":"","ldquo":"","ldquor":"","ldrdhar":"","ldrushar":"","ldsh":"","le":"","lE":"","LeftAngleBracket":"","LeftArrowBar":"","leftarrow":"","LeftArrow":"","Leftarrow":"","LeftArrowRightArrow":"","leftarrowtail":"","LeftCeiling":"","LeftDoubleBracket":"","LeftDownTeeVector":"","LeftDownVectorBar":"","LeftDownVector":"","LeftFloor":"","leftharpoondown":"","leftharpoonup":"","leftleftarrows":"","leftrightarrow":"","LeftRightArrow":"","Leftrightarrow":"","leftrightarrows":"","leftrightharpoons":"","leftrightsquigarrow":"","LeftRightVector":"","LeftTeeArrow":"","LeftTee":"","LeftTeeVector":"","leftthreetimes":"","LeftTriangleBar":"","LeftTriangle":"","LeftTriangleEqual":"","LeftUpDownVector":"","LeftUpTeeVector":"","LeftUpVectorBar":"","LeftUpVector":"","LeftVectorBar":"","LeftVector":"","lEg":"","leg":"","leq":"","leqq":"","leqslant":"","lescc":"","les":"","lesdot":"","lesdoto":"","lesdotor":"","lesg":"","lesges":"","lessapprox":"","lessdot":"","lesseqgtr":"","lesseqqgtr":"","LessEqualGreater":"","LessFullEqual":"","LessGreater":"","lessgtr":"","LessLess":"","lesssim":"","LessSlantEqual":"","LessTilde":"","lfisht":"","lfloor":"","Lfr":"","lfr":"","lg":"","lgE":"","lHar":"","lhard":"","lharu":"","lharul":"","lhblk":"","LJcy":"","ljcy":"","llarr":"","ll":"","Ll":"","llcorner":"","Lleftarrow":"","llhard":"","lltri":"","Lmidot":"","lmidot":"","lmoustache":"","lmoust":"","lnap":"","lnapprox":"","lne":"","lnE":"","lneq":"","lneqq":"","lnsim":"","loang":"","loarr":"","lobrk":"","longleftarrow":"","LongLeftArrow":"","Longleftarrow":"","longleftrightarrow":"","LongLeftRightArrow":"","Longleftrightarrow":"","longmapsto":"","longrightarrow":"","LongRightArrow":"","Longrightarrow":"","looparrowleft":"","looparrowright":"","lopar":"","Lopf":"","lopf":"","loplus":"","lotimes":"","lowast":"","lowbar":"_","LowerLeftArrow":"","LowerRightArrow":"","loz":"","lozenge":"","lozf":"","lpar":"(","lparlt":"","lrarr":"","lrcorner":"","lrhar":"","lrhard":"","lrm":"","lrtri":"","lsaquo":"","lscr":"","Lscr":"","lsh":"","Lsh":"","lsim":"","lsime":"","lsimg":"","lsqb":"[","lsquo":"","lsquor":"","Lstrok":"","lstrok":"","ltcc":"","ltcir":"","lt":"<","LT":"<","Lt":"","ltdot":"","lthree":"","ltimes":"","ltlarr":"","ltquest":"","ltri":"","ltrie":"","ltrif":"","ltrPar":"","lurdshar":"","luruhar":"","lvertneqq":"","lvnE":"","macr":"","male":"","malt":"","maltese":"","Map":"","map":"","mapsto":"","mapstodown":"","mapstoleft":"","mapstoup":"","marker":"","mcomma":"","Mcy":"","mcy":"","mdash":"","mDDot":"","measuredangle":"","MediumSpace":"","Mellintrf":"","Mfr":"","mfr":"","mho":"","micro":"","midast":"*","midcir":"","mid":"","middot":"","minusb":"","minus":"","minusd":"","minusdu":"","MinusPlus":"","mlcp":"","mldr":"","mnplus":"","models":"","Mopf":"","mopf":"","mp":"","mscr":"","Mscr":"","mstpos":"","Mu":"","mu":"","multimap":"","mumap":"","nabla":"","Nacute":"","nacute":"","nang":"","nap":"","napE":"","napid":"","napos":"","napprox":"","natural":"","naturals":"","natur":"","nbsp":"","nbump":"","nbumpe":"","ncap":"","Ncaron":"","ncaron":"","Ncedil":"","ncedil":"","ncong":"","ncongdot":"","ncup":"","Ncy":"","ncy":"","ndash":"","nearhk":"","nearr":"","neArr":"","nearrow":"","ne":"","nedot":"","NegativeMediumSpace":"","NegativeThickSpace":"","NegativeThinSpace":"","NegativeVeryThinSpace":"","nequiv":"","nesear":"","nesim":"","NestedGreaterGreater":"","NestedLessLess":"","NewLine":"\\n","nexist":"","nexists":"","Nfr":"","nfr":"","ngE":"","nge":"","ngeq":"","ngeqq":"","ngeqslant":"","nges":"","nGg":"","ngsim":"","nGt":"","ngt":"","ngtr":"","nGtv":"","nharr":"","nhArr":"","nhpar":"","ni":"","nis":"","nisd":"","niv":"","NJcy":"","njcy":"","nlarr":"","nlArr":"","nldr":"","nlE":"","nle":"","nleftarrow":"","nLeftarrow":"","nleftrightarrow":"","nLeftrightarrow":"","nleq":"","nleqq":"","nleqslant":"","nles":"","nless":"","nLl":"","nlsim":"","nLt":"","nlt":"","nltri":"","nltrie":"","nLtv":"","nmid":"","NoBreak":"","NonBreakingSpace":"","nopf":"","Nopf":"","Not":"","not":"","NotCongruent":"","NotCupCap":"","NotDoubleVerticalBar":"","NotElement":"","NotEqual":"","NotEqualTilde":"","NotExists":"","NotGreater":"","NotGreaterEqual":"","NotGreaterFullEqual":"","NotGreaterGreater":"","NotGreaterLess":"","NotGreaterSlantEqual":"","NotGreaterTilde":"","NotHumpDownHump":"","NotHumpEqual":"","notin":"","notindot":"","notinE":"","notinva":"","notinvb":"","notinvc":"","NotLeftTriangleBar":"","NotLeftTriangle":"","NotLeftTriangleEqual":"","NotLess":"","NotLessEqual":"","NotLessGreater":"","NotLessLess":"","NotLessSlantEqual":"","NotLessTilde":"","NotNestedGreaterGreater":"","NotNestedLessLess":"","notni":"","notniva":"","notnivb":"","notnivc":"","NotPrecedes":"","NotPrecedesEqual":"","NotPrecedesSlantEqual":"","NotReverseElement":"","NotRightTriangleBar":"","NotRightTriangle":"","NotRightTriangleEqual":"","NotSquareSubset":"","NotSquareSubsetEqual":"","NotSquareSuperset":"","NotSquareSupersetEqual":"","NotSubset":"","NotSubsetEqual":"","NotSucceeds":"","NotSucceedsEqual":"","NotSucceedsSlantEqual":"","NotSucceedsTilde":"","NotSuperset":"","NotSupersetEqual":"","NotTilde":"","NotTildeEqual":"","NotTildeFullEqual":"","NotTildeTilde":"","NotVerticalBar":"","nparallel":"","npar":"","nparsl":"","npart":"","npolint":"","npr":"","nprcue":"","nprec":"","npreceq":"","npre":"","nrarrc":"","nrarr":"","nrArr":"","nrarrw":"","nrightarrow":"","nRightarrow":"","nrtri":"","nrtrie":"","nsc":"","nsccue":"","nsce":"","Nscr":"","nscr":"","nshortmid":"","nshortparallel":"","nsim":"","nsime":"","nsimeq":"","nsmid":"","nspar":"","nsqsube":"","nsqsupe":"","nsub":"","nsubE":"","nsube":"","nsubset":"","nsubseteq":"","nsubseteqq":"","nsucc":"","nsucceq":"","nsup":"","nsupE":"","nsupe":"","nsupset":"","nsupseteq":"","nsupseteqq":"","ntgl":"","Ntilde":"","ntilde":"","ntlg":"","ntriangleleft":"","ntrianglelefteq":"","ntriangleright":"","ntrianglerighteq":"","Nu":"","nu":"","num":"#","numero":"","numsp":"","nvap":"","nvdash":"","nvDash":"","nVdash":"","nVDash":"","nvge":"","nvgt":">","nvHarr":"","nvinfin":"","nvlArr":"","nvle":"","nvlt":"<","nvltrie":"","nvrArr":"","nvrtrie":"","nvsim":"","nwarhk":"","nwarr":"","nwArr":"","nwarrow":"","nwnear":"","Oacute":"","oacute":"","oast":"","Ocirc":"","ocirc":"","ocir":"","Ocy":"","ocy":"","odash":"","Odblac":"","odblac":"","odiv":"","odot":"","odsold":"","OElig":"","oelig":"","ofcir":"","Ofr":"","ofr":"","ogon":"","Ograve":"","ograve":"","ogt":"","ohbar":"","ohm":"","oint":"","olarr":"","olcir":"","olcross":"","oline":"","olt":"","Omacr":"","omacr":"","Omega":"","omega":"","Omicron":"","omicron":"","omid":"","ominus":"","Oopf":"","oopf":"","opar":"","OpenCurlyDoubleQuote":"","OpenCurlyQuote":"","operp":"","oplus":"","orarr":"","Or":"","or":"","ord":"","order":"","orderof":"","ordf":"","ordm":"","origof":"","oror":"","orslope":"","orv":"","oS":"","Oscr":"","oscr":"","Oslash":"","oslash":"","osol":"","Otilde":"","otilde":"","otimesas":"","Otimes":"","otimes":"","Ouml":"","ouml":"","ovbar":"","OverBar":"","OverBrace":"","OverBracket":"","OverParenthesis":"","para":"","parallel":"","par":"","parsim":"","parsl":"","part":"","PartialD":"","Pcy":"","pcy":"","percnt":"%","period":".","permil":"","perp":"","pertenk":"","Pfr":"","pfr":"","Phi":"","phi":"","phiv":"","phmmat":"","phone":"","Pi":"","pi":"","pitchfork":"","piv":"","planck":"","planckh":"","plankv":"","plusacir":"","plusb":"","pluscir":"","plus":"+","plusdo":"","plusdu":"","pluse":"","PlusMinus":"","plusmn":"","plussim":"","plustwo":"","pm":"","Poincareplane":"","pointint":"","popf":"","Popf":"","pound":"","prap":"","Pr":"","pr":"","prcue":"","precapprox":"","prec":"","preccurlyeq":"","Precedes":"","PrecedesEqual":"","PrecedesSlantEqual":"","PrecedesTilde":"","preceq":"","precnapprox":"","precneqq":"","precnsim":"","pre":"","prE":"","precsim":"","prime":"","Prime":"","primes":"","prnap":"","prnE":"","prnsim":"","prod":"","Product":"","profalar":"","profline":"","profsurf":"","prop":"","Proportional":"","Proportion":"","propto":"","prsim":"","prurel":"","Pscr":"","pscr":"","Psi":"","psi":"","puncsp":"","Qfr":"","qfr":"","qint":"","qopf":"","Qopf":"","qprime":"","Qscr":"","qscr":"","quaternions":"","quatint":"","quest":"?","questeq":"","quot":"\\"","QUOT":"\\"","rAarr":"","race":"","Racute":"","racute":"","radic":"","raemptyv":"","rang":"","Rang":"","rangd":"","range":"","rangle":"","raquo":"","rarrap":"","rarrb":"","rarrbfs":"","rarrc":"","rarr":"","Rarr":"","rArr":"","rarrfs":"","rarrhk":"","rarrlp":"","rarrpl":"","rarrsim":"","Rarrtl":"","rarrtl":"","rarrw":"","ratail":"","rAtail":"","ratio":"","rationals":"","rbarr":"","rBarr":"","RBarr":"","rbbrk":"","rbrace":"}","rbrack":"]","rbrke":"","rbrksld":"","rbrkslu":"","Rcaron":"","rcaron":"","Rcedil":"","rcedil":"","rceil":"","rcub":"}","Rcy":"","rcy":"","rdca":"","rdldhar":"","rdquo":"","rdquor":"","rdsh":"","real":"","realine":"","realpart":"","reals":"","Re":"","rect":"","reg":"","REG":"","ReverseElement":"","ReverseEquilibrium":"","ReverseUpEquilibrium":"","rfisht":"","rfloor":"","rfr":"","Rfr":"","rHar":"","rhard":"","rharu":"","rharul":"","Rho":"","rho":"","rhov":"","RightAngleBracket":"","RightArrowBar":"","rightarrow":"","RightArrow":"","Rightarrow":"","RightArrowLeftArrow":"","rightarrowtail":"","RightCeiling":"","RightDoubleBracket":"","RightDownTeeVector":"","RightDownVectorBar":"","RightDownVector":"","RightFloor":"","rightharpoondown":"","rightharpoonup":"","rightleftarrows":"","rightleftharpoons":"","rightrightarrows":"","rightsquigarrow":"","RightTeeArrow":"","RightTee":"","RightTeeVector":"","rightthreetimes":"","RightTriangleBar":"","RightTriangle":"","RightTriangleEqual":"","RightUpDownVector":"","RightUpTeeVector":"","RightUpVectorBar":"","RightUpVector":"","RightVectorBar":"","RightVector":"","ring":"","risingdotseq":"","rlarr":"","rlhar":"","rlm":"","rmoustache":"","rmoust":"","rnmid":"","roang":"","roarr":"","robrk":"","ropar":"","ropf":"","Ropf":"","roplus":"","rotimes":"","RoundImplies":"","rpar":")","rpargt":"","rppolint":"","rrarr":"","Rrightarrow":"","rsaquo":"","rscr":"","Rscr":"","rsh":"","Rsh":"","rsqb":"]","rsquo":"","rsquor":"","rthree":"","rtimes":"","rtri":"","rtrie":"","rtrif":"","rtriltri":"","RuleDelayed":"","ruluhar":"","rx":"","Sacute":"","sacute":"","sbquo":"","scap":"","Scaron":"","scaron":"","Sc":"","sc":"","sccue":"","sce":"","scE":"","Scedil":"","scedil":"","Scirc":"","scirc":"","scnap":"","scnE":"","scnsim":"","scpolint":"","scsim":"","Scy":"","scy":"","sdotb":"","sdot":"","sdote":"","searhk":"","searr":"","seArr":"","searrow":"","sect":"","semi":";","seswar":"","setminus":"","setmn":"","sext":"","Sfr":"","sfr":"","sfrown":"","sharp":"","SHCHcy":"","shchcy":"","SHcy":"","shcy":"","ShortDownArrow":"","ShortLeftArrow":"","shortmid":"","shortparallel":"","ShortRightArrow":"","ShortUpArrow":"","shy":"","Sigma":"","sigma":"","sigmaf":"","sigmav":"","sim":"","simdot":"","sime":"","simeq":"","simg":"","simgE":"","siml":"","simlE":"","simne":"","simplus":"","simrarr":"","slarr":"","SmallCircle":"","smallsetminus":"","smashp":"","smeparsl":"","smid":"","smile":"","smt":"","smte":"","smtes":"","SOFTcy":"","softcy":"","solbar":"","solb":"","sol":"/","Sopf":"","sopf":"","spades":"","spadesuit":"","spar":"","sqcap":"","sqcaps":"","sqcup":"","sqcups":"","Sqrt":"","sqsub":"","sqsube":"","sqsubset":"","sqsubseteq":"","sqsup":"","sqsupe":"","sqsupset":"","sqsupseteq":"","square":"","Square":"","SquareIntersection":"","SquareSubset":"","SquareSubsetEqual":"","SquareSuperset":"","SquareSupersetEqual":"","SquareUnion":"","squarf":"","squ":"","squf":"","srarr":"","Sscr":"","sscr":"","ssetmn":"","ssmile":"","sstarf":"","Star":"","star":"","starf":"","straightepsilon":"","straightphi":"","strns":"","sub":"","Sub":"","subdot":"","subE":"","sube":"","subedot":"","submult":"","subnE":"","subne":"","subplus":"","subrarr":"","subset":"","Subset":"","subseteq":"","subseteqq":"","SubsetEqual":"","subsetneq":"","subsetneqq":"","subsim":"","subsub":"","subsup":"","succapprox":"","succ":"","succcurlyeq":"","Succeeds":"","SucceedsEqual":"","SucceedsSlantEqual":"","SucceedsTilde":"","succeq":"","succnapprox":"","succneqq":"","succnsim":"","succsim":"","SuchThat":"","sum":"","Sum":"","sung":"","sup1":"","sup2":"","sup3":"","sup":"","Sup":"","supdot":"","supdsub":"","supE":"","supe":"","supedot":"","Superset":"","SupersetEqual":"","suphsol":"","suphsub":"","suplarr":"","supmult":"","supnE":"","supne":"","supplus":"","supset":"","Supset":"","supseteq":"","supseteqq":"","supsetneq":"","supsetneqq":"","supsim":"","supsub":"","supsup":"","swarhk":"","swarr":"","swArr":"","swarrow":"","swnwar":"","szlig":"","Tab":"\\t","target":"","Tau":"","tau":"","tbrk":"","Tcaron":"","tcaron":"","Tcedil":"","tcedil":"","Tcy":"","tcy":"","tdot":"","telrec":"","Tfr":"","tfr":"","there4":"","therefore":"","Therefore":"","Theta":"","theta":"","thetasym":"","thetav":"","thickapprox":"","thicksim":"","ThickSpace":"","ThinSpace":"","thinsp":"","thkap":"","thksim":"","THORN":"","thorn":"","tilde":"","Tilde":"","TildeEqual":"","TildeFullEqual":"","TildeTilde":"","timesbar":"","timesb":"","times":"","timesd":"","tint":"","toea":"","topbot":"","topcir":"","top":"","Topf":"","topf":"","topfork":"","tosa":"","tprime":"","trade":"","TRADE":"","triangle":"","triangledown":"","triangleleft":"","trianglelefteq":"","triangleq":"","triangleright":"","trianglerighteq":"","tridot":"","trie":"","triminus":"","TripleDot":"","triplus":"","trisb":"","tritime":"","trpezium":"","Tscr":"","tscr":"","TScy":"","tscy":"","TSHcy":"","tshcy":"","Tstrok":"","tstrok":"","twixt":"","twoheadleftarrow":"","twoheadrightarrow":"","Uacute":"","uacute":"","uarr":"","Uarr":"","uArr":"","Uarrocir":"","Ubrcy":"","ubrcy":"","Ubreve":"","ubreve":"","Ucirc":"","ucirc":"","Ucy":"","ucy":"","udarr":"","Udblac":"","udblac":"","udhar":"","ufisht":"","Ufr":"","ufr":"","Ugrave":"","ugrave":"","uHar":"","uharl":"","uharr":"","uhblk":"","ulcorn":"","ulcorner":"","ulcrop":"","ultri":"","Umacr":"","umacr":"","uml":"","UnderBar":"_","UnderBrace":"","UnderBracket":"","UnderParenthesis":"","Union":"","UnionPlus":"","Uogon":"","uogon":"","Uopf":"","uopf":"","UpArrowBar":"","uparrow":"","UpArrow":"","Uparrow":"","UpArrowDownArrow":"","updownarrow":"","UpDownArrow":"","Updownarrow":"","UpEquilibrium":"","upharpoonleft":"","upharpoonright":"","uplus":"","UpperLeftArrow":"","UpperRightArrow":"","upsi":"","Upsi":"","upsih":"","Upsilon":"","upsilon":"","UpTeeArrow":"","UpTee":"","upuparrows":"","urcorn":"","urcorner":"","urcrop":"","Uring":"","uring":"","urtri":"","Uscr":"","uscr":"","utdot":"","Utilde":"","utilde":"","utri":"","utrif":"","uuarr":"","Uuml":"","uuml":"","uwangle":"","vangrt":"","varepsilon":"","varkappa":"","varnothing":"","varphi":"","varpi":"","varpropto":"","varr":"","vArr":"","varrho":"","varsigma":"","varsubsetneq":"","varsubsetneqq":"","varsupsetneq":"","varsupsetneqq":"","vartheta":"","vartriangleleft":"","vartriangleright":"","vBar":"","Vbar":"","vBarv":"","Vcy":"","vcy":"","vdash":"","vDash":"","Vdash":"","VDash":"","Vdashl":"","veebar":"","vee":"","Vee":"","veeeq":"","vellip":"","verbar":"|","Verbar":"","vert":"|","Vert":"","VerticalBar":"","VerticalLine":"|","VerticalSeparator":"","VerticalTilde":"","VeryThinSpace":"","Vfr":"","vfr":"","vltri":"","vnsub":"","vnsup":"","Vopf":"","vopf":"","vprop":"","vrtri":"","Vscr":"","vscr":"","vsubnE":"","vsubne":"","vsupnE":"","vsupne":"","Vvdash":"","vzigzag":"","Wcirc":"","wcirc":"","wedbar":"","wedge":"","Wedge":"","wedgeq":"","weierp":"","Wfr":"","wfr":"","Wopf":"","wopf":"","wp":"","wr":"","wreath":"","Wscr":"","wscr":"","xcap":"","xcirc":"","xcup":"","xdtri":"","Xfr":"","xfr":"","xharr":"","xhArr":"","Xi":"","xi":"","xlarr":"","xlArr":"","xmap":"","xnis":"","xodot":"","Xopf":"","xopf":"","xoplus":"","xotime":"","xrarr":"","xrArr":"","Xscr":"","xscr":"","xsqcup":"","xuplus":"","xutri":"","xvee":"","xwedge":"","Yacute":"","yacute":"","YAcy":"","yacy":"","Ycirc":"","ycirc":"","Ycy":"","ycy":"","yen":"","Yfr":"","yfr":"","YIcy":"","yicy":"","Yopf":"","yopf":"","Yscr":"","yscr":"","YUcy":"","yucy":"","yuml":"","Yuml":"","Zacute":"","zacute":"","Zcaron":"","zcaron":"","Zcy":"","zcy":"","Zdot":"","zdot":"","zeetrf":"","ZeroWidthSpace":"","Zeta":"","zeta":"","zfr":"","Zfr":"","ZHcy":"","zhcy":"","zigrarr":"","zopf":"","Zopf":"","Zscr":"","zscr":"","zwj":"","zwnj":""}')},2061:function(e){"use strict";e.exports=JSON.parse('{"Aacute":"","aacute":"","Acirc":"","acirc":"","acute":"","AElig":"","aelig":"","Agrave":"","agrave":"","amp":"&","AMP":"&","Aring":"","aring":"","Atilde":"","atilde":"","Auml":"","auml":"","brvbar":"","Ccedil":"","ccedil":"","cedil":"","cent":"","copy":"","COPY":"","curren":"","deg":"","divide":"","Eacute":"","eacute":"","Ecirc":"","ecirc":"","Egrave":"","egrave":"","ETH":"","eth":"","Euml":"","euml":"","frac12":"","frac14":"","frac34":"","gt":">","GT":">","Iacute":"","iacute":"","Icirc":"","icirc":"","iexcl":"","Igrave":"","igrave":"","iquest":"","Iuml":"","iuml":"","laquo":"","lt":"<","LT":"<","macr":"","micro":"","middot":"","nbsp":"","not":"","Ntilde":"","ntilde":"","Oacute":"","oacute":"","Ocirc":"","ocirc":"","Ograve":"","ograve":"","ordf":"","ordm":"","Oslash":"","oslash":"","Otilde":"","otilde":"","Ouml":"","ouml":"","para":"","plusmn":"","pound":"","quot":"\\"","QUOT":"\\"","raquo":"","reg":"","REG":"","sect":"","shy":"","sup1":"","sup2":"","sup3":"","szlig":"","THORN":"","thorn":"","times":"","Uacute":"","uacute":"","Ucirc":"","ucirc":"","Ugrave":"","ugrave":"","uml":"","Uuml":"","uuml":"","Yacute":"","yacute":"","yen":"","yuml":""}')},5529:function(e){"use strict";e.exports=JSON.parse('{"amp":"&","apos":"\'","gt":">","lt":"<","quot":"\\""}')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(7378),t=n(1542);function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}var o=n(3615),s=n.n(o);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function l(e){return"/"===e.charAt(0)}function c(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}var u=function(e,t){if(!e)throw new Error("Invariant failed")};function h(e){return"/"===e.charAt(0)?e:"/"+e}function d(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function f(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function p(e){var t=e.pathname,n=e.search,r=e.hash,i=t||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i}function m(e,t,n,r){var i;"string"==typeof e?(i=function(e){var t=e||"/",n="",r="",i=t.indexOf("#");-1!==i&&(r=t.substr(i),t=t.substr(0,i));var o=t.indexOf("?");return-1!==o&&(n=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e),i.state=t):(void 0===(i=a({},e)).pathname&&(i.pathname=""),i.search?"?"!==i.search.charAt(0)&&(i.search="?"+i.search):i.search="",i.hash?"#"!==i.hash.charAt(0)&&(i.hash="#"+i.hash):i.hash="",void 0!==t&&void 0===i.state&&(i.state=t));try{i.pathname=decodeURI(i.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+i.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(i.key=n),r?i.pathname?"/"!==i.pathname.charAt(0)&&(i.pathname=function(e,t){void 0===t&&(t="");var n,r=e&&e.split("/")||[],i=t&&t.split("/")||[],o=e&&l(e),s=t&&l(t),a=o||s;if(e&&l(e)?i=r:r.length&&(i.pop(),i=i.concat(r)),!i.length)return"/";if(i.length){var u=i[i.length-1];n="."===u||".."===u||""===u}else n=!1;for(var h=0,d=i.length;d>=0;d--){var f=i[d];"."===f?c(i,d):".."===f?(c(i,d),h++):h&&(c(i,d),h--)}if(!a)for(;h--;h)i.unshift("..");!a||""===i[0]||i[0]&&l(i[0])||i.unshift("");var p=i.join("/");return n&&"/"!==p.substr(-1)&&(p+="/"),p}(i.pathname,r.pathname)):i.pathname=r.pathname:i.pathname||(i.pathname="/"),i}function g(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,i){if(null!=e){var o="function"==typeof e?e(t,n):e;"string"==typeof o?"function"==typeof r?r(o,i):i(!0):i(!1!==o)}else i(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}var y=!("undefined"==typeof window||!window.document||!window.document.createElement);function v(e,t){t(window.confirm(e))}var b="popstate",w="hashchange";function x(){try{return window.history.state||{}}catch(e){return{}}}function E(e){void 0===e&&(e={}),y||u(!1);var t,n=window.history,r=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,i=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e,s=o.forceRefresh,l=void 0!==s&&s,c=o.getUserConfirmation,E=void 0===c?v:c,_=o.keyLength,S=void 0===_?6:_,C=e.basename?f(h(e.basename)):"";function T(e){var t=e||{},n=t.key,r=t.state,i=window.location,o=i.pathname+i.search+i.hash;return C&&(o=d(o,C)),m(o,r,n)}function O(){return Math.random().toString(36).substr(2,S)}var P=g();function A(e){a(U,e),U.length=n.length,P.notifyListeners(U.location,U.action)}function k(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||L(T(e.state))}function M(){L(T(x()))}var N=!1;function L(e){N?(N=!1,A()):P.confirmTransitionTo(e,"POP",E,(function(t){t?A({action:"POP",location:e}):function(e){var t=U.location,n=I.indexOf(t.key);-1===n&&(n=0);var r=I.indexOf(e.key);-1===r&&(r=0);var i=n-r;i&&(N=!0,j(i))}(e)}))}var R=T(x()),I=[R.key];function D(e){return C+p(e)}function j(e){n.go(e)}var F=0;function z(e){1===(F+=e)&&1===e?(window.addEventListener(b,k),i&&window.addEventListener(w,M)):0===F&&(window.removeEventListener(b,k),i&&window.removeEventListener(w,M))}var B=!1,U={length:n.length,action:"POP",location:R,createHref:D,push:function(e,t){var i="PUSH",o=m(e,t,O(),U.location);P.confirmTransitionTo(o,i,E,(function(e){if(e){var t=D(o),s=o.key,a=o.state;if(r)if(n.pushState({key:s,state:a},null,t),l)window.location.href=t;else{var c=I.indexOf(U.location.key),u=I.slice(0,c+1);u.push(o.key),I=u,A({action:i,location:o})}else window.location.href=t}}))},replace:function(e,t){var i="REPLACE",o=m(e,t,O(),U.location);P.confirmTransitionTo(o,i,E,(function(e){if(e){var t=D(o),s=o.key,a=o.state;if(r)if(n.replaceState({key:s,state:a},null,t),l)window.location.replace(t);else{var c=I.indexOf(U.location.key);-1!==c&&(I[c]=o.key),A({action:i,location:o})}else window.location.replace(t)}}))},go:j,goBack:function(){j(-1)},goForward:function(){j(1)},block:function(e){void 0===e&&(e=!1);var t=P.setPrompt(e);return B||(z(1),B=!0),function(){return B&&(B=!1,z(-1)),t()}},listen:function(e){var t=P.appendListener(e);return z(1),function(){z(-1),t()}}};return U}var _=1073741823,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:{};function C(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,r){e=n,t.forEach((function(t){return t(e,r)}))}}}var T=e.createContext||function(t,n){var r,o,a,l="__create-react-context-"+((S[a="__global_unique_id__"]=(S[a]||0)+1)+"__"),c=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).emitter=C(t.props.value),t}i(t,e);var r=t.prototype;return r.getChildContext=function(){var e;return(e={})[l]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var t,r=this.props.value,i=e.value;((o=r)===(s=i)?0!==o||1/o==1/s:o!=o&&s!=s)?t=0:(t="function"==typeof n?n(r,i):_,0!=(t|=0)&&this.emitter.set(e.value,t))}var o,s},r.render=function(){return this.props.children},t}(e.Component);c.childContextTypes=((r={})[l]=s().object.isRequired,r);var u=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).state={value:t.getValue()},t.onUpdate=function(e,n){0!=((0|t.observedBits)&n)&&t.setState({value:t.getValue()})},t}i(n,e);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?_:t},r.componentDidMount=function(){this.context[l]&&this.context[l].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?_:e},r.componentWillUnmount=function(){this.context[l]&&this.context[l].off(this.onUpdate)},r.getValue=function(){return this.context[l]?this.context[l].get():t},r.render=function(){return function(e){return Array.isArray(e)?e[0]:e}(this.props.children)(this.state.value)},n}(e.Component);return u.contextTypes=((o={})[l]=s().object,o),{Provider:c,Consumer:u}},O=T,P=n(405),A=n.n(P);function k(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n(9185),n(5839);var M=function(e){var t=O();return t.displayName=e,t},N=M("Router-History"),L=function(e){var t=O();return t.displayName=e,t},R=L("Router"),I=function(t){function n(e){var n;return(n=t.call(this,e)||this).state={location:e.history.location},n._isMounted=!1,n._pendingLocation=null,e.staticContext||(n.unlisten=e.history.listen((function(e){n._isMounted?n.setState({location:e}):n._pendingLocation=e}))),n}i(n,t),n.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var r=n.prototype;return r.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},r.componentWillUnmount=function(){this.unlisten&&this.unlisten()},r.render=function(){return e.createElement(R.Provider,{value:{history:this.props.history,location:this.state.location,match:n.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},e.createElement(N.Provider,{children:this.props.children||null,value:this.props.history}))},n}(e.Component);e.Component,e.Component;var D={},j=0;function F(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,i=n.exact,o=void 0!==i&&i,s=n.strict,a=void 0!==s&&s,l=n.sensitive,c=void 0!==l&&l;return[].concat(r).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var r=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=D[n]||(D[n]={});if(r[e])return r[e];var i=[],o={regexp:A()(e,i,t),keys:i};return j<1e4&&(r[e]=o,j++),o}(n,{end:o,strict:a,sensitive:c}),i=r.regexp,s=r.keys,l=i.exec(e);if(!l)return null;var u=l[0],h=l.slice(1),d=e===u;return o&&!d?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:d,params:s.reduce((function(e,t,n){return e[t.name]=h[n],e}),{})}}),null)}var z=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement(R.Consumer,null,(function(n){n||u(!1);var r=t.props.location||n.location,i=a({},n,{location:r,match:t.props.computedMatch?t.props.computedMatch:t.props.path?F(r.pathname,t.props):n.match}),o=t.props,s=o.children,l=o.component,c=o.render;return Array.isArray(s)&&0===s.length&&(s=null),e.createElement(R.Provider,{value:i},i.match?s?"function"==typeof s?s(i):s:l?e.createElement(l,i):c?c(i):null:"function"==typeof s?s(i):null)}))},n}(e.Component);e.Component;var B=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement(R.Consumer,null,(function(n){n||u(!1);var r,i,o=t.props.location||n.location;return e.Children.forEach(t.props.children,(function(t){if(null==i&&e.isValidElement(t)){r=t;var s=t.props.path||t.props.from;i=s?F(o.pathname,a({},t.props,{path:s})):n.match}})),i?e.cloneElement(r,{location:o,computedMatch:i}):null}))},n}(e.Component);e.useContext;var U=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).history=E(e.props),e}return i(n,t),n.prototype.render=function(){return e.createElement(I,{history:this.history,children:this.props.children})},n}(e.Component);e.Component;var V=function(e,t){return"function"==typeof e?e(t):e},H=function(e,t){return"string"==typeof e?m(e,null,null,t):e},q=function(e){return e},W=e.forwardRef;void 0===W&&(W=q);var G=W((function(t,n){var r=t.innerRef,i=t.navigate,o=t.onClick,s=k(t,["innerRef","navigate","onClick"]),l=s.target,c=a({},s,{onClick:function(e){try{o&&o(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||l&&"_self"!==l||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),i())}});return c.ref=q!==W&&n||r,e.createElement("a",c)})),$=W((function(t,n){var r=t.component,i=void 0===r?G:r,o=t.replace,s=t.to,l=t.innerRef,c=k(t,["component","replace","to","innerRef"]);return e.createElement(R.Consumer,null,(function(t){t||u(!1);var r=t.history,h=H(V(s,t.location),t.location),d=h?r.createHref(h):"",f=a({},c,{href:d,navigate:function(){var e=V(s,t.location);(o?r.replace:r.push)(e)}});return q!==W?f.ref=n||l:f.innerRef=l,e.createElement(i,f)}))})),Y=function(e){return e},X=e.forwardRef;void 0===X&&(X=Y);var K=X((function(t,n){var r=t["aria-current"],i=void 0===r?"page":r,o=t.activeClassName,s=void 0===o?"active":o,l=t.activeStyle,c=t.className,h=t.exact,d=t.isActive,f=t.location,p=t.sensitive,m=t.strict,g=t.style,y=t.to,v=t.innerRef,b=k(t,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return e.createElement(R.Consumer,null,(function(t){t||u(!1);var r=f||t.location,o=H(V(y,r),r),w=o.pathname,x=w&&w.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),E=x?F(r.pathname,{path:x,exact:h,sensitive:p,strict:m}):null,_=!!(d?d(E,r):E),S=_?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(c,s):c,C=_?a({},g,{},l):g,T=a({"aria-current":_&&i||null,className:S,style:C,to:o},b);return Y!==X?T.ref=n||v:T.innerRef=v,e.createElement($,T)}))})),Z=function(){return e.createElement("div",{className:"bg-white ta-center p-2 f-1 flex-col"},e.createElement("div",{className:"p-1"},"404 page not found"),e.createElement(K,{to:"/"},"Home"))},J="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",Q="M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16",ee="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z",te="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z",ne="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z",re="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z",ie="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",oe="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",se="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",ae="M6 12.45V9.64C7.47 10.47 9.61 11 12 11S16.53 10.47 18 9.64V12.03C18.17 12 18.33 12 18.5 12C19 12 19.5 12.07 20 12.18V7C20 4.79 16.42 3 12 3S4 4.79 4 7V17C4 19.21 7.59 21 12 21C12.17 21 12.33 21 12.5 21C12.24 20.37 12.09 19.7 12.03 19L12 19C8.13 19 6 17.5 6 17V14.77C7.61 15.55 9.72 16 12 16C12.17 16 12.34 16 12.5 16C12.85 15.18 13.34 14.46 13.95 13.86C13.32 13.95 12.67 14 12 14C9.58 14 7.3 13.4 6 12.45M12 5C15.87 5 18 6.5 18 7S15.87 9 12 9 6 7.5 6 7 8.13 5 12 5M18 18.5L19.77 16.73C19.32 16.28 18.69 16 18 16C16.62 16 15.5 17.12 15.5 18.5S16.62 21 18 21C18.82 21 19.54 20.61 20 20H21.71C21.12 21.47 19.68 22.5 18 22.5C15.79 22.5 14 20.71 14 18.5S15.79 14.5 18 14.5C19.11 14.5 20.11 14.95 20.83 15.67L22 14.5V18.5H18Z",le="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",ce="M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z",ue="M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M12,12L16,16H13.5V19H10.5V16H8L12,12Z",he="M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z",de="M18.5,4L19.66,8.35L18.7,8.61C18.25,7.74 17.79,6.87 17.26,6.43C16.73,6 16.11,6 15.5,6H13V16.5C13,17 13,17.5 13.33,17.75C13.67,18 14.33,18 15,18V19H9V18C9.67,18 10.33,18 10.67,17.75C11,17.5 11,17 11,16.5V6H8.5C7.89,6 7.27,6 6.74,6.43C6.21,6.87 5.75,7.74 5.3,8.61L4.34,8.35L5.5,4H18.5Z",fe="M15.6,5.29C14.5,5.19 13.53,6 13.43,7.11L13.18,10H16V12H13L12.56,17.07C12.37,19.27 10.43,20.9 8.23,20.7C6.92,20.59 5.82,19.86 5.17,18.83L6.67,17.33C6.91,18.07 7.57,18.64 8.4,18.71C9.5,18.81 10.47,18 10.57,16.89L11,12H8V10H11.17L11.44,6.93C11.63,4.73 13.57,3.1 15.77,3.3C17.08,3.41 18.18,4.14 18.83,5.17L17.33,6.67C17.09,5.93 16.43,5.36 15.6,5.29Z",pe="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,19H15V21H19A2,2 0 0,0 21,19V15H19M19,3H15V5H19V9H21V5A2,2 0 0,0 19,3M5,5H9V3H5A2,2 0 0,0 3,5V9H5M5,15H3V19A2,2 0 0,0 5,21H9V19H5V15Z",me="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",ge="M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z",ye="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z",ve="M14.06,9L15,9.94L5.92,19H5V18.08L14.06,9M17.66,3C17.41,3 17.15,3.1 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18.17,3.09 17.92,3 17.66,3M14.06,6.19L3,17.25V21H6.75L17.81,9.94L14.06,6.19Z",be="M8,5.14V19.14L19,12.14L8,5.14Z",we="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",xe="M13.8 22H5C3.3 22 2 20.7 2 19V18H13.1C13 18.3 13 18.7 13 19C13 20.1 13.3 21.1 13.8 22M13.8 16H5V5C5 3.3 6.3 2 8 2H19C20.7 2 22 3.3 22 5V6H20V5C20 4.4 19.6 4 19 4S18 4.4 18 5V13.1C16.2 13.4 14.7 14.5 13.8 16M8 8H15V6H8V8M8 12H14V10H8V12M17 16V22L22 19L17 16Z",Ee="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4M9,9V15H15V9",_e="M5,4H19A2,2 0 0,1 21,6V18A2,2 0 0,1 19,20H5A2,2 0 0,1 3,18V6A2,2 0 0,1 5,4M5,8V12H11V8H5M13,8V12H19V8H13M5,14V18H11V14H5M13,14V18H19V14H13Z",Se="M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.08 20.21,11.08 20.42,11.3L21.7,12.58C21.92,12.79 21.92,13.14 21.7,13.35M12,18.94L18.07,12.88L20.12,14.93L14.06,21H12V18.94M4,2H18A2,2 0 0,1 20,4V8.17L16.17,12H12V16.17L10.17,18H4A2,2 0 0,1 2,16V4A2,2 0 0,1 4,2M4,6V10H10V6H4M12,6V10H18V6H12M4,12V16H10V12H4Z",Ce="M16.59,5.41L15.17,4L12,7.17L8.83,4L7.41,5.41L12,10M7.41,18.59L8.83,20L12,16.83L15.17,20L16.58,18.59L12,14L7.41,18.59Z",Te="M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z",Oe="M4 5V18H21V5H4M14 7V16H11V7H14M6 7H9V16H6V7M19 16H16V7H19V16Z",Pe=n(9823),Ae=n.n(Pe),ke=(e,t)=>("string"==typeof t&&(t=t.split(".")),t.reduce(((e,t)=>e&&"undefined"!==e[t]?e[t]:void 0),e));function Me(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];if(!t.length&&!n.length)return{};var r=Object.keys(e);if(e&&r.length){var i={};return r.map((r=>{(t.length&&t.includes(r)||n.length&&!n.includes(r))&&(i[r]=e[r])})),i}return e}function Ne(e){for(var t in e)return!1;return!1}function Le(e,t){var n,r=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(n=r.length-1;0<n&&!(e>=r[n].value);n--);return(e/r[n].value).toFixed(t).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+r[n].symbol}function Re(e){if(e&&"string"==typeof e){var t,n=[];return e.split("").map(((r,i)=>{var o=r.match(/[A-Za-z]/)?"c":r.match(/[0-9.]/)?"n":"s",s={idx:i,len:1,val:r,type:o,decimalPlaces:0};t?t.type===o?(t.len=i-t.idx+1,t.val+=r):(n.push(t),t=s):t=s,i===e.length-1&&(t.len=i-t.idx+1,n.push(t))})),n.map((e=>("n"===e.type&&e.val.includes(".")&&(e.decimalPlaces=e.len-1-e.val.indexOf(".")),e)))}return[]}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Ie(Object(t),!0).forEach((function(n){je(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ie(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Fe extends e.Component{constructor(){super(...arguments),je(this,"scrollIntoView",(()=>{var{error:e}=this.props;e&&this.ref&&this.ref.scrollIntoView&&(this.ref.scrollIntoViewIfNeeded?this.ref.scrollIntoViewIfNeeded():this.ref.scrollIntoView())}))}componentDidMount(){this.scrollIntoView()}componentDidUpdate(){this.scrollIntoView()}render(){var{error:t,className:n="",style:r={},pre:i=!1,findMsg:o=!1,withIcon:s=!1}=this.props,a=e=>{var t="";return"string"==typeof e?t=e:Array.isArray(e)?t=a(e):e&&!Ne(e)&&Object.keys(e).length?(o&&(t=ke(e,"err.err_msg")||ke(e,"err.constraint")||ke(e,"err.txt")||e.err_msg||JSON.stringify(e)),!t&&(t=Object.keys(e).map((t=>"".concat(t,": ").concat(JSON.stringify(e[t],null,2)))).join("\n"))):t=ke(e,"toString")?e.toString():JSON.stringify(e),"string"==typeof t&&t.length&&((t=t.trim()).startsWith('"')&&t.endsWith('"')&&(t=t.slice(1,-1)),t.toLowerCase().startsWith("error: ")&&(t=t.slice(7)),t=t.replace(/\\"/g,'"')),t};return e.createElement("div",{ref:e=>{e&&(this.ref=e)},className:"f-1 flex-row ai-start text-red-800 p-1 o-auto min-w-0 min-h-0 o-auto "+(i?" ws-pre ":"")+n,style:De(De({whiteSpace:"pre-line",textAlign:"left",display:t?"flex":"none"},r),{},{minWidth:"150px"})},(a(t)+"").slice(0,300),s&&e.createElement(Ae(),{size:2,className:"ml-1",path:J}))}}class ze extends e.Component{constructor(){super(...arguments),je(this,"state",{error:"",errorInfo:""})}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){var{error:t,errorInfo:n}=this.state,r=ke(this.props,"children.type.name"),i={error:t,stack:ke(n,"componentStack")||n};return r&&(i=De({component:r},i)),t?e.createElement(Fe,{error:i}):this.props.children}}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Be(Object(t),!0).forEach((function(n){qe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Be(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Ve(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function He(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Ve(a,r,i,o,s,"next",e)}function s(e){Ve(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class We extends e.Component{constructor(){var e;super(...arguments),e=this,qe(this,"state",{}),qe(this,"d",{}),qe(this,"componentDidUpdate",function(){var t=He((function*(t,n){var r,i;Object.keys(Ue(Ue({},t),e.props)).map((n=>{t[n]!==e.props[n]&&(r=Ue(Ue({},r),{[n]:e.props[n]}))})),Object.keys(Ue(Ue({},n),e.state)).map((t=>{n[t]!==e.state[t]&&(i=Ue(Ue({},i),{[t]:e.state[t]}))}));try{(i||r)&&(yield e.setDeltaPS(r,i)),yield e.onUpdated(t,n)}catch(e){console.error("onUpdated error",e)}}));return function(){return t.apply(this,arguments)}}()),qe(this,"setDeltaPS",((e,t)=>{this.p=Ue(Ue({},this.p),e),this.s=Ue(Ue({},this.s),t),this._onDelta(e,t,void 0)})),qe(this,"_onDelta",function(){var t=He((function*(t,n,r){try{yield e.onDelta(t,n,r);var i=Ue(Ue(Ue({},t),n),r);yield e.onDeltaCombined(i,Object.keys(i))}catch(e){throw e}}));return function(){return t.apply(this,arguments)}}())}componentDidMount(){this.mounted=!0,this.onMount();try{this.setDeltaPS(Ue({},this.props),Ue({},this.state))}catch(e){console.error("setDeltaPS error",e)}}onMount(){}componentWillUnmount(){this.mounted=!1,this.onUnmount()}onUnmount(){}onUpdated(){}setData(e,t){this.d=Ue(Ue({},this.d),e);try{this._onDelta(void 0,void 0,t||e)}catch(e){console.error("onDelta error",e)}}onDelta(){}onDeltaCombined(){}setState(e,t){if(this.mounted)return super.setState(e,t)}}function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Ge(Object(t),!0).forEach((function(n){Ye(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ge(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xe extends We{constructor(){super(...arguments),Ye(this,"state",{ready:!1}),Ye(this,"mounted",!1),Ye(this,"onDeltaCombined",((e,t)=>{t.includes("show")}))}onMount(){if(this.mounted=!0,!("show"in this.props)){var{delay:e=500}=this.props;setTimeout((()=>{this.mounted&&this.setState({ready:!0})}),e)}}render(){var{style:t={},className:n="",variant:r,sizePx:i=30}=this.props,{show:o=this.state.ready}=this.props,s=i+"px",a={opacity:o?1:1e-4};return"top-bar"===r?e.createElement("div",{style:$e($e({position:"absolute",zIndex:2,top:0,left:0,right:0,width:"100%",height:"6px"},t),a),className:"top-bar-loader "+n}):"cover"===r?e.createElement(e.Fragment,null,e.createElement("div",{style:$e($e($e({position:"absolute",cursor:"wait",zIndex:2,inset:0,width:"100%",height:"100%"},t),a),{},{background:"rgb(255 255 255 / 73%)"}),className:"cover-loader "+n})):e.createElement("div",{style:$e($e({},t),{},{width:s,height:s,opacity:o?1:0}),className:"spinner-loader "+n},e.createElement("svg",{className:"spinner",width:s,height:s,viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},e.createElement("circle",{className:"path",fill:"none",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"})))}}function Ke(){return Ke=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ke.apply(this,arguments)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Ze(Object(t),!0).forEach((function(n){Qe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ze(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class et extends We{constructor(){super(...arguments),Qe(this,"state",{show:!0})}render(){var{_ref:t,iconPath:n,children:r,className:i="",style:o={},disabledInfo:s,title:a,onClick:l,loading:c=!1,color:u,fadeIn:h,exactClassName:d,variant:f}=this.props,{show:p}=this.state,m={},g=s||c,y=d||"",{size:v}=this.props;d||(y="f-0 flex-row ai-center bg-transparent bg-active-hover",!v&&window.isMobileDevice&&(v="small"),r?("outline"===f&&(m={border:"1px solid"},"small"===v&&(m.padding="6px 8px")),"large"===v&&(m.padding="12px 16px")):(m={padding:"8px"},"outline"===f&&(m={padding:"0.5em"}),"small"===v&&(m.padding="4px")),y+=" ".concat("filled"===f?"bg":"text").concat("danger"===u?"-red-600":"warn"===u?"-yellow-500":"action"===u?"-blue-500":"inherit"===u?"-inherit":"-gray-500"," "),u&&"filled"===f&&(y+="text-white ")),y+=(h?" fade-in ":"")+(n&&!r?"  ":"rounded")+(g?" disabled ":" ")+i;var b=Me(this.props,[],["iconPath","children","disabledInfo","title","onClick","loading","color","fadeIn","_ref","ref","style","size","exactClassName"]);return e.createElement("button",Ke({},b,{onClick:g||c?void 0:l,title:s||a,ref:t,style:Je(Je({},m),{},{lineHeight:"1em",width:"fit-content"},o),onMouseDown:e=>e.preventDefault(),className:y}),!n||c?null:e.createElement(Ae(),{path:n,size:"small"===v?.75:1,className:r?"mr-p5":""}),c?e.createElement(Xe,{className:"mr-p5"}):null,e.createElement("div",{style:c?{opacity:.5}:{}},r))}}function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?tt(Object(t),!0).forEach((function(n){rt(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class it extends e.Component{render(){var t=nt({},this.props),{id:n,className:r="",label:i,checked:o,style:s={},onChange:a,readOnly:l,title:c}=t,u=e.createElement("label",{className:"flex-row-wrap relative b b-gray-300 checkbox pointer ai-center jc-center w-fit focusable ",tabIndex:0,style:{padding:"3px",borderRadius:"3px",position:"relative"}},e.createElement("input",{id:n,className:"hidden",type:"checkbox",checked:o,onChange:a?e=>{a(e,e.target.checked)}:void 0,readOnly:l}),e.createElement(Ae(),{path:ne,size:.75,className:"text-blue-500",style:{opacity:o?1:0}}));return e.createElement("label",{style:nt({},s),htmlFor:n,className:"flex-row-wrap ai-center pointer "+r,title:c},u,i?e.createElement("div",{className:"ml-1 noselect"},i):null)}}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ot(Object(t),!0).forEach((function(n){at(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ot(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lt extends e.Component{render(){var{onClick:t,children:n,style:r}=this.props;return e.createElement("div",{style:st({display:"block",position:"fixed",backgroundColor:"rgb(0 0 0 / .5)",zIndex:0},r),className:"fixed noselect inset-0 w-full, h-full",ref:e=>{e&&(this.clickCatch=e)},onClick:e=>{e.target===this.clickCatch&&t(e)},onContextMenu:e=>(e.preventDefault(),e.target===this.clickCatch&&t(e),!1)},n)}}function ct(){return ct=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ct.apply(this,arguments)}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ut(Object(t),!0).forEach((function(n){dt(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ut(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ft=document.getElementById("modal-root");ft||((ft=document.createElement("div")).setAttribute("id","modal-root"),document.body.appendChild(ft));class pt extends We{constructor(){super(...arguments),dt(this,"el",document.createElement("div")),dt(this,"state",{loaded:!1,stateStyle:{opacity:0},collapsed:!1}),dt(this,"checkFocus",(e=>{var{onClose:t,focusTrap:n=!0,onKeyDown:r}=this.props;if(r&&r(e),n&&"Tab"===e.key){var i,o,s=this.el.querySelector(".popup-actual-content").querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]");e.shiftKey&&document.activeElement===s[0]&&(e.preventDefault(),s.length&&(null===(i=s[s.length-1])||void 0===i||i.focus())),e.shiftKey||document.activeElement!==s[s.length-1]&&this.el.contains(document.activeElement)||(e.preventDefault(),s.length&&(null===(o=s[0])||void 0===o||o.focus()))}"Escape"===e.key&&t()})),dt(this,"position",{x:void 0,y:void 0}),dt(this,"checkPosition",(()=>{if(this.mounted){var{anchorEl:e,anchorXY:t,positioning:n}=this.props;if("as-is"===n)this.setState({stateStyle:{opacity:1,zIndex:2,position:"fixed",clipPath:"circle(150% at 0% 0%)"}});else{var r,i=900<window.innerWidth?10:0,o=this.ref.getBoundingClientRect(),s=window.innerWidth<o.width?0:i,a=window.innerHeight<o.height?0:i,l=0,c=0,u=0,h=0;t?(l=t.x,c=t.y):e?(l=(r=e.getBoundingClientRect()).x,c=r.y,h=r.height,u=r.width):(l=(window.innerWidth-o.width)/2,c=(window.innerHeight-o.height)/2,n&&"top-center"!==n&&console.warn("Popup positioning provided without an anchorEl or anchorXY"));var d=l,f=Math.max(0,r?r.x:t?t.x:l),p=Math.max(0,r?r.x+(Math.max(o.width,r.width)-Math.min(o.width,r.width))/2:t?t.x-o.width/2:l),m=c;if("top-center"===n)m=50,d=.5*(window.document.body.offsetWidth-o.width);else if("top-fill"===n)m=c,d=f;else if("beneath-fill"===n)m=c+h,d=p;else if("beneath-center"===n)m=c+h,d=f;else if("beneath-left"===n||"beneath-left-minfill"===n)m=c+h,d=f;else if("beneath-right"===n)m=c+h,d=l+u-o.width;else if("tooltip"===n)m=c+a,d=l-s-o.width;else if("inside-top-center"===n||"above-center"===n){var g;d=p,m=(null===(g=r)||void 0===g?void 0:g.y)||0,"above-center"===n&&(m=c-o.height)}if(d+o.width+s>window.innerWidth?d=Math.max(s,window.innerWidth-o.width-s):0>d&&(d=s),m+o.height+a>window.innerHeight){if(m=Math.max(a,window.innerHeight-o.height-a),d===s&&m>a){var y=c-a-o.height;0<y&&(m=y)}}else 0>m&&(m=a);if(this.position.x!==d||this.position.y!==m){var v,b;if(this.position={x:d,y:m},!this.mounted||!this.el.isConnected)return;var w,x={stateStyle:{opacity:1,zIndex:2,left:"".concat(Math.round(d),"px"),position:"fixed",top:"".concat(Math.round(m),"px"),clipPath:"circle(150% at 0% 0%)"}};null!=n&&n.endsWith("-minfill")&&null!==(v=r)&&void 0!==v&&v.width&&o.width<(null===(b=r)||void 0===b?void 0:b.width)?x.stateStyle.width="".concat(null===(w=r)||void 0===w?void 0:w.width,"px"):null!=n&&n.endsWith("-fill")&&(x.stateStyle.width="".concat(u,"px")),this.setState(x)}}}}))}onMount(){this.el.classList.add("w-fit","h-fit"),ft&&ft.appendChild(this.el),setTimeout((()=>{this.checkPosition()}),50),window.document.body.addEventListener("keydown",this.checkFocus),this.rObserver=new ResizeObserver((()=>{this.checkPosition()})),this.rObserver.observe(this.ref)}onUnmount(){if(ft)try{ft.removeChild(this.el)}catch(e){console.error(e)}window.document.body.removeEventListener("keydown",this.checkFocus),this.rObserver.unobserve(this.ref)}onUpdated(){setTimeout((()=>{this.checkPosition()}),50)}render(){var{onClose:n=(()=>{}),positioning:r,title:i,content:o,children:s,footerButtons:a=[],clickCatchStyle:l={},rootStyle:c={},onClickClose:u,contentClassName:h="p-1",footer:d,contentStyle:f={},collapsible:p}=this.props,{stateStyle:m,collapsed:g=!1}=this.state,y=()=>{this.setState({collapsed:!g})},v=a.filter((e=>e)),b={};"tooltip"===r&&(b={pointerEvents:"none",touchAction:"none"});var w=ht(ht(ht({maxWidth:"99vw",maxHeight:"100vh",outline:"none",clipPath:"circle(1% at 50% 10%)",zIndex:1,padding:0,borderRadius:".5em"},b),m),c),x=e.createElement(e.Fragment,null,n?e.createElement(lt,{style:ht({position:"fixed",zIndex:2},l),className:"absolute inset-0 bg-gray-500 opacity-75 flex-col",onClick:()=>{n()}}):null,e.createElement("div",{className:"card m-auto bg-white flex-col shadow-xl transform transition-all ",ref:e=>{e&&(this.ref=e)},onClick:u&&n?()=>{n()}:void 0,style:ht(ht({},w),{},{boxSizing:"content-box"}),role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},e.createElement("div",{className:"w-full min-h-0 text-center flex-col f-1"},i&&n?e.createElement("div",{className:"flex-row ai-center"},p&&e.createElement(et,{className:"f-0",onClick:y,iconPath:g?Te:Ce,title:"Collapse/Expand changes"}),e.createElement("h4",{className:"f-1 text-lg pl-p5 noselect font-medium text-gray-900 o-hidden text-ellipsis ta-left "+(p?" pl-0 pointer ":" "),id:"modal-headline",onClick:p?y:void 0,style:ht(ht({},window.isMobileDevice?{margin:"8px",whiteSpace:"nowrap"}:{}),p?{paddingLeft:0}:{})},i),e.createElement(et,{className:"f-0",iconPath:oe,onClick:()=>n()})):null,!g&&e.createElement("div",{className:"flex-col f-1 min-h-0 popup-actual-content "+h,style:ht({borderRadius:".5em"},f)},o||s),d?e.createElement("div",{className:"popup-footer f-0 flex-row-wrap"},d):null),v.length?e.createElement("div",{className:"bg-gray-50 flex-row-wrap x-spacers-1 jc-around "+(window.isMobileDevice?" p-p5 ":"p-1 ")},v.map(((t,r)=>e.createElement(mt,ct({key:r},t,{onClick:e=>{t.onClickClose&&n?n():t.onClick?t.onClick(e):console.error("Button is missing click handler")}}),t.label)))):null));return t.createPortal(x,this.el)}}class mt extends e.Component{render(){var{onClick:t,disabled:n=!1,type:r="button",children:i,isPrimary:o=!1,isDanger:s=!1,className:a=""}=this.props,l="secondary";return s?l="inline-flex justify-center w-fit rounded-md border leading-6 font-medium px-4 py-2 sm:text-sm sm:leading-5 shadow-sm focus:outline-none border-transparent bg-red-600 text-base text-white hover:bg-red-500 focus:border-red-700 focus:shadow-outline-red ":o&&(l=" bg-blue-600 "),n&&(l="inline-flex items-center px-4 py-2 border border-transparent text-sm leading-5 font-medium rounded-md text-white bg-gray-500 bg-opacity-50 focus:outline-none "),e.createElement("button",{onClick:n?null:t,type:"button",style:{lineHeight:"1em"},className:l+" px-1 py-p5 "+a},i)}}function gt(){return gt=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},gt.apply(this,arguments)}function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?yt(Object(t),!0).forEach((function(n){xt(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function bt(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function wt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){bt(a,r,i,o,s,"next",e)}function s(e){bt(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Et=e=>["boolean","number"].includes(typeof e)?e.toString():e;class _t extends e.Component{constructor(){var e;super(...arguments),e=this,xt(this,"state",{searchTerm:"",searchItems:void 0,searchClosed:!0,searchingItems:!1,matchCase:!1}),xt(this,"onClick",(e=>{var t,n,{variant:r}=this.props,{searchClosed:i}=this.state;null!=r&&r.startsWith("search")&&this.refList&&e.target&&(i||this.refList.contains(e.target)||null!==(t=this.refInput)&&void 0!==t&&t.contains(e.target)?i&&this.refInput&&this.refInput.contains(e.target)&&this.setState({searchClosed:!1}):(this.setState({searchClosed:!0}),null===(n=this.cancelCurrentSearch)||void 0===n||n.call(this)))})),xt(this,"focusInput",(()=>{this.refInput&&this.refInput.focus()})),xt(this,"onSetTerm",((e,t)=>{var{onSearch:n,onType:r}=this.props;this.focusedRowIndex=void 0,null==r||r(e,(t=>{e=t})),this.setState({searchTerm:e}),null==n||n(e,t),this.onSearchItems(e)})),xt(this,"onSearchItems",function(){var t=wt((function*(t){var{onSearchItems:n,searchEmpty:r}=e.props;if(n){if(e.searching){if(e.searching.term===t)return;clearTimeout(e.searching.timeout)}"string"==typeof t&&(r||t)?(!e.state.searchingItems&&e.setState({searchingItems:!0}),e.searching={term:t,timeout:setTimeout(wt((function*(){var n,r;e.setState({searchingItems:!0});var i=null!==(n=null===(r=e.props.matchCase)||void 0===r?void 0:r.value)&&void 0!==n?n:e.state.matchCase;try{e.props.onSearchItems(t,{matchCase:i},((n,r,i)=>{var o;e.cancelCurrentSearch=()=>{e.setState({searchingItems:!1,error:void 0}),i(),e.searching=void 0},t===(null===(o=e.searching)||void 0===o?void 0:o.term)?e.setState({searchItems:n,searchClosed:!1,error:void 0}):!e.searching&&e.state.searchingItems&&e.cancelCurrentSearch(),r&&e.cancelCurrentSearch()}))}catch(t){e.setState({searchingItems:!1,error:t,searchClosed:!0})}})),400)}):e.setState({searchItems:[],searchingItems:!1})}}));return function(){return t.apply(this,arguments)}}())}componentDidMount(){var{autoFocus:e=!0,defaultSearch:t,defaultValue:n}=this.props;e&&setTimeout(this.focusInput,5);var r=Et(n);"string"==typeof r&&r?this.setState({searchTerm:r}):"string"==typeof t&&t&&this.onSetTerm(t,{}),window.addEventListener("click",this.onClick)}componentWillUnmount(){window.removeEventListener("click",this.onClick)}componentDidUpdate(e,t){this.state.matchCase!==t.matchCase&&this.state.searchTerm&&this.onSetTerm(this.state.searchTerm)}render(){var t,{className:n="",id:r,style:i={},items:o=[],placeholder:s="",onReorder:a,onSearch:l,onType:c,noSearch:u,multiSelect:h,onChange:d,inputEl:f,dontHighlight:p,variant:m,selectedKey:g,onSearchItems:y,rootStyle:v={},label:b,limit:w=30,onPressEnter:x,matchCase:E,searchStyle:_={},searchEmpty:S=!1}=this.props,{searchTerm:C,searchItems:T=[],searchingItems:O=!1,searchClosed:P,selectPopup:A,error:k}=this.state,M=null!==(t=null==E?void 0:E.value)&&void 0!==t?t:this.state.matchCase,N=C,L=e=>vt(vt({},e),_t.getMatch({matchCase:M,term:N,text:Et(void 0===e.label?e.key:e.label),key:e.key,subLabel:e.subLabel})),R=y?T:p?o:l?o.map(L):o.map(L).filter((e=>e.rank!==1/0)).sort(((e,t)=>N?e.rank-t.rank||(e.label||"").length-(t.label||"").length:0)).slice(0,w),I=o.filter((e=>e.checked)),D=!(u||f),j=null==m?void 0:m.startsWith("search"),F=null==m?void 0:m.includes("no-shadow"),z="select"===m,B=!R.length&&!N||j&&P,U=k?e.createElement(Fe,{error:k}):B?null:e.createElement("div",{className:"relative w-full f-1  min-h-0 min-w-0 no-scroll-bar "+(j?" o-visible ":" o-auto ")},j&&!!R.length&&e.createElement("div",{style:{position:"fixed",inset:0,zIndex:1,background:"#ebebeb38",backdropFilter:"blur(1px)"}}),e.createElement("ul",{className:"f-1 o-auto min-h-0 min-w-0 ul-search-list "+(j?" no-scroll-bar shadow ":""),role:"list",ref:e=>{e&&(this.refList=e)},style:vt({padding:0},j?{position:"absolute",background:"white",zIndex:1,left:0,right:0,maxHeight:"400px"}:{})},l&&!this.props.items?null:R.length?R.map(((t,n)=>{var i=t.onPress?e=>{var n;t.onPress(e,this.state.searchTerm),j&&!P&&(null===(n=this.cancelCurrentSearch)||void 0===n||n.call(this),this.setState({searchClosed:!0}))}:void 0;return e.createElement("li",{key:n,role:"listitem",title:t.title,tabIndex:0,draggable:!!a,onDrag:a?e=>{var t=e.currentTarget,n=t.parentElement;t.style.display="none",Array.from(n.children).map(((t,r)=>{var i=t.getBoundingClientRect(),o=e.clientY>i.y&&e.clientY<i.y+i.height,s=o?"".concat(35,"px"):"";s!==t.style.paddingTop&&(t.style.paddingTop=s),o&&(n._targetIdx=r)}));var r=n.getBoundingClientRect();e.clientY>r.y+r.height?n.scrollTop+=10:e.clientY<r.y&&(n.scrollTop-=10)}:void 0,onDragEnd:a?function(){var e=wt((function*(e){var t,r,i,s=e.currentTarget,l=s.parentElement,c=l._targetIdx,u=o.slice(0);t=n,r=c,i=u.splice(t,1)[0],u.splice(r,0,i),yield a(u),setTimeout((()=>{Array.from(l.children).map((e=>{e.style.paddingTop=""})),s.style.display="flex"}),1)}));return function(){return e.apply(this,arguments)}}():void 0,className:"flex-row ai-start p-p5 pl-1 pointer min-w-0 "+(t.selected?" bg-gray-100 ":""),onClick:e=>i(e,this.state.searchTerm),onKeyUp:i?e=>{"Enter"===e.key&&i(e,this.state.searchTerm)}:void 0},t.content||e.createElement("div",{className:"flex-row ai-center f-1 "},t.contentLeft||null,e.createElement("div",{className:"flex-col ai-start f-1"},e.createElement("label",{className:"ws-pre mr-p5 f-1 flex-row pointer noselect min-w-0 w-full",style:t.style},t.node),t.contentBottom),t.contentRight||null,"boolean"==typeof t.checked?e.createElement(it,{id:r,className:"f-0 no-pointer-events",checked:t.checked,style:{marginRight:"12px"},onChange:()=>{}}):null))})):e.createElement("div",{className:"p-p5 text-gray-600"},"No results"))),V=e.createElement("div",{className:"search list-comp ta-left flex-col bg-white min-h-0 rounded "+n,ref:e=>{e&&(this.refRoot=e)},style:vt(vt({},i),j?{}:v),onKeyDown:e=>{if(this.refList){var t=this.refList.lastChild,n=this.refList.firstChild,r=document.activeElement,i=r.previousElementSibling,o=r.nextElementSibling,s=!this.refList.contains(r);if("Enter"===e.key&&this.refInput&&this.refInput.contains(r)&&n&&(e.preventDefault(),x&&void 0===this.focusedRowIndex?x(N):n.click()),!(s||1!==e.key.length||e.shiftKey||e.ctrlKey||e.altKey))return void this.focusInput();switch(e.key){case"ArrowUp":r===n||s?t&&t.focus():this.refList.childElementCount&&i&&i.focus(),e.preventDefault(),this.focusedRowIndex=null!=r&&r.parentElement.children?Array.from(r.parentElement.children).indexOf(r):-1;break;case"ArrowDown":r===t||s?n&&n.focus():this.refList.childElementCount&&o&&o.focus(),e.preventDefault(),this.focusedRowIndex=null!=r&&r.parentElement.children?Array.from(r.parentElement.children).indexOf(r):-1}}}},b?e.createElement("div",{className:" noselect text-gray-500 "+(j?" pb-p25 ":" p-p75 pb-0 "),style:{}},b):null,e.createElement("div",{className:"f-0 min-h-0 min-w-0 flex-row jc-start relative "+(j||z?" ":"  mtt-1  ")+(D||h?"":" hidden"),style:_},D?e.createElement("div",{className:"flex-row h-fit f-1 relative o-hidden relative rounded focus-border b b-gray-300 "+(j&&!F?" shadow ":" "),style:vt({},j?{zIndex:U?2:"unset"}:z?{margin:"8px",marginBottom:"2px"}:{margin:"8px"}),onClick:()=>{!U&&S&&this.onSetTerm(N||"",{})}},e.createElement(St,{ref:e=>{e&&(this.refInput=e)},type:"text",style:vt({},j&&!B?{borderBottomLeftRadius:0,borderBottomRightRadius:0,zIndex:3}:{}),placeholder:s,autoComplete:"off",className:"search-list-comp-input f-1 w-full ",value:N,onChange:e=>{var t=e.currentTarget.value;this.onSetTerm(t,e)}}),e.createElement("div",{className:"rounded f-0 ai-center jc-center flex-row bg-white ",style:{borderRadius:"3px",overflow:"hidden",margin:"1px"}},j&&O?e.createElement(Xe,{className:"noselect mr-p25",sizePx:24}):e.createElement(et,{title:"Match case",iconPath:"M20.06,18C20,17.83 19.91,17.54 19.86,17.11C19.19,17.81 18.38,18.16 17.45,18.16C16.62,18.16 15.93,17.92 15.4,17.45C14.87,17 14.6,16.39 14.6,15.66C14.6,14.78 14.93,14.1 15.6,13.61C16.27,13.12 17.21,12.88 18.43,12.88H19.83V12.24C19.83,11.75 19.68,11.36 19.38,11.07C19.08,10.78 18.63,10.64 18.05,10.64C17.53,10.64 17.1,10.76 16.75,11C16.4,11.25 16.23,11.54 16.23,11.89H14.77C14.77,11.46 14.92,11.05 15.22,10.65C15.5,10.25 15.93,9.94 16.44,9.71C16.95,9.5 17.5,9.36 18.13,9.36C19.11,9.36 19.87,9.6 20.42,10.09C20.97,10.58 21.26,11.25 21.28,12.11V16C21.28,16.8 21.38,17.42 21.58,17.88V18H20.06M17.66,16.88C18.11,16.88 18.54,16.77 18.95,16.56C19.35,16.35 19.65,16.07 19.83,15.73V14.16H18.7C16.93,14.16 16.04,14.63 16.04,15.57C16.04,16 16.19,16.3 16.5,16.53C16.8,16.76 17.18,16.88 17.66,16.88M5.46,13.71H9.53L7.5,8.29L5.46,13.71M6.64,6H8.36L13.07,18H11.14L10.17,15.43H4.82L3.86,18H1.93L6.64,6Z",color:M?"action":void 0,size:"small",onClick:()=>{E?E.onChange(!M):this.setState({matchCase:!M})}}))):h?e.createElement("div",{className:"pl-1 py-p5 noselect text-gray-500"},I.length||0," selected"):null,h?e.createElement(it,{id:r,style:{paddingLeft:"1em",paddingRight:"20px",marginLeft:"auto"},checked:!!I.length,onChange:e=>{var t=e.currentTarget.checked;if(d){var n=o.map((e=>vt(vt({},e),{},{checked:R.find((t=>t.key===e.key))?t:e.checked}))).filter((e=>e.checked)).map((e=>e.key));d(n,e)}else o.map((n=>{var r;n.checked!==t&&(null===(r=n.onPress)||void 0===r||r.call(n,e,this.state.searchTerm))}))}}):null),U);return"select"===m?A?e.createElement(pt,{open:!0,onClose:()=>{this.setState({selectPopup:!1})}},V):e.createElement(et,{onClick:()=>{this.setState({selectPopup:!0})}},g):V}}xt(_t,"getMatch",(t=>{var n=t=>{var{term:n,text:r,key:i,isSublabel:o=!1,matchCase:s=!1}=t,a=o?{fontSize:"14px",marginTop:".25em"}:{fontSize:"18px"},l=" text-gray-".concat(o?600:900," "),c=0,u=r||"",h=o?u.split("\n").slice(0,3).join("\n"):u,d=e.createElement("span",{className:l+" text-ellipsis",style:a},h);if(n){var f=s?u:u.toLowerCase(),p=s?n:n.toLowerCase(),m=f.indexOf(p);if(c=m+1,-1<m){var g,y;if(o){var v=u.split("\n"),b=v.findIndex((e=>s?e.includes(n):e.toLowerCase().includes(n.toLowerCase())));u=v[b],m=s?u.indexOf(n):u.toLowerCase().indexOf(n.toLowerCase()),2<b&&(g=v.slice(b-2,b-1)),y=v.slice(b+1,b+2)}else u=u.split("\n").join(" ");d=e.createElement("div",{className:"flex-col  f-1",style:a,title:r},void 0!==g&&0<g.length&&e.createElement("span",{className:"f-0 text-gray-400 text-ellipsis"},g.join("\n")),e.createElement("div",{className:"flex-row f-1"},e.createElement("span",{className:"f-1 ta-right text-gray-600 text-ellipsis",style:{maxWidth:"fit-content"}},u.slice(0,m)),e.createElement("strong",{className:"f-0"},u.slice(m,m+p.length)),e.createElement("span",{className:"f-1 text-gray-600 text-ellipsis"},u.slice(m+p.length))),void 0!==y&&0<y.length&&e.createElement("span",{className:"f-0 text-gray-400 text-ellipsis"},y.join("\n")))}else c=1/0}return u||(""===i&&(d=e.createElement("i",null,"[Empty]")),null===i&&(d=e.createElement("i",null,"[NULL]"))),{rank:c,node:d}},{term:r,text:i,key:o,subLabel:s,matchCase:a}=t,l=n({term:r,text:i,key:o,matchCase:a}),c=l;if(s){var u=n({term:r,text:s,key:s,isSublabel:!0,matchCase:a});c.node=e.createElement("div",{className:"flex-col f-1"},l.node,u.node);var h=Math.min(l.rank,u.rank+5);l.rank!==1/0&&u.rank!==1/0&&(h/=2),c.rank=h}return c}));var St=e.forwardRef(((t,n)=>{var{className:r="",style:i={}}=t;return e.createElement("input",gt({ref:e=>{e&&(n&&n(e),setTimeout((()=>{t.autoFocus&&document.activeElement!==e&&(e.focus(),e.select())}),40))}},Me(t,[],["className","style"]),{style:i,className:"custom-input rounded "+r}))}));function Ct(){return Ct=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ct.apply(this,arguments)}function Tt(t){var[n,r]=(0,e.useState)(),[i,o]=(0,e.useState)(),{render:s,children:a,content:l,style:c={},className:u=""}=t,h=null;return n&&(h=e.createElement(pt,Ct({},t,{onClose:()=>{r(null)},onClickClose:!s,open:!!n,content:s?s((()=>r(null))):l||a,anchorEl:i}))),e.createElement("div",{ref:e=>{e&&o(e)},style:c,className:"h-fit w-fit "+u,onClick:e=>{i.contains(e.nativeEvent.target)&&r(e.nativeEvent.target)}},t.button,h)}var Ot=Math.sqrt(50),Pt=Math.sqrt(10),At=Math.sqrt(2);function kt(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ot?10:o>=Pt?5:o>=At?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ot?10:o>=Pt?5:o>=At?2:1)}function Mt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Nt(e){let t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)<0?r=o+1:i=o}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>Mt(e(t),n)}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);const s=r(e,n,i,o-1);return s>i&&t(e[s-1],n)>-t(e[s],n)?s-1:s},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)>0?i=o:r=o+1}return r}}}const Lt=Nt(Mt),Rt=Lt.right;Lt.left,Nt((function(e){return null===e?NaN:+e})).center;var It=Rt;function Dt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ft(){}var zt=.7,Bt=1/zt,Ut="\\s*([+-]?\\d+)\\s*",Vt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ht="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qt=/^#([0-9a-f]{3,8})$/,Wt=new RegExp("^rgb\\("+[Ut,Ut,Ut]+"\\)$"),Gt=new RegExp("^rgb\\("+[Ht,Ht,Ht]+"\\)$"),$t=new RegExp("^rgba\\("+[Ut,Ut,Ut,Vt]+"\\)$"),Yt=new RegExp("^rgba\\("+[Ht,Ht,Ht,Vt]+"\\)$"),Xt=new RegExp("^hsl\\("+[Vt,Ht,Ht]+"\\)$"),Kt=new RegExp("^hsla\\("+[Vt,Ht,Ht,Vt]+"\\)$"),Zt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Jt(){return this.rgb().formatHex()}function Qt(){return this.rgb().formatRgb()}function en(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=qt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?tn(t):3===n?new sn(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?nn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?nn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Wt.exec(e))?new sn(t[1],t[2],t[3],1):(t=Gt.exec(e))?new sn(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=$t.exec(e))?nn(t[1],t[2],t[3],t[4]):(t=Yt.exec(e))?nn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Xt.exec(e))?un(t[1],t[2]/100,t[3]/100,1):(t=Kt.exec(e))?un(t[1],t[2]/100,t[3]/100,t[4]):Zt.hasOwnProperty(e)?tn(Zt[e]):"transparent"===e?new sn(NaN,NaN,NaN,0):null}function tn(e){return new sn(e>>16&255,e>>8&255,255&e,1)}function nn(e,t,n,r){return r<=0&&(e=t=n=NaN),new sn(e,t,n,r)}function rn(e){return e instanceof Ft||(e=en(e)),e?new sn((e=e.rgb()).r,e.g,e.b,e.opacity):new sn}function on(e,t,n,r){return 1===arguments.length?rn(e):new sn(e,t,n,null==r?1:r)}function sn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function an(){return"#"+cn(this.r)+cn(this.g)+cn(this.b)}function ln(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function cn(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function un(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new dn(e,t,n,r)}function hn(e){if(e instanceof dn)return new dn(e.h,e.s,e.l,e.opacity);if(e instanceof Ft||(e=en(e)),!e)return new dn;if(e instanceof dn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new dn(s,a,l,e.opacity)}function dn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function fn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function pn(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}Dt(Ft,en,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Jt,formatHex:Jt,formatHsl:function(){return hn(this).formatHsl()},formatRgb:Qt,toString:Qt}),Dt(sn,on,jt(Ft,{brighter:function(e){return e=null==e?Bt:Math.pow(Bt,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?zt:Math.pow(zt,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:an,formatHex:an,formatRgb:ln,toString:ln})),Dt(dn,(function(e,t,n,r){return 1===arguments.length?hn(e):new dn(e,t,n,null==r?1:r)}),jt(Ft,{brighter:function(e){return e=null==e?Bt:Math.pow(Bt,e),new dn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?zt:Math.pow(zt,e),new dn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new sn(fn(e>=240?e-240:e+120,i,r),fn(e,i,r),fn(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var mn=e=>()=>e;function gn(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):mn(isNaN(e)?t:e)}var yn=function e(t){var n=function(e){return 1==(e=+e)?gn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):mn(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=on(e)).r,(t=on(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),s=gn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function vn(e){return function(t){var n,r,i=t.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=on(t[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=e(o),s=e(s),a=e(a),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=a(e),r+""}}}function bn(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=On(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=o[n](e);return s}}function wn(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function xn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function En(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=On(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}vn((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return pn((n-r/t)*t,s,i,o,a)}})),vn((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return pn((n-r/t)*t,i,o,s,a)}}));var _n=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sn=new RegExp(_n.source,"g");function Cn(e,t){var n,r,i,o=_n.lastIndex=Sn.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=_n.exec(e))&&(r=Sn.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:xn(n,r)})),o=Sn.lastIndex;return o<t.length&&(i=t.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function Tn(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function On(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?mn(t):("number"===i?xn:"string"===i?(n=en(t))?(t=n,yn):Cn:t instanceof en?yn:t instanceof Date?wn:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?bn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?En:xn:Tn))(e,t)}function Pn(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function An(e){return+e}var kn=[0,1];function Mn(e){return e}function Nn(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Ln(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=Nn(i,r),o=n(s,o)):(r=Nn(r,i),o=n(o,s)),function(e){return o(r(e))}}function Rn(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=Nn(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=It(e,t,1,r)-1;return o[n](i[n](t))}}function In(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Dn(){return function(){var e,t,n,r,i,o,s=kn,a=kn,l=On,c=Mn;function u(){var e,t,n,l=Math.min(s.length,a.length);return c!==Mn&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?Rn:Ln,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),a,l)))(e(c(t)))}return h.invert=function(n){return c(t((o||(o=r(a,s.map(e),xn)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,An),u()):s.slice()},h.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},h.rangeRound=function(e){return a=Array.from(e),l=Pn,u()},h.clamp=function(e){return arguments.length?(c=!!e||Mn,u()):c!==Mn},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}()(Mn,Mn)}function jn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var Fn,zn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bn(e){if(!(t=zn.exec(e)))throw new Error("invalid format: "+e);var t;return new Un({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Un(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Vn(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Hn(e){return(e=Vn(Math.abs(e)))?e[1]:NaN}function qn(e,t){var n=Vn(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Bn.prototype=Un.prototype,Un.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Wn={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>qn(100*e,t),r:qn,s:function(e,t){var n=Vn(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Fn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Vn(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Gn(e){return e}var $n,Yn,Xn,Kn=Array.prototype.map,Zn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Jn(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,i,o,s,a=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(s=kt(e,t,n))||!isFinite(s))return[];if(s>0){let n=Math.round(e/s),r=Math.round(t/s);for(n*s<e&&++n,r*s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(e*s),r=Math.round(t*s);for(n/s<e&&++n,r/s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)/s}return r&&o.reverse(),o}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var i,o=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ot?i*=10:o>=Pt?i*=5:o>=At&&(i*=2),t<e?-i:i}(e,t,n);switch((r=Bn(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Hn(t)/3)))-Hn(Math.abs(e)))}(o,s))||(r.precision=i),Xn(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Hn(t)-Hn(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-Hn(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return Yn(r)}(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(i=l,l=c,c=i,i=s,s=a,a=i);u-- >0;){if((i=kt(l,c,n))===r)return o[s]=l,o[a]=c,t(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function Qn(){var e=Dn();return e.copy=function(){return In(e,Qn())},jn.apply(e,arguments),Jn(e)}$n=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Gn:(t=Kn.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?Gn:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Kn.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Bn(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):Wn[v]||(void 0===g&&(g=12),y=!0,v="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",x=Wn[v],E=/[defgprs%]/.test(v);function _(e){var i,o,l,d=b,_=w;if("c"===v)_=x(e)+_,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,_=("s"===v?Zn[8+Fn/3]:"")+_+(S&&"("===h?")":""),E)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){_=(46===l?s+e.slice(i+1):e.slice(i))+_,e=e.slice(0,i);break}}m&&!f&&(e=r(e,1/0));var C=d.length+e.length+_.length,T=C<p?new Array(p-C+1).join(t):"";switch(m&&f&&(e=r(T+e,T.length?p-_.length:1/0),T=""),n){case"<":e=d+e+_+T;break;case"=":e=d+T+e+_;break;case"^":e=T.slice(0,C=T.length>>1)+d+e+_+T.slice(C);break;default:e=T+d+e+_}return a(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:h,formatPrefix:function(e,t){var n=h(((e=Bn(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Hn(t)/3))),i=Math.pow(10,-r),o=Zn[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Yn=$n.format,Xn=$n.formatPrefix;var er=n(4926),tr=Math.round;function nr(e){var t=e.length,n={};return"rgb"===e.slice(0,3).toLowerCase()?(e=e.replace(" ","").split(","),n[0]=parseInt(e[0].slice("a"===e[3].toLowerCase()?5:4),10),n[1]=parseInt(e[1],10),n[2]=parseInt(e[2],10),n[3]=e[3]?parseFloat(e[3]):-1):(e=6>t?parseInt(e[1]+""+e[1]+e[2]+e[2]+e[3]+e[3]+(4<t?e[4]+""+e[4]:""),16):parseInt(e.slice(1),16),n[0]=255&e>>16,n[1]=255&e>>8,n[2]=255&e,n[3]=9===t||5===t?tr((255&e>>24)/255*1e4)/1e4:-1),n}function rr(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.5;e=e.trim(),t=t.trim();var r=0>n;n=r?-1*n:n;var i=nr(e),o=nr(t);if("r"===t[0]){var s=-1<i[3]&&-1<o[3]?tr(1e4*((o[3]-i[3])*n+i[3]))/1e4:0>o[3]?i[3]:o[3];return"rgb"+("a"===t[3]?"a(":"(")+tr((o[0]-i[0])*n+i[0])+","+tr((o[1]-i[1])*n+i[1])+","+tr((o[2]-i[2])*n+i[2])+(0>i[3]&&0>o[3]?"":","+s)+")"}return"#"+(4294967296+16777216*(-1<i[3]&&-1<o[3]?tr(255*((o[3]-i[3])*n+i[3])):-1<o[3]?tr(255*o[3]):-1<i[3]?tr(255*i[3]):255)+65536*tr((o[0]-i[0])*n+i[0])+256*tr((o[1]-i[1])*n+i[1])+tr((o[2]-i[2])*n+i[2])).toString(16).slice(-1<i[3]||-1<o[3]?1:3)}function ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function or(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ir(Object(t),!0).forEach((function(n){sr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ir(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ar=["=","<=","<",">",">=","!=","in","not in","contains","not null"];class lr extends We{constructor(){super(...arguments),sr(this,"state",{minValue:void 0,maxValue:void 0})}render(){var{column:t,onUpdate:n,tsDataType:r}=this.props,i=["None","Fixed","Conditional"],{style:o={type:"None",textColor:"",chipColor:"",cellColor:""}}=t;t&&["number","Date"].includes(r)&&(i.push("Scale"),i.push("Barchart"));var s=o.type||"None",a=e=>{if(e.type&&e.type!==o.type){var t=or({},e);"Barchart"===e.type&&(t=or({barColor:"rgba(0,246,96,1)",textColor:"black"},t)),n({style:t})}else n({style:or(or({},o),e)})},l=ke(o,"conditions")||[],c=(e,t,n)=>{var r=l.map((e=>or({},e)));"remove"===n?r=r.filter(((e,n)=>n!==t)):"add"===n?r.push({color:"red",operator:"=",condition:""}):r=l.map(((n,r)=>r===t?or(or({},n),e):n)),a({conditions:r})};return e.createElement("div",{className:"flex-col p-p5"},e.createElement(eN,{label:"Style mode",value:s,variant:"div",options:i,onChange:e=>{a({type:e})}}),"Fixed"===o.type?e.createElement(e.Fragment,null,e.createElement(cr,{label:"Text",className:"m-p5",value:o.textColor||"black",onChange:e=>{a({textColor:e})}}),e.createElement(cr,{label:"Chip",className:"m-p5",value:o.chipColor,onChange:e=>{a({chipColor:e})}}),e.createElement(cr,{label:"Cell",className:"m-p5",value:o.cellColor||"white",onChange:e=>{a({cellColor:e})}})):"Conditional"===o.type?e.createElement("div",null,e.createElement("div",{className:"flex-row p-p5 ai-center"},e.createElement("div",{className:"mr-p5 mt-p5"},"Text: "),e.createElement(cr,{className:"mr-p5",value:o.textColor,onChange:e=>{a({textColor:e})}})),(l||[]).map(((t,n)=>e.createElement("div",{key:n,className:"flex-row p-p5 ai-center"},e.createElement(cr,{className:"mr-p5",value:t.color,onChange:e=>{c({color:e},n)}}),e.createElement(eN,{className:"mr-p5",value:t.operator,variant:"div",options:ar,onChange:e=>c({operator:e},n)}),e.createElement(aN,{className:"mr-p5",placeholder:"Value",inputStyle:{padding:"4px 6px"},value:t.condition||"",onChange:e=>{c({condition:e},n)}}),e.createElement(et,{title:"Remove style",iconPath:oe,onClick:()=>{c(null,n,"remove")}})))),e.createElement(et,{title:"Add condition style",className:"w-fit h-fit",iconPath:we,onClick:()=>{c(null,null,"add")}}),e.createElement("div",{className:"flex-row p-p5 ai-center"},e.createElement(cr,{label:"Default",className:"mr-p5",value:ke(o,"defaultStyle.color"),onChange:e=>{a({defaultStyle:{color:e}})}}))):"Scale"===o.type?e.createElement(e.Fragment,null,e.createElement(cr,{className:"mr-p5",label:"Min color",value:o.minColor,onChange:e=>{a({minColor:e})}}),e.createElement(cr,{className:"mr-p5",label:"Max color",value:o.maxColor,onChange:e=>{a({maxColor:e})}})):"Barchart"===o.type?e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-col p-p5 ai-center"},e.createElement(cr,{label:"Bar",className:"m-p5",value:o.barColor,onChange:e=>{a({barColor:e})}}),e.createElement(cr,{label:"Text",className:"m-p5",value:o.textColor,onChange:e=>{a({textColor:e})}}))):null)}}sr(lr,"getStyle",((e,t,n)=>{var{style:r,name:i}=e,o={};if(r&&r.type){if("Fixed"===r.type)o={textColor:r.textColor,chipColor:r.chipColor,cellColor:r.cellColor};else if("Conditional"===r.type){var s=n[e.name],a=(r.conditions||[]).find((e=>{var{operator:n,condition:r}=e,i="number"===t?+r:r;if("contains"===n)return s&&"".concat(JSON.stringify(s)).includes(i+"");if("="===n)return s==i;if(">"===n)return s>i;if(">="===n)return s>=i;if("<="===n)return s<=i;if("<"===n)return s<i;if("!="===n)return s!=i;if(["in","not in"].includes(n)){var o=r.split(",").map((e=>"number"===t?+e.trim():e.trim())).includes(s);return"in"===n?o:!o}})),l=ke(r,"defaultStyle.color");!a&&l&&(o={textColor:r.textColor,chipColor:l}),a&&(o={textColor:r.textColor,chipColor:a.color})}else if("Barchart"===r.type){var{minValue:c,maxValue:u,barColor:h="rgba(0,246,96,1)",textColor:d="black"}=r,f="Date"===t?+new Date(n[e.name]):+n[e.name];if(![f,c,u].find((e=>"number"!=typeof e||isNaN(e)))){var p=Math.round(100*(f-c)/(u-c));o={textColor:d,cellColor:"linear-gradient(90deg, ".concat(h," 0%, ").concat(h," ").concat(p,"%, rgba(0,0,0,0) ").concat(p,"%)")}}}else if("Scale"===r.type){var{minValue:m,maxValue:g,textColor:y="black",minColor:v="#63f717",maxColor:b="#46b5d5"}=r,w="Date"===t?+new Date(n[e.name]):+n[e.name];[w,m,g].find((e=>"number"!=typeof e||isNaN(e)))||(o={textColor:y,cellColor:rr(v,b,(w-m)/(g-m))})}}else o={};return o}));class cr extends e.Component{constructor(){super(...arguments),sr(this,"state",{anchorEl:null}),sr(this,"asRGB",(e=>[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)])),sr(this,"lastChanged",Date.now()),sr(this,"onChange",(e=>{this.color=e;var{onChange:t}=this.props,n=Date.now();this.willChange||n-this.lastChanged<500?(clearTimeout(this.willChange),this.willChange=setTimeout((()=>{this.willChange=null,this.onChange(this.color)}),500)):(t(this.color,this.asRGB(this.color)),this.lastChanged=n)}))}render(){var{anchorEl:t}=this.state,{value:n,style:r={},className:i="",onChange:o,label:s}=this.props;return e.createElement("div",{className:"flex-row ai-center "+i,style:r},s?e.createElement("div",{className:"mr-1 noselect f-1"},s):null,e.createElement("div",{className:"round pointer shadow ",style:{width:"24px",height:"24px",backgroundColor:n},onClick:e=>{this.setState({anchorEl:e.currentTarget})}}),t?e.createElement(pt,{open:!0,anchorEl:t,positioning:"beneath-left",onClose:()=>this.setState({anchorEl:null}),contentClassName:"p-1"},e.createElement("div",{className:"flex-row-wrap"},["#ffffff","#174CFA","#7430F0","#0AA1FA","#CB11F0","#F79800","#36E00B"].map(((t,n)=>e.createElement("div",{key:n,className:"round pointer mr-1 mb-1 shadow",style:{width:"24px",height:"24px",backgroundColor:t},onClick:()=>{o(t,this.asRGB(t)),this.setState({anchorEl:null})}})))),e.createElement(aN,{className:"mt-1",label:"Other",type:"color",value:n,onChange:e=>this.onChange(e)}),e.createElement(et,{className:"mt-1",onClick:()=>{this.onChange("")}},"None")):null)}}function ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ur(Object(t),!0).forEach((function(n){dr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ur(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fr extends e.Component{constructor(){super(...arguments),dr(this,"state",{searchTerm:""})}render(){var{className:t="",variant:n="vertical",style:r={},items:i=[]}=this.props;return e.createElement("div",{className:" menu list-comp bg-white rounded "+("vertical"===n?" w-fit ":"")+t,style:hr({maxHeight:"99vh",padding:0},r),onKeyDown:e=>{var t=this.refList.lastChild,n=this.refList.firstChild,r=document.activeElement.previousElementSibling,i=document.activeElement.nextElementSibling;switch(e.key){case"ArrowUp":document.activeElement===n?t.focus():this.refList.childElementCount&&r.focus();break;case"ArrowDown":document.activeElement===t?n.focus():this.refList.childElementCount&&i.focus()}}},e.createElement("ul",{className:"f-1 o-auto min-h-0 min-w-0 "+("vertical"===n?"flex-col ":"flex-row "),role:"list",ref:e=>{e&&(this.refList=e)},style:{padding:0}},i.map(((t,n)=>e.createElement("li",{key:n,role:"listitem",tabIndex:0,title:t.disabledText,style:hr(hr({},t.style||{}),t.disabledText?{cursor:"not-allowed",opacity:.5}:{}),className:"flex-row  p-p5  text-gray-900 "+(!t.disabledText&&t.onPress?" pointer ":" "),onClick:!t.onPress||t.disabledText?void 0:()=>{t.onPress()},onKeyUp:!t.onPress||t.disabledText?void 0:e=>{"Enter"===e.key&&t.onPress()}},e.createElement("label",{className:"mr-p5 f-1 flex-row ai-center ",style:{cursor:"inherit"}},t.leftIconPath?e.createElement(Ae(),{className:"mr-p5 text-gray-400",path:t.leftIconPath,size:1}):null,t.label," ",t.contentRight||null))))))}}function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mr(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?pr(Object(t),!0).forEach((function(n){gr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yr extends e.Component{constructor(){super(...arguments),gr(this,"state",{activeKey:void 0})}render(){var t,n,r,{className:i="",style:o={},variant:s="horizontal",contentClass:a="",onChange:l,compactMode:c}=this.props,u=this.props.items||{},{activeKey:h=this.props.activeKey}=this.state,d=null;"string"==typeof h&&u[h]&&u[h].content&&(d=null===(r=u[h])||void 0===r?void 0:r.content);var f={borderColor:"transparent",borderRightStyle:"solid",borderRightWidth:"2px"},p="flex-row ";"horizontal"===s&&(p="flex-col ",f={borderColor:"transparent",borderBottomStyle:"solid",borderBottomWidth:"2px"}),c&&(f={borderColor:"transparent"});var m=mr(mr({},f),{},{borderColor:"red",background:"#ffefef"}),g=!1;return c&&h&&(p="flex-col ",g=!0),e.createElement("div",{className:p+" min-w-0 min-h-0 "+i,style:o},g?e.createElement("div",{className:"flex-row ai-center",style:{backgroundColor:"aliceblue"}},e.createElement(et,{iconPath:ee,onClick:()=>{this.setState({activeKey:null}),l&&l(null)}},h),(null==u||null===(t=u[h])||void 0===t?void 0:t.leftIconPath)&&e.createElement(Ae(),{className:"text-gray-400 mr-1",path:null==u||null===(n=u[h])||void 0===n?void 0:n.leftIconPath,size:1})):e.createElement(fr,{className:"f-0 w-full noselect",variant:s,items:Object.keys(u).map((e=>{var t,n,r,i,o;return{label:(null===(t=u[e])||void 0===t?void 0:t.label)||e,leftIconPath:null===(n=u[e])||void 0===n?void 0:n.leftIconPath,disabledText:null===(r=u[e])||void 0===r?void 0:r.disabledText,style:mr(mr({},e===h?m:f),(null===(i=u[e])||void 0===i?void 0:i.style)||{}),onPress:null!==(o=u[e])&&void 0!==o&&o.disabledText?void 0:()=>{l&&l(e),this.setState({activeKey:e})}}}))}),d?e.createElement("div",{className:"f-1 "+a},d):null)}}function vr(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function br(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){vr(a,r,i,o,s,"next",e)}function s(e){vr(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xr(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?wr(Object(t),!0).forEach((function(n){Er(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _r={name:"Rename",type:"Data type",foreign:"Foreign key",primary:"Primary key",drop:"Drop"};class Sr extends e.Component{constructor(){super(...arguments),Er(this,"state",{action:_r.name,newName:void 0,query:"",error:"",hint:"",field:"",dataType:null,editableQuery:!0,running:!1,onSuccess:()=>{}})}componentDidMount(){}getQuery(){}render(){var t=this,{tableName:n,db:r}=this.props,i=this.state.field||this.props.field,{newName:o,query:s="",editableQuery:a=!0,error:l,hint:c,running:u,onSuccess:h,action:d,dataType:f}=this.state;return e.createElement("div",{className:window.isMobileDevice?" flex-col ":"flex-row ",style:{}},e.createElement(yr,{variant:"vertical",compactMode:!!window.isMobileDevice,onChange:e=>{var t=JSON.stringify(n),r=JSON.stringify(i),o="ALTER TABLE ".concat(t," \n"),s=e===_r.drop?"\n-DROP COLUMN ".concat(r," "):e===_r.foreign?"\nADD FOREIGN KEY (".concat(r,") \n")+"REFERENCES other_table ( other_column );":e===_r.primary?"\nADD PRIMARY KEY (".concat(r,") \n"):"",a="";s&&(a+=o+s),this.setState({action:e,query:a})},contentClass:"p-1 flex-row ai-center",items:Object.values(_r).reduce(((e,t)=>xr(xr({},e),{},{[t]:{}})),{})}),e.createElement("div",{className:"flex-col p-1 o-auto"},d?d===_r.name?e.createElement(aN,{className:"mb-1",placeholder:"New column name",value:o,onChange:e=>{this.setState({newName:e,editableQuery:!1,query:"ALTER TABLE ".concat(JSON.stringify(n)," \nRENAME COLUMN ").concat(JSON.stringify(i)," \nTO ").concat(JSON.stringify(e)," ")})}}):d===_r.type?e.createElement(eN,{className:"mb-1",label:"New data type",variant:"div",value:f,options:["TEXT","UUID","TSVECTOR","JSON","JSONB","GEOMETRY","TIMESTAMP","TIMESTAMPZ","INTEGER","NUMERIC","FLOAT","DECIMAL (4,4)"],onChange:function(){var e=br((function*(e){var o=JSON.stringify(i),s=JSON.stringify(n),a="USING  ".concat(o,"::").concat(e);if(e.startsWith("TIMESTAMP")){function t(e){return"string"==typeof(e+="")&&!isNaN(e)&&!isNaN(parseFloat(e))}a="USING to_timestamp(".concat(o,", 'YYYY-MM-DD HH:MI:SS'))::").concat(e);var l=yield r.sql("SELECT ".concat(o," FROM ").concat(s," WHERE  ").concat(o," IS NOT NULL LIMIT 1"),{},{returnType:"rows"});l&&l.length&&Object.values(l[0]).find(t)&&(a="USING to_timestamp(cast(".concat(o," as BIGINT))::").concat(e)),"TIMESTAMPZ"===e&&(a+="at time zone 'utc'")}else e.startsWith("GEOMETRY")&&(a="USING st_transform( \n st_setsrid( \n   st_geometryfromtext( \n"+"        'POINT' || replace(".concat(o,", ',', ' ')  \n")+"   ), \n   27700 \n ), \n 4326 \n)");t.setState({dataType:e,editableQuery:!0,query:"ALTER TABLE ".concat(s," \n")+"ALTER COLUMN ".concat(o," \n")+"TYPE ".concat(e," \n")+a})}));return function(){return e.apply(this,arguments)}}()}):null:null,s?e.createElement(e.Fragment,null,e.createElement(aN,{className:"",value:s,asTextArea:!0,onChange:e=>{this.setState({query:e})},error:l,hint:c}),e.createElement(et,{style:{alignSelf:"flex-end"},className:"mt-1 ",iconPath:be,variant:"outline",title:"Run rename query",loading:u,onClick:br((function*(){try{t.setState({running:!0}),yield r.sql(s),t.setState({error:"",hint:"Success!"})}catch(e){t.setState({error:e})}t.setState({running:!1})}))},"RUN")):null))}}var Cr=n(2040);function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Or(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Tr(Object(t),!0).forEach((function(n){Pr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Tr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ar extends e.Component{render(){var{onChange:t,className:n="",value:r,id:i="",style:o={},options:s=[],variant:a}=this.props,l=".375rem",c=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n={borderTopLeftRadius:0,borderBottomLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,fontWeight:t?500:300};return"dense"===a&&(n=Or(Or({},n),{},{padding:"6px",fontSize:"14px"})),e?e<s.length-1?Or(Or({},n),{},{marginRight:"-1px"}):Or(Or({},n),{},{borderTopRightRadius:l,borderBottomRightRadius:l}):Or(Or({},n),{},{borderTopLeftRadius:l,borderBottomLeftRadius:l,marginRight:"-1px"})};return e.createElement("div",{style:Or({},o),className:"button-group flex-row  rounded-md w-fit "+n},s.map(((n,i)=>e.createElement("button",{key:n,style:Or({},c(i,r===n)),onClick:e=>t(n,e),type:"button",className:" relative f-0 rounded-l-md border border-gray-300 bg-white text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:z-10 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-100 "},n))))}}function kr(){return kr=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},kr.apply(this,arguments)}class Mr extends e.Component{render(){var{className:t="",value:n,label:r,variant:i}=this.props,o=" chip lg gray b b-gray-300 ";return"naked"===i&&(o=""),e.createElement("div",kr({},Me(this.props,[],["children","label","value","variant"]),{className:"chip-component flex-row ws-pre "+o+t}),"string"==typeof r?e.createElement("span",{className:"text-gray-600",style:{fontWeight:400}},r,": "):null,e.createElement("span",{className:"font-medium f-1 text-ellipsis"},n))}}function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lr(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Nr(Object(t),!0).forEach((function(n){Rr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Nr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ir extends e.Component{constructor(){super(...arguments),Rr(this,"state",{chartType:void 0})}static getChartCols(e){var t=[],n="";if("sql"===e.type){var r,i,o=e;t=(null===(r=o.options)||void 0===r||null===(i=r.sqlResultCols)||void 0===i?void 0:i.map((e=>Lr(Lr({},e),{},{name:e.key}))))||[],n=o.options.lastSQL}else{var s;t=(null===(s=e.columns)||void 0===s?void 0:s.map((e=>{var t,n;return Lr(Lr({},e),{},{udt_name:(null===(t=e.info)||void 0===t?void 0:t.udt_name)||(null===(n=e.computedInfo)||void 0===n?void 0:n.udt_name)})})))||[]}return{geoCols:t.filter((e=>["geography","geometry"].includes(e.udt_name))),dateCols:t.filter((e=>(e.udt_name||"").startsWith("timestamp"))),cols:t,sql:n}}render(){var{w:t,onAddChart:n}=this.props,{chartType:r}=this.state;if(!t)return null;var{geoCols:i,dateCols:o,cols:s,sql:a}=Ir.getChartCols(t),l=t.table_name,c=(e,r,i)=>{var o="".concat(l||""," (").concat(r,")");n({type:e,tableName:l,name:o,linkOpts:{[i]:r,sql:a,fromSelected:!!t.selected_sql}})},u=[{label:"Map",iconPath:ge,cols:i,onAdd:e=>{c("map",e,"geomColumn")}},{label:"Timechart",iconPath:"M16,11.78L20.24,4.45L21.97,5.45L16.74,14.5L10.23,10.75L5.46,19H22V21H2V3H4V17.54L9.5,8L16,11.78Z",cols:o,onAdd:e=>{c("timechart",e,"dateColumn")}}],h={};return u.map((t=>{t.cols.length&&(h[t.label]={leftIconPath:t.iconPath,label:t.label,content:e.createElement(_t,{label:"Choose column",id:"chart-col",items:t.cols.map((e=>({key:e.name,label:e.name,subLabel:e.udt_name,onPress:()=>{t.onAdd(e.name)}})))})})})),e.createElement("div",{className:"flex-row ",style:{}},e.createElement(yr,{activeKey:r,variant:"vertical",onChange:e=>{this.setState({chartType:e});var t=u.find((t=>t.label===e));1===t.cols.length&&t.onAdd(t.cols[0].name)},contentClass:"p-1 flex-row ai-center",items:h}))}}function Dr(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function jr(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Dr(a,r,i,o,s,"next",e)}function s(e){Dr(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}class Fr extends e.Component{constructor(){super(...arguments),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",{sql:void 0})}render(){var t,n=this,{running:r,error:i}=this.state,{hint:o,db:s,onSuccess:a}=this.props;if(!this.props.sql)return null;var l=null!==(t=this.state.sql)&&void 0!==t?t:this.props.sql;return e.createElement("div",{className:"flex-col"},e.createElement(aN,{className:"my-1 f-1",asColumn:!0,label:o||"Prepared query",maxWidth:"",placeholder:" ",value:l,asTextArea:!0,onChange:e=>{this.setState({sql:e})},error:i,hint:o}),e.createElement(et,{style:{alignSelf:"flex-start"},size:"small",variant:"outline",iconPath:be,title:"Run query",loading:r,onClick:jr((function*(){try{n.setState({running:!0}),yield s.sql(l),n.setState({running:!1,hint:"Success!",error:void 0}),null==a||a()}catch(e){n.setState({error:null==e?void 0:e.err_msg,running:!1})}}))},"RUN"))}}function zr(){return zr=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},zr.apply(this,arguments)}function Br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ur(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Br(Object(t),!0).forEach((function(n){qr(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Br(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Vr(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Hr(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Vr(a,r,i,o,s,"next",e)}function s(e){Vr(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function qr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Wr extends We{constructor(){var e;super(...arguments),e=this,qr(this,"state",{addColMenu:void 0,query:void 0}),qr(this,"onDelta",function(){var t=Hr((function*(t,n,r){Ur(Ur(Ur({},t),n),r);var i=e.props.w;i&&i.$cloneSync&&!e.wSub&&(e.wSub=yield i.$cloneSync((t=>{e.setState({w:t})})))}));return function(){return t.apply(this,arguments)}}())}render(){var{w:t,addColMenu:n,query:r}=this.state,{db:i,tables:o,tableName:s,nestedTable:a,onClose:l}=this.props;if(!t)return null;var c,u=o.find((e=>e.name===s)),h=jo.getFullColumnConfig(o,t),d=e=>{if(!a)return t.$update({columns:e});var n=Ur({},t.nested_tables[a]);return n.cols=n.cols=e,t.$update({nested_tables:Ur(Ur({},t.nested_tables),{},{[a]:n})})};a&&t.nested_tables[a]&&(u=o.find((e=>e.name===a)),h=null!==(c=t.nested_tables[a].cols)&&void 0!==c?c:jo.getFullColumnConfig(o,{table_name:a}));var f=null;return n&&(f=e.createElement($r,{columns:u.columns,onAdd:e=>{if(a){var n=Ur({},t.nested_tables[a]);n.cols=n.cols.concat([e]),t.$update({sort:[],nested_tables:Ur(Ur({},t.nested_tables),{},{[a]:n})})}else{var r;t.$update({sort:[],columns:((null===(r=t.columns)||void 0===r?void 0:r.map((e=>Ur({},e))))||[]).concat([e])})}},anchorEl:n,cols:h,onClose:l})),e.createElement("div",{className:"flex-col f-1 min-h-0"},f,e.createElement(_t,{id:"cols",onReorder:function(){var e=Hr((function*(e){yield d(e.map((e=>Ur(Ur({},e.data),{},{show:e.checked}))))}));return function(){return e.apply(this,arguments)}}(),className:"f-1",multiSelect:!0,items:h.sort(((e,t)=>+!!t.show-+!!e.show)).map((n=>{var r,i,o,s,a,l,c,u;return{key:n.name,label:n.name+(null!==(r=n.info)&&void 0!==r&&r.references?"    (".concat(null===(i=n.info)||void 0===i?void 0:i.references.ftable,")"):""),data:n,title:(null===(o=n.info)||void 0===o?void 0:o.udt_name)||"computed",contentLeft:e.createElement(Ae(),{size:1,className:"mr-p5 text-gray-400",path:n.computedConfig?"M12.42,5.29C11.32,5.19 10.35,6 10.25,7.11L10,10H12.82V12H9.82L9.38,17.07C9.18,19.27 7.24,20.9 5.04,20.7C3.79,20.59 2.66,19.9 2,18.83L3.5,17.33C3.83,18.38 4.96,18.97 6,18.63C6.78,18.39 7.33,17.7 7.4,16.89L7.82,12H4.82V10H8L8.27,6.93C8.46,4.73 10.39,3.1 12.6,3.28C13.86,3.39 15,4.09 15.66,5.17L14.16,6.67C13.91,5.9 13.23,5.36 12.42,5.29M22,13.65L20.59,12.24L17.76,15.07L14.93,12.24L13.5,13.65L16.35,16.5L13.5,19.31L14.93,20.72L17.76,17.89L20.59,20.72L22,19.31L19.17,16.5L22,13.65Z":["geometry","geography"].includes(null===(s=n.info)||void 0===s?void 0:s.udt_name)?"M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z":"Object"===(null===(a=n.info)||void 0===a?void 0:a.tsDataType)?"M5,3H7V5H5V10A2,2 0 0,1 3,12A2,2 0 0,1 5,14V19H7V21H5C3.93,20.73 3,20.1 3,19V15A2,2 0 0,0 1,13H0V11H1A2,2 0 0,0 3,9V5A2,2 0 0,1 5,3M19,3A2,2 0 0,1 21,5V9A2,2 0 0,0 23,11H24V13H23A2,2 0 0,0 21,15V19A2,2 0 0,1 19,21H17V19H19V14A2,2 0 0,1 21,12A2,2 0 0,1 19,10V5H17V3H19M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15M8,15A1,1 0 0,1 9,16A1,1 0 0,1 8,17A1,1 0 0,1 7,16A1,1 0 0,1 8,15M16,15A1,1 0 0,1 17,16A1,1 0 0,1 16,17A1,1 0 0,1 15,16A1,1 0 0,1 16,15Z":"string"===(null===(l=n.info)||void 0===l?void 0:l.tsDataType)?de:"Date"===(null===(c=n.info)||void 0===c?void 0:c.tsDataType)?te:"number"===(null===(u=n.info)||void 0===u?void 0:u.tsDataType)?"M4,17V9H2V7H6V17H4M22,15C22,16.11 21.1,17 20,17H16V15H20V13H18V11H20V9H16V7H20A2,2 0 0,1 22,9V10.5A1.5,1.5 0 0,1 20.5,12A1.5,1.5 0 0,1 22,13.5V15M14,15V17H8V13C8,11.89 8.9,11 10,11H12V9H8V7H12A2,2 0 0,1 14,9V11C14,12.11 13.1,13 12,13H10V15H14Z":"M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M13,3.5L18.5,9H13V3.5M12,11A3,3 0 0,1 15,14C15,15.88 12.75,16.06 12.75,17.75H11.25C11.25,15.31 13.5,15.5 13.5,14A1.5,1.5 0 0,0 12,12.5A1.5,1.5 0 0,0 10.5,14H9A3,3 0 0,1 12,11M11.25,18.5H12.75V20H11.25V18.5Z"}),contentRight:n.computedConfig?e.createElement(et,{className:"text-red-700",color:"inherit",title:n.format?"Remove formatting":"Remove computed field",iconPath:le,onClick:e=>{var r;e.stopPropagation(),r=n.format?t.columns.map((e=>{if(e.name===n.name){var t=Ur(Ur({},e),{},{computed:!1});return delete t.format,t}return e})):t.columns.filter((e=>e.name!==n.name)),d(r)}}):null,onPress:()=>{var e=t.columns.map((e=>(e.name===n.name&&(e.show=!n.show),e)));d(e)},checked:n.show}}))}),e.createElement("div",{className:"flex-col p-1"},e.createElement(et,{className:"mt-1",iconPath:we,variant:"outline",size:"small",onClick:e=>{this.setState({addColMenu:e.currentTarget})}},"Add computed column"),e.createElement(et,{className:"my-1 ",iconPath:we,variant:"outline",size:"small",onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(s)," ADD COLUMN new_colname INTEGER"),hint:"New column will not appear instantly in the menu"}})}},"Create column"),e.createElement(Fr,zr({db:i},r))))}}var Gr=["Function","Aggregate Function"];class $r extends We{constructor(){super(...arguments),qr(this,"state",{})}render(){var t,n,r,{cols:i,onClose:o,onAdd:s,columns:a}=this.props,{colType:l="Function",column:c,func:u}=this.state,h=(null===(t=this.state)||void 0===t?void 0:t.name)||(null!=u&&null!==(n=u.def)&&void 0!==n&&n.label?"".concat(null==u||null===(r=u.def)||void 0===r?void 0:r.label,"(").concat(c||"",")"):"")||"col_name",d=a;u&&(u.def.tsDataTypeCol||u.def.udtDataTypeCol)&&(d=a.filter((e=>"any"===u.def.tsDataTypeCol||"any"===u.def.udtDataTypeCol||(u.def.tsDataTypeCol?u.def.tsDataTypeCol.includes(e.tsDataType):!!u.def.udtDataTypeCol&&u.def.udtDataTypeCol.includes(e.udt_name)))));var f,p=u&&!(null!=u&&u.def.tsDataTypeCol)&&!(null!=u&&u.def.udtDataTypeCol);return e.createElement(pt,{open:!0,title:"Add computed column",rootStyle:{top:window.isMobileDevice?0:"2em",maxHeight:window.isIOSDevice?"calc(100vh - 4em)":"100%"},onClose:o},e.createElement(eN,{className:"mt-1",label:"Column type",variant:"pill",options:Gr,value:l,onChange:e=>{this.setState({colType:e,func:void 0,column:void 0})}}),e.createElement("div",{className:"flex-row  f-1 min-h-0 mt-1"},c?e.createElement("div",{className:"flex-col f-1 min-h-0 mt-1 mr-1"},e.createElement("label",{className:"noselect f-0 text-gray-500 ta-left  mb-p5 "},"Column"),e.createElement(et,{variant:"filled",style:{backgroundColor:"rgb(0, 183, 255)"},onClick:()=>{this.setState({column:void 0})}},c)):p?null:e.createElement(_t,{id:"cols-elect",className:"mt-1 mr-1 f-1",label:"Column",items:d.map((e=>({key:e.name,label:e.name,subLabel:e.udt_name,onPress:()=>{this.setState({column:e.name})}})))}),u?e.createElement("div",{className:"flex-col mt-1"},e.createElement("label",{className:"noselect f-0 text-gray-500 ta-left  mb-p5 "},"Function"),e.createElement(et,{variant:"filled",style:{backgroundColor:"rgb(0, 183, 255)"},onClick:()=>{this.setState({func:void 0})}},u.def.label)):e.createElement(_t,{className:"mt-1 f-1",id:"dada",label:"Function",items:("Aggregate Function"===l?Kr.map((e=>Ur(Ur({},e),{},{label:e.name,subLabel:e.label}))):(f=[...[{key:"$ST_AsText",label:"ST_AsText",subLabel:"Returns the OGC Well-Known Text (WKT) representation of the geometry/geography"},{key:"$ST_AsGeoJSON",label:"ST_AsGeoJSON",subLabel:"Returns a geometry as a GeoJSON 'geometry', or a row as a GeoJSON 'feature'"},{key:"$ST_SnapToGrid",label:"ST_SnapToGrid",subLabel:"Snap all points of the input geometry to the grid defined by its origin and cell size. Remove consecutive points falling on the same cell"}].map((e=>Ur(Ur({},e),{},{outType:Yr.geo,udtDataTypeCol:["geography","geometry"]}))),...[{key:"$datetime",label:"Date and time",subLabel:"timestamp formated as YYYY-MM-DD HH24:MI"},{key:"$timedate",label:"Time and date",subLabel:"timestamp formated as HH24:MI YYYY-MM-DD"},{key:"$D",label:"Day of week number",subLabel:"timestamp formated as D. Day of the week, Sunday (1) to Saturday (7)"},{key:"$dy",label:"Day name short",subLabel:"timestamp formated as dy. Abbreviated lower case day name (3 chars in English, localized lengths vary)"},{key:"$Dy",label:"Day Name short",subLabel:"timestamp formated as Dy. Abbreviated capitalized day name (3 chars in English, localized lengths vary)"},{key:"$DD",label:"Day of month",subLabel:"timestamp formated as DD. Day of month (01-31)"},{key:"$ID",label:"ISO 8601 day of the week",subLabel:"timestamp formated as ID. Monday (1) to Sunday (7)"},{key:"$MM",label:"Month number",subLabel:"timestamp formated as MM. Month number (01-12)"},{key:"$yy",label:"Year short",subLabel:"timestamp formated as YY. Last 2 digits of year"},{key:"$day",label:"Day name",subLabel:"timestamp formated as day. Full lower case day name"},{key:"$Day",label:"Day Name",subLabel:"timestamp formated as Day. Full capitalized day name"},{key:"$mon",label:"Month name short",subLabel:"timestamp formated as mon. Abbreviated lower case month name (3 chars in English, localized lengths vary)"},{key:"$Mon",label:"Month Name short",subLabel:"timestamp formated as Mon. Abbreviated capitalized month name (3 chars in English, localized lengths vary)"},{key:"$month",label:"Month name",subLabel:"timestamp formated as month. Full lower case month name "},{key:"$Month",label:"Month Name",subLabel:"timestamp formated as Month. Full capitalized month name "},{key:"$date",label:"Date",subLabel:"timestamp formated as YYYY-MM-DD"},{key:"$time",label:"Time",subLabel:"timestamp formated as HH24:MI. 24 Hour time format"},{key:"$yyyy",label:"Year full",subLabel:"timestamp formated as yyyy. Year (4 or more digits)"},{key:"$time12",label:"Time 12H",subLabel:"timestamp formated as HH:MI. 12 Hour time format"},{key:"$timeAM",label:"Time AM/PM",subLabel:"timestamp formated as HH:MI AM. 24 Hour time format with AM/PM meridiem indicators"},{key:"$age",label:"AGE",subLabel:"Age of timestamp compared to today"}].map((e=>Ur(Ur({},e),{},{outType:Yr.string,tsDataTypeCol:["Date"]}))),...[{key:"$trim",label:"TRIM",subLabel:"Remove spaces or set of characters from the leading or trailing or both side from a string"},{key:"$upper",label:"Uppercase",subLabel:"Convert all characters to uppercase"},{key:"$lower",label:"Lowercase",subLabel:"Convert all characters to lowercase"},{key:"$length",label:"Length",subLabel:"Number of characters in the string"},{key:"$reverse",label:"Reverse",subLabel:"Arrange a string in reverse order"},{key:"$initcap",label:"Capitalise Initials",subLabel:"Convert the first letter of each word to upper case and the remaining to lower case"},{key:"$unnest_words",label:"Split into words",subLabel:"Split text from a column at spaces"}].map((e=>Ur(Ur({},e),{},{outType:Yr.string,tsDataTypeCol:["string"]}))),...[{key:"$ceil",label:"Ceil",subLabel:"Smallest integer which is greater than, or equal to, the specified numeric expression"},{key:"$floor",label:"Floor",subLabel:"Smallest integer which is lower than, or equal to, the specified numeric expression"},{key:"$sign",label:"Sign",subLabel:"Returns -1 0 or 1 depending of the column value. Returns null if null is provided"},{key:"$round",label:"Round",subLabel:"Round to nearest integer"}].map((e=>Ur(Ur({},e),{},{outType:Yr.number,tsDataTypeCol:["number"]})))].map((e=>Ur({},e))),f)).filter((e=>{var t,n,r=d;return c&&(r=a.filter((e=>e.name===c))),!e.tsDataTypeCol&&!e.udtDataTypeCol||"any"===e.tsDataTypeCol||"any"===e.udtDataTypeCol||Array.isArray(e.udtDataTypeCol)&&(null===(t=e.udtDataTypeCol)||void 0===t?void 0:t.find((e=>r.some((t=>t.udt_name===e)))))||Array.isArray(e.tsDataTypeCol)&&(null===(n=e.tsDataTypeCol)||void 0===n?void 0:n.find((e=>r.some((t=>t.tsDataType===e)))))})).map((t=>Ur(Ur({},t),{},{contentLeft:e.createElement(Ae(),{size:1.25,path:fe}),onPress:()=>{this.setState({func:{def:t,key:t.key,isAgg:"Aggregate Function"===l}})}})))})),(u&&c||p)&&e.createElement(e.Fragment,null,e.createElement(aN,{label:"Name",type:"text",className:"mt-1",asColumn:!0,value:h,onChange:e=>{this.setState({name:e})}}),e.createElement(et,{className:"mt-1",variant:"filled",color:"action",onClick:()=>{if(h)if(null!=i&&i.find((e=>e.name===h)))alert("Column name already in use: "+h);else{var e;"$string_agg"===u.key&&(e=[", "]),s({name:h,show:!0,width:130,computedConfig:Ur(Ur({funcName:u.key,funcDef:u.def,column:c},u.def.outType),{},{extraArgs:e})}),null==o||o()}else alert("Provide a column name")}},"ADD")))}}var Yr={string:{tsDataType:"string"},number:{tsDataType:"number"},date:{tsDataType:"Date"},geo:{udt_name:"geography",tsDataType:"Object"}},Xr=["number","Date"],Kr=[{key:"$countAll",name:"COUNT ALL",label:"Count all rows",tsDataTypeCol:void 0,outType:Yr.number},{key:"$count",name:"COUNT",label:"Count of rows for which the column value is not null",tsDataTypeCol:"any",outType:Yr.number},{key:"$max",name:"MAX",label:"Maximum value",tsDataTypeCol:Xr,outType:Yr.number},{key:"$min",name:"MIN",label:"Minimum value",tsDataTypeCol:Xr,outType:Yr.number},{key:"$avg",name:"AVERAGE",label:"Average value",tsDataTypeCol:Xr,outType:Yr.number},{key:"$sum",name:"SUM",label:"Sum of all non-null input values",tsDataTypeCol:Xr,outType:Yr.number},{key:"$string_agg",name:"AGGREGATE STRING",label:"Non-null string/text values concatenated into a string, separated by delimiter",tsDataTypeCol:["string"],outType:Yr.string}];function Zr(){return Zr=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Zr.apply(this,arguments)}function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qr(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Jr(Object(t),!0).forEach((function(n){ni(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Jr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function ei(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function ti(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){ei(a,r,i,o,s,"next",e)}function s(e){ei(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ri=["Realtime","Interval","None"];class ii extends We{constructor(){var e;super(...arguments),e=this,ni(this,"state",{l1Key:void 0,l2Key:void 0,query:void 0,running:void 0,error:void 0,initError:void 0,hint:void 0,indexes:void 0,columnsConfig:void 0,infoQuery:void 0,autoRefreshSeconds:void 0,tableMeta:void 0}),ni(this,"d",{w:void 0}),ni(this,"onUnmount",ti((function*(){e.wSub&&(yield e.wSub.$unsync())}))),ni(this,"loading",!1),ni(this,"onDelta",function(){var t=ti((function*(t,n,r){Qr(Qr(Qr({},t),n),r);var{db:i,tableName:o,cols:s,dbs:a}=e.props,l=e.d.w||e.props.w;o&&null!=l&&l.$cloneSync&&!e.loading&&(e.loading=!0,e.wSub=yield l.$cloneSync(((t,n)=>{e.setData({w:t},{w:n})})),e.getTableInfo()),n&&"query"in n&&e.setState({error:void 0})}));return function(){return t.apply(this,arguments)}}())}getTableInfo(){var e=this,{db:t,tableName:n}=this.props;n&&function(){return oi.apply(this,arguments)}(t,n).then(function(){var t=ti((function*(t){e.setState({tableMeta:t})}));return function(){return t.apply(this,arguments)}}()).catch((e=>{this.setState({initError:e})}))}render(){var t=this,{tableName:n,db:r,cols:i,onAddChart:o,onClose:s,w:a,tables:l}=this.props,{infoQuery:c,l1Key:u,query:h,initError:d,tableMeta:f,linkTablePath:p}=this.state;if(d)return e.createElement("div",{className:"p-1"},e.createElement(Fe,{error:d}));var m,g=null;if(h&&(g=e.createElement(Fr,Zr({db:r},h,{onSuccess:()=>{this.getTableInfo()}}))),a.table_name){var y,v,b,w,x,E=jo.getFullColumnConfig(l,a);m={Columns:{leftIconPath:Oe,content:e.createElement(Wr,{w:a,db:r,tableName:n,tables:l,onClose:s})},"Data Refresh":{leftIconPath:"M2 12A10 10 0 1 0 12 2A10 10 0 0 0 2 12M15.6 13.72A4 4 0 0 0 16 12A4 4 0 0 0 12 8V10L8.88 7L12 4V6A6 6 0 0 1 18 12A5.9 5.9 0 0 1 17.07 15.19M6 12A5.9 5.9 0 0 1 6.93 8.81L8.4 10.28A4 4 0 0 0 8 12A4 4 0 0 0 12 16V14L15 17L12 20V18A6 6 0 0 1 6 12Z",style:"None"===((null===(y=a.options)||void 0===y||null===(v=y.refresh)||void 0===v?void 0:v.type)||"None")?{}:{color:"var(--blue-600)"},content:si(a)},Triggers:{label:f?"Triggers "+f.triggers.length:void 0,leftIconPath:"M7,2V13H10V22L17,10H13L17,2H7Z",content:f?e.createElement("div",{className:"flex-col  ws-pre"},e.createElement("div",{className:"flex-row ai-center mb-1"},e.createElement(et,{iconPath:we,className:"f-0 mr-1 ",size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(n)," DISABLE TRIGGER ALL")}})}},"Disable all triggers"),e.createElement(et,{iconPath:we,className:"  f-0",size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(n)," ENABLE TRIGGER ALL")}})}},"Enable all triggers")),e.createElement("div",{className:"flex-col f-1 min-h-0 o-auto"},f.triggers.map(((t,r)=>e.createElement("div",{key:r,className:"flex-row ai-center"},e.createElement("div",{className:"flex-row mr-1 "},e.createElement(et,{iconPath:le,title:"Drop trigger",onClick:()=>{this.setState({query:{sql:"DROP TRIGGER ".concat((0,Cr.asName)(t.trigger_name)," ON ").concat((0,Cr.asName)(n)," ;")}})}}),e.createElement(et,{iconPath:fe,title:"View trigger function",onClick:()=>{this.setState({query:{sql:t.function_def}})}})),e.createElement(Mr,{variant:"naked",label:t.trigger_name,value:"".concat(t.action_timing," ").concat(t.event_manipulation," ").concat(t.action_statement)}))))),g):null},Constraints:{label:f?"Constraints "+f.constraints.length:void 0,leftIconPath:"M11.1 19C11.2 19.7 11.4 20.4 11.7 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H17L21 7V11.7C20.4 11.4 19.7 11.2 19 11.1V7.8L16.2 5H5V19H11.1M12 12C10.3 12 9 13.3 9 15C9 16.3 9.8 17.4 11 17.8C11.1 15.6 12.1 13.7 13.7 12.5C13.2 12.2 12.6 12 12 12M15 10V6H6V10H15M22.8 19.6L21.8 21.3C21.7 21.4 21.6 21.4 21.5 21.4L20.3 21C20 21.2 19.8 21.3 19.5 21.5L19.3 22.8C19.3 22.9 19.2 23 19.1 23H17.1C17 23 16.9 22.9 16.8 22.8L16.6 21.5C16.3 21.4 16 21.2 15.8 21L14.6 21.5C14.5 21.5 14.4 21.5 14.3 21.4L13.3 19.7C13.2 19.6 13.3 19.5 13.4 19.4L14.5 18.6V17.6L13.4 16.8C13.3 16.7 13.3 16.6 13.3 16.5L14.3 14.8C14.4 14.7 14.5 14.7 14.6 14.7L15.8 15.2C16.1 15 16.3 14.9 16.6 14.7L16.8 13.4C16.8 13.3 16.9 13.2 17.1 13.2H19.1C19.2 13.2 19.3 13.3 19.3 13.4L19.5 14.7C19.8 14.8 20.1 15 20.4 15.2L21.6 14.7C21.7 14.7 21.9 14.7 21.9 14.8L22.9 16.5C23 16.6 22.9 16.7 22.8 16.8L21.7 17.6V18.6L22.8 19.4C22.9 19.4 22.9 19.5 22.8 19.6M19.5 18C19.5 17.2 18.8 16.5 18 16.5S16.5 17.2 16.5 18 17.2 19.5 18 19.5C18.8 19.5 19.5 18.8 19.5 18Z",content:f?e.createElement("div",{className:"flex-col ai-start o-auto ws-pre"},e.createElement(et,{iconPath:we,className:"mb-1 f-0",size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(n),' \nADD CONSTRAINT "my_constraint" \nPRIMARY KEY (\n').concat(E.slice(0,2).map((e=>(0,Cr.asName)(e.name))).join(", \n"),"\n);")}})}},"Add"),e.createElement("div",{className:"flex-col f-1 min-h-0 o-auto"},f.constraints.map(((t,r)=>e.createElement("div",{key:r,className:"flex-row ai-center"},e.createElement("div",{className:"flex-row mr-1 "},e.createElement(et,{iconPath:le,onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(n)," DROP CONSTRAINT ").concat((0,Cr.asName)(t.conname),";")}})}})),e.createElement(Mr,{label:t.conname,value:t.definition}))))),g):null},Indexes:{label:f?"Indexes "+f.indexes.length:void 0,leftIconPath:"M18.68,12.32C16.92,10.56 14.07,10.57 12.32,12.33C10.56,14.09 10.56,16.94 12.32,18.69C13.81,20.17 16.11,20.43 17.89,19.32L21,22.39L22.39,21L19.3,17.89C20.43,16.12 20.17,13.8 18.68,12.32M17.27,17.27C16.29,18.25 14.71,18.24 13.73,17.27C12.76,16.29 12.76,14.71 13.74,13.73C14.71,12.76 16.29,12.76 17.27,13.73C18.24,14.71 18.24,16.29 17.27,17.27M10.9,20.1C10.25,19.44 9.74,18.65 9.42,17.78C6.27,17.25 4,15.76 4,14V17C4,19.21 7.58,21 12,21V21C11.6,20.74 11.23,20.44 10.9,20.1M4,9V12C4,13.68 6.07,15.12 9,15.7C9,15.63 9,15.57 9,15.5C9,14.57 9.2,13.65 9.58,12.81C6.34,12.3 4,10.79 4,9M12,3C7.58,3 4,4.79 4,7C4,9 7,10.68 10.85,11H10.9C12.1,9.74 13.76,9 15.5,9C16.41,9 17.31,9.19 18.14,9.56C19.17,9.09 19.87,8.12 20,7C20,4.79 16.42,3 12,3Z",content:f?e.createElement("div",{className:"flex-col ws-pre"},e.createElement("div",{className:"flex-row ai-center mb-1 f-0"},e.createElement(et,{iconPath:we,className:"mr-1",size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"CREATE INDEX ON public.".concat((0,Cr.asName)(n)," (").concat(E.map((e=>e.name)).join(", "),")"),hint:"Add new index"}})}},"Add"),e.createElement(et,{iconPath:ae,size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"REINDEX TABLE  ".concat((0,Cr.asName)(n)),hint:"REINDEX is similar to a drop and recreate of the index in that the index contents are rebuilt from scratch"}})}},"Reindex table")),e.createElement("div",{className:"flex-col f-1 min-h-0 o-auto"},f.indexes.map(((t,n)=>e.createElement("div",{key:n,className:"flex-row ai-center"},e.createElement("div",{className:"flex-row mr-1 "},e.createElement(et,{iconPath:le,onClick:()=>{this.setState({query:{sql:"DROP INDEX ".concat((0,Cr.asName)(t.indexname))}})}}),e.createElement(et,{iconPath:ae,onClick:()=>{this.setState({query:{sql:"REINDEX INDEX  ".concat((0,Cr.asName)(t.indexname)),hint:"REINDEX is similar to a drop and recreate of the index in that the index contents are rebuilt from scratch"}})}})),e.createElement(Mr,{variant:"naked",value:t.indexdef}))))),g):null},"Table info":{leftIconPath:me,content:f?e.createElement("div",{className:"flex-col ai-start o-auto"},e.createElement("div",{className:"flex-row mr-1 ai-center"},e.createElement(Mr,{className:" ",variant:"naked",label:"Name",value:n}),e.createElement(et,{iconPath:ye,variant:"outline",onClick:()=>{this.setState({query:{sql:"ALTER TABLE ".concat((0,Cr.asName)(n)," \nRENAME TO new_table_name")}})}})),e.createElement(Mr,{className:" ",variant:"naked",label:"OID",value:null==a?void 0:a.table_oid}),e.createElement("div",{className:"flex-row mr-1 ai-center"},e.createElement(Mr,{className:" ",variant:"naked",label:"Comment",value:null==f?void 0:f.comment}),e.createElement(et,{iconPath:ye,variant:"outline",onClick:()=>{this.setState({query:{sql:"COMMENT ON TABLE ".concat((0,Cr.asName)(n)," IS 'My comment';")}})}})),e.createElement("h4",{className:""},"Size on disk"),e.createElement(Mr,{className:"mb-p5",variant:"naked",label:"Actual Size",value:f.sizeInfo["Actual Size"]}),e.createElement(Mr,{className:"mb-p5",variant:"naked",label:"Index Size",value:f.sizeInfo["Index Size"]}),e.createElement(Mr,{className:"mb-p5",variant:"naked",label:"Total Size",value:f.sizeInfo["Total Size"]}),e.createElement(Mr,{className:"mb-p5",variant:"naked",label:"Row count",value:(+f.sizeInfo["Row count"]||0).toLocaleString()}),e.createElement("div",{className:"flex-row mr-1 ai-center mt-1 "},e.createElement(et,{className:"mr-1",iconPath:ae,size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"VACUUM ".concat((0,Cr.asName)(n)," "),hint:"Garbage-collect and optionally analyze a database"}})}},"Vacuum"),e.createElement(et,{className:"mr-1",iconPath:ae,size:"small",variant:"outline",onClick:()=>{this.setState({query:{sql:"VACUUM FULL ".concat((0,Cr.asName)(n)," "),hint:'Selects "full" vacuum, which can reclaim more space, but takes much longer and exclusively locks the table'}})}},"Vacuum Full"),e.createElement(et,{iconPath:"M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z",size:"small",color:"danger",variant:"outline",onClick:()=>{this.setState({query:{sql:"-DROP TABLE ".concat((0,Cr.asName)(n)," "),hint:'Table will be deleted from the database. Remove "-" and then run the query'}})}},"Drop")),g):null},Options:{leftIconPath:se,content:e.createElement("div",{className:"flex-col ai-start mb-1 f-1 o-auto"},e.createElement(aN,{className:"mt-1 w-fit f-0",asColumn:!0,type:"checkbox",label:"View as card",value:!(null==a||!a.options.viewAsCard),onChange:e=>{a.$update({options:{viewAsCard:e}},{deepMerge:!0})}}),(null==a?void 0:a.options.viewAsCard)&&e.createElement(aN,{className:"mt-1 w-fit f-0",asColumn:!0,type:"number",label:"Cards per row",inputProps:{step:1,min:1,max:8},value:(null==a?void 0:a.options.cardRows)||1,onChange:e=>{a.$update({options:{cardRows:Math.round(+e)}},{deepMerge:!0})}}),(null==a?void 0:a.options.viewAsCard)&&e.createElement(aN,{className:"mt-1 w-fit f-0",asColumn:!0,type:"checkbox",label:"Hide card column names",value:!(null==a||!a.options.hideCardFieldNames),onChange:e=>{a.$update({options:{hideCardFieldNames:e}},{deepMerge:!0})}}),e.createElement(aN,{className:"mt-1 w-fit f-0",asColumn:!0,type:"checkbox",label:"Hide edit row button",value:!(null==a||!a.options.hideEditRow),onChange:e=>{a.$update({options:{hideEditRow:e}},{deepMerge:!0})}}),e.createElement(aN,{className:"mt-2 w-fit f-0",asColumn:!0,type:"checkbox",label:"Hide top count",value:!(null==a||!a.options.hideCount),onChange:e=>{a.$update({options:{hideCount:e}},{deepMerge:!0})},hint:"Will improve performance"}),e.createElement(aN,{className:"mt-1 w-fit f-0",asColumn:!0,type:"number",label:"Maximum number of characters per column",value:null!==(b=!(null==a||!a.options.maxCellChars))&&void 0!==b?b:500,onChange:e=>{a.$update({options:{maxCellChars:e}},{deepMerge:!0})}}),e.createElement(eN,{label:"Max row height in pixels",className:"mt-1 w-fit f-0",value:null!==(w=null===(x=a.options)||void 0===x?void 0:x.maxRowHeight)&&void 0!==w?w:100,variant:"div",options:[25,50,100,150,200,300,400,500,600,700,800],onChange:e=>{a.$update({options:{maxRowHeight:e}},{deepMerge:!0})}}))}}}return e.createElement("div",{className:"table-menu c-s-fit flex-col",style:{maxHeight:"calc(100vh - 65px)",maxWidth:"100vw"}},e.createElement(yr,{variant:"vertical",contentClass:" min-h-0 max-h-100v flex-col  "+("Alter"===u?" ":" p-1")+" ",items:m,compactMode:!0,activeKey:u,onChange:function(){var e=ti((function*(e){if(t.setState({l1Key:e,query:void 0,infoQuery:void 0}),"View as card"===e)t.d.w.$update({options:{viewAsCard:!0}},{deepMerge:!0});else if("Columns"===e){var i=yield ii.getWCols(r[n],a,!0);t.setState({columnsConfig:i})}else if("Filter"===e){var o={show_menu:!1};t.d.w.filter||(o.filter=[]),t.d.w.$update(o)}}));return function(){return e.apply(this,arguments)}}()}),"Columns"===u?e.createElement("div",{className:"flex-col o-auto p-1"},n&&r.sql?e.createElement(e.Fragment,null,c?e.createElement(e.Fragment,null,e.createElement(aN,{className:"mb-1",asColumn:!0,label:c.label,readOnly:!0,asTextArea:!0,value:c.query})):null):null):null)}}function oi(){return(oi=ti((function*(e,t){try{return{constraints:yield e.sql("\n      SELECT conname, pg_get_constraintdef(c.oid) as definition \n      FROM pg_catalog.pg_constraint c\n        INNER JOIN pg_catalog.pg_class rel\n        ON rel.oid = c.conrelid\n        INNER JOIN pg_catalog.pg_namespace nsp\n        ON nsp.oid = connamespace\n        WHERE nsp.nspname = 'public'\n            AND rel.relname = ${tableName};",{tableName:t},{returnType:"rows"}),indexes:yield e.sql("\n      SELECT tablename, indexname, indexdef\n      FROM pg_indexes\n      WHERE schemaname = 'public' AND tablename=${tableName}",{tableName:t},{returnType:"rows"}),sizeInfo:(yield e.sql('\n      SELECT\n        relname  as table_name,\n        pg_size_pretty(pg_total_relation_size(relid)) As "Total Size",\n        pg_size_pretty(pg_total_relation_size(relid) - pg_relation_size(relid)) as "Index Size",\n        pg_size_pretty(pg_relation_size(relid)) as "Actual Size",\n        (SELECT COUNT(*) FROM ${tableName:name}) as "Row count"\n      FROM pg_catalog.pg_statio_user_tables \n      WHERE relname=${tableName}\n      ORDER BY pg_total_relation_size(relid) DESC;\n    ',{tableName:t},{returnType:"row"}))||{},comment:yield e.sql("SELECT obj_description(format('%I', $1)::regclass::oid) as c FROM pg_class LIMIT 1",[t],{returnType:"value"}),triggers:yield e.sql("\n      SELECT event_object_table\n        ,trigger_name\n        ,event_manipulation\n        ,action_statement\n        ,action_timing\n        ,CASE WHEN pg_catalog.starts_with(action_statement, 'EXECUTE FUNCTION ') THEN pg_get_functiondef(RIGHT(action_statement, -17 )::regprocedure) ELSE '' END as function_def\n      FROM  information_schema.triggers\n      -- WHERE event_object_table = ${tableName}\n      ORDER BY event_object_table\n      ,event_manipulation\n    ",{tableName:t},{returnType:"rows"})}}catch(e){throw console.error(e),e}}))).apply(this,arguments)}function si(t){var{refresh:n}=t.options||{},{type:r="None",intervalSeconds:i=3,throttleSeconds:o=0}=n||{},s=e=>{t.$update({options:Qr(Qr({},t.options),{},{refresh:Qr(Qr({},n),e)})})};return e.createElement("div",{className:"flex-col ai-start"},e.createElement(Ar,{variant:"dense",options:ri,value:r,style:{marginRight:"40px",marginBottom:"1em"},onChange:e=>{s({type:e,throttleSeconds:0,intervalSeconds:3})}}),e.createElement("p",{className:"text-gray-600 noselect mt-0"},"Realtime"===r?"Changes shown as received from database. Needs super user to create triggers":"Interval"===r?"Run the query every N seconds":"Data will not be refreshed"),"Interval"===r&&e.createElement(aN,{label:"Seconds",type:"number",value:i,asColumn:!0,hint:"0 to disable",onChange:e=>{var t=+e;s(!t||0>e?{type:"None"}:{intervalSeconds:t})}}),"Realtime"===r&&e.createElement(aN,{label:"Throttle seconds",type:"number",asColumn:!0,value:o,onChange:e=>{s({throttleSeconds:e})}}))}ni(ii,"getWCols",function(){var e=ti((function*(e,t){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(!e||!e.getColumns)return[];var r=(yield e.getColumns()).map((e=>({name:e.name,show:!0,tsDataType:e.tsDataType,computed:!1}))),i=r;if(t&&t.columns&&Array.isArray(t.columns)){if(t.columns.map((e=>e.name)).sort().join()!==r.map((e=>e.name)).sort().join()){var o=t.columns.map((e=>Qr({},e))).filter((e=>r.find((t=>t.name===e.name)))),s=r.filter((e=>!o.find((t=>t.name===e.name)))).map((e=>({name:e.name,show:!0})));o=o.concat(s),n&&(yield t.$update({columns:o})),i=o}}else n&&(yield t.$update({columns:r}));return i}));return function(){return e.apply(this,arguments)}}());var ai=[{label:"CREATE TABLE",info:"Create a table within the current database",sql:"/* DROP TABLE IF EXISTS my_new_table; */\n  CREATE TABLE /* IF NOT EXISTS */ my_new_table (\n\n    /* Auto incrementing key */\n    id  SERIAL PRIMARY KEY\n\n    username    TEXT NOT NULL,\n    first_name  TEXT NOT NULL,\n    last_name   TEXT NOT NULL,\n    created     TIMESTAMP DEFAULT NOW()\n\n);\n/* \nAlternatively, you can use a UUID PRIMARY KEY. This requires pgcrypto extension to be installed:\n  CREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid()\n\nTo reference a (unique) column from another table:\n  user_id UUID NOT NULL REFERENCES users(id), \n*/"},{label:"INSERT ROWS",info:"Add data to a table",sql:"INSERT INTO my_new_table (col1, col2, col3)\nVALUES \n  (1, 1, 1),\n  (2, 2, 2),\n  (3, 3, 3);\n\n/* From select */\nINSERT INTO my_new_table (col1, col2, col3)\nSELECT col1, col2, col3 \nFROM my_other_table\nWHERE col3 = 33;\n"},{label:"DELETE ROWS",info:"Delete data from a table",sql:"DELETE FROM my_new_table\nWHERE col3 = 33;\n\n/* To delete matching records in a child table where a foreign key relationship is in place */\nDELETE FROM my_new_table CASCADE\nWHERE col3 = 33;\n"},{label:"UPDATE ROWS",info:"Update data in a table",sql:"UPDATE my_new_table\nSET status = 'active'\nWHERE username = 'me'\n\n/* From select */\nUPDATE my_new_table\nSET customer = subquery.customer,\n  address = subquery.address\nFROM (\n  SELECT customer, address, row_id\n  FROM ...\n) AS subquery\nWHERE my_new_table.row_id = subquery.row_id;\n"},{label:"DROP TABLE",info:"Drop a table",sql:"DROP TABLE /* IF EXISTS */ my_new_table;"},{label:"RENAME A TABLE",info:"Rename a table. Change table name",sql:"ALTER TABLE my_table\nRENAME TO my_new_table;"},{label:"VACUUM A TABLE",info:"Vacuum a table. Reclaims storage occupied by dead tuples",sql:"VACUUM /* FULL */ my_table;"},{label:"COMMENT A TABLE",info:"Comment on a table ",sql:"COMMENT ON TABLE my_table IS 'My comment';"},{label:"ADD NEW COLUMN",info:"Add a new column to an existing table",sql:"ALTER TABLE my_table ADD COLUMN new_colname INTEGER;"},{label:"RENAME COLUMN",info:"Add a new column to an existing table",sql:"ALTER TABLE my_table RENAME COLUMN colname TO new_colname;"},{label:"CHANGE COLUMN DATA TYPE",info:"Change an existing column data type",sql:"ALTER TABLE my_table ALTER COLUMN colname TYPE TIMESTAMP;\n\n/* To apply a function during conversion */\nALTER TABLE my_table ALTER COLUMN colname TYPE TIMESTAMP USING to_timestamp(colname, 'yyyy-mm-dd');\n"},{label:"ADD FOREIGN KEY",info:"Add a FOREIGN KEY/REFERENCES constraint to an existing column from table",sql:"ALTER TABLE my_table\nADD FOREIGN KEY (table2_id) \nREFERENCES table2 ( id );"},{label:"ADD PRIMARY KEY",info:"Add a PRIMARY KEY constraint to an existing column from table",sql:"ALTER TABLE my_table\n  ADD PRIMARY KEY (colname) \n  "},{label:"DROP COLUMN",info:"Drops/Removes column from a table",sql:"ALTER TABLE my_table\nDROP COLUMN colname "},{label:"CREATE USER",info:"Creates a user",sql:"CREATE USER new_user WITH ENCRYPTED PASSWORD 'the_password';\n\n/* To allow user access to a database */\nGRANT ALL PRIVILEGES ON DATABASE my_db TO new_user;\n\n/* To grant full control to user */\nALTER USER new_user WITH SUPERUSER \n"},{label:"CREATE DATABASE",info:"Creates a database",sql:"CREATE DATABASE my_db;"},{label:"DROP DATABASE",info:"Drops/removes a database",sql:"DROP DATABASE my_db;"},{label:"CREATE EXTENSION",info:"Creates/enables/installs an extension",sql:"/*** Some extensions are included in the default installation ***/\n/* Provides cryptographic functions  */\nCREATE EXTENSION pgcrypto;\n\n/* Track statistics on the queries executed by a Postgres database */\nCREATE EXTENSION pg_stat_statements;\n\n/* Allows using a Foreign Data Wrapper to access tables on remote Postgres servers */\nCREATE EXTENSION postgres_fdw;\n\n/*** Other extensions need to be installed first ***/  \n/* Adds support for geographic and geometric data types and functions */  \nCREATE EXTENSION IF NOT EXISTS postgis;\n\n"},{label:"CREATE TRIGGER",info:"Create trigger on data change",sql:"CREATE OR REPLACE FUNCTION order_on_insert\n  RETURNS trigger AS\n$$\n\nBEGIN\n\n  INSERT INTO orders_audit (id, customer_id, product_id, added)\n  VALUES(NEW.id, NEW.customer_id, NEW.product_id, now());\n\n  RETURN NEW;\n\nEND;\n\n$$\nLANGUAGE 'plpgsql';\n\nCREATE TRIGGER order_on_insert_trigger\nAFTER INSERT\nON orders\nFOR EACH ROW\nEXECUTE PROCEDURE order_on_insert();"},{label:"CREATE EXTENSION",info:"Creates/enables/installs an extension",sql:"/*** Some extensions are included in the default installation ***/\n/* Provides cryptographic functions  */\nCREATE EXTENSION pgcrypto;\n\n/* Track statistics on the queries executed by a Postgres database */\nCREATE EXTENSION pg_stat_statements;\n\n/* Allows using a Foreign Data Wrapper to access tables on remote Postgres servers */\nCREATE EXTENSION postgres_fdw;\n\n/*** Other extensions need to be installed first ***/  \n/* Adds support for geographic and geometric data types and functions */  \nCREATE EXTENSION IF NOT EXISTS postgis;\n\n"},{label:"Clone database",info:"Create a copy/clone of an existing database",sql:"/* originaldb must be idle/not accessed by other users */\nCREATE DATABASE newdb WITH TEMPLATE originaldb OWNER dbuser;\n\n/* To make originaldb idle */\nSELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity \nWHERE pg_stat_activity.datname = 'originaldb' AND pid <> pg_backend_pid();\n  "}];function li(){return li=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},li.apply(this,arguments)}function ci(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ui(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ci(Object(t),!0).forEach((function(n){fi(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ci(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function hi(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function di(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){hi(a,r,i,o,s,"next",e)}function s(e){hi(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function fi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pi=[{key:"views and queries",label:"Tables/Queries"},{key:"rows",label:"Data"},{key:"commands",label:"SQL Snippets"}];class mi extends We{constructor(t){var n,r;super(t),n=this,fi(this,"onDeltaCombined",function(){var e=di((function*(e,t){t.includes("searchType")&&e.searchType&&n.setState({sType:e.searchType}),t.includes("sType")&&e.sType&&n.searchTerm}));return function(){return e.apply(this,arguments)}}()),fi(this,"searchRows",(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",{sType:r,tablesToSearch:i,matchCase:o}=n.state,{db:s,tables:a}=n.props;n.searchTerm=t,n.searching&&clearTimeout(n.searching),n.searching=setTimeout(di((function*(){var t=n.searchTerm+"";if("rows"===r&&s.sql){n.setState({loading:!0}),n.setState({items:void 0});var o=function*(r){var i,o="*",l=null===(i=a.find((e=>e.name===r)))||void 0===i?void 0:i.columns;if(l&&(o=l.filter((e=>"geography"!==e.udt_name&&"geometry"!==e.udt_name&&(!/[a-z]/i.test(t)||"number"!==e.tsDataType))).map((e=>e.name))),s[r].find&&n.mounted&&o.length&&t===n.searchTerm){var{matchCase:c}=n.state;n.setState({currentSearchedTable:r});var u={$term_highlight:[o,t,{edgeTruncate:30,matchCase:c,returnType:"object"}]},h={$term_highlight:[o,t,{matchCase:c,returnType:"boolean"}]},d=(yield s[r].find(h,{select:{$rowhash:1,s:u},limit:3})).filter((e=>e.s)).map((e=>{var t=Object.keys(e.s)[0];return{$rowhash:e.$rowhash,table:r,colName:t,match:e.s[t].map(((e,n)=>n?e:"".concat(t,": ").concat(e)))}}));if(t===n.searchTerm&&"rows"===n.searchType){var{onOpen:f,onClose:p}=n.props,m=d.map(((r,i)=>{var o;return ui(ui({},r),{},{key:r.$rowhash+i,label:r.table,content:e.createElement("div",{className:"f-1 flex-row ai-start",title:"Open table at row"},e.createElement("div",{className:"flex-col ai-start f-0 mr-p5 text-gray-500"},e.createElement(Ae(),{path:null!=s&&null!==(o=s[r.table])&&void 0!==o&&o.insert?Se:_e,size:1.5})),e.createElement("div",{className:"flex-col ai-start f-1"},e.createElement("div",{className:"font-18"},r.table),e.createElement("div",{style:{fontSize:"16px",opacity:.7,textAlign:"left",width:"100%",marginTop:".25em"},className:n.searchType?"":"text-gray-400"},mi.renderRow(r.match,i)))),onPress:()=>{var e=[];r.colName&&e.push({fieldName:r.colName,type:"$term_highlight",value:t}),f({table:r.table,filter:e}),p()}})}));m.length&&n.setState({items:[...n.state.items||[],...m]})}else n.setState({loading:!1})}};for(var l of i)yield*o(l);n.setState({loading:!1,items:n.state.items||[]}),n.searching=null}else console.error("Unexpected option")})),600)})),this.state={searchTerm:"",sType:null!==(r=t.searchType)&&void 0!==r?r:"rows",matches:[],loading:!1,rows:[],cols:[],db_objects:[],tablesToSearch:[],allTablesToSearch:[],matchCase:!1,objTypesToSearch:["tables","queries"]}}onMount(){var{defaultTerm:e,db:t}=this.props,n=Object.keys(t).filter((e=>t[e].find)),r=n.slice(0);this.setState({searchTerm:e,tablesToSearch:n,allTablesToSearch:r},(()=>{e&&this.searchRows(e)}))}getSearchListProps(){var{sType:t,objTypesToSearch:n}=this.state,{queries:r,onClose:i,suggestions:o}=this.props;this.searchType=t;var s,a=!1,l=void 0;return"views and queries"===t?s=o.slice(0).filter((e=>"table"===e.type&&"public"===e.schema&&n.includes("tables"))).map((t=>({key:t.label,label:t.escapedIdentifier,subLabel:t.subLabel,contentLeft:e.createElement("div",{className:"f-0"},e.createElement(Ae(),{className:"text-gray-500 p-p25",size:1.5,path:"table"===t.type?_e:"function"===t.type?fe:null})),onPress:()=>{this.props.onClose(),this.props.onOpenDBObject(t)}}))).concat((n.includes("queries")?r:[]).map((t=>({key:t.id,label:t.name,subLabel:t.sql||"",contentLeft:e.createElement("div",{className:"f-0"},e.createElement(Ae(),{className:"text-gray-500 p-p25",size:1.5,path:xe})),onPress:(e,n)=>{var r;this.props.onClose();var i={};if(t.sql&&n&&t.sql.toLowerCase().includes(n.toLowerCase())){var o=t.sql.split("\n").map((e=>e.toLowerCase())),s=o.findIndex((e=>e.includes(n.toLowerCase()))),a={column:o[s].indexOf(n.toLowerCase())+1,lineNumber:s+1};i={options:ui(ui({},t.options||{}),{},{cursorPosition:a})}}null===(r=t.$update)||void 0===r||r.call(t,ui({closed:!1},i),{deepMerge:!0})}})))):"commands"===t?s=ai.map((t=>ui(ui({},t),{},{key:t.label,label:t.label,subLabel:t.info+"\n"+t.sql,contentLeft:e.createElement(Ae(),{path:"M6 2C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H12V20H6V4H13V9H18V12H20V8L14 2M18 14C17.87 14 17.76 14.09 17.74 14.21L17.55 15.53C17.25 15.66 16.96 15.82 16.7 16L15.46 15.5C15.35 15.5 15.22 15.5 15.15 15.63L14.15 17.36C14.09 17.47 14.11 17.6 14.21 17.68L15.27 18.5C15.25 18.67 15.24 18.83 15.24 19C15.24 19.17 15.25 19.33 15.27 19.5L14.21 20.32C14.12 20.4 14.09 20.53 14.15 20.64L15.15 22.37C15.21 22.5 15.34 22.5 15.46 22.5L16.7 22C16.96 22.18 17.24 22.35 17.55 22.47L17.74 23.79C17.76 23.91 17.86 24 18 24H20C20.11 24 20.22 23.91 20.24 23.79L20.43 22.47C20.73 22.34 21 22.18 21.27 22L22.5 22.5C22.63 22.5 22.76 22.5 22.83 22.37L23.83 20.64C23.89 20.53 23.86 20.4 23.77 20.32L22.7 19.5C22.72 19.33 22.74 19.17 22.74 19C22.74 18.83 22.73 18.67 22.7 18.5L23.76 17.68C23.85 17.6 23.88 17.47 23.82 17.36L22.82 15.63C22.76 15.5 22.63 15.5 22.5 15.5L21.27 16C21 15.82 20.73 15.65 20.42 15.53L20.23 14.21C20.22 14.09 20.11 14 20 14M19 17.5C19.83 17.5 20.5 18.17 20.5 19C20.5 19.83 19.83 20.5 19 20.5C18.16 20.5 17.5 19.83 17.5 19C17.5 18.17 18.17 17.5 19 17.5Z",size:1.5,className:"mr-p5 text-gray-500"}),onPress:()=>{this.props.loadTable({type:"sql",name:t.label,sql:t.sql}),this.props.onClose()}}))):"rows"===t&&(l=this.searchRows,a=!0,s=this.state.items),{items:s,onSearch:l,onType:(e,n)=>{"commands"!==t&&">"===e&&(n(""),this.setState({sType:"commands",searchTerm:""}))},dontHighlight:a,placeholder:"Search..."}}render(){var{loading:t=!1,sType:n,tablesToSearch:r,allTablesToSearch:i,currentSearchedTable:o,matchCase:s,objTypesToSearch:a}=this.state,{defaultTerm:l,onClose:c}=this.props,u=this.getSearchListProps(),h=600>window.innerWidth,d=h?0:"2em",f={marginTop:h?".5em":"68px",flex:"none"},p="f-0 "+(h?"":" px-1 "),m="commands"===n?null:"rows"===n?e.createElement(eN,{label:"Tables",style:f,className:p,limit:1e3,options:i,value:r,multiSelect:!0,onChange:e=>this.setState({tablesToSearch:e})}):e.createElement(eN,{label:"Tables/Queries",style:f,className:p,limit:1e3,options:["tables","queries"],value:a,multiSelect:!0,onChange:e=>this.setState({objTypesToSearch:e})}),g=e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-row aai-start w-full min-h-0",style:{width:"hh550px",maxWidth:"88vw",alignSelf:"center"}},!h&&m,e.createElement("div",{className:"flex-col min-w-0 min-h-0 f-1"},e.createElement(Ar,{variant:"dense",className:"o-auto",options:pi.map((e=>e.label)),value:pi.find((e=>e.key===n)).label,style:{marginRight:"40px",marginBottom:"1em"},onChange:e=>{var t=pi.find((t=>t.label===e)).key;this.setState({sType:t})}}),h&&m,"commands"===n?null:t&&"rows"===n?e.createElement("div",{className:"flex-row f-0 min-h-0 ai-center h-fit "},e.createElement(Xe,{sizePx:18,className:"f-0 m-p5",show:t}),e.createElement("div",{className:"f-1 ta-left font-14"},"Searching ".concat(o," (").concat(r.indexOf(o)+1,"/").concat(r.length,")"))):e.createElement("div",{style:{width:"34px",height:"34px"}}),e.createElement(_t,li({matchCase:{value:s,onChange:e=>this.setState({matchCase:e})},id:"search-all-db",className:"f-1 min-w-0 flex-col ",searchStyle:{maxWidth:"500px"},defaultSearch:l,limit:1e3},u)))));return e.createElement(pt,{title:"Quick search",contentClassName:" p-1",contentStyle:{overflow:"unset",paddingTop:0},rootStyle:{minHeight:"50vh",top:d,right:d,left:d,maxHeight:"calc(100vh - 4em)"},open:!0,onClose:c,focusTrap:!0},g)}}function gi(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function yi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}fi(mi,"renderRow",((t,n)=>t&&Array.isArray(t)?e.createElement("div",{key:n,className:"flex-row ws-pre f-1 "},t.map(((n,r)=>{if("string"==typeof n){var i=r?{}:{display:"flex",maxWidth:"40%",flex:"none",width:"fit-content",justifyContent:"end"};return 1===t.length&&(delete i.maxWidth,n=BM(n.split("\n").join(" "),25)),e.createElement("span",{key:r,style:i,className:" f-1 text-gray-600 text-ellipsis"+(r?" ta-left":" ")},n)}return Array.isArray(n)&&"string"==typeof n[0]?e.createElement("strong",{key:r,className:"f-0"},n[0]):(console.warn("Unexpected $term_highlight item",n),null)}))):null));class vi extends We{constructor(){var t;super(...arguments),t=this,yi(this,"state",{searchKey:Date.now()}),yi(this,"onDelta",(e=>{null!=e&&e.defaultValue&&this.setState({searchKey:Date.now()})})),yi(this,"onSearchItems",function(){var n,r=(n=function*(n,r,i){var o;if("string"!=typeof n)return[];var s=!(null===(o=null==r?void 0:r.matchCase)||void 0===o)&&o,{db:a,tableName:l,columns:c,column:u,onType:h,tables:d,detailedFilter:f=[]}=t.props,p=d.find((e=>e.name===l)),m=null==p?void 0:p.columns.filter((e=>(u&&e.name===u||(null==c?void 0:c.length)&&c.includes(e.name)||!c&&!u)&&e.select&&"geography"!==e.udt_name&&"geometry"!==e.udt_name&&"bytea"!==e.udt_name)),g=null==p?void 0:p.columns.find((e=>e.name===u));null==h||h(n);for(var y,v=[],b=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,r={$term_highlight:[[e],n,{matchCase:s,edgeTruncate:30,returnType:"boolean"}]},i={prgl_term_highlight:{$term_highlight:[[e],n,{matchCase:s,edgeTruncate:30,returnType:"object"}]}};return u&&(i[u]=1),null!=f&&f.length&&(r={$and:[...ki(f).$and,r].filter((e=>e))}),a[l].find(r,{select:i,limit:t,groupBy:!0})},w=!(!n||!/[a-z]/i.test(n)),x=[],E=!1,_=0;_<m.length;_++)if(y=m[_],E||"number"===y.tsDataType&&w);else{var S=(v=v.concat(yield b(y.name))).filter((e=>null==e?void 0:e.prgl_term_highlight)).map(((r,i)=>{var o,s,a,l,c=null!=u?u:null===(o=Object.keys((null==r?void 0:r.prgl_term_highlight)||{}))||void 0===o?void 0:o[0];return c&&(a=null!==(l=u&&"Date"!==(null==g?void 0:g.tsDataType)?null==r?void 0:r[u]:void 0)&&void 0!==l?l:null==r?void 0:r.prgl_term_highlight[c].flat().join(""),s=e.createElement("div",{className:"flex-col ws-pre f-1"},1!==(null==m?void 0:m.length)&&e.createElement("div",{className:"f-0 color-action font-14",style:{fontWeight:400}},c,": "),e.createElement("div",{className:"f-1 ",style:{marginTop:"4px"}},mi.renderRow(null==r?void 0:r.prgl_term_highlight[c],i)))),{key:i,content:s,label:a,title:a+"",onPress:()=>{var e,r=[{fieldName:c,type:"$term_highlight",value:null!==(e=a)&&void 0!==e?e:n}];t.props.detailedFilter&&(r=r.concat(t.props.detailedFilter)),t.props.onChange(r,{columnValue:a,term:n,colName:c})}}}));x=x.concat(S),i(S,_===m.length-1,(()=>{E=!0}))}return x},function(){var e=this,t=arguments;return new Promise((function(r,i){function o(e){gi(a,r,i,o,s,"next",e)}function s(e){gi(a,r,i,o,s,"throw",e)}var a=n.apply(e,t);o(void 0)}))});return function(){return r.apply(this,arguments)}}())}render(){var{searchItems:t,searchKey:n}=this.state,{style:r,className:i,label:o,placeholder:s="Search ...",defaultValue:a,onPressEnter:l,variant:c,searchEmpty:u=!1}=this.props;return e.createElement(_t,{key:a,defaultValue:a,style:r,id:"search-all",className:i,items:t,variant:c||"search",searchEmpty:u,onSearchItems:this.onSearchItems,label:o,placeholder:s,onPressEnter:l})}}function bi(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function wi(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){bi(a,r,i,o,s,"next",e)}function s(e){bi(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function xi(){return xi=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},xi.apply(this,arguments)}function Ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _i(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Ei(Object(t),!0).forEach((function(n){Si(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ei(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ci=[{key:"=",label:"="},{key:"<>",label:"!="},{key:"not null",label:"NOT NULL"},{key:"$in",label:"IN"},{key:"$nin",label:"NOT IN"}],Ti=[{key:"@@.to_tsquery",label:"to_tsquery"},{key:"@@.plainto_tsquery",label:"plainto_tsquery"},{key:"@@.phraseto_tsquery",label:"phraseto_tsquery"},{key:"@@.websearch_to_tsquery",label:"websearch_to_tsquery"}],Oi=[{key:"$ilike",label:"ILIKE"},{key:"$like",label:"LIKE"},{key:"$term_highlight",label:"CONTAINS"}],Pi=[{key:"$between",label:"Between"},{key:">",label:">"},{key:">=",label:">="},{key:"<",label:"<"},{key:"<=",label:"<="}],Ai=e=>{if(!("fieldName"in e)||void 0!==e.value){var t=e=>{var t=_i({},e).value;return"not null"===e.type?{[e.fieldName+".<>"]:null}:{[[e.fieldName,"="===e.type?null:e.type].filter((e=>e)).join(".")]:t}};return Ti.some((t=>t.key===e.type))&&"fieldName"in e?{["".concat(e.fieldName,".").concat(e.type)]:[e.value]}:"$existsJoined"===e.type?{$existsJoined:{["".concat(e.path.join("."))]:t(e.filter)}}:"$term_highlight"===e.type?{$term_highlight:[[e.fieldName||"*"],e.value,{matchCase:!1,edgeTruncate:30,returnType:"boolean"}]}:t(e)}},ki=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return{$and:e.map((e=>Ai(e))).filter((e=>e))}};class Mi extends We{constructor(){super(...arguments),Si(this,"state",{popupAnchor:null,defaultSearch:void 0,options:void 0,addFilter:void 0,searchTerm:""}),Si(this,"onChange",(e=>{this.filter=e;var{onChange:t}=this.props;t(this.filter)}))}render(){var t,{addFilter:n}=this.state,{db:r,tableName:i,detailedFilter:o=[],className:s,style:a={},tables:l}=this.props,c=this.onChange,u=l.find((e=>e.name===i)).columns;null!=n&&null!==(t=n.path)&&void 0!==t&&t.length&&(null==n||n.path[(null==n?void 0:n.path.length)-1]);var h=null!=u&&u.length?e.createElement("div",{key:"o",style:a,className:"flex-row-wrap ai-start min-w-0 min-h-0 "+s},o.map(((t,n)=>{var s,a,h,d=i;if("$existsJoined"===t.type){({fieldName:a}=t.filter);var f=t.path[t.path.length-1];d=f,s=l.find((e=>e.name===f)).columns.find((e=>e.name===a)),h=t.path.join(" > ")+"."+a}else({fieldName:a}=t),s=u.find((e=>e.name===a));s||(s={comment:"",name:a,data_type:"text",delete:!1,element_type:"",element_udt_name:"",filter:!0,has_default:!1,insert:!1,udt_name:"text",is_nullable:!0,is_pkey:!1,label:a,ordinal_position:-1,select:!0,tsDataType:"string",update:!0});var p,m=this.props.detailedFilter.filter(((e,t)=>t!==n)),g={className:"shadow  mr-p5 mt-p5 min-w-0 min-h-0",key:n+a,db:r,label:h,tableName:d,column:s,tables:l,filter:"$existsJoined"===t.type?t.filter:t,otherFilters:"$existsJoined"===t.type?m.filter((e=>"$existsJoined"!==e.type)).map((e=>({type:"$existsJoined",path:[...t.path.slice(0).reverse().slice(1),this.props.tableName],filter:e}))):m,onChange:e=>{var r=[...o];e?"$existsJoined"===t.type?r[n].filter=_i({},e):r[n]=_i({},e):r=r.filter(((e,t)=>t!==n)),c(r)}};return p=e.createElement(Ni,xi({},g,{tables:l})),1<o.length&&n<o.length-1?e.createElement(e.Fragment,{key:"o"+n},p,e.createElement("div",{className:"mr-p5 mt-1 text-gray-600"},"AND")):p}))):null;return h}}Si(Mi,"getDefaultFilter",function(){var e=wi((function*(e){var t,n,r=["number","Date"].includes((null===(t=e.info)||void 0===t?void 0:t.tsDataType)||(null===(n=e.computedConfig)||void 0===n?void 0:n.tsDataType));return{fieldName:e.name,type:r?"$between":"$in"}}));return function(){return e.apply(this,arguments)}}());class Ni extends We{constructor(){var e;super(...arguments),e=this,Si(this,"state",{popupAnchor:null,defaultSearch:void 0,options:void 0,searchTerm:"",allOptionsCount:void 0,searchingItems:!1}),Si(this,"setTerm",function(){var t=wi((function*(t){if(e.searching){if(e.searching.term===t)return;clearTimeout(e.searching.timeout)}"string"==typeof t?(!e.state.searchingItems&&e.setState({searchingItems:!0}),e.searching={term:t,timeout:setTimeout(wi((function*(){e.setState({searchingItems:!0});try{var n,r,i,o,s,a,{db:l,column:c,tableName:u,tables:h,otherFilters:d}=e.props,f=(null==c||null===(n=c.references)||void 0===n?void 0:n.ftable)||u,p=(null==c||null===(r=c.references)||void 0===r||null===(i=r.fcols)||void 0===i?void 0:i[0])||c.name,m=!(null==c||null===(o=c.references)||void 0===o||!o.ftable),g=!0,y={};if(f&&null!=l&&null!==(s=l[f])&&void 0!==s&&s.find){var v,b=null===(v=h.find((e=>e.name===f)))||void 0===v?void 0:v.columns.find((e=>e.name===p));"jsonb"===b.udt_name&&(g=!1);var w=(yield KM.getSuggestions({db:l,col:b,table:f,term:t,groupBy:g,filter:m?{$existsJoined:{[u]:ki(d)}}:ki(d)})).map((e=>"jsonb"===b.udt_name?{raw:e,display:e?JSON.stringify(e):e}:{raw:e,display:e}));y={options:w,searchingItems:!1,error:void 0},e.state.options||(y=_i(_i({},y),{},{allOptionsCount:w.length}))}t===(null===(a=e.searching)||void 0===a?void 0:a.term)?(e.setState(y),e.searching=void 0):e.setState({searchingItems:!1,error:void 0})}catch(t){e.setState({error:t})}})),400)}):e.setState({searchingItems:!1})}));return function(){return t.apply(this,arguments)}}()),Si(this,"onDelta",function(){var t=wi((function*(){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},{db:n,column:r,tableName:i,tables:o,otherFilters:s}=e.props,{searchTerm:a=""}=e.state;(!e.state.options||"searchTerm"in t)&&e.setTerm(a)}));return function(){return t.apply(this,arguments)}}())}render(){var t,n,r,i,{column:o,className:s="",style:a={},tables:l,onChange:c,db:u,tableName:h}=this.props,d=_i(_i({},this.props.filter),{},{type:null!==(t=this.props.filter.type)&&void 0!==t?t:"="}),{options:f=[],allOptionsCount:p,searchTerm:m,searchingItems:g,error:y}=this.state;if("not null"===this.props.filter.type)n=null;else if(["$in","$nin"].includes(this.props.filter.type)){var v=[];!m&&Array.isArray(null==d?void 0:d.value)&&null!=d&&d.value.length&&(v=null==d?void 0:d.value.filter((e=>!f.includes(e))));var b=Array.from(new Set([...v,...f.map((e=>e.display))])).map((e=>({key:e,label:e,title:"".concat(e),onPress:()=>{var t=d.value;t&&Array.isArray(t)||(t=[]),t.includes(e)?t=t.filter((t=>t!==e)):t.push(e),t.length||(t=void 0),c(_i(_i({},d),{},{value:t}))},checked:!!((null==d?void 0:d.value)&&Array.isArray(null==d?void 0:d.value)&&(null==d?void 0:d.value.includes(e)))})));n=e.createElement(_t,{onSearch:e=>{this.setState({searchTerm:e})},noSearch:p&&8>p,id:"values",items:b,multiSelect:!0,onChange:e=>{e.length||(e=void 0),c(_i(_i({},d),{},{value:e}))}})}else if(["$ilike","$like"].includes(d.type)||Ti.some((e=>e.key===d.type)))n=e.createElement(aN,{asColumn:!0,className:"m-p5",type:"text",autoComplete:"off",value:d.value,inputStyle:{padding:window.isMobileDevice?"2px 6px":"8px"},onChange:e=>{c(_i(_i({},d),{},{value:"".concat(e)}))}});else{if(r=o,!(["$ilike","$like","$term_highlight"].includes(null==(i=d)?void 0:i.type)||(null==r?void 0:r.references)||(null==r?void 0:r.is_pkey))&&["number","Date"].includes(null==r?void 0:r.tsDataType)||"$between"===d.type)return e.createElement(Li,xi({},this.props,{type:o.tsDataType.toLowerCase(),inputType:KM.getInputType(o)}));n=e.createElement(vi,{className:"m-pa25",db:u,tableName:h,style:{padding:".5em"},variant:"search-no-shadow",tables:l,defaultValue:d.value,column:d.fieldName,onPressEnter:e=>{var t=_i({},d);t.value=e,console.log(t),c(t)},onChange:(e,t)=>{var{columnValue:n,term:r}=t,i=_i({},d);i.value=n||r,c(i)}})}return e.createElement(Ri,xi({},this.props,{filter:d,types:[...Oi,...Ti]}),y&&e.createElement(Fe,{error:y}),g&&e.createElement(Xe,{variant:"cover"}),n)}}class Li extends We{constructor(){var e;super(...arguments),e=this,Si(this,"state",{limits:void 0}),Si(this,"onDelta",function(){var t=wi((function*(){var t,{db:n,column:r,tableName:i}=e.props;if(!e.state.limits&&i&&null!=n&&null!==(t=n[i])&&void 0!==t&&t.find){var o=yield n[i].findOne({},{select:{min:{$min:[r.name]},max:{$max:[r.name]}}});e.setState({limits:o}),e.setValue(o)}}));return function(){return t.apply(this,arguments)}}()),Si(this,"setValue",(function(t){var n,r,i,{column:o,filter:s}=e.props,{min:a=(null==s||null===(n=s.value)||void 0===n?void 0:n[0]),max:l=(null==s||null===(r=s.value)||void 0===r?void 0:r[1]),_val:c=(null==s?void 0:s.value)}=t,u="Date"===o.tsDataType;u&&(a=new Date(a),l=new Date(l),c=new Date(c));var h=null!==(i=e.props.filter.type)&&void 0!==i?i:"$between",d=[a,l];if("$ilike"===h||"$like"===h)d=c;else if(null===c)d=c;else if(c&&Number.isFinite(+c))d=+c;else if(a&&Number.isFinite(+a)&&l&&Number.isFinite(+l))+a>+l&&(a=+l),d=[+a,+l];else if(a&&Number.isFinite(+a)&&"$between"===h)d=[+a,+a+1];else{if(!l||!Number.isFinite(+l)||"$between"!==h)return void console.warn("Invalid filter value");d=[+l-1,+l]}u&&null!==d&&(d=Array.isArray(d)?d.map((e=>new Date(e))):new Date(d)),e.props.onChange({fieldName:o.name,type:h,value:d})}))}render(){var t,n,{onChange:r,filter:i,column:o,type:s,inputType:a,tables:l}=this.props,{limits:c}=this.state;if(!o)return null;var u=i.type,h="$between"===u?null==i||null===(t=i.value)||void 0===t?void 0:t[0]:">="===u?null==i?void 0:i.value:null,d="$between"===u?null==i||null===(n=i.value)||void 0===n?void 0:n[1]:"<="===u?null==i?void 0:i.value:null,f=["$ilike","$like"].includes(u),p={className:"p-p25 mr-p5",style:"date"===s?{}:{maxWidth:"125px"},inputStyle:{padding:"4px"},type:f?"text":a,asColumn:!0};return e.createElement(Ri,xi({},this.props,{types:[...Pi,...Oi]}),"not null"===(null==i?void 0:i.type)?null:e.createElement("div",{className:"flex-col p-p5",style:{minWidth:"150px"}},e.createElement("div",{className:"flex-row-wrap f-1"},"$between"===(null==i?void 0:i.type)?e.createElement(e.Fragment,null,e.createElement(aN,xi({},p,{value:KM.parseValue(o,h),label:"Min",onChange:e=>{this.setValue({min:e})}})),e.createElement(aN,xi({},p,{value:KM.parseValue(o,d),label:"Max",onChange:e=>{this.setValue({max:e})}}))):f?e.createElement(aN,xi({},p,{type:"text",value:i.value,onChange:e=>{this.setValue({_val:e})}})):e.createElement(KM,xi({variant:"compact"},p,{tables:l,style:{margin:".5em"},column:o,value:Array.isArray(i.value)?null:KM.parseValue(o,i.value),onChange:e=>{this.setValue({_val:e})}})))))}}class Ri extends We{constructor(){super(...arguments),Si(this,"state",{popupAnchor:null,defaultSearch:void 0,options:void 0,searchTerm:"",allOptionsCount:void 0}),Si(this,"onDelta",(e=>{var{filter:t,db:n,tableName:r}=this.props;null!=e&&e.filter&&"fieldName"in t&&void 0!==t.value&&n[r].find(Ai(t),{limit:0}).then((()=>{this.setState({error:void 0})})).catch((e=>{this.setState({error:e})}))}))}render(){var{onChange:t,filter:n,column:r,children:i,className:o="",style:s={},types:a,label:l=(null==r?void 0:r.name)}=this.props,{error:c}=this.state,u=!!n.minimised,h=()=>{t(_i(_i({},n),{},{minimised:!u}))},d="Click to expand/collapse",f=[...Ci,...a||[]];if(u){var p,m,g=null!==(p=null==f||null===(m=f.find((e=>e.key===n.type)))||void 0===m?void 0:m.label)&&void 0!==p?p:n.type,y=JSON.stringify(n.value||"");Array.isArray(n.value)&&(y="( "+y.slice(1,-1)+" )");var v=y.length>26&&Array.isArray(n.value)&&1<n.value.length?"(".concat(n.value.length,") "):void 0,b=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"...";return e.length>t?"".concat(e.slice(0,t)).concat(n):e}(y,26,v?"...) ":void 0);return"$between"===n.type&&Array.isArray(n.value)&&(b=e.createElement(e.Fragment,null,n.value[0],e.createElement("span",{className:"ws-pre text-gray-500 font-normal font-14"}," AND "),n.value[1],"`")),e.createElement("button",{title:d,className:"flex-row ai-center noselect pointer relative o-hidden "+o,style:_i(_i({},s),{},{background:"rgb(236, 247, 255)",border:"1px solid rgb(226, 226, 226)",borderRadius:"1em",padding:"6px 8px"}),onClick:h},e.createElement("div",{className:"flex-row ai-center noselect pointer relative o-hidden "},e.createElement("div",{className:"text-blue-800 font-18 mr-p25 "+(void 0===(null==n?void 0:n.value)?" text-gray-400 ":""),style:{fontWeight:600}},l),e.createElement("div",{className:" mr-p25 mt-p25 font-14 ",style:{color:"rgb(126 126 126)",textTransform:"uppercase"}},g),"not null"!==n.type&&e.createElement(e.Fragment,null,e.createElement("div",{className:"min-w-0 min-h-0 o-hidden font-18 flex-row ai-center ",style:{whiteSpace:"nowrap",fontWeight:600,color:"string"===r.tsDataType?"#810909":"Date"===r.tsDataType?"#0000ad":"number"===r.tsDataType?"rgb(0, 110, 0)":"black"}},b),v&&e.createElement("div",{className:"min-w-0 min-h-0 o-hidden text-gray-500 ml-p5 flex-row ai-center ",style:{fontWeight:600}},v))))}return e.createElement("div",{className:"flex-col bg-white relative "+o,style:_i({maxWidth:"400px",maxHeight:"50vh"},s)},e.createElement("div",{className:"flex-row ai-start p-p25 "},e.createElement("div",{title:d,className:"flex-row-wrap f-1 font-medium noselect mr-p5 pointer noselect"},e.createElement(et,{exactClassName:"flex-row mx-p25 "+(void 0===n.value?" text-gray-400  ":" text-blue-800 "),style:{marginTop:"0.25em",background:"aliceblue"},onClick:h},l),f?e.createElement(eN,{className:"mt-p25 ",title:"Choose filter type",fullOptions:f,value:(null==n?void 0:n.type)||"",onChange:e=>{var i=_i(_i({},n),{},{type:e,fieldName:n.fieldName});"Date"===r.tsDataType||Array.isArray(n.value)&&"$between"!==e&&"$in"!==e&&"$nin"!==e||("$between"===e||"$in"===e||"$nin"===e)&&!Array.isArray(n.value)?delete i.value:"string"!=typeof i.value&&Oi.some((t=>t.key===e))&&(i.value+=""),t(i)}}):null),e.createElement(et,{iconPath:le,title:"Delete filter",variant:"outline",onClick:()=>{t()}})),i,e.createElement(Fe,{error:c}))}}var Ii=e=>{var{tables:t,tableName:n,excludeTables:r=[]}=e,i=t.find((e=>e.name===n));if(!i)throw"Table info not found";var o=[],s=e=>{r.includes(e.table)||o.find((t=>t.table===e.table&&JSON.stringify(t.on)===JSON.stringify(e.on)))||o.push(e)};i.columns.forEach((e=>{if(e.references){var t,n={table:e.references.ftable,on:null===(t=e.references)||void 0===t?void 0:t.cols.map(((t,n)=>{var r;return[t,null===(r=e.references)||void 0===r?void 0:r.fcols[n]]}))};s(n)}})),t.forEach((e=>{e.name!==n&&e.columns.forEach((t=>{var r;if((null===(r=t.references)||void 0===r?void 0:r.ftable)===n){var i,o={table:e.name,on:null===(i=t.references)||void 0===i?void 0:i.fcols.map(((e,n)=>{var r;return[e,null===(r=t.references)||void 0===r?void 0:r.cols[n]]}))};s(o)}}))}));var a=o.map((e=>_i(_i({},e),{},{joins:Ii({tableName:e.table,tables:t,excludeTables:[n,...r,e.table]})})));return a=a.map((e=>_i({},e))),a};function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ji(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Di(Object(t),!0).forEach((function(n){Bi(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Di(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Fi(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function zi(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Fi(a,r,i,o,s,"next",e)}function s(e){Fi(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function Bi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ui=[{key:"fixed",label:"Fixed"},{key:"fromColumn",label:"From column"},{key:"fromUrlEnding",label:"From URL extension"}],Vi=[{key:"img",label:"Image"},{key:"video",label:"Video"},{key:"audio",label:"Audio"},{key:"svg",label:"SVG"},{key:"apth",label:"Path (SVG)"}],Hi=[{key:"first",label:"First"},{key:"last",label:"Last"},{key:null,label:"None"}];class qi extends We{constructor(){var e;super(...arguments),e=this,Bi(this,"state",{column:null,l1Key:null}),Bi(this,"d",{w:null}),Bi(this,"onDelta",function(){var t=zi((function*(t,n,r){var i,o=ji(ji(ji({},t),n),r),{db:s,tableName:a,colName:l,tables:c}=e.props,u=e.d.w||e.props.w;if(u&&u.$cloneSync&&!e.wSub&&(e.wSub=yield u.$cloneSync(((t,n)=>{e.setData({w:t},{w:n}),e.mounted&&e.forceUpdate()}))),u)if(u.columns&&Array.isArray(u.columns)){if(l&&null!=o&&null!==(i=o.w)&&void 0!==i&&i.columns){var h=jo.getFullColumnConfig(c,u).find((e=>e.name===l));h?e.setState({column:h}):console.warn("Column (".concat(l,") was not found, delete?!"))}}else u.$update({columns:yield ii.getWCols(s[a],u,!0)})}));return function(){return t.apply(this,arguments)}}()),Bi(this,"onUpdate",(e=>{var{w:t}=this.d,{column:n}=this.state,r=t.columns.map((t=>t.name===n.name?ji(ji({},t),e):t));t.$update({columns:r})}))}render(){var t,n,r,i,o,s,a,l,c,u,h,d=this,{w:f}=this.d,{column:p,l1Key:m}=this.state,{db:g,onAddFilter:y,tableName:v,onClose:b,colName:w,tables:x,showColumns:E}=this.props;if(!f||!p)return null;var _=(f.sort||[]).find((e=>e.key===p.name))||{key:p.name,asc:null},S=e=>{var t=!1,n=(f.sort||[]).map((n=>n.key===p.name?(t=!0,ji(ji({},n),e)):ji({},n)));null===e.asc?n=n.filter((t=>t.key!==e.key)):!t&&n.push(e),f.$update({sort:n})},C=x.find((e=>e.name===f.table_name)),{format:T="NONE",contentConfig:O={fromUrlEnding:!0}}=p,P="string"===(null===(t=p.info)||void 0===t?void 0:t.tsDataType)||"string"===(null===(n=p.computedConfig)||void 0===n?void 0:n.tsDataType),A=p.format&&"NONE"!==p.format||p.computedConfig;return e.createElement("div",{className:"f-1 flex-col"},e.createElement("div",{className:"f-1 flex-col p-p5 bg-gray-100 ta-left noselect"},w),e.createElement(yr,{compactMode:!0,variant:"vertical",contentClass:" o-auto "+("Alter"===m?" o-auto ":" p-1 "),items:{Sort:{leftIconPath:"M18 21L14 17H17V7H14L18 3L22 7H19V17H22M2 19V17H12V19M2 13V11H9V13M2 7V5H6V7H2Z",style:"boolean"==typeof _.asc?{color:"var(--blue-600)"}:{},content:e.createElement("div",{className:"flex-col"},e.createElement(eN,{label:"Sort",value:!0===(null==_?void 0:_.asc)?"Ascending":!1===_.asc?"Descending":null,variant:"div",emptyLabel:"None",fullOptions:[{key:!0,label:"Ascending"},{key:!1,label:"Descending"},{key:null,label:"None"}],onChange:e=>{S(ji(ji({},_),{},{asc:e}))}}),"boolean"==typeof _.asc?e.createElement(e.Fragment,null,e.createElement(eN,{label:"Nulls",className:"mt-1",value:(null==_?void 0:_.nulls)||null,variant:"div",fullOptions:Hi,onChange:e=>{S(ji(ji({},_),{},{nulls:e}))}}),P&&e.createElement(aN,{type:"checkbox",label:"Null empty text",className:"mt-1",asColumn:!0,value:_.nullEmpty,onChange:e=>{S(ji(ji({},_),{},{nullEmpty:e}))}})):null)},Style:{leftIconPath:"M19,11.5C19,11.5 17,13.67 17,15A2,2 0 0,0 19,17A2,2 0 0,0 21,15C21,13.67 19,11.5 19,11.5M5.21,10L10,5.21L14.79,10M16.56,8.94L7.62,0L6.21,1.41L8.59,3.79L3.44,8.94C2.85,9.5 2.85,10.47 3.44,11.06L8.94,16.56C9.23,16.85 9.62,17 10,17C10.38,17 10.77,16.85 11.06,16.56L16.56,11.06C17.15,10.47 17.15,9.5 16.56,8.94Z",disabledText:"Media"===p.format?"Cannot style a media format column":void 0,style:null!==(r=p.style)&&void 0!==r&&r.type&&"None"!==(null===(i=p.style)||void 0===i?void 0:i.type)?{color:"var(--blue-600)"}:{},content:e.createElement(lr,{column:p,onUpdate:this.onUpdate,tsDataType:(null===(o=p.info)||void 0===o?void 0:o.tsDataType)||(null===(s=p.computedConfig)||void 0===s?void 0:s.tsDataType)})},"Display format":{style:p.format?{color:"var(--blue-600)"}:{},leftIconPath:de,disabledText:1>=Wi(p.info||p.computedConfig).length?"Only text columns can have custom formats at the moment":void 0,content:e.createElement("div",{className:"flex-col"},e.createElement(eN,{label:"Display format",value:T,variant:"div",options:Wi(p.info||p.computedConfig).map((e=>e.label)),onChange:e=>{var t={format:e};t.contentConfig="Media"===t.format?{fromUrlEnding:!0}:void 0,"NONE"===t.format&&(t.format=void 0),this.onUpdate(t)}}),"HTML"===T&&e.createElement(e.Fragment,null,e.createElement(it,{className:"pt-1",checked:!p.noSanitize,label:"Sanitize HTML. Leave unchecked if you understand the risks",onChange:e=>{this.onUpdate({noSanitize:!e.target.checked})}}),!p.noSanitize&&e.createElement(eN,{label:"Allowed tags",className:"mt-1",value:p.allowedHTMLTags||[],variant:"div",fullOptions:Vi,multiSelect:!0,onChange:e=>{this.onUpdate({allowedHTMLTags:e})}})),"Media"===T&&e.createElement(e.Fragment,null,e.createElement(eN,{label:"Content type",className:"mt-1",value:null!==(a=null===(l=Object.keys(O||{}))||void 0===l?void 0:l[0])&&void 0!==a?a:"fromUrlEnding",variant:"div",fullOptions:Ui,onChange:e=>{"fixed"===e?this.onUpdate({contentConfig:{fixed:"image"}}):"fromColumn"===e?this.onUpdate({contentConfig:{fromColumn:""}}):this.onUpdate({contentConfig:{fromUrlEnding:!0}})}}),"fromColumn"in O&&e.createElement(eN,{label:"Content type",className:"mt-1",value:null!==(c=null===(u=Object.keys(O||{}))||void 0===u?void 0:u[0])&&void 0!==c?c:"fixed",variant:"div",options:null==C?void 0:C.columns.filter((e=>e.name!==O.fromColumn&&"string"===e.tsDataType)).map((e=>e.name)),onChange:e=>{this.onUpdate({contentConfig:{fromColumn:e}})}}),"fixed"in O&&e.createElement(eN,{label:"Content type",className:"mt-1",value:O.fixed,variant:"div",options:["image","video","audio"],onChange:e=>{this.onUpdate({contentConfig:{fixed:e}})}})))},Filter:{leftIconPath:he,disabledText:A?"Cannot filter a computed column":void 0,style:null!==(h=f.filter)&&void 0!==h&&h.some((e=>"fieldName"in e&&e.fieldName===p.name))?{color:"var(--blue-600)"}:{}},Alter:{leftIconPath:"M21.71 20.29L20.29 21.71A1 1 0 0 1 18.88 21.71L7 9.85A3.81 3.81 0 0 1 6 10A4 4 0 0 1 2.22 4.7L4.76 7.24L5.29 6.71L6.71 5.29L7.24 4.76L4.7 2.22A4 4 0 0 1 10 6A3.81 3.81 0 0 1 9.85 7L21.71 18.88A1 1 0 0 1 21.71 20.29M2.29 18.88A1 1 0 0 0 2.29 20.29L3.71 21.71A1 1 0 0 0 5.12 21.71L10.59 16.25L7.76 13.42M20 2L16 4V6L13.83 8.17L15.83 10.17L18 8H20L22 4Z",disabledText:A?"Cannot alter a computed column":void 0,content:e.createElement(Sr,{db:g,tableName:v,field:p.name})},Hide:{leftIconPath:ce},"Hide Others":{leftIconPath:ce},Columns:{leftIconPath:Oe}},onChange:function(){var e=zi((function*(e){if("Columns"===e)E();else if("Filter"===e){var t,n=yield Mi.getDefaultFilter(p,g);null!==(t=d.d.w.filter)&&void 0!==t&&t.length?d.d.w.$update({filter:[n,...d.d.w.filter]}):d.d.w.$update({filter:[n]}),b(),y()}else if("Hide"===e){var r,i=null===(r=d.d.w)||void 0===r?void 0:r.columns.map((e=>ji(ji({},e),{},{show:p.name!==e.name&&e.show})));d.d.w.$update({columns:i}),b()}else if("Hide Others"===e){var o,s=null===(o=d.d.w)||void 0===o?void 0:o.columns.map((e=>ji(ji({},e),{},{show:p.name===e.name})));d.d.w.$update({columns:s}),b()}d.setState({l1Key:e})}));return function(){return e.apply(this,arguments)}}()}))}}function Wi(e){var t=[];return"string"===e.tsDataType&&(t=[{label:"Email",info:"Email link"},{label:"Tel",info:"Telephone number link"},{label:"Media",info:"Display media (video/image/audio) from URL"},{label:"URL",info:"Display string as a clickable URL"},{label:"HTML",info:"Display string as sanitised HTML"}]),t.unshift({label:"NONE",info:"Display data as is"}),t}var Gi=n(9139),$i=n.n(Gi);function Yi(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Xi(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Yi(a,r,i,o,s,"next",e)}function s(e){Yi(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}class Ki extends We{constructor(){super(...arguments),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",{})}render(){var{onClose:t,onAccept:n,acceptBtn:r,message:i,title:o}=this.props;return e.createElement(pt,{open:!0,rootStyle:{padding:0},contentClassName:"flex-col ai-center",onClose:t,title:o},e.createElement("div",{className:"p-1"},i),e.createElement("div",{className:"flex-row p-p5"},e.createElement(et,{color:r.color,variant:"filled",onClick:Xi((function*(){yield n()}))},r.text),e.createElement(et,{variant:"outline",style:{marginLeft:"5em"},onClick:()=>t()},"Cancel")))}}function Zi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ji(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Zi(Object(t),!0).forEach((function(n){Qi(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Zi(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Qi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eo extends We{constructor(){super(...arguments),Qi(this,"state",{focusedFile:void 0,isOverflowing:!1}),Qi(this,"onDelta",(()=>{this.isViewerMode()?!this.resizeObserver&&(this.resizeObserver=new ResizeObserver((()=>{var e=this.refWrapper.scrollWidth>this.refWrapper.offsetWidth;this.state.isOverflowing!==e&&this.setState({isOverflowing:e})})),this.resizeObserver.observe(this.refWrapper)):this.resizeObserver&&this.resizeObserver.unobserve(this.refWrapper)})),Qi(this,"renderMedia",(t=>{var{file:n,i:r,onDelete:i,style:o={},onClick:s}=t,a="url"in n?Ji(Ji({},n),{},{type:n.content_type}):{name:n.name,type:n.data.type,url:URL.createObjectURL(n.data)},{type:l,url:c,name:u}=a,h=null;if(c){var d={maxWidth:"100%",maxHeight:"100%"};l.startsWith("image")?h=e.createElement("img",{loading:"lazy",src:c,style:d}):l.startsWith("video")?h=e.createElement("video",{style:d,controls:!0,src:c}):l.startsWith("audio")&&(h=e.createElement("audio",{style:d,controls:!0,src:c}))}return e.createElement("div",{key:r,className:" relative flex-col ",style:Ji({width:"150px",height:"150px"},o)},e.createElement("div",{className:" relative flex-col f-1"},s?e.createElement("div",{className:"absolute w-full h-full pointer",style:{zIndex:1},onClick:e=>{e.stopPropagation(),e.preventDefault(),s()}}):null,i?e.createElement(et,{style:{position:"absolute",top:"10px",right:"10px",zIndex:2,backgroundColor:"white"},className:"shadow",iconPath:oe,title:"Remove file",onClick:()=>{i()}}):null,e.createElement("div",{className:"f-1 min-w-0 min-h-0 flex-row ai-center"},h)),u?e.createElement("div",{className:"f-0 noselect p-p5 text-gray-500 font-14 absolute w-full f-0",style:{position:"absolute",zIndex:1,bottom:0,color:"white",background:"linear-gradient(to bottom, rgb(255 255 255 / 0%) 0%,#00000075 70%)"}},u):e.createElement("a",{href:c,target:"_blank",className:"p-5 f-0"},c))})),Qi(this,"isViewerMode",(()=>{var{onAdd:e,onDelete:t}=this.props;return!(e||t)}))}render(){var t,n,r,{className:i="",style:o={},label:s,maxFileCount:a=100,accept:l,id:c="file-input-comp",onAdd:u,media:h=[],onDelete:d,minSize:f=150}=this.props,{focusedFile:p,isOverflowing:m}=this.state,g=this.isViewerMode();if(p){var y="data"in p.file?p.file.data.type:p.file.content_type;r=e.createElement(pt,{open:!0,rootStyle:{padding:0},contentClassName:"",onClose:()=>{this.setState({focusedFile:void 0})},title:p.file.name,onKeyDown:g?e=>{if("ArrowRight"===e.key){var t=p.index<h.length-1?p.index+1:0;this.setState({focusedFile:{file:h[t],index:t}})}else if("ArrowLeft"===e.key){var n=p.index?p.index-1:h.length-1;this.setState({focusedFile:{file:h[n],index:n}})}}:void 0},this.renderMedia({file:p.file,i:"focused",style:{width:"fit-content",height:"fit-content",border:"unset"},onClick:y.startsWith("image")?()=>{this.setState({focusedFile:void 0})}:void 0,focused:!0}))}var v=a<=h.length||!u?null:e.createElement("label",{htmlFor:c,className:"f-1 flex-row pl-1 "},e.createElement(Ae(),{path:we,size:1.25,title:"Add files",className:"shadow bg-white pointer round text-blue-500"}),e.createElement("input",{id:c,style:{width:0,height:0},type:"file",accept:l,multiple:1<a,onChange:e=>{var t=Array.from(e.target.files).map((e=>({data:e,name:e.name})));u(t)}})),b=m&&g,w=!(!b||!(null===(t=this.refWrapper)||void 0===t?void 0:t.scrollLeft)),x=!(!b||null!==(n=this.refWrapper)&&void 0!==n&&n.scrollLeft&&!(this.refWrapper.scrollWidth-20>this.refWrapper.scrollLeft+this.refWrapper.clientWidth)),E=e=>{if(this.refWrapper){var t,n,r=(null===(t=this.refWrapper.children)||void 0===t||null===(n=t[1])||void 0===n?void 0:n.offsetWidth)||f;this.refWrapper.scrollLeft+=e*r,this.forceUpdate()}},_="absolute h-full w-fit flex-row ai-center pointer noselect",S={zIndex:2,top:0,bottom:0};return e.createElement("div",{ref:e=>{e&&(this.ref=e)},className:"flex-col f-1 min-w-0 min-h-0 "+i,style:Ji({},o)},r,e.createElement("div",{className:"relative flex-col min-w-0 min-h-0 ",style:{}},v||s?e.createElement("div",{className:"flex-row-wrap ai-center f-0 ",style:{}},e.createElement("div",{className:"py-1 noselect",style:{textAlign:"start",color:"#374151",flex:.5}},s),v):null,e.createElement("div",{className:g?" f-1 flex-row o-auto min-w-0 min-h-0 o-auto ":" p-1  flex-row-wrap ",ref:e=>{e&&(this.refWrapper=e)},onScroll:()=>{var e=window;(!e.__lastMediaScroll||e.__lastMediaScroll<Date.now()-100)&&(this.forceUpdate(),e.__lastMediaScroll=Date.now())}},w&&e.createElement("div",{className:_,style:Ji(Ji({},S),{},{left:0,background:"linear-gradient( -90deg, transparent, white)"}),onClick:()=>E(-1)},e.createElement(Ae(),{size:1.5,path:re})),h.map(((e,t)=>this.renderMedia({file:e,i:t+"media",onDelete:d?()=>{d(e)}:void 0,onClick:()=>{this.setState({focusedFile:{file:e,index:t}})},style:g?{width:"250px",height:"250px",minWidth:"".concat(f,"px"),minHeight:"".concat(f,"px"),margin:0}:{}}))),x&&e.createElement("div",{className:_,style:Ji(Ji({},S),{},{right:0,background:"linear-gradient( 90deg, transparent, white)"}),onClick:()=>E(1)},e.createElement(Ae(),{size:1.5,path:ie})))))}}function to(){return to=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},to.apply(this,arguments)}class no extends e.Component{render(){var{className:t=""}=this.props;return e.createElement("div",to({},this.props,{className:"custom-animations success-checkmark "+t}),e.createElement("div",{className:"check-icon"},e.createElement("span",{className:"icon-line line-tip"}),e.createElement("span",{className:"icon-line line-long"}),e.createElement("div",{className:"icon-circle"}),e.createElement("div",{className:"icon-fix"})))}}function ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function io(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ro(Object(t),!0).forEach((function(n){ao(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ro(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function oo(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function so(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){oo(a,r,i,o,s,"next",e)}function s(e){oo(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function ao(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.Component;class lo extends We{constructor(){var e;super(...arguments),e=this,ao(this,"state",{columns:void 0,error:void 0,currentRow:void 0,newRow:void 0,success:"",confirmUpdates:void 0,showLocalChanges:void 0,rowFilter:void 0,localChanges:[],errors:void 0,tableInfo:void 0,defaultColumnData:{},insertMode:void 0,loaded:!1,sendingData:!1,collapseChanges:!1}),ao(this,"onMount",so((function*(){var t,{columns:n,tableName:r,db:i,lang:o,includeMedia:s=!0,rowFilter:a}=e.props;if(!i[r])throw"Table not available/published: "+r;var l,c,u=yield i[r].getInfo(),h=yield i[r].getColumns(o);n&&(h=n.map((e=>{if("string"==typeof e)return h.find((t=>t.name===e));var t=h.find((t=>t.name===e.name));return e.sectionHeader?io(io({},t),e):io({},t)})).filter((e=>e))),null!=u&&u.has_media&&s&&null!==(t=i[u.media_table_name])&&void 0!==t&&t.getInfo&&(l=yield null===(c=i[u.media_table_name])||void 0===c?void 0:c.getInfo());var d={};a||h.map((e=>{d[e.name]=KM.parseDefaultValue(e,void 0,!1)})),e.setState({columns:h,tableInfo:u,mediaTableInfo:l,defaultColumnData:d,loaded:e.state.loaded||!a})}))),ao(this,"getErrors",function(){var t=so((function*(t){var n,{defaultData:r={},rowFilter:i,cannotBeNullMessage:o="Must not be empty"}=e.props,{columns:s,newRow:a={},defaultColumnData:l={}}=e.state,c=io(io(io({},l),r),a);if(e.getDisplayedColumns().filter((e=>!e.is_nullable&&(e.insert||e.update))).map((e=>{var t;(i||(t=null==c?void 0:c[e.name],![void 0,null].includes(t))||e.has_default)&&null!==(null==c?void 0:c[e.name])||((n=n||{})[e.name]=o)})),n)e.setState({errors:n});else{var u;e.props.onValidateValue?yield Promise.all(s.map(function(){var t=so((function*(t){var n=yield e.props.onValidateValue(c[t.name],c,t);n&&(u=io(io({},u=u||{}),{},{[t.name]:n}))}));return function(){return t.apply(this,arguments)}}())):e.props.onValidate&&(u=yield e.props.onValidate(c,s));var h=u||(yield t(c));h&&!Ne(h)&&e.setState({errors:h})}}));return function(){return t.apply(this,arguments)}}()),ao(this,"onDelta",function(){var t=so((function*(t,n){var r,{tableName:i,db:o,getRef:s}=e.props;s&&s({getErrors:e.getErrors});var a=e.getRowFilter();if((null!=t&&t.rowFilter||null!=n&&n.rowFilter)&&JSON.stringify((null===(r=e.rowSub)||void 0===r?void 0:r.filter)||"")!==JSON.stringify(a||"")&&(e.rowSub&&(yield e.rowSub.unsubscribe()),o[i].subscribeOne))try{e.rowSub=yield o[i].subscribeOne(a,{select:yield e.getSelect()},(t=>{t&&e.setState({currentRow:t,loaded:!0})}))}catch(t){console.error("Could not subscribe",t),e.setState({loaded:!0,currentRow:yield o[i].findOne(a,{select:yield e.getSelect()})})}}));return function(){return t.apply(this,arguments)}}()),ao(this,"onUnmount",so((function*(){e.rowSub&&(yield e.rowSub.unsubscribe())}))),ao(this,"getSelect",so((function*(){var t,{tableName:n,db:r,includeMedia:i=!0}=e.props,{tableInfo:o}=e.state,s=o;o||(s=yield null===(t=r[n])||void 0===t?void 0:t.getInfo(),e.setState({tableInfo:s}));var a={$rowhash:1,"*":1};return i&&s.media_table_name&&(a[s.media_table_name]="*"),a}))),ao(this,"getRowFilter",(()=>{var e,t;return(null===(e=this.state)||void 0===e?void 0:e.rowFilter)||(null===(t=this.props)||void 0===t?void 0:t.rowFilter)})),ao(this,"getRow",so((function*(){var{tableName:t,db:n,includeMedia:r=!0}=e.props;return n[t].find(e.getRowFilter(),{select:yield e.getSelect()})}))),ao(this,"checkRow",so((function*(){var t=e.getRowFilter();return yield e.getRow(),t}))),ao(this,"setData",function(){var t=so((function*(t,n){var r,i;e.wasChanged=!0;var o,s,{db:a,tableName:l,rowFilter:c,onChange:u,onSuccess:h}=e.props,{currentRow:d={},localChanges:f,confirmUpdates:p=!(null===(r=e.props.confirmUpdates)||void 0===r)&&r,showLocalChanges:m=!(null===(i=e.props.showLocalChanges)||void 0===i)&&i,errors:g}=e.state,y=io(io({},e.state.newRow||{}),{},{[t.name]:n}),v=Object.keys(y).reduce(((e,t)=>io(io({},e),{},{[t]:d[t]})),{}),b={};if(u||!c||p)b=io(io({},b),{},{newRow:y});else try{yield a[l].update(c,{[t.name]:n}),null==h||h()}catch(e){throw e.txt||e}!p&&c&&t.is_pkey&&(b=io(io({},b),{},{rowFilter:io(io({},(null===(o=e.props)||void 0===o?void 0:o.rowFilter)||{}),{},{[t.name]:n})})),null==u||u(y),g&&(delete(s=io({},g))[t.name],b=io(io({},b),{},{errors:s})),e.setState(io(io({},b),{},{localChanges:f.slice(0).concat([{oldRow:v,newRow:y}])}))}));return function(){return t.apply(this,arguments)}}()),ao(this,"closed",!1),ao(this,"wasChanged",!1),ao(this,"onClose",(()=>{var{onClose:e,rowFilter:t}=this.props;t||!this.wasChanged||this.closed?e(!0):this.setState({confirmPopup:{acceptBtn:{color:"danger",text:"Discard"},onClose:e,message:"Are you sure you want to close this? You will lose your changes",onAccept:e}})})),ao(this,"getThisRow",(()=>{var{newRow:e,currentRow:t={},defaultColumnData:n={},clonedRow:r}=this.state,{defaultData:i={}}=this.props;return io(r?io({},r):io(io(io({},t),n),i),e)})),ao(this,"parseError",(e=>{var t={error:e.err||e.txt||e.msg||e};if(Object.keys(e||{}).length&&e.constraint){var n=[],r={};e.columns?n=e.columns:e.column&&(n=[e.column]),n.forEach((t=>{this.state.columns.find((e=>e.name===t))&&(r[t]=e.constraint)})),Object.keys(r).length&&(t={errors:r})}this.setState(io(io({},t),{},{sendingData:!1}))})),ao(this,"getAction",(()=>{var e,t,{db:n,tableName:r,rowFilter:i}=this.props,{clonedRow:o}=this.state,s="view";return i&&null!=n&&null!==(e=n[r])&&void 0!==e&&e.update&&!o?s="update":null!=n&&null!==(t=n[r])&&void 0!==t&&t.insert&&(!i||o)&&(s="insert"),s})),ao(this,"getDisplayedColumns",(()=>{var e=this.getAction();return(this.state.columns||[]).filter((t=>"view"===e||"update"===e&&t.update||"insert"===e&&t.insert))}))}render(){var t,n,r,i,o,s,a=this,{db:l,tableName:c,onChange:u,showSuggestions:h,label:d,hideChangesOptions:f=!1,includeMedia:p=!0,asPopup:m,onInserted:g,enableInsert:y=!1,onSuccess:v,tables:b}=this.props,{error:w,columns:x,newRow:E,success:_,localChanges:S,errors:C={},tableInfo:T,confirmUpdates:O=null!==(t=this.props.confirmUpdates)&&void 0!==t&&t,showLocalChanges:P=null!==(n=this.props.showLocalChanges)&&void 0!==n&&n,confirmPopup:A,insertMode:k,mediaTableInfo:M,loaded:N,sendingData:L=!1,currentRow:R,collapseChanges:I,clonedRow:D}=this.state,j=this.getAction(),F="view"===j||this.props.hideNullBtn,z=null;if("view"!==j&&P&&!u&&(z=S.length?e.createElement("div",{className:"flex-col ai-start o-auto",style:{maxHeight:"30%"}},S.map(((t,n)=>{var{oldRow:r,newRow:i}=t;return e.createElement("div",{key:n,className:"mt-p5 flex-col ai-start"},"update"===j?e.createElement(e.Fragment,null,e.createElement("div",{className:"p-p25"},"Old data: ",JSON.stringify(r)),e.createElement("div",{className:"p-p25"},"New data: ",JSON.stringify(i))):e.createElement("div",{className:"p-p25"},JSON.stringify(i)))}))):e.createElement("div",{className:"p-1"},"No local changes")),!x||!N)return e.createElement(Xe,{className:"absolute"});var B=this.getThisRow(),U=null;if(!u){var V,H="view"===j?null:"update"===j?e.createElement(e.Fragment,null,O&&null!=l&&null!==(V=l[c])&&void 0!==V&&V.update?e.createElement(et,{color:"action",className:"mt-1 mr-1",variant:"filled",disabledInfo:Object.keys(E||{}).length?void 0:"No data to ".concat(j),onClick:so((function*(){a.getErrors(function(){var e=so((function*(e){var t;e&&a.setState({confirmPopup:{message:"Are you sure you want to update this row?",acceptBtn:{text:"Update row!",color:"action"},onAccept:(t=so((function*(){var e;a.setState({confirmPopup:void 0,sendingData:!0});try{e=yield a.checkRow(),yield l[c].update(e,E),null==v||v(),a.setState({error:null,success:"updated",sendingData:!1}),a.closed=!0,setTimeout((()=>{var e,t;a.mounted&&(null===(e=a.props)||void 0===e||null===(t=e.onClose)||void 0===t||t.call(e,!0))}),2e3)}catch(t){a.parseError(t),console.error(t,e,E)}})),function(){return t.apply(this,arguments)}),onClose:()=>a.setState({confirmPopup:void 0})}})}));return function(){return e.apply(this,arguments)}}())}))},"Update"):null,l[c].delete?e.createElement(et,{color:"danger",variant:"outline",title:"Remove this row from table",className:"mt-1 mr-1",onClick:so((function*(){var e;a.setState({confirmPopup:{message:"Are you sure you want to delete this?",acceptBtn:{text:"Delete!",color:"danger"},onAccept:(e=so((function*(){a.setState({confirmPopup:void 0,sendingData:!0});try{yield l[c].delete(yield a.checkRow()),null==v||v(),a.setState({error:null,success:"deleted",sendingData:!1}),a.closed=!0,setTimeout((()=>{var e,t;a.mounted&&(null===(e=a.props)||void 0===e||null===(t=e.onClose)||void 0===t||t.call(e,!0))}),2e3)}catch(e){a.parseError(e),console.error(e)}})),function(){return e.apply(this,arguments)}),onClose:()=>a.setState({confirmPopup:void 0})}})}))},"Delete"):null,l[c].insert?e.createElement(et,{color:"action",variant:"outline",title:"Prepare a duplicate insert that excludes primary key fields",className:"mt-1 mr-1",onClick:so((function*(){try{var e=yield l[c].find(a.props.rowFilter);if(1===e.length){var t=b.find((e=>e.name===c)),n=e[0];t.columns.map((e=>{e.is_pkey&&delete n[e.name]})),a.setState({clonedRow:n})}else a.setState({error:"Could not clone row because the row filter refers to more than 1 row"})}catch(e){a.parseError(e),console.error(e)}}))},"Clone"):null):e.createElement(e.Fragment,null,e.createElement(et,{color:"action",className:"mt-1 mr-1",variant:"filled",onClick:so((function*(){a.getErrors(function(){var e=so((function*(e){if(e)try{a.setState({sendingData:!0});var t=yield l[c].insert(a.getThisRow(),g?{returning:"*"}:{});null==v||v(),null==g||g(t),a.setState({error:null,success:"inserted",sendingData:!1}),a.closed=!0,setTimeout((()=>{var e,t;a.mounted&&(null===(e=a.props)||void 0===e||null===(t=e.onClose)||void 0===t||t.call(e,!0))}),2e3)}catch(e){a.parseError(e),console.error(e)}}));return function(){return e.apply(this,arguments)}}())}))},"Insert"));U=e.createElement("div",{className:"flex-row-wrap p-p5 f-0 bt jc-around"},_&&!w?null:H,e.createElement(et,{className:"mt-1 mr-1",variant:"outline",onClick:this.onClose},"Cancel"))}var q,W=null;if(null!=T&&T.has_media&&p){var G=T.media_table_name;W=e.createElement(eo,{className:"mt-p5",label:(null==M?void 0:M.comment)||G,media:(null==B?void 0:B[G])||[],onAdd:e=>{var t=(null==E?void 0:E[G])||[];this.setData({name:G,is_pkey:!1},[...t,...e])},onDelete:e=>{if("id"in e&&e.id)l[G].update&&(l[G].update({id:e.id},{deleted:!0}),null==v||v());else{var t=(null==E?void 0:E[G])||[];this.setData({name:G,is_pkey:!1},t.filter((t=>t.name!==e.name)))}}})}A&&(q=e.createElement(Ki,{onClose:()=>{this.setState({confirmPopup:void 0})},onAccept:so((function*(){yield A.onAccept(),a.setState({confirmPopup:void 0})})),message:A.message,acceptBtn:A.acceptBtn}));var $="update"===j&&Object.keys(E||{}).length,Y=null;k&&null!=l&&null!==(r=l[null==k||null===(i=k.references)||void 0===i?void 0:i.ftable])&&void 0!==r&&r.insert&&1===(null==k||null===(o=k.references)||void 0===o||null===(s=o.fcols)||void 0===s?void 0:s.length)&&(Y=e.createElement(lo,{asPopup:!0,tables:b,db:l,hideNullBtn:F,tableName:k.references.ftable,hideChangesOptions:!0,onClose:()=>{this.setState({insertMode:void 0})},onInserted:e=>{x.filter((e=>{var t,n;return(null===(t=e.references)||void 0===t?void 0:t.ftable)===(null==k||null===(n=k.references)||void 0===n?void 0:n.ftable)})).map((t=>{var n;null===(n=t.references)||void 0===n||n.fcols.map((n=>{this.setData(t,e[n])}))})),this.setState({insertMode:void 0})}}));var X=this.getRowFilter(),K=X?c+" ("+Object.keys(X).map((e=>"".concat(e,": ").concat(JSON.stringify(X[e])))).join(" AND ")+")":j+" "+((null==T?void 0:T.comment)||c),Z=null!=d?d:(D?"[Cloned row] ":"")+K,J=m||!d&&"label"in this.props?null:Z?e.createElement("h4",{style:{margin:0,padding:"1em",paddingBottom:".5em"}},Z):null,Q=e.createElement("div",{className:"flex-col f-1 min-h-0 bt relative "+(L?" no-pointer-events noselect ":" ")},L?e.createElement("div",{className:"absolute bg-gray-600 flex-col ai-center jc-center",style:{inset:0,zIndex:1,opacity:.4}},e.createElement(Xe,null)):null,Y,q,J,e.createElement("div",{className:"flex-col f-1 o-auto min-h-0 min-w-0 p-1",style:{paddingTop:0}},this.getDisplayedColumns().map(((t,n)=>{var r,i,o=null;return y&&"insert"===j&&null!=l&&null!==(r=l[null==t||null===(i=t.references)||void 0===i?void 0:i.ftable])&&void 0!==r&&r.insert&&(o=e.createElement(et,{iconPath:we,onClick:()=>{this.setState({insertMode:t})}})),e.createElement(KM,{tables:b,key:n,db:l,tableName:c,action:j,column:t,value:(B||{})[t.name]||"",rawValue:(B||{})[t.name],onChange:e=>this.setData(t,e),showSuggestions:h,error:C[t.name],rightContent:o,hideNullBtn:F,sectionHeader:t.sectionHeader,style:t.sectionHeader?{marginTop:"1em"}:{},variant:"column"})})),W),f||"view"===j?null:e.createElement(e.Fragment,null,u||"insert"===j?null:e.createElement(it,{label:"Confirm updates",checked:O,onChange:e=>{var{currentTarget:t}=e;this.setState({confirmUpdates:t.checked})}}),u?null:e.createElement(it,{label:"Show local changes",checked:P,onChange:e=>{var{currentTarget:t}=e;this.setState({showLocalChanges:t.checked})}})),z,u?null:e.createElement("div",{className:"flex-col o-auto min-h-0 min-w-0 w-full f-0 "+($?" p-1 ":" "),style:{boxShadow:"0px 3px 9px 0px #404040",clipPath:"inset(-10px 0px 0px 0px)",minHeight:"1px",maxHeight:"30vh"}},$?e.createElement(e.Fragment,null,e.createElement("div",{className:"noselect text-gray-600 flex-row ai-center pointer "+(I?" ":"  mb-p5 "),onClick:()=>this.setState({collapseChanges:!I})},e.createElement("div",{className:"noselect text-gray-600 f-1"},"Changes (",Object.keys(E||{}).length,"):"),e.createElement(et,{className:"f-0 ",iconPath:I?Te:Ce,title:"Collapse/Expand changes",size:"small"})),!I&&e.createElement("div",{className:"flex-col w-full ai-start"},Object.keys(E).map((t=>{var n=null==x?void 0:x.find((e=>e.name===t)),r=null,i=null;return!n&&(null==T?void 0:T.media_table_name)===t&&Array.isArray(E[t])?(i=JSON.stringify([R[t].map((e=>e.name))]).slice(1,-1),r=JSON.stringify([E[t].map((e=>e.name))]).slice(1,-1)):(i=KM.renderValue(n,R[t]),r=KM.renderValue(n,E[t])),e.createElement("div",{key:t,className:"flex-row mb-p5 ai-center w-full"},e.createElement("div",{className:"flex-col mb-p5 ta-left o-auto "},e.createElement("div",{className:"text-gray-500 font-14 mb-p25"},(null==n?void 0:n.label)||t,": "),e.createElement("div",{title:"Old value",className:" text-red-500 o-auto",style:{maxHeight:"100px"}},i),e.createElement("div",{title:"New value",className:" text-green-500 o-auto",style:{maxHeight:"100px"}},r)),e.createElement(et,{iconPath:le,size:"small",title:"Remove update",onClick:()=>{this.setState({newRow:Me(E,void 0,[t])})}}))})))):null),e.createElement(Fe,{error:w}),_&&!w?e.createElement("div",{className:"text-green-600 p-1 flex-col"},e.createElement("div",{className:"text-green-600 p-1 flex-col mb-p5"}," Row ",_,"! "),e.createElement(no,null)):null,U);return m?e.createElement(pt,{title:Z,open:!0,rootStyle:{padding:0,top:window.isMobileDevice?0:"2em",maxHeight:window.isIOSDevice?"calc(100vh - 100px)":"calc(100% - 3em)"},contentClassName:"",onClose:this.onClose},Q):Q}}function co(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function uo(){return uo=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},uo.apply(this,arguments)}function ho(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fo=["image","video","audio"];class po extends We{constructor(){super(...arguments),ho(this,"state",{isFocused:!1,url:void 0}),ho(this,"renderMedia",(()=>{if(!this.state.url)return null;var{isFocused:t}=this.state,{validated:n,content_type:r}=this.state.url,i=null;if(n){var o={style:{maxWidth:"100%",maxHeight:"100%"},className:"b b-gray-300 "};null!=r&&r.startsWith("image")?i=e.createElement("img",uo({loading:"lazy",src:n},o)):null!=r&&r.startsWith("video")?i=e.createElement("video",uo({},o,{controls:!0,src:n})):null!=r&&r.startsWith("audio")?i=e.createElement("audio",uo({},o,{controls:!0,src:n})):!t&&n&&(i=e.createElement("a",{href:n,target:"_blank",className:"p-1 f-0"},n))}return t?i:e.createElement("div",{className:"relative f-1 noselect"},i,e.createElement("div",{className:"absolute w-full h-full pointer",style:{zIndex:1,inset:0},onClick:e=>{e.stopPropagation(),e.preventDefault(),this.setState({isFocused:!0})}}))}))}static getMimeFromURL(e){if(e&&"string"==typeof e){var t,n,r=null===(t=e.split(".").slice(-1))||void 0===t||null===(n=t[0])||void 0===n?void 0:n.toLowerCase();if({jpg:1,jpeg:1,png:1,tiff:1,gif:1,svg:1,ico:1}[r])return"image";if({mp3:1,wav:1}[r])return"audio";if({mp4:1,avi:1,ogg:1,webm:1,mov:1}[r])return"video"}}onUnmount(){}onDelta(e){var t=this,{url:n,allowedHostnames:r}=this.props,i=function(){var e,r=(e=function*(){var e;if(!("allowedContentTypes"in t.props)&&"content_type"in t.props)"content_type"in t.props&&(e=t.props.content_type);else if("allowedContentTypes"in t.props&&1===t.props.allowedContentTypes.length)e=t.props.allowedContentTypes[0];else{var r,i,o=yield function(e){return new Promise(((t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.setRequestHeader("Range","bytes=0"),r.onreadystatechange=function(){this.readyState==this.DONE?t(this.getResponseHeader("Content-Type")):n(r.statusText)},r.send()}))}(n),s=null==o||null===(r=o.split(";"))||void 0===r||null===(i=r[0])||void 0===i?void 0:i.trim();if("allowedContentTypes"in t.props&&!t.props.allowedContentTypes.find((e=>s.startsWith(e))))throw"ContentType ".concat(s," is not allowed. Allowed ContentTypes: ").concat(t.props.allowedContentTypes);e=s}var a=fo.find((t=>{var n;return null===(n=e)||void 0===n?void 0:n.startsWith(t)}));if(e&&!a)throw"ContentType prefix ".concat(e," is not recognised/supported. Supported ContentTypes preffixes ").concat(fo);t.setState({url:{raw:n,validated:n,content_type:e}})},function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){co(a,r,i,o,s,"next",e)}function s(e){co(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))});return function(){return r.apply(this,arguments)}}();if(null!=e&&e.url&&this.rawURL!==n)if(this.rawURL=n,r)try{var o=new URL(n);if(!r.includes(o.hostname))throw"Hostname ".concat(o.hostname," is not allowed. Allowed hostnames: ").concat(r);i()}catch(e){console.error("Could check media URL",e)}else i()}render(){var{url:t,isFocused:n}=this.state,{onKeyLeft:r,onKeyRight:i}=this.props;return n?e.createElement(pt,{open:!0,rootStyle:{padding:0},contentClassName:"o-hidden",onClose:()=>{this.setState({isFocused:!1})},title:e.createElement("a",{href:t.validated,target:"_blank",className:"p-1 f-0"},t.validated),onKeyDown:r&&i?e=>{"ArrowRight"===e.key?null==i||i():"ArrowLeft"===e.key&&(null==r||r())}:void 0},e.createElement("div",{className:"relative flex-col f-1"},this.renderMedia())):this.renderMedia()}}function mo(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function go(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){mo(a,r,i,o,s,"next",e)}function s(e){mo(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function yo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vo extends We{constructor(){var e;super(...arguments),e=this,yo(this,"state",{showChartMenu:!1,myLinks:[]}),yo(this,"d",{}),yo(this,"onDelta",go((function*(){var{dbs:t,w:n}=e.props;if(null!=n&&n.workspace_id&&t&&!e.d.linksSync){var r=yield t.links.sync({workspace_id:n.workspace_id},{handlesOnData:!0},((t,r)=>{var i;if(e.mounted&&n){var o=t.filter((e=>[e.w1_id,e.w2_id].includes(n.id)));(null===(i=e.state.myLinks)||void 0===i?void 0:i.map((e=>e.id)).sort().join())!==(null==o?void 0:o.map((e=>e.id)).sort().join())&&e.setState({myLinks:o}),e.setData({links:t},{links:r})}}));e.setData({linksSync:r},{linksSync:r})}}))),yo(this,"getMenu",(()=>null))}onUnmount(){var e=this;return go((function*(){var t,n;yield null===(t=e.d)||void 0===t||null===(n=t.linksSync)||void 0===n?void 0:n.$unsync(),e.d.linksSync=void 0}))()}render(){var t,n,r,i,o=this,{w:s,setLinkMenu:a,tables:l,onAddChart:c}=this.props,{showChartMenu:u,myLinks:h}=this.state;if(!s||!h)return null;var d,f=null==l?void 0:l.find((e=>e.name===s.table_name)),p=!!(s&&s.table_name&&(null==f||null===(t=f.joins)||void 0===t?void 0:t.length))||!!h.length,m=null!=f&&f.columns.some((e=>"Date"===e.tsDataType||"geography"===e.udt_name||"geometry"===e.udt_name));if("sql"===s.type){var g,y,v,b=s;m=(null==b||null===(g=b.options)||void 0===g?void 0:g.lastSQL)&&(null==b||null===(y=b.options)||void 0===y||null===(v=y.sqlResultCols)||void 0===v?void 0:v.some((e=>"timestamp"===e.udt_name||"timestamptz"===e.udt_name||"geography"===e.udt_name||"geometry"===e.udt_name)))}return f||p||m?(u&&m&&(d=e.createElement(Ir,{w:s,onAddChart:c})),e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-row ai-center bg-gray-300 rounded b b-gray-300 h-fit w-fit m-auto",ref:e=>{e&&(this.ref=e)}},p&&e.createElement(et,{title:"Cross filter tables",className:"prostgles-link-btn",size:"small",iconPath:"M9,5C10.04,5 11.06,5.24 12,5.68C12.94,5.24 13.96,5 15,5A7,7 0 0,1 22,12A7,7 0 0,1 15,19C13.96,19 12.94,18.76 12,18.32C11.06,18.76 10.04,19 9,19A7,7 0 0,1 2,12A7,7 0 0,1 9,5M15,7L14,7.11C15.28,8.41 16,10.17 16,12C16,13.83 15.28,15.59 14,16.9L15,17A5,5 0 0,0 20,12A5,5 0 0,0 15,7M8.5,12C8.5,13.87 9.29,15.56 10.56,16.75L11.56,16.29C10.31,15.29 9.5,13.74 9.5,12C9.5,10.26 10.31,8.71 11.56,7.71L10.56,7.25C9.29,8.44 8.5,10.13 8.5,12Z",style:h.length?{color:null==h||null===(n=h[0])||void 0===n||null===(r=n.options)||void 0===r?void 0:r.color}:{},onClick:function(){var e=go((function*(e){a({w:s,anchorEl:e.target})}));return function(){return e.apply(this,arguments)}}()}),m&&e.createElement(et,{title:"Add chart",className:"prostgles-chart-btn",size:"small",iconPath:"M7.2,11.2C8.97,11.2 10.4,12.63 10.4,14.4C10.4,16.17 8.97,17.6 7.2,17.6C5.43,17.6 4,16.17 4,14.4C4,12.63 5.43,11.2 7.2,11.2M14.8,16A2,2 0 0,1 16.8,18A2,2 0 0,1 14.8,20A2,2 0 0,1 12.8,18A2,2 0 0,1 14.8,16M15.2,4A4.8,4.8 0 0,1 20,8.8C20,11.45 17.85,13.6 15.2,13.6A4.8,4.8 0 0,1 10.4,8.8C10.4,6.15 12.55,4 15.2,4Z",style:{},onClick:function(){var e=go((function*(){o.setState({showChartMenu:!0})}));return function(){return e.apply(this,arguments)}}()}),f&&e.createElement(et,{title:"Show/Hide filtering",className:"prostgles-filter-btn",size:"small",iconPath:he,color:null!==(i=s.filter)&&void 0!==i&&i.some((e=>{var t;return"not null"===e.type||("$existsJoined"===e.type?void 0!==(null===(t=e.filter)||void 0===t?void 0:t.value):void 0!==e.value)}))?"action":void 0,style:{},onClick:function(){var e=go((function*(){var e=s;e.$update({options:{showFilters:!(null!=e&&e.options.showFilters)}},{deepMerge:!0})}));return function(){return e.apply(this,arguments)}}()})),d&&e.createElement(pt,{open:!0,title:"Add chart",anchorEl:this.ref,positioning:"inside",rootStyle:{padding:0},clickCatchStyle:{opacity:.5,backdropFilter:"blur(1px)"},contentClassName:"",onClose:()=>{this.setState({showChartMenu:!1})}},d))):null}}function bo(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function wo(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){bo(a,r,i,o,s,"next",e)}function s(e){bo(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function xo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Eo extends We{constructor(){var e;super(...arguments),e=this,xo(this,"state",{showMenu:!1}),xo(this,"d",{}),xo(this,"onDelta",(e=>{var t,n,{w:r}=this.d,{onWChange:i}=this.props;if(this.ref&&r){var o,s,a=null===(o=this.ref)||void 0===o||null===(s=o.parentElement)||void 0===s?void 0:s.querySelector(":scope > .silver-grid-item-header > div > .silver-grid-item-header--title"),l=r.name||r.table_name||r.id||"Empty";a&&a.innerText!==l&&(a.innerText=l,a.title=l)}if(null!=e&&e.onWChange&&null!==(t=this.d)&&void 0!==t&&t.w&&(null==i||i(this.d.w,this.d.w)),null!==(n=this.props)&&void 0!==n&&n.w&&!this.d.wSync){var c=this.props.w.$cloneSync(((e,t)=>{this.setData({w:e},{w:t}),null==i||i(e,t),this.setState({w:e})}));this.setData({wSync:c})}})),xo(this,"onUnmount",wo((function*(){var t,n;yield null===(t=e.d)||void 0===t||null===(n=t.wSync)||void 0===n?void 0:n.$unsync(),e.d.wSync=void 0})))}getTitleIcon(){var{quickMenuProps:t}=this.props,{w:n}=this.d;if(!t)return null;var{setLinkMenu:r,dbs:i,tables:o,onAddChart:s}=t;return r?e.createElement(vo,{tables:o,w:n,dbs:i,setLinkMenu:r,onAddChart:s}):null}render(){var n,r,{children:i,getMenu:o}=this.props,{showMenu:s}=this.state,{w:a}=this.state;if(!a)return null;var l,c=null===(n=this.ref)||void 0===n||null===(r=n.parentElement)||void 0===r?void 0:r.querySelector(":scope > .silver-grid-item-header > .silver-grid-item-header--icon");o&&c&&(l=t.createPortal(e.createElement(e.Fragment,null,e.createElement(et,{className:"f-0",iconPath:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",title:"Open menu",onClick:()=>{this.setState({showMenu:!s})}}),this.getTitleIcon()),c));var u=()=>{this.setState({showMenu:!1})};return e.createElement(e.Fragment,null,l,e.createElement("div",{key:a.id+"-content",className:"flex-col f-1 min-h-0 min-w-0",ref:e=>{var t;e&&(this.ref||(t=!0),this.ref=e,t&&this.forceUpdate())}},e.createElement(ze,null,i)),s&&e.createElement(pt,{open:!0,anchorEl:this.ref,positioning:"inside",rootStyle:{padding:0},clickCatchStyle:{opacity:.5,backdropFilter:"blur(1px)"},contentClassName:"",onClose:u},e.createElement(ze,null,o(a,u))))}}class _o extends We{constructor(){super(...arguments),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",{jpath:[]})}static hasJoins(e,t){return!!t.find((t=>t.name===e&&t.columns.find((e=>e.references))||t.name!==e&&t.columns.find((t=>{var n;return(null===(n=t.references)||void 0===n?void 0:n.ftable)===e}))))}onDelta(){var{tables:e,tableName:t}=this.props;e&&t&&!this.state.joins&&this.setState({joins:Ii({tables:e,tableName:t})||[]})}render(){var{jpath:t,joins:n,j:r}=this.state,{onSelect:i,className:o="",style:s={},tableName:a,onLinkTable:l}=this.props,c=n;if(r&&(c=r.joins),!n)return e.createElement(Xe,null);var u=(e,t)=>{this.setState({jpath:e,j:t}),i(e.map((e=>e.table)),e)},h=t.map(((n,r)=>e.createElement("div",{key:r,className:"flex-col ",style:{marginLeft:"".concat(5*r,"px")}},e.createElement("div",{className:"flex-row p-p25 text-gray-500",style:{marginLeft:"".concat(5*(r-1),"px")}},"(",n.on.map((e=>e.join(" = "))).join(" AND"),")"),e.createElement("div",{className:"flex-row p-p25 "+(r===t.length-1?"":" pointer  text-hover ")+(r===t.length-1?" font-bold ":"  "),style:{marginLeft:"".concat(5*(r+1),"px")},onClick:r===t.length-1?void 0:()=>{var e=t.findIndex((e=>e.table===n.table)),r=t.slice(0,e+1);u(r,n)}},n.table)))),d=t.length?e.createElement("div",{className:"flex-col ta-left bg-gray-100 mb-1"},e.createElement("div",{className:"flex-row p-p5 text-gray-500"},"Current path:"),e.createElement("div",{className:"flex-row p-p25 pointer text-hover",onClick:()=>{u([],void 0)}},a),h):null,f=null;c.length&&(f=e.createElement(_t,{style:{backgroundColor:"transparent"},className:"",id:"link-menu",noSearch:15>c.length,items:c.map((e=>({key:e.table,label:e.table,subLabel:" (".concat(e.on.flatMap((e=>e[0]+" = "+e[1])).join(", "),")"),onPress:()=>{var n=[...t,e];u(n,e)}})))}));var p=t.map((e=>e.table)),m=null==p?void 0:p[p.length-1],g=null;return l&&m&&(g=e.createElement("div",{className:"flex-col w-fit"},e.createElement(et,{iconPath:ne,variant:"filled",color:"action",size:"small",className:" ",onClick:()=>{l(m,p)}},"Join to ",JSON.stringify(m)),f&&e.createElement("div",{className:"mt-p5"},"or"))),e.createElement("div",{className:"flex-col noselect "+o,style:s},d,g,f&&e.createElement("div",{className:"flex-col  bg-bldue-50  mt-1"},e.createElement("div",{className:"flex-row p-p5 text-blue-500 p-1"},"Choose next table"),f))}}function So(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Co(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?So(Object(t),!0).forEach((function(n){To(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):So(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function To(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Oo extends We{constructor(){super(...arguments),To(this,"state",{popupAnchor:null,defaultSearch:void 0,options:void 0,addFilter:void 0,searchTerm:""})}render(){var t,n,r,{addFilter:i,searchItems:o}=this.state,{tableName:s,onChange:a,detailedFilter:l,className:c,style:u={},tables:h,filterFields:d}=this.props,f=l||[],p=h.find((e=>e.name===s)).columns.filter((e=>!d||d.includes(e.name))),m=e=>null!=e&&e.references||!["number","Date"].includes(null==e?void 0:e.tsDataType),g=_o.hasJoins(s,h);null!=i&&null!==(t=i.path)&&void 0!==t&&t.length&&(r=null==i?void 0:i.path[(null==i?void 0:i.path.length)-1]);var y,v=null!=i&&null!==(n=i.path)&&void 0!==n&&n.length?h.find((e=>e.name===r)).columns:p;return i&&(y=e.createElement(pt,{open:!0,positioning:"top-center",onClose:()=>{this.setState({addFilter:void 0})},contentStyle:{padding:0}},g?e.createElement(et,{title:(null!=i&&i.path?"Disable":"Enable")+" Join filter",className:"w-full",style:{width:"100%"},iconPath:"M9,5A7,7 0 0,0 2,12A7,7 0 0,0 9,19C10.04,19 11.06,18.76 12,18.32C12.94,18.76 13.96,19 15,19A7,7 0 0,0 22,12A7,7 0 0,0 15,5C13.96,5 12.94,5.24 12,5.68C11.06,5.24 10.04,5 9,5M9,7C9.34,7 9.67,7.03 10,7.1C8.72,8.41 8,10.17 8,12C8,13.83 8.72,15.59 10,16.89C9.67,16.96 9.34,17 9,17A5,5 0 0,1 4,12A5,5 0 0,1 9,7M15,7A5,5 0 0,1 20,12A5,5 0 0,1 15,17C14.66,17 14.33,16.97 14,16.9C15.28,15.59 16,13.83 16,12C16,10.17 15.28,8.41 14,7.11C14.33,7.04 14.66,7 15,7Z",color:null!=i&&i.path?"action":void 0,onClick:()=>{this.setState({addFilter:Co(Co({},i||{}),{},{path:null!=i&&i.path?void 0:[]})})}},(null!=i&&i.path?"Disable":"Enable")+" Join filter"):null,e.createElement("div",{className:(window.isMobileDevice?" flex-col ":" flex-row ")+"  bt b-gray-200",style:{maxHeight:"90vh"}},g?e.createElement("div",{className:"flex-col f-1 o-auto br b-gray-200"},null!=i&&i.path?e.createElement(_o,{tables:h,tableName:s,onSelect:e=>{this.setState({addFilter:Co(Co({},i||{}),{},{path:e})})}}):null):null,e.createElement(_t,{label:"Choose column"+(r?" (".concat(r,")"):""),id:"search-list-cols f-1",style:{maxHeight:"unset"},items:v.map((e=>({key:e.name,label:e.name,subLabel:e.udt_name,onPress:()=>{var t,n=e.name,r=v.find((e=>e.name===n)),o={fieldName:n,type:null!=i&&i.path?"not null":m(r)?"$in":"$between",filter:void 0};t=null!=i&&i.path?{type:"$existsJoined",path:null==i?void 0:i.path,filter:o}:o,a([...f,t]),this.setState({addFilter:void 0})}})))})))),e.createElement(e.Fragment,null,e.createElement(et,{title:"Add filter",className:"shadow m-p5"+c,size:"small",style:Co({backgroundColor:"white",borderRadius:"6px"},u),iconPath:"M12 12V19.88C12.04 20.18 11.94 20.5 11.71 20.71C11.32 21.1 10.69 21.1 10.3 20.71L8.29 18.7C8.06 18.47 7.96 18.16 8 17.87V12H7.97L2.21 4.62C1.87 4.19 1.95 3.56 2.38 3.22C2.57 3.08 2.78 3 3 3H17C17.22 3 17.43 3.08 17.62 3.22C18.05 3.56 18.13 4.19 17.79 4.62L12.03 12H12M15 17H18V14H20V17H23V19H20V22H18V19H15V17Z",onClick:()=>{this.setState({addFilter:{}})}}),y)}}function Po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ao(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Po(Object(t),!0).forEach((function(n){ko(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Po(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function ko(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Mo extends e.Component{constructor(){super(...arguments),ko(this,"state",{})}render(){var t,n,r,{db:i,tables:o,leftContent:s,w:a,filterFields:l,style:c,className:u,rightContent:h}=this.props,d=o.find((e=>e.name===a.table_name)),f=e=>{a.$update({filter:e})},p=null==a||null===(t=a.filter)||void 0===t?void 0:t.some((e=>!e.minimised));return e.createElement("div",{className:"flex-col min-h-0 min-w-0 relative  "+u,style:c},s,e.createElement("div",{className:"flex-row-wrap min-h-0 f-0 relative ai-center px-1 "},e.createElement(Oo,{tableName:a.table_name,filterFields:l,db:i,tables:o,detailedFilter:a.filter,onChange:f}),!(null==a||null===(n=a.filter)||void 0===n||!n.length)&&e.createElement(et,{onClick:()=>{var e=null==a?void 0:a.filter.map((e=>Ao(Ao({},e),{},{minimised:p})));f(e)}},p?"Collapse":"Expand"," filters"),e.createElement("div",{className:"flex-row f-1 mx-p5 jc-center mr-p5 "},e.createElement(vi,{tables:o,db:i,style:{alignSelf:"center"},tableName:a.table_name,detailedFilter:a.filter,onChange:(e,t)=>{var{colName:n,columnValue:r,term:i}=t,o=d.columns.find((e=>e.name===n)),s=e.slice(0);r&&o&&"Date"===o.tsDataType?s=[...a.filter,{fieldName:n,type:"$term_highlight",value:i}]:(r&&o&&"number"===o.tsDataType||r&&o&&"number"===o.tsDataType)&&(s=[...a.filter,{fieldName:n,type:"=",value:r}]),f(s)}}),h)),!(null===(r=a.filter)||void 0===r||!r.length)&&e.createElement("div",{className:"flex-row-wrap min-h-0 f-0 relative ai-start px-1 mb-p5"},e.createElement(Mi,{className:"mr-1 mt-p5",tables:o,db:i,tableName:a.table_name,detailedFilter:a.filter,onChange:f})))}}function No(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lo(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?No(Object(t),!0).forEach((function(n){Do(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):No(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Ro(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Io(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Ro(a,r,i,o,s,"next",e)}function s(e){Ro(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function Do(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jo extends We{constructor(){var t;super(...arguments),t=this,Do(this,"state",{barchartVals:{},runningQuery:!1,sql:"",loading:!1,totalRows:0,rows:void 0,sort:[],joins:[],filter:{},rowCount:0,duration:0,w:null,error:"",popup:null,hideTable:!0,sqlError:null,rowPanel:null,rowDelta:null,onRowClick:null,filterPopup:!1,joinFilterStr:void 0}),Do(this,"d",{page:1,pageSize:qM(Math.round(1.2*window.innerHeight/55)||25,zM),w:void 0,dataAge:0,wSync:void 0}),Do(this,"calculatedColWidths",!1),Do(this,"loadingData",!1),Do(this,"currentDataRequestSignature",""),Do(this,"getTableCols",function(){var n=Io((function*(n){var r,i=[],{w:o}=t.d;if(!o)return i;var s,{db:a,activeRow:l,onClose:c,onClickRow:u,joinFilter:h,dbs:d,tables:f}=t.props,p=o.table_name,m=f.find((e=>e.name===p)),g=null==m?void 0:m.columns;return g&&(i=jo.getFullColumnConfig(f,o,n,null===(s=t.ref)||void 0===s?void 0:s.getBoundingClientRect().width).filter((e=>e.show)).map((e=>Lo(Lo({},e),{},{tsDataType:(e.info||e.computedConfig).tsDataType,udt_name:(e.info||e.computedConfig).udt_name}))).map((n=>{var r,i,s,l,c,u,h,m,g,y,v,b;return Lo(Lo({},n),{},{filter:null===(r=n.info)||void 0===r?void 0:r.filter,sortable:"json"!==(null===(i=n.info)||void 0===i?void 0:i.udt_name),computed:!!n.computedConfig,key:n.name,table:p,label:n.name+(null!==(s=n.info)&&void 0!==s&&s.references?" (".concat(null===(l=n.info)||void 0===l?void 0:l.references.ftable,")"):""),subLabel:e.createElement("div",{className:"flex-row ai-center"},n.computedConfig||n.format?e.createElement(Ae(),{path:fe,size:.75,className:"color-action ml-p25"}):null,null!==(c=n.info)&&void 0!==c&&c.is_pkey?e.createElement("div",{title:"Primary key",className:"flex-row ai-center"},e.createElement(Ae(),{path:"M7,14A2,2 0 0,1 5,12A2,2 0 0,1 7,10A2,2 0 0,1 9,12A2,2 0 0,1 7,14M12.65,10C11.83,7.67 9.61,6 7,6A6,6 0 0,0 1,12A6,6 0 0,0 7,18C9.61,18 11.83,16.33 12.65,14H17V18H21V14H23V10H12.65Z",size:.75,className:"mr-p25"}),null===(u=n.info)||void 0===u?void 0:u.udt_name):null===(h=n.info)||void 0===h?void 0:h.udt_name,n.computedConfig&&(null!==(m=null===(g=n.computedConfig)||void 0===g?void 0:g.funcDef.outType.udt_name)&&void 0!==m?m:null===(y=n.computedConfig)||void 0===y?void 0:y.funcDef.outType.tsDataType),null!=o&&null!==(v=o.filter)&&void 0!==v&&v.some((e=>"fieldName"in e&&e.fieldName===n.name))?e.createElement(Ae(),{path:he,size:.75,className:"color-action ml-p25"}):null),hidden:"$rowhash"===n.name,width:null!==(b=n.width)&&void 0!==b?b:100,onRender:"HTML"===n.format?t=>{var r;return e.createElement("div",{className:"relative min-w-0 min-h-0",dangerouslySetInnerHTML:{__html:n.noSanitize?null!==(r=t[n.name])&&void 0!==r?r:"":er(t[n.name],{allowedTags:er.defaults.allowedTags.concat(n.allowedHTMLTags||[]),parser:{lowerCaseAttributeNames:!1}})}})}:["URL","Email","Tel"].includes(n.format)?t=>e.createElement("a",{href:("Email"===n.format?"mailto:":"Tel"===n.format?"tel:":"")+t[n.name],target:"_blank"},t[n.name]):"Media"===n.format&&n.contentConfig?t=>{var r;return t[n.name]&&e.createElement(po,{url:t[n.name],allowedContentTypes:"fixed"in n.contentConfig?[null!==(r=n.contentConfig.fixed)&&void 0!==r?r:"image"]:"fromColumn"in n.contentConfig?[t[n.contentConfig.fromColumn]]:[po.getMimeFromURL(t[n.name])]})}:void 0,getCellStyle:()=>"Media"===n.format?{display:"flex"}:"number"===n.tsDataType?{color:"rgb(0 110 0)"}:{},onContextMenu:r=>{r.preventDefault();var i={style:{padding:0},anchorEl:r.currentTarget,positioning:"beneath-left",content:e.createElement(qi,{onAddFilter:()=>t.setState({filterPopup:!0}),db:a,dbs:d,tableName:p,colName:n.name,tables:f,w:o,onClose:()=>{t.setState({popup:void 0})},showColumns:()=>{t.setState({popup:{style:{},anchorEl:t.ref,positioning:"inside-top-center",content:e.createElement(Wr,{w:o,db:a,tableName:p,tables:f,onClose:()=>{t.setState({popup:void 0})}})}})}})};return t.setState({popup:i}),!1}})}))),o&&o.columns&&(Array.isArray(o.columns)?i=i.map((n=>{var r=n;if(r&&r.style&&r.style.type&&"None"!==r.style.type){if("Barchart"===r.style.type||"Scale"===r.style.type){var{minValue:i,maxValue:o}=t.state.barchartVals[n.name]||{};r.style.minValue=i,r.style.maxValue=o}n.getCellStyle=e=>{var t=lr.getStyle(r,n.tsDataType,e),i={};return t.cellColor&&(i=Lo(Lo({},i),{},{background:t.cellColor})),t.textColor&&(i=Lo(Lo({},i),{},{color:t.textColor})),"Barchart"===r.style.type&&(i=Lo(Lo({},i),{},{border:"1px solid var(--gray-200)"})),i},n.onRender=(t,i,o)=>{var s=lr.getStyle(r,n.tsDataType,t);return s&&s.chipColor?e.createElement("div",{style:{backgroundColor:s.chipColor,padding:"6px 8px",borderRadius:"1em",width:"fit-content"}},o):o}}return n})):console.warn("Bad w.columns format",o.columns)),a[p].update&&!(null!==(r=o.options)&&void 0!==r&&r.hideEditRow)&&i.unshift(Lo(Lo({},Lo(Lo({},{key:"edit_row",name:" ",label:" ",sortable:["string","number","boolean","Date"].includes("Object"),tsDataType:"Object",udt_name:"text",filter:!0,computed:!0}),{},{filter:!1,select:!1,sortable:!1})),{},{className:"ai-center jc-center",label:e.createElement(Ae(),{style:{marginLeft:"7px"},path:ve,title:"Edit row",size:1}),hidden:!1,width:50,getCellStyle:()=>({padding:0}),onRender:n=>e.createElement(et,{className:"h-full h-fit w-fit"+(window.isMobileDevice?" text-gray-300 ":" show-on-hover  "),title:"Edit row",iconPath:ve,onClick:function(){var e=Io((function*(e){e.stopPropagation();var r={},i=g.find((e=>e.is_pkey));if(i)r={[i.name]:n[i.name]};else{var o=g.filter((e=>["number","string","boolean"].includes(e.tsDataType))),s=e=>"string"==typeof e&&400<e.length?{">=":"".concat(e.slice(0,625),"%")}:e;r=o.reduce(((e,t)=>Lo(Lo({},e),{},{[t.name]:s(n[t.name])})),{}),console.log(yield a[p].count(r),r)}Ne(r)||1!==(yield a[p].count(r))?alert("Could not create row update filter. Your table/column selection is a missing primary key"):t.setState({rowPanel:{type:"update",data:r}})}));return function(){return e.apply(this,arguments)}}()})})),i}));return function(){return n.apply(this,arguments)}}()),Do(this,"dataAge",0),Do(this,"onDelta",function(){var e=Io((function*(e,n,r){var i,o,s,a,l,c,u,h,d,f,p,m,g,y,v,b,w=Lo(Lo(Lo({},e),n),r),{rows:x,sql:E}=t.state,{db:_,activeRow:S,onClose:C,onClickRow:T,joinFilter:O,workspace:P,tables:A}=t.props,{w:k,pageSize:M}=t.d||{},{table_name:N,table_oid:L,sort:R,filter:I}=k||{},D=R,j=Lo({},I);if(k){var F=Object.keys((null==w||null===(i=w.w)||void 0===i?void 0:i.options)||{});if(_&&N&&(j=ki(I||[])),_&&N&&!_[N]){if(!L)return alert("Table not found. Removing..."),void C();var z=[];yield Promise.all(Object.keys(_).map(function(){var e=Io((function*(e){_[e].getInfo&&z.push(Lo({name:e},yield _[e].getInfo()))}));return function(){return e.apply(this,arguments)}}()));var B=z.find((e=>e.oid===L));if(B)return void(yield k.$update({table_name:B.name}))}Array.isArray(D)||(D=[]),w.db&&console.log(Object.keys(w.db)),null!=w&&null!==(o=w.w)&&void 0!==o&&null!==(s=o.options)&&void 0!==s&&s.maxRowHeight&&(v=v||{}),null!=w&&null!==(a=w.w)&&void 0!==a&&a.columns&&k.$update({sort:[]}),null!=w&&null!==(l=w.w)&&void 0!==l&&l.filter&&!(null!=w&&null!==(c=w.w)&&void 0!==c&&c.id)&&k&&!(null!=k&&k.options.showFilters)&&k.$update({options:{showFilters:!0}},{deepMerge:!0}),null!=w&&null!==(u=w.w)&&void 0!==u&&u.filter&&k&&t.setData({page:1}),null!=w&&null!==(h=w.w)&&void 0!==h&&h.options&&"hideCount"in(null==w||null===(d=w.w)||void 0===d?void 0:d.options)&&null!==(f=t.state.rows)&&void 0!==f&&f.length&&(v=Lo(Lo({},v),{},{dataAge:Date.now()}));var U=!(null!==(p=P.options)&&void 0!==p&&p.hideCounts||k.options.hideCount);if(_&&t.state.rows&&(w.tables||w.db||!t.state.cols||null!=w&&null!==(m=w.w)&&void 0!==m&&m.columns||null!=w&&w.w&&"filter"in(null==w?void 0:w.w)||["cardRows","hideEditRow"].some((e=>F.includes(e))))&&(v=v||{},v={onSort:(b=Io((function*(e){return t.setState({sort:e})})),function(){return b.apply(this,arguments)}),loading:!1,cols:yield t.getTableCols(v.rows||t.state.rows),totalRows:U?+(yield _[N].count()):0,onRowClick:(e,n)=>{var r;e&&null!==(r=t.d.w)&&void 0!==r&&r.columns.find((t=>!t.computedConfig&&!t.format&&Object.keys(e).includes(t.name)))?T(e,n):T(void 0,void 0)}}),k&&N&&_&&_[N]&&_[N].find&&(!x&&_[N]||null!==(g=w.w)&&void 0!==g&&null!==(y=g.options)&&void 0!==y&&y.refresh||null!=w&&w.dataAge||["pageSize","page","sort","filter","joinFilter","limit","cols","dataAge","db","activeRow","columns"].some((e=>e in w||w.w&&e in w.w)))){var V,H,q,W,G,$={$and:[j&&!Ne(j)?j:void 0,t.props.joinFilter].filter((e=>e))},Y=JSON.stringify($),X=()=>{var e,n;return null===(e=t.dataSub)||void 0===e||null===(n=e.unsubscribe)||void 0===n?void 0:n.call(e)},K=()=>{t.autoRefresh&&(clearTimeout(t.autoRefresh),t.autoRefresh=null)},Z=function(){var e=Io((function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;yield X(),K(),t.dataSubFilter=Y,t.dataSub=yield _[N].subscribe($,{select:"",throttle:1e3*e},(()=>{t.setData({dataAge:Date.now()})}))}));return function(){return e.apply(this,arguments)}}();if("Realtime"===(null==k||null===(V=k.options)||void 0===V||null===(H=V.refresh)||void 0===H?void 0:H.type)&&_[N].subscribe&&t.dataSubFilter!==Y&&Z(null==k||null===(W=k.options)||void 0===W||null===(G=W.refresh)||void 0===G?void 0:G.throttleSeconds),"refresh"in((null==w||null===(q=w.w)||void 0===q?void 0:q.options)||{})){var J;yield X(),K();var{type:Q="None",throttleSeconds:ee=0,intervalSeconds:te=3}=(null==k||null===(J=k.options)||void 0===J?void 0:J.refresh)||{};"Realtime"===Q?Z(ee):"Interval"===Q&&0<te&&(t.autoRefresh=setInterval((()=>{t.setState({dataAge:Date.now()})}),1e3*te))}t.loadingData=!0;try{var{select:ne,barchartVals:re}=yield jo.getSelect(k,A,_,$);re&&((v=v||{}).barchartVals=Lo(Lo({},t.state.barchartVals),re));var ie=jo.getSort(A,k),{limit:oe,offset:se}=t.getPagination(),ae=jo.getDataRequestSignature({select:ne,orderBy:ie,limit:oe,offset:se,joinFilter:O,filter:$});if(null!=w&&w.dataAge||t.currentDataRequestSignature!==ae){if(t.currentDataRequestSignature=ae,t.setState({runningQuery:!0}),Object.keys(ne).length){var le,ce=yield _[N].count($),ue=yield _[N].find($,{select:ne,orderBy:ie,limit:oe,offset:se});t.activeRowStr=JSON.stringify(O||{});var he=ue.map((e=>Lo({},e)));null!==(le=k.columns)&&void 0!==le&&le.some((e=>Number.isFinite(e.width)))||((v=v||{}).localCols=jo.getFullColumnConfig(A,k,he),k.$update({columns:v.localCols}));var de=U?"".concat(k.table_name," - ").concat(ce.toLocaleString()," records"):k.table_name;de!==k.name&&k.$update({name:de}),(v=Lo(Lo({},v),{},{rows:he,rowCount:ce})).joinFilterStr=O?JSON.stringify(O):void 0}else v=Lo(Lo({},v),{},{rows:[],rowCount:0});v.error=void 0,t.dataAge=Date.now()}}catch(e){console.error(e),v=Lo(Lo({},v),{},{error:e,cols:[]})}t.loadingData=!1}!v&&F.length&&["viewAsCard","hideCardFieldNames","cardRows","hideEditRow","showFilters"].some((e=>F.includes(e)))&&(v={}),v&&(v.runningQuery=!1,t.setState(v))}}));return function(){return e.apply(this,arguments)}}()),Do(this,"getWCols",(()=>{var{w:e}=this.d,{tables:t}=this.props,{rows:n}=this.state;return jo.getFullColumnConfig(t,e,n)})),Do(this,"getPaginationProps",(()=>{var{page:e,pageSize:t}=this.d,{rowCount:n}=this.state;return{page:e,pageSize:t,totalRows:n,onPageChange:e=>{this.setData({page:e})},onPageSizeChange:e=>{this.setData({pageSize:e})}}})),Do(this,"getMenu",((t,n)=>{var{db:r,onLinkTable:i,onAddChart:o,dbs:s,tables:a}=this.props,l=t.columns;return l?e.createElement(ii,{db:r,dbs:s,tableName:t.table_name,cols:l.filter((e=>!e.computed)),tables:a,onAddChart:o,w:t,onLinkTable:i,onClose:n}):null})),Do(this,"renderCell",(()=>{}))}static getColWidth(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0,i=e;if(t&&(null==e||!e.some((e=>Number.isFinite(e.width))))){var o=0,s=0;if(i=i.map((e=>{var r=Lo({},e);return t.map((e=>{var t=8*JSON.stringify(e[r[n]]||"").length,i=Number.isFinite(r.width)?r.width:t;r.width=Math.min(Math.max(t,100,i),300)})),r.width=r.width||100,r.width>=300&&s++,o+=r.width,r})),r&&r>o){var a=r-o-25;i=i.map((e=>(s?e.width>=300&&(e.width+=a/s):e.width+=a/i.length,e)))}}return i}static getFullColumnConfig(e,t,n,r){var{columns:i,table_name:o}=t,s=e.find((e=>e.name===o)),a=e=>e.computedConfig,l=(i||[]).map((e=>Lo(Lo({},e),{},{info:a(e)?void 0:s.columns.find((t=>t.name===e.name))})));l=l.filter((e=>!(!e.computedConfig&&!e.info)&&(!e.format||e.info)));var c=s.columns.filter((e=>!l.find((t=>t.info&&t.name===e.name))));return l=l.concat(c.map((e=>({info:e,name:e.name,show:!0})))),l=jo.getColWidth(l,n,"name",r)}static getSelect(e,t,n,r){return Io((function*(){var i,o={};return e.columns&&Array.isArray(e.columns)?yield Promise.all(jo.getFullColumnConfig(t,e).map(function(){var t=Io((function*(t){if(t.show){if(t.style&&["Barchart","Scale"].includes(t.style.type)){var s;if(t.computedConfig)throw"Cannot use Scale/Barchart styling on a computed column";i=i||{};var a=yield n[e.table_name].findOne(r,{select:{minValue:{$min:[t.name]},maxValue:{$max:[t.name]}}}),l="Date"===(null===(s=t.info)||void 0===s?void 0:s.tsDataType);a&&(i[t.name]={minValue:l?+new Date(a.minValue):+a.minValue,maxValue:l?+new Date(a.maxValue):+a.maxValue})}o[t.name]=t.format&&"NONE"!==t.format?"$ST_SnapToGrid"===t.format?{[t.format]:[t.name,.002]}:["base64","Media","URL","HTML","Email","Tel"].includes(t.format)?1:t.format:null!=t&&t.computedConfig?{[t.computedConfig.funcName]:t.computedConfig.column?[t.computedConfig.column,...t.computedConfig.extraArgs||[]]:[]}:1}}));return function(){return t.apply(this,arguments)}}())):o={"*":1},{barchartVals:i,select:o}}))()}static getSort(e,t){var{sort:n}=t;if(!n)return[];var r=n.map((e=>Lo({},e))),i=e.find((e=>e.name===t.table_name)).columns,o=t.columns;return r=r.filter((e=>{if(!o)return i.some((t=>t.name===e.key));var t=o.find((t=>t.name===e.key));return i.some((e=>{var n,r;return null!=t&&t.computedConfig?!(null!==(n=t.computedConfig)&&void 0!==n&&n.column)||(null===(r=t.computedConfig)||void 0===r?void 0:r.column)===e.name:t.name===e.name}))}))}onMount(){var e=this;return Io((function*(){var{db:t,dbs:n,w:r,tables:i}=e.props;if(r&&!r.filter&&r.$update({filter:[]}),t&&!e.d.wSync){var o=r.$cloneSync(((t,n)=>{e.setData({w:t},{w:n})}));e.setData({wSync:o})}}))()}onUnmount(){var e=this;return Io((function*(){var t,n;yield null===(t=e.dataSub)||void 0===t||null===(n=t.unsubscribe)||void 0===n?void 0:n.call(t)}))()}static getDataRequestSignature(e){if("sql"in e)return e.sql;var{filter:t,joinFilter:n,select:r,limit:i,offset:o,orderBy:s}=e;return JSON.stringify({filter:t,joinFilter:n,select:r,limit:i,offset:o,orderBy:s})}getPagination(){var{pageSize:e,page:t}=this.d;return{limit:e,offset:this.props.joinFilter?0:(t-1)*e}}getCardView(){var{rows:t=[],cols:n}=this.state,{page:r,pageSize:i,w:o}=this.d,{cardRows:s=1,hideCardFieldNames:a}=o.options||{};return e.createElement("div",{className:(1<s?" flex-row-wrap ":" flex-col ")+" o-auto no-scroll-bar f-1 min-w-0 min-h-0 px-p5 bg-gray-200 pt-p5",style:{placeContent:1<s?"flex-start":void 0}},t.map(((t,r)=>e.createElement("div",{key:r,className:"card bg-white flex-row-wrap  f-0 min-w-0 "+(r||1<s?"mt-p5":"")+(1<s?" h-fit w-fit ":""),style:{padding:window.isMobileDevice?".5em":"1em",paddingTop:0,width:1<s?"calc(".concat(99/s,"% - .5em)"):"",marginRight:1<s?".5em":""}},n.filter((e=>!e.hidden)).map(((n,r)=>{var i,l,c,u;return e.createElement("div",{key:r,className:" flex-col mt-p5 mr-1 min-w-0 "+(1<s?" h-fit w-fit ":"")},!a&&e.createElement("div",{className:" text-gray-400 "},n.name),e.createElement("div",{className:" o-auto ",style:Lo(Lo({},(null===(i=n.getCellStyle)||void 0===i?void 0:i.call(n,t,t[n.name],t[n.name]))||{}),{},{maxHeight:"".concat((null==o||null===(l=o.options)||void 0===l?void 0:l.maxRowHeight)||100,"px")})},null!==(c=null===(u=n.onRender)||void 0===u?void 0:u.call(n,t,t[n.name],t[n.name]))&&void 0!==c?c:KM.renderValue(n,t[n.name])))}))))),e.createElement(VM,this.getPaginationProps()))}render(){var t=this,{loading:n,totalRows:r,rows:i=[],cols:o,popup:s,runningQuery:a,rowPanel:l,filterPopup:c,error:u}=this.state,{page:h,pageSize:d,w:f}=this.d,{db:p,setLinkMenu:m,joinFilter:g,activeRow:y,onAddChart:v,dbs:b,activeRowStyle:w,tables:x}=this.props,E=this.activeRowStr===JSON.stringify(g||{})?w:{},_=null;if(null!=f&&f.table_name&&!p[f.table_name])_=e.createElement("div",{className:" p-2 flex-row ai-center text-red-700"},e.createElement(Ae(),{path:Q,size:1,className:"mr-p5 "}),"Table ",JSON.stringify(f.table_name)," not found");else if(!n&&f&&p&&(!f.table_name||p[f.table_name]&&o)){var S,C,T,O,{table_name:P}=f,A=-1;y&&y.row_filter&&(A=i.findIndex((e=>zo(y.row_filter,e))));var k=!!(p&&P&&p[P]&&p[P].insert);_=e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-col f-1 min-h-0 min-w-0 ",ref:e=>{e&&(this.ref=e)}},null!=f&&null!==(S=f.options)&&void 0!==S&&S.showFilters?e.createElement("div",{className:" ai-center p-p5 bg-gray-200",onClick:()=>{this.setState({filterPopup:!c})},title:"Edit filters"},e.createElement(Mo,{db:p,w:f,tables:x,className:""})):null,e.createElement("div",{className:"flex-col oy-auto f-1 relative bt b-gray-300"},a?e.createElement(Xe,{variant:"cover"}):null,u&&e.createElement(Fe,{style:{flex:"unset"},error:u}),null!=f&&f.options.viewAsCard?this.getCardView():e.createElement(UM,{maxCharsPerCell:null!==(C=null==f||null===(T=f.options)||void 0===T?void 0:T.maxCellChars)&&void 0!==C?C:500,maxRowHeight:null==f||null===(O=f.options)||void 0===O?void 0:O.maxRowHeight,rowStyle:g?E:{},onSort:e=>{f.$update({sort:e})},cols:(o||[]).filter((e=>{var t=this.getWCols();if(t&&Array.isArray(t)){var n=t.find((t=>t.name===e.name));if(n)return!!n.show}return!e.hidden})).sort(((e,t)=>{var n=this.getWCols();if(n&&Array.isArray(n)){var r=n.findIndex((t=>t.name===e.name)),i=n.findIndex((e=>e.name===t.name));if(-1<r&&-1<i)return r-i}return 0})).map((e=>{return Lo(Lo({},e),{},{headerClassname:"number"===e.tsDataType?" jc-end  ":" ",className:"number"===e.tsDataType?" ta-right ":" ",onResize:(n=Io((function*(n){var r=t.getWCols();if(Array(r)){var i=r.map((t=>(t.name===e.key&&(t.width=n),t)));f.$update({columns:i})}})),function(){return n.apply(this,arguments)})});var n})),rows:i,sort:f.sort,style:{flex:1,boxShadow:"unset"},tableStyle:{borderRadius:"unset",border:"unset"},pagination:this.getPaginationProps(),activeRowStyle:E,activeRowIndex:A,onRowClick:this.state.onRowClick}),k?e.createElement(et,{iconPath:we,title:"Insert row",className:"shadow w-fit h-fit",color:"action",style:{position:"absolute",right:"15px",bottom:"15px",background:"#ffffff",lineHeight:"unset"},onClick:Io((function*(){t.setState({rowPanel:{type:"insert",data:void 0}})}))}):null)),s?e.createElement(pt,{rootStyle:s.style,anchorEl:s.anchorEl,positioning:s.positioning,clickCatchStyle:{opacity:.25,backdropFilter:"blur(1px)"},onClose:()=>{this.setState({popup:void 0})},open:!0,contentClassName:""},s.content):null,l&&e.createElement(lo,{asPopup:!0,confirmUpdates:!0,hideChangesOptions:!0,db:p,tables:x,tableName:P,rowFilter:l.data,onSuccess:()=>{this.setState({dataAge:Date.now()})},onClose:()=>{this.setState({rowPanel:null})}}))}else _=e.createElement(Xe,{className:"m-auto absolute"});return e.createElement(Eo,{w:f,quickMenuProps:{tables:x,dbs:b,setLinkMenu:m,onAddChart:v},getMenu:this.getMenu},_)}}function Fo(e){var t=Math.abs(e);return 999999<t?Math.sign(e)*+(Math.abs(e)/1e6).toFixed(1)+"m":999<t?Math.sign(e)*+(Math.abs(e)/1e3).toFixed(1)+"k":e}function zo(e,t){return!(!e||!t||Object.keys(e).some((n=>e[n]!==t[n])))}function Bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uo(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Bo(Object(t),!0).forEach((function(n){Vo(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Bo(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ho(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function qo(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Ho(a,r,i,o,s,"next",e)}function s(e){Ho(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function Wo(){return Go.apply(this,arguments)}function Go(){return(Go=qo((function*(e){return yield e.sql("  SELECT *, format('%I', usename) as escaped_identifier FROM pg_catalog.pg_user",{},{returnType:"rows"})}))).apply(this,arguments)}function $o(){return Yo.apply(this,arguments)}function Yo(){return(Yo=qo((function*(e){return yield e.sql("SELECT *, format('%I', datname) as escaped_identifier FROM pg_catalog.pg_database ",{},{returnType:"rows"})}))).apply(this,arguments)}function Xo(){return Xo=qo((function*(e){var t=[];(yield ts(e)).map((e=>{t.push({label:e.name,subLabel:"(".concat(e.cols.map((e=>"".concat(e.escaped_identifier," ").concat(e.udt_name.toUpperCase()))).join(", "),")"),escapedIdentifier:e.escaped_identifier,schema:e.schema,insertText:e.escaped_identifier,detail:"(table)",documentation:"**".concat(e.escaped_identifier,"**  \n").concat(e.cols.map((e=>"- ".concat(e.name,"     ","`").concat(e.udt_name,"`"))).join("  \n")," "),type:"table",cols:e.cols}),t=t.concat(e.cols.map((t=>({label:t.name,detail:"(column) ",escapedParentName:e.escaped_identifier,schema:e.schema,parentName:e.name,parentOID:e.oid,insertText:t.escaped_identifier,documentation:"Type: `".concat("ARRAY"===t.data_type?"".concat(t.udt_name.slice(1),"[]"):t.udt_name,"`  \n Schema: `").concat(e.schema,"`  \n Table: `").concat(e.name,"`  "),type:"column"}))))}));var n=yield $o(e);t=t.concat(n.map((e=>({label:e.datname,escapedIdentifier:e.escaped_identifier,insertText:e.escaped_identifier,detail:"(database) ",documentation:" ",type:"database"}))));var r=yield Wo(e);t=t.concat(r.map((e=>({label:e.usename,escapedIdentifier:e.escaped_identifier,insertText:e.escaped_identifier,detail:"(role)\n\n   usesuper: ".concat(e.usesuper,"\n   usecreatedb: ").concat(e.usecreatedb,"\n   usecreatedb: ").concat(e.userepl,"\n   usebypassrls: ").concat(e.usebypassrls),documentation:" ",type:"role"}))));var i=yield as({db:e,minArgs:0,limit:4e3,distinct:!0});t=t.concat(i.map((e=>({label:e.name,subLabel:e.func_signature,escapedIdentifier:e.escaped_identifier,insertText:e.escaped_identifier,detail:"(".concat(e.is_aggregate?"agg ":"","function) \n").concat(e.name,"(").concat(e.arg_list_str,") => ").concat(e.restype),documentation:"Schema: `".concat(e.schema,"`  \n\n").concat((e.description||"").trim()),type:"function",definition:e.definition}))));var o=yield Zo(e);t=t.concat(o.map((e=>({label:e.name,detail:"(data type)",documentation:e.name,properties:e,type:"dataType"}))));var s=yield Qo(e);t=t.concat(s.map((e=>({label:e,detail:"(keyword)",documentation:e,type:"keyword"}))));var a=yield rs(e);t=t.concat(a.map((e=>({label:e.name,detail:"(extension) \nv".concat(e.default_version,"  ").concat(e.installed?"Installed":"Not installed"," "),documentation:e.comment,type:"extension"}))));var l=(yield os(e)).map((e=>{var{name:t}=e;return{label:t,detail:"(schema)",type:"schema"}}));t=(t=t.concat(l)).map((e=>(!e.insertText&&["extension","function","table","column"].includes(e.type)&&(e.label[0].match(/[^a-z_]/g)||e.label.slice(1).match(/[^a-z_0-9]/g))&&(e.insertText=JSON.stringify(e.label)),e)));var c=(yield Ko(e)).map((e=>({label:"".concat(e.name,"   (").concat(e.setting,")"),detail:"(setting)",type:"setting",insertText:e.name,documentation:"**".concat(e.description,"**  \n").concat(["setting","unit","min_val","max_val","reset_val"].map((t=>"- ".concat(t,"     ","`").concat(e[t],"`"))).join("  \n")," ")})));return{suggestions:t,settingSuggestions:c}})),Xo.apply(this,arguments)}function Ko(e){return e.sql("\n    SHOW ALL;\n\n    /*\n    SELECT name, setting, unit, short_desc, min_val, max_val, reset_val\n    ,format('%I', name) as escaped_identifier\n    FROM pg_catalog.pg_settings \n    order by name \n    */\n  ",{},{returnType:"rows"})}function Zo(){return Jo.apply(this,arguments)}function Jo(){return(Jo=qo((function*(e){var t=Object.keys(e).filter((t=>e[t].getColumns));return yield e.sql("select typname as name, typtype, typtype NOT IN ('p', 'd', 'c') AS for_cols from pg_type "+(t.length?"WHERE typname NOT IN ($1:csv) ":""),[t.concat(t.map((e=>"_"+e)))],{returnType:"rows"})}))).apply(this,arguments)}function Qo(){return es.apply(this,arguments)}function es(){return(es=qo((function*(e){return(yield e.sql("select upper(word) as word from pg_get_keywords();",{},{returnType:"rows"})).map((e=>e.word)).concat(["RAISE","NOTICE","IF NOT EXISTS"])}))).apply(this,arguments)}function ts(){return ns.apply(this,arguments)}function ns(){return(ns=qo((function*(e){return yield e.sql("\n      SELECT -- COUNT(*)\n      c.oid,\n      relkind,\n      nspname as schema, \n      relname as name,\n      CASE WHEN current_schema() = nspname THEN format('%I', relname) ELSE format('%I.%I', nspname, relname) END as escaped_identifier,\n      json_agg((\n        SELECT x FROM (\n          SELECT column_name as name,\n          format('%I', column_name) as escaped_identifier,\n          data_type, \n          udt_name\n        ) as x\n      ) ORDER BY ordinal_position ) as cols \n      FROM pg_catalog.pg_class AS c\n      JOIN pg_catalog.pg_namespace AS ns\n        ON c.relnamespace = ns.oid\n      INNER JOIN information_schema.columns cols\n      ON (cols.table_schema, cols.table_name) IN ((nspname, relname))\n      WHERE relkind IN ('r', 'v', 'm' )\n      --AND relname ilike 'trigger%'\n      GROUP BY c.oid, relkind, nspname, relname\n    ",{},{returnType:"rows"})}))).apply(this,arguments)}function rs(){return is.apply(this,arguments)}function is(){return(is=qo((function*(e){return yield e.sql("SELECT *, installed_version IS NOT NULL as installed  FROM pg_available_extensions;",{},{returnType:"rows"})}))).apply(this,arguments)}function os(){return ss.apply(this,arguments)}function ss(){return(ss=qo((function*(e){return yield e.sql("\n    SELECT schema_name as name \n    FROM information_schema.schemata\n  ",{},{returnType:"rows"})}))).apply(this,arguments)}function as(){return ls.apply(this,arguments)}function ls(){return ls=qo((function*(e){var{db:t,name:n,minArgs:r=0,limit:i=10,distinct:o=!1,searchTerm:s}=e;if(s);else if(void 0===n)n="";else if(""===n)return[];var a=" LIMIT ${limit}",l="\n        SELECT *\n          , upper(name) || '(' || concat_ws(',', arg_list_str) || ')' || ' => ' || restype || E'\n' || description as func_signature\n          , CASE WHEN is_aggregate THEN 'Could not get aggregate function definition' ELSE pg_get_functiondef(oid) END as definition\n          , CASE WHEN schema IS NULL OR current_schema() = schema OR schema = 'pg_catalog' THEN format('%I', name) ELSE format('%I.%I', schema, name) END as escaped_identifier\n        FROM (\n          SELECT p.proname AS name\n                , pg_get_function_identity_arguments(p.oid) AS arg_list_str\n                , pg_catalog.pg_get_function_result(p.oid) as restype\n                , d.description\n                , n.nspname as schema\n                , pronargs as args_length\n                , prokind = 'a' as is_aggregate\n                , p.oid\n          FROM   pg_proc p\n          LEFT JOIN pg_description d ON d.objoid = p.oid\n          LEFT JOIN pg_catalog.pg_namespace n ON n.oid = p.pronamespace\n          WHERE TRUE\n          ".concat(" AND pronargs >= ${minArgs} ","\n          ").concat(" AND p.proname ilike ${name} ","\n        ) tt\n      "),c="\n    SELECT DISTINCT ON (length(name::text), name) name, arg_list_str, description, args_length, is_aggregate, restype, schema, func_signature, definition, escaped_identifier\n    FROM (\n      SELECT * \n      FROM (\n        ".concat(l,"  \n      ) t\n      WHERE TRUE\n      ORDER BY arg_list_str ILIKE '%cstring%' OR arg_list_str = 'cstring'\n    ) t     \n    ORDER BY length(name::text), name, arg_list_str, description \n    ").concat(a,"\n  ");return yield t.sql(o?c:l+"\n"+a,{name:n||"%",limit:i,minArgs:r}).then((e=>e.rows.map((e=>{var t=(e.arg_list_str?e.arg_list_str.split(","):[]).map(((e,t)=>({label:"arg".concat(t,": ")+e.trim(),data_type:e.trim()})));return e.arg_list_str=t.map((e=>e.label)).join(", "),Uo(Uo({},e),{},{args:t})}))))})),ls.apply(this,arguments)}Do(jo,"getJoinedTables",((e,t)=>{var n,r=(null===(n=e.find((e=>e.name===t)))||void 0===n?void 0:n.columns).filter((e=>e.references)).map((e=>{var t,n;return{tableName:null===(t=e.references)||void 0===t?void 0:t.ftable,on:[e.name,null===(n=e.references)||void 0===n?void 0:n.fcols[0]]}})),i=[];return e.filter((e=>e.name!==t)).forEach((e=>{var{name:n,columns:r}=e;r.forEach((e=>{var r,o;(null===(r=e.references)||void 0===r?void 0:r.ftable)===t&&i.push({tableName:n,on:[null===(o=e.references)||void 0===o?void 0:o.fcols[0],e.name]})}))})),[...r,...i]}));var cs=["A","ABORT","ABS","ABSENT","ABSOLUTE","ACCESS","ACCORDING","ACTION","ADA","ADD","ADMIN","AFTER","AGGREGATE","ALL","ALLOCATE","ALSO","ALTER","ALWAYS","ANALYSE","ANALYZE","AND","ANY","ARE","ARRAY","ARRAY_AGG","ARRAY_MAX_CARDINALITY","AS","ASC","ASENSITIVE","ASSERTION","ASSIGNMENT","ASYMMETRIC","AT","ATOMIC","ATTRIBUTE","ATTRIBUTES","AUTHORIZATION","AVG","BACKWARD","BASE64","BEFORE","BEGIN","BEGIN_FRAME","BEGIN_PARTITION","BERNOULLI","BETWEEN","BIGINT","BINARY","BIT","BIT_LENGTH","BLOB","BLOCKED","BOM","BOOLEAN","BOTH","BREADTH","BY","C","CACHE","CALL","CALLED","CARDINALITY","CASCADE","CASCADED","CASE","CAST","CATALOG","CATALOG_NAME","CEIL","CEILING","CHAIN","CHAR","CHARACTER","CHARACTERISTICS","CHARACTERS","CHARACTER_LENGTH","CHARACTER_SET_CATALOG","CHARACTER_SET_NAME","CHARACTER_SET_SCHEMA","CHAR_LENGTH","CHECK","CHECKPOINT","CLASS","CLASS_ORIGIN","CLOB","CLOSE","CLUSTER","COALESCE","COBOL","COLLATE","COLLATION","COLLATION_CATALOG","COLLATION_NAME","COLLATION_SCHEMA","COLLECT","COLUMN","COLUMNS","COLUMN_NAME","COMMAND_FUNCTION","COMMAND_FUNCTION_CODE","COMMENT","COMMENTS","COMMIT","COMMITTED","CONCURRENTLY","CONDITION","CONDITION_NUMBER","CONFIGURATION","CONFLICT","CONNECT","CONNECTION","CONNECTION_NAME","CONSTRAINT","CONSTRAINTS","CONSTRAINT_CATALOG","CONSTRAINT_NAME","CONSTRAINT_SCHEMA","CONSTRUCTOR","CONTAINS","CONTENT","CONTINUE","CONTROL","CONVERSION","CONVERT","COPY","CORR","CORRESPONDING","COST","COUNT","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CSV","CUBE","CUME_DIST","CURRENT","CURRENT_CATALOG","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_PATH","CURRENT_ROLE","CURRENT_ROW","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CURSOR_NAME","CYCLE","DATA","DATABASE","DATALINK","DATE","DATETIME_INTERVAL_CODE","DATETIME_INTERVAL_PRECISION","DAY","DB","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFERRABLE","DEFERRED","DEFINED","DEFINER","DEGREE","DELETE","DELIMITER","DELIMITERS","DENSE_RANK","DEPTH","DEREF","DERIVED","DESC","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DICTIONARY","DISABLE","DISCARD","DISCONNECT","DISPATCH","DISTINCT","DLNEWCOPY","DLPREVIOUSCOPY","DLURLCOMPLETE","DLURLCOMPLETEONLY","DLURLCOMPLETEWRITE","DLURLPATH","DLURLPATHONLY","DLURLPATHWRITE","DLURLSCHEME","DLURLSERVER","DLVALUE","DO","DOCUMENT","DOMAIN","DOUBLE","DROP","DYNAMIC","DYNAMIC_FUNCTION","DYNAMIC_FUNCTION_CODE","EACH","ELEMENT","ELSE","EMPTY","ENABLE","ENCODING","ENCRYPTED","END","END-EXEC","END_FRAME","END_PARTITION","ENFORCED","ENUM","EQUALS","ESCAPE","EVENT","EVERY","EXCEPT","EXCEPTION","EXCLUDE","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXP","EXPLAIN","EXPRESSION","EXTENSION","EXTERNAL","EXTRACT","FALSE","FAMILY","FETCH","FILE","FILTER","FINAL","FIRST","FIRST_VALUE","FLAG","FLOAT","FLOOR","FOLLOWING","FOR","FORCE","FOREIGN","FORTRAN","FORWARD","FOUND","FRAME_ROW","FREE","FREEZE","FROM","FS","FULL","FUNCTION","FUNCTIONS","FUSION","G","GENERAL","GENERATED","GET","GLOBAL","GO","GOTO","GRANT","GRANTED","GREATEST","GROUP","GROUPING","GROUPS","HANDLER","HAVING","HEADER","HEX","HIERARCHY","HOLD","HOUR","ID","IDENTITY","IF","IGNORE","ILIKE","IMMEDIATE","IMMEDIATELY","IMMUTABLE","IMPLEMENTATION","IMPLICIT","IMPORT","IN","INCLUDING","INCREMENT","INDENT","INDEX","INDEXES","INDICATOR","INHERIT","INHERITS","INITIALLY","INLINE","INNER","INOUT","INPUT","INSENSITIVE","INSERT","INSTANCE","INSTANTIABLE","INSTEAD","INT","INTEGER","INTEGRITY","INTERSECT","INTERSECTION","INTERVAL","INTO","INVOKER","IS","ISNULL","ISOLATION","JOIN","K","KEY","KEY_MEMBER","KEY_TYPE","LABEL","LAG","LANGUAGE","LARGE","LAST","LAST_VALUE","LATERAL","LEAD","LEADING","LEAKPROOF","LEAST","LEFT","LENGTH","LEVEL","LIBRARY","LIKE","LIKE_REGEX","LIMIT","LINK","LISTEN","LN","LOAD","LOCAL","LOCALTIME","LOCALTIMESTAMP","LOCATION","LOCATOR","LOCK","LOCKED","LOGGED","LOWER","M","MAP","MAPPING","MATCH","MATCHED","MATERIALIZED","MAX","MAXVALUE","MAX_CARDINALITY","MEMBER","MERGE","MESSAGE_LENGTH","MESSAGE_OCTET_LENGTH","MESSAGE_TEXT","METHOD","MIN","MINUTE","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MORE","MOVE","MULTISET","MUMPS","NAME","NAMES","NAMESPACE","NATIONAL","NATURAL","NCHAR","NCLOB","NESTING","NEW","NEXT","NFC","NFD","NFKC","NFKD","NIL","NO","NONE","NORMALIZE","NORMALIZED","NOT","NOTHING","NOTIFY","NOTNULL","NOWAIT","NTH_VALUE","NTILE","NULL","NULLABLE","NULLIF","NULLS","NUMBER","NUMERIC","OBJECT","OCCURRENCES_REGEX","OCTETS","OCTET_LENGTH","OF","OFF","OFFSET","OIDS","OLD","ON","ONLY","OPEN","OPERATOR","OPTION","OPTIONS","OR","ORDER","ORDERING","ORDINALITY","OTHERS","OUT","OUTER","OUTPUT","OVER","OVERLAPS","OVERLAY","OVERRIDING","OWNED","OWNER","P","PAD","PARAMETER","PARAMETER_MODE","PARAMETER_NAME","PARAMETER_ORDINAL_POSITION","PARAMETER_SPECIFIC_CATALOG","PARAMETER_SPECIFIC_NAME","PARAMETER_SPECIFIC_SCHEMA","PARSER","PARTIAL","PARTITION","PASCAL","PASSING","PASSTHROUGH","PASSWORD","PATH","PERCENT","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PERIOD","PERMISSION","PLACING","PLANS","PLI","POLICY","PORTION","POSITION","POSITION_REGEX","POWER","PRECEDES","PRECEDING","PRECISION","PREPARE","PREPARED","PRESERVE","PRIMARY","PRIOR","PRIVILEGES","PROCEDURAL","PROCEDURE","PROGRAM","PUBLIC","QUOTE","RANGE","RANK","READ","READS","REAL","REASSIGN","RECHECK","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","REINDEX","RELATIVE","RELEASE","RENAME","REPEATABLE","REPLACE","REPLICA","REQUIRING","RESET","RESPECT","RESTART","RESTORE","RESTRICT","RESULT","RETURN","RETURNED_CARDINALITY","RETURNED_LENGTH","RETURNED_OCTET_LENGTH","RETURNED_SQLSTATE","RETURNING","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUTINE","ROUTINE_CATALOG","ROUTINE_NAME","ROUTINE_SCHEMA","ROW","ROWS","ROW_COUNT","ROW_NUMBER","RULE","SAVEPOINT","SCALE","SCHEMA","SCHEMA_NAME","SCOPE","SCOPE_CATALOG","SCOPE_NAME","SCOPE_SCHEMA","SCROLL","SEARCH","SECOND","SECTION","SECURITY","SELECT","SELECTIVE","SELF","SENSITIVE","SEQUENCE","SEQUENCES","SERIALIZABLE","SERVER","SERVER_NAME","SESSION","SESSION_USER","SET","SETOF","SETS","SHARE","SHOW","SIMILAR","SIMPLE","SIZE","SKIP","SMALLINT","SNAPSHOT","SOME","SOURCE","SPACE","SPECIFIC","SPECIFICTYPE","SPECIFIC_NAME","SQL","SQLCODE","SQLERROR","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQRT","STABLE","STANDALONE","START","STATE","STATEMENT","STATIC","STATISTICS","STDDEV_POP","STDDEV_SAMP","STDIN","STDOUT","STORAGE","STRICT","STRIP","STRUCTURE","STYLE","SUBCLASS_ORIGIN","SUBMULTISET","SUBSTRING","SUBSTRING_REGEX","SUCCEEDS","SUM","SYMMETRIC","SYSID","SYSTEM","SYSTEM_TIME","SYSTEM_USER","T","TABLE","TABLES","TABLESAMPLE","TABLESPACE","TABLE_NAME","TEMP","TEMPLATE","TEMPORARY","TEXT","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOKEN","TOP_LEVEL_COUNT","TRAILING","TRANSACTION","TRANSACTIONS_COMMITTED","TRANSACTIONS_ROLLED_BACK","TRANSACTION_ACTIVE","TRANSFORM","TRANSFORMS","TRANSLATE","TRANSLATE_REGEX","TRANSLATION","TREAT","TRIGGER","TRIGGER_CATALOG","TRIGGER_NAME","TRIGGER_SCHEMA","TRIM","TRIM_ARRAY","TRUE","TRUNCATE","TRUSTED","TYPE","TYPES","UESCAPE","UNBOUNDED","UNCOMMITTED","UNDER","UNENCRYPTED","UNION","UNIQUE","UNKNOWN","UNLINK","UNLISTEN","UNLOGGED","UNNAMED","UNNEST","UNTIL","UNTYPED","UPDATE","UPPER","URI","USAGE","USER","USER_DEFINED_TYPE_CATALOG","USER_DEFINED_TYPE_CODE","USER_DEFINED_TYPE_NAME","USER_DEFINED_TYPE_SCHEMA","USING","VACUUM","VALID","VALIDATE","VALIDATOR","VALUE","VALUES","VALUE_OF","VARBINARY","VARCHAR","VARIADIC","VARYING","VAR_POP","VAR_SAMP","VERBOSE","VERSION","VERSIONING","VIEW","VIEWS","VOLATILE","WHEN","WHENEVER","WHERE","WHITESPACE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WORK","WRAPPER","WRITE","XML","XMLAGG","XMLATTRIBUTES","XMLBINARY","XMLCAST","XMLCOMMENT","XMLCONCAT","XMLDECLARATION","XMLDOCUMENT","XMLELEMENT","XMLEXISTS","XMLFOREST","XMLITERATE","XMLNAMESPACES","XMLPARSE","XMLPI","XMLQUERY","XMLROOT","XMLSCHEMA","XMLSERIALIZE","XMLTABLE","XMLTEXT","XMLVALIDATE","YEAR","YES","ZONE","IF NOT EXISTS"],us=Array.from(new Set([...[{key:"SELECT",type:"column"},{key:"RETURNING",type:"column"},{key:"FROM",type:"table"},{key:"INTO",type:"table"},{key:"JOIN",type:"table"},{key:"ON",type:"column"},{key:"WHERE",type:"column"},{key:"ORDER BY",type:"column"},{key:"UPDATE",type:"table"},{key:"DELETE",type:"table"},{key:"TABLE",type:"table"}].map((e=>e.key)),...ds()]));cs=cs.sort(((e,t)=>+us.includes(t)-+us.includes(e)));var hs=ds();function ds(){return["SELECT","FROM","INNER","JOIN","LEFT","CREATE","ALTER","TABLE","OFFSET","LIMIT","ORDER","ON","COLUMN","DROP","DELETE","UPDATE","INSERT","VALUES","WHERE","AND","OR","INTO","INDEX","USING","COMMENT","BEGIN","DO","WITH","SET","COPY","EXPLAIN","VACUUM","NOTIFY","LISTEN","RAISE","NOTICE","SHOW","GRANT","REVOKE","FOR"].map((e=>{var t,n=!1;return"SELECT"===e?(n=!0,t="Retrieves data from tables, functions or other objects   \n```sql\nSELECT * FROM users;\n\nSELECT version();\n\nSELECT  f1, f2, MAX(f12)\nFROM table_name \nWHERE f1 = 2 \nGROUP BY col2\nHAVING MAX(f12) < 10\nORDER BY f1 DESC\nLIMIT 1\nOFFSET 2\n```\n"):"SHOW"===e?(n=!0,t="Show the value of a run-time parameter. These variables can be set using the SET statement\n```sql\nSHOW datestyle\n\nSHOW ALL\n```\n"):"LISTEN"===e?(n=!0,t="Listen to NOTIFY notifications on a channel\n```sql\nLISTEN my_channel;\n\n/* To push a message */\nNOTIFY my_channel, 'hello';\n```\n"):"NOTIFY"===e?(n=!0,t="Send a notification to a channel\n```sql\nNOTIFY my_channel, 'hello';\n\n\n/* To listen to this channel */\nLISTEN my_channel;\n```\n"):"DELETE"===e?(n=!0,t="Delete data from a table    \n```sql\nDELETE FROM table_name;\n\nDELETE FROM users\nWHERE last_active < now() - interval'1 month'\nRETURNING *\n```\n"):"FOR"===e?(n=!0,t="Insert data into a table  \n```sql\n\nFOR temprow IN\n  SELECT * FROM mytable LIMIT 10\nLOOP\n  INSERT INTO ...\nEND LOOP;\n\n```\n"):"INSERT"===e?(n=!0,t="Insert data into a table  \n```sql\nINSERT INTO some_table \nDEFAULT VALUES;\n\nINSERT INTO users(age, name, added)\nVALUES(112, 'a', now())\nRETURNING *;\n\n```\n"):"UPDATE"===e?(n=!0,t="Updates data in a table\n```sql\nUPDATE users SET status = 'active';\n\nUPDATE books \nSET title = books || 'active'\nWHERE title NOT ILIKE 'title%';\n\n```\n"):"CREATE"===e?(n=!0,t="Create an object\n```sql\nCREATE TABLE users(\n  age INTEGER,  \n  name TEXT,  \n  type TEXT,  \n  added TIMESTAMP  \n);\n\nCREATE OR REPLACE VIEW admin_users AS \n  SELECT * FROM users WHERE type = 'admin';\n\nCREATE OR REPLACE FUNCTION log_message(VARIADIC args TEXT[]) RETURNS VOID AS $$     \nBEGIN\n\n  IF to_regclass('logs') IS NULL THEN\n    CREATE TABLE IF NOT EXISTS logs(m TEXT);\n  END IF;\n\n  INSERT INTO logs(m) \n  VALUES(concat_ws(' ', args));\n\nEND;\n$$ LANGUAGE plpgsql;\n\n```\n"):"DROP"===e?(n=!0,t="Drop an object  \n```sql\nDROP TABLE users;\n\nDROP TABLE IF EXISTS books;\n\nDROP VIEW admin_users;\n```\n"):"ORDER"===e?(n=!0,t="Sepcify how rows will be ordered\n```sql\n...\nORDER BY col_name, col_name DESC\n\nORDER BY col_name DESC NULLS FIRST\nORDER BY col_name ASC NULLS LAST\n\n```\n"):"RAISE"===e?(n=!0,t="Report messages and raise errors. Can only be used in PL/pgSQL\n```sql\nRAISE EXCEPTION 'something not right';\n\nRAISE NOTICE 'Calling cs_create_job(%)', v_job_id;\n```\n"):"COMMENT"===e?(n=!0,t="Adds a comment to an object\n```sql\nCOMMENT ON FUNCTION log_message \nIS 'Concat and insert arguments into logs table';\n```\n"):"BEGIN"===e?(n=!0,t="Initiates a transaction block where all statements will be executed in a single transaction until an explicit COMMIT or ROLLBACK is given\n```sql\nBEGIN;\nUPDATE orders SET price = 2;\nCOMMIT;\n\nBEGIN ISOLATION LEVEL SERIALIZABLE;\nUPDATE orders SET price = 2;\nCOMMIT;\n```\n"):"FROM"===e?(n=!0,t="Precedes a table or expression \n```sql\nSELECT ... FROM table_name;\n\nDELETE FROM table_name;\n\nSELECT * FROM (SELECT max(a), ... FROM ...)\n```\n"):"DO"===e?(n=!0,t="Execute an anonymous code block\n```sql\nDO $$ \n  DECLARE r regclass;\nBEGIN\n\n  r := to_regclass('my_table');\n  IF r IS NOT NULL THEN\n    UPDATE my_table SET last_check = NOW();\n  END IF;\n\nEND $$;\n```\n"):"FOR"===e?t="Iterate through data. Can only be executed within a function or code block\n```sql\nDO $$ \n  DECLARE usr RECORD;\nBEGIN\n\n  FOR usr IN SELECT * FROM users\n  LOOP\n  \n      DELETE FROM sessions \n      WHERE user_id = usr.id;\n  END LOOP;\n\nEND $$;\n```\n":"SET"===e?(n=!0,t="Change a run-time parameter. Run ` SHOW ALL ` to see all parameters\n```sql\nSET TIME ZONE 'Europe/London';\n\nSET search_path TO my_schema, public;\n\n```\n"):"ALTER"===e?(n=!0,t='Change an object\n```sql\nALTER TABLE users \nADD COLUMN deleted BOOLEAN;\n\nALTER DATABASE database_name \nSET datestyle TO "ISO, DMY";\n\n```\n'):"WITH"===e?(n=!0,t="Specifies a temporary named result set\n```sql\nWITH cte1 AS (SELECT * FROM orders)\n, cte2 AS (SELECT * FROM customers)\n\nSELECT *\nFROM\n  cte1 c1\n  INNER JOIN cte2 c2\n  ON ........\n\n```\n"):"SHOW"===e?(n=!0,t="Show the value of a run-time parameter\n```sql\nSHOW ALL;\n\n\n```\n"):"COPY"===e?(n=!0,t="Export or import data\n```sql\n-- Export to csv\nCOPY my_table TO '/tmp/my_table.csv' WITH (FORMAT CSV, HEADER);\n\n-- Import from csv (Must create table beforehand)\nCOPY zip_codes FROM '/path/to/ZIP_CODES.txt' DELIMITER ',' CSV HEADER;\n```\n"):"JOIN"===e?t="Combine two or more result sets into one\n```sql\nSELECT *\nFROM weather w\nINNER JOIN cities c\nON w.city = c.name;\n```\n":"EXPLAIN"===e?(n=!0,t="Get query plan of a query\n```sql\nEXPLAIN SELECT * FROM weather;\n\nEXPLAIN ANALYZE SELECT * FROM weather;\n```\n"):"VACUUM"===e?(n=!0,t="Garbage-collect and optionally analyze a database\n```sql\nVACUUM (VERBOSE, ANALYZE) my_database;\n```\n"):"GRANT"===e?(n=!0,t="The GRANT command has two basic variants: \n  1. one that grants privileges on a database object (table, column, view, sequence, database, foreign-data wrapper, foreign server, function, procedural language, schema, or tablespace),\n  2. one that grants membership in a role\n\n```sql\nGRANT INSERT, UPDATE ON films TO PUBLIC;\n```\n"):"REVOKE"==e&&(n=!0,t="The REVOKE command revokes previously granted privileges from one or more roles. The key word PUBLIC refers to the implicitly defined group of all roles.\n\n```sql\nREVOKE INSERT, UPDATE ON films TO PUBLIC;\n\n/* Revoke membership in role admins from user joe */\nREVOKE admins FROM joe;\n\n```\n"),{label:e,info:t,start_kwd:n}}))}function fs(e){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}function ps(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||fs()}const ms="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",gs=ps();class ys{constructor(e,t,n="sessionStorage"){this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(e){return null}}(n),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function vs(e,t,n,r=600){const i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));const o=e.width*n,s=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}const bs={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function ws(e){return"string"==typeof e?bs[e.toUpperCase()]||bs.WHITE:e}function xs(e,t){if(!e)throw new Error(t||"Assertion failed")}const Es={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},_s=Es.window||Es.self||Es.global,Ss=Es.process||{};function Cs(){let e;if(gs&&_s.performance)e=_s.performance.now();else if(Ss.hrtime){const t=Ss.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}console;const Ts={debug:gs&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Os={enabled:!0,level:0};function Ps(){}const As={},ks={once:!0};function Ms(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}class Ns{constructor({id:e}={id:""}){this.id=e,this.VERSION=ms,this._startTs=Cs(),this._deltaTs=Cs(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new ys("__probe-".concat(this.id,"__"),Os),this.userData={},this.timeStamp("".concat(this.id," started")),function(e,t=["constructor"]){const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n);for(const n of r)"function"==typeof e[n]&&(t.find((e=>n===e))||(e[n]=e[n].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Cs()-this._startTs).toPrecision(10))}getDelta(){return Number((Cs()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}assert(e,t){xs(e,t)}warn(e){return this._getLogFunction(0,e,Ts.warn,arguments,ks)}error(e){return this._getLogFunction(0,e,Ts.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,Ts.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,Ts.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,Ts.debug||Ts.info,arguments,ks)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Ps,n&&[n],{tag:Ms(t)}):Ps}image({logLevel:e,priority:t,image:r,message:i="",scale:o=1}){return this._shouldLog(e||t)?gs?function({image:e,message:t="",scale:n=1}){if("string"==typeof e){const r=new Image;return r.onload=()=>{const e=vs(r,t,n);console.log(...e)},r.src=e,Ps}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...vs(e,t,n)),Ps;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...vs(r,t,n)),r.src=e.toDataURL(),Ps}return Ps}({image:r,message:i,scale:o}):function({image:e,message:t="",scale:r=1}){let i=null;try{i=n(1835)}catch(e){}return i?()=>i(e,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then((e=>console.log(e))):Ps}({image:r,message:i,scale:o}):Ps}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(e){return this._storage.config[e]}set(e,t){this._storage.updateConfiguration({[e]:t})}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Ps)}group(e,t,n={collapsed:!1}){n=Rs({logLevel:e,message:t,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ps)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Ls(e)}_getLogFunction(e,t,n,r=[],i){if(this._shouldLog(e)){i=Rs({logLevel:e,message:t,args:r,opts:i}),xs(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Cs();const o=i.tag||i.message;if(i.once){if(As[o])return Ps;As[o]=Cs()}return t=function(e,t,n){if("string"==typeof t){const r=n.time?function(e,t=8){const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";t=function(e,t,n){return gs||"string"!=typeof e||(t&&(t=ws(t),e="[".concat(t,"m").concat(e,"[39m")),n&&(t=ws(n),e="[".concat(n+10,"m").concat(e,"[49m"))),e}(t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),n.color,n.background)}return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return Ps}}function Ls(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return xs(Number.isFinite(t)&&t>=0),t}function Rs(e){const{logLevel:t,message:n}=e;e.logLevel=Ls(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(e.args=r,typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const i=typeof e.message;return xs("string"===i||"object"===i),Object.assign(e,e.opts)}Ns.VERSION=ms;var Is=new Ns({id:"deck"});const Ds={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ds,"IDENTITY",{get:()=>Is.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const js={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Fs={common:0,meters:1,pixels:2},zs={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Bs=new Ns({id:"luma.gl"});function Us(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function Vs(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version))}function Hs(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function qs(e){return Us(Vs(e),"Invalid WebGLRenderingContext"),e}function Ws(e){return Us(Hs(e),"Requires WebGL2"),e}var Gs=n(5231);const $s={};const Ys=function e(t){const n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let t=0;t<this.attribs.length;t++){const r=new e.VertexAttrib(n);this.attribs[t]=r}this.maxAttrib=0};(Ys.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Xs=function(e){const t=this;this.gl=e,function(e){const t=e.getError;e.getError=function(){let n;do{n=t.apply(e),0!==n&&($s[n]=!0)}while(0!==n);for(n in $s)if($s[n])return delete $s[n],parseInt(n,10);return 0}}(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);const i=r.attribs[e];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);const i=r.attribs[e];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,r){switch(e){case 34962:t.currentArrayBuffer=r;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,r){const i=t.currentVertexArrayObject,o=i.attribs[e];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,r,i,o,s,a){const l=t.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,e);const c=l.attribs[e];return c.buffer=t.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",(()=>{Gs.CO.console&&Gs.CO.console.log&&Gs.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()}),!0),this.reset_()};Xs.prototype.VERTEX_ARRAY_BINDING_OES=34229,Xs.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new Ys(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Xs.prototype.createVertexArrayOES=function(){const e=new Ys(this);return this.vertexArrayObjects.push(e),e},Xs.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Xs.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Ys&&e.hasBeenBound&&e.ext===this)},Xs.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",$s[1282]=!0,void(void 0!==n&&(r=n,Gs.CO.console&&Gs.CO.console.error&&Gs.CO.console.error(r)));var n,r;const i=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||i.bindBuffer.call(t,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const l=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let e=0;e<=l;e++){const n=s.attribs[e],r=o?o.attribs[e]:null;if(o&&n.enabled===r.enabled||(n.enabled?i.enableVertexAttribArray.call(t,e):i.disableVertexAttribArray.call(t,e)),n.enabled){let s=!1;o&&n.buffer===r.buffer||(a!==n.buffer&&(i.bindBuffer.call(t,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==r.cached)&&i.vertexAttribPointer.call(t,e,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const Ks="OES_element_index",Zs="WEBGL_draw_buffers",Js="WEBGL_debug_renderer_info",Qs=e=>Hs(e)?void 0:0,ea={3074:e=>Hs(e)?void 0:36064,35723:e=>Hs(e)?void 0:4352,35977:Qs,32937:Qs,36795:(e,t)=>{const n=Hs(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const n=e.getExtension(Js);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(e,t)=>{const n=e.getExtension(Js);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Qs,35071:Qs,37447:Qs,36063:(e,t)=>{if(!Hs(e)){const n=e.getExtension(Zs);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Qs,35374:Qs,35377:Qs,34852:e=>{if(!Hs(e)){const t=e.getExtension(Zs);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:e=>e.getExtension(Ks)?2147483647:65535,33001:e=>e.getExtension(Ks)?16777216:65535,33e3:e=>16777216,37157:Qs,35373:Qs,35657:Qs,36183:Qs,37137:Qs,34045:Qs,35978:Qs,35979:Qs,35968:Qs,35376:Qs,35375:Qs,35659:Qs,37154:Qs,35371:Qs,35658:Qs,35076:Qs,35077:Qs,35380:Qs},ta="ANGLE_instanced_arrays",na={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Us(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[ta]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){Us(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Us(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Us(!1)},deleteQuery:()=>{Us(!1)},beginQuery:()=>{Us(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},ra={readBuffer:(e,t,n)=>{Hs(e)&&t(n)},getVertexAttrib:(e,t,n,r)=>{const{webgl2:i,ext:o}=function(e,t){return{webgl2:Hs(e),ext:e.getExtension("ANGLE_instanced_arrays")}}(e);let s;switch(r){case 35069:s=!!i&&void 0;break;case 35070:s=i||o?void 0:0}return void 0!==s?s:t(n,r)},getProgramParameter:(e,t,n,r)=>{if(!Hs(e))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return t(n,r)},getInternalformatParameter:(e,t,n,r,i)=>Hs(e)||32937!==i?e.getInternalformatParameter(n,r,i):new Int32Array([0]),getTexParameter(e,t,n,r){if(34046===r){const{extensions:t}=e.luma,n=t.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(n,r)},getParameter:function(e,t,n){const r=ea[n],i="function"==typeof r?r(e,t,n):r;return void 0!==i?i:t(n)},hint:(e,t,n,r)=>t(n,r)};function ia(e,{extension:t,target:n,target2:r}){const i=na[t];Us(i);const{meta:o={}}=i,{suffix:s=""}=o,a=e.getExtension(t);for(const t of Object.keys(i)){const o=`${t}${s}`;let l=null;"meta"===t||"function"==typeof e[t]||(a&&"function"==typeof a[o]?l=(...e)=>a[o](...e):"function"==typeof i[t]&&(l=i[t].bind(n))),l&&(n[t]=l,r[t]=l)}}(void 0!==n.g?n.g:window).polyfillContext=function(e){e.luma=e.luma||{};const{luma:t}=e;return t.polyfilled||(function(e){if("function"==typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const n=e.getExtension;e.getExtension=function(t){return n.call(this,t)||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Xs(this)),this.__OESVertexArrayObject))}}(e),function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}(e),function(e,t){for(const n of Object.getOwnPropertyNames(t))"overrides"!==n&&ia(e,{extension:n,target:e.luma,target2:e})}(e,na),function(e,{target:t,target2:n}){Object.keys(ra).forEach((r=>{if("function"==typeof ra[r]){const i=e[r]?e[r].bind(e):()=>{},o=ra[r].bind(null,e,i);t[r]=o,n[r]=o}}))}(e,{target:t,target2:e}),t.polyfilled=!0),e};const oa={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},sa=(e,t,n)=>t?e.enable(n):e.disable(n),aa=(e,t,n)=>e.hint(n,t),la=(e,t,n)=>e.pixelStorei(n,t);function ca(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const ua={3042:sa,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:sa,2885:(e,t)=>e.cullFace(t),2929:sa,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:sa,35723:aa,36006:(e,t)=>{const n=Hs(e)?36009:36160;return e.bindFramebuffer(n,t)},2886:(e,t)=>e.frontFace(t),33170:aa,2849:(e,t)=>e.lineWidth(t),32823:sa,32824:"polygonOffset",10752:"polygonOffset",35977:sa,32938:"sampleCoverage",32939:"sampleCoverage",3089:sa,3088:(e,t)=>e.scissor(...t),2960:sa,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),3333:la,3317:la,37440:la,37441:la,37443:la,3330:la,3332:la,3331:la,36010:(e,t)=>e.bindFramebuffer(36008,t),3314:la,32878:la,3316:la,3315:la,32877:la,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=ca(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=ca(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=ca(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=ca(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,o,s,a)},stencilOp:(e,t)=>{t=ca(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,o,s,a)},viewport:(e,t)=>e.viewport(...t)};function ha(e,t,n){return void 0!==t[e]?t[e]:n[e]}const da={blendEquation:(e,t,n)=>e.blendEquationSeparate(ha(32777,t,n),ha(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(ha(32969,t,n),ha(32968,t,n),ha(32971,t,n),ha(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(ha(32824,t,n),ha(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(ha(32938,t,n),ha(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,ha(2962,t,n),ha(2967,t,n),ha(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,ha(34816,t,n),ha(36003,t,n),ha(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,ha(2964,t,n),ha(2965,t,n),ha(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,ha(34817,t,n),ha(34818,t,n),ha(34819,t,n))},fa={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},pa=(e,t)=>e.isEnabled(t),ma={3042:pa,2884:pa,2929:pa,3024:pa,32823:pa,32926:pa,32928:pa,3089:pa,2960:pa,35977:pa};function ga(e){for(const t in e)return!1;return!0}function ya(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}function va(e,t){const n=e[t].bind(e);e[t]=function(...t){const r=t[0];return r in e.state.cache&&e.state.enable?e.state.cache[r]:n(...t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function ba(e,t,n){const r=e[t].bind(e);e[t]=function(...t){const{valueChanged:i,oldValue:o}=n(e.state._updateCache,...t);return i&&r(...t),o},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}class wa{constructor(e,{copyState:t=!1,log:n=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(e,t){if("number"==typeof(t=t||oa)){const n=t,r=ma[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const t of n){const n=ma[t];r[t]=n?n(e,Number(t)):e.getParameter(Number(t))}return r}(e):Object.assign({},oa),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Us(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];_a(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in e){Us(void 0!==i);const o=e[i],s=this.cache[i];ya(o,s)||(n=!0,t=s,r&&!(i in r)&&(r[i]=s),this.cache[i]=o)}return{valueChanged:n,oldValue:t}}}function xa(e,t={}){const{enable:r=!0,copyState:i}=t;if(Us(void 0!==i),!e.state){const t=void 0!==n.g?n.g:window,{polyfillContext:r}=t;r&&r(e),e.state=new wa(e,{copyState:i}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}(e);for(const t in fa)ba(e,t,fa[t]);va(e,"getParameter"),va(e,"isEnabled")}return e.state.enable=r,e}function Ea(e){Us(e.state),e.state.pop()}function _a(e,t){if(Us(Vs(e),"setParameters requires a WebGL context"),ga(t))return;const n={};for(const r in t){const i=Number(r),o=ua[r];o&&("string"==typeof o?n[o]=!0:o(e,t[r],i))}const r=e.state&&e.state.cache;if(r)for(const i in n)(0,da[i])(e,t,r)}function Sa(e,t,n){if(ga(t))return n(e);const{nocatch:r=!0}=t;let i;if(function(e){e.state||xa(e,{copyState:!1}),e.state.push()}(e),_a(e,t),r)i=n(e),Ea(e);else try{i=n(e)}finally{Ea(e)}return i}function Ca(e){const{luma:t}=e;if(e.canvas&&t){const{clientWidth:n}=t.canvasSizeInfo;return n?e.drawingBufferWidth/n:1}return 1}function Ta(e,t,n=!0){return function(e,t,n,r,i){const o=Oa(e[0],t,n);let s=Pa(e[1],t,r,i),a=Oa(e[0]+1,t,n);const l=a===n-1?a:a-1;let c;return a=Pa(e[1]+1,t,r,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===r-1?a:a-1,{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(c-s+1,1)}}(t,Ca(e),e.drawingBufferWidth,e.drawingBufferHeight,n)}function Oa(e,t,n){return Math.min(Math.round(e*t),n-1)}function Pa(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const Aa=(0,Gs.jU)(),ka=Aa&&"undefined"!=typeof document,Ma={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Na(e={}){Us(Aa,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},Ma,e);const{width:t,height:n}=e;function r(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let i;e.onError=r;const{canvas:o}=e,s=function({canvas:e,width:t=800,height:n=600,onError:r}){let i;return"string"==typeof e?(ka&&"complete"===document.readyState||r(`createGLContext called on canvas '${e}' before page was loaded`),i=document.getElementById(e)):e?i=e:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(t)?`${t}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",document.body.insertBefore(i,document.body.firstChild)),i}({canvas:o,width:t,height:n,onError:r});return i=function(e,t){const{onError:n}=t;let r=null;const i=e=>r=e.statusMessage||r;e.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=t;let a=null;return s&&(a=a||e.getContext("webgl2",t),a=a||e.getContext("experimental-webgl2",t)),o&&(a=a||e.getContext("webgl",t),a=a||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",i,!1),a?(t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1),a):n(`Failed to create ${s&&!o?"WebGL2":"WebGL"} context: ${r||"Unknown error"}`)}(s,e),i?(i=La(i,e),function(e){const t=Hs(e)?"WebGL2":"WebGL1",n=function(e){const t=e.getParameter(7936),n=e.getParameter(7937),r=e.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&e.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||t,renderer:r&&e.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e),r=n?`(${n.vendor},${n.renderer})`:"",i=e.debug?" debug":"";Bs.info(1,`${t}${i} context ${r}`)()}(i),i):null}function La(e,t={}){if(!e||e._instrumented)return e;e._version=e._version||function(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?2:1}(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},t=Object.assign({},Ma,t);const{manageState:n,debug:r}=t;return n&&xa(e,{copyState:!1,log:(...e)=>Bs.log(1,...e)()}),Aa&&r&&(Gs.CO.makeDebugContext?(e=Gs.CO.makeDebugContext(e,t),Bs.level=Math.max(Bs.level,1)):Bs.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function Ra(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class Ia{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Ra(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Ra()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Da{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(e=[]){e.forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:n}=e;return this.stats[t]||(this.stats[t]=e instanceof Ia?e:new Ia(t,n)),this.stats[t]}}const ja="8.5.10",Fa=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Da({id:e})),this.stats.get(e)}};if(Gs.CO.luma&&Gs.CO.luma.VERSION!==ja)throw new Error(`luma.gl - multiple VERSIONs detected: ${Gs.CO.luma.VERSION} vs 8.5.10`);function za(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function Ba(e,t){if("string"!=typeof t)return t;const n=Number(t);if(!isNaN(n))return n;const r=e[t=t.replace(/^.*\./,"")];return za(void 0!==r,`Accessing undefined constant GL.${t}`),r}function Ua(e,t){t=Number(t);for(const n in e)if(e[n]===t)return`GL.${n}`;return String(t)}Gs.CO.luma||((0,Gs.jU)()&&Bs.log(1,"luma.gl 8.5.10 - set luma.log.level=1 (or higher) to trace rendering")(),Gs.CO.luma=Gs.CO.luma||{VERSION:ja,version:ja,log:Bs,stats:Fa,globals:{modules:{},nodeIO:{}}}),Gs.CO.luma;const Va={};function Ha(e="id"){return Va[e]=Va[e]||1,`${e}-${Va[e]++}`}function qa(e){return za("number"==typeof e,"Input must be a number"),e&&0==(e&e-1)}function Wa(e){let t=!0;for(const n in e){t=!1;break}return t}function Ga(e,t,n,r){const i=`See luma.gl ${n} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,o=Object.getPrototypeOf(e);r.forEach((e=>{o.methodName||(o[e]=()=>{throw Bs.removed(`Calling removed method ${t}.${e}: `,i)(),new Error(e)})}))}const $a="Resource subclass must define virtual methods";class Ya{constructor(e,t={}){qs(e);const{id:n,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=n||Ha(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach((e=>e.delete())),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){za(e=Ba(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Hs(this.gl);if("webgl2"in n&&!e||"extension"in n&&!this.gl.getExtension(n.extension)){const t=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return e?r:t}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:n}=e,r=this.constructor.PARAMETERS||{},i=Hs(this.gl),o={},s=t||Object.keys(r);for(const t of s){const s=r[t];if(s&&(!("webgl2"in s)||i)&&(!("extension"in s)||this.gl.getExtension(s.extension))){const r=n?Ua(this.gl,t):t;o[r]=this.getParameter(t,e),n&&"GLenum"===s.type&&(o[r]=Ua(this.gl,o[r]))}}return o}setParameter(e,t){za(e=Ba(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Hs(this.gl);if("webgl2"in n&&!e||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(t=Ba(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return Ga(this,e,t,n)}initialize(e){}_createHandle(){throw new Error($a)}_deleteHandle(){throw new Error($a)}_bindHandle(e){throw new Error($a)}_getOptsFromHandle(){throw new Error($a)}_getParameter(e,t){throw new Error($a)}_setParameter(e,t){throw new Error($a)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=Fa.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;Fa.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const n=Fa.get("Memory Usage");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=Fa.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function Xa(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Ka(e,{clamped:t=!0}={}){switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Za({data:e,width:t,height:n}){const r=Math.round(t/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let n=0;n<i;n++)for(let i=0;i<r;i++)for(let s=0;s<4;s++)o[4*(n*r+i)+s]=e[4*(2*n*t+2*i)+s];return{data:o,width:r,height:i}}function Ja(e,t,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const n in r)if(n in t){const t=r[n]?`${e}.${r[n]}`:"N/A";Bs.removed(`${e}.${n}`,t)()}for(const n in i)if(n in t){const t=i[n];Bs.deprecated(`${e}.${n}`,`${e}.${t}`)()}let s=null;for(const n in o)if(n in t){const r=o[n];Bs.deprecated(`${e}.${n}`,`${e}.${r}`)(),s=s||Object.assign({},t),s[r]=t[n],delete s[n]}return s||t}const Qa={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},el={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class tl{static getBytesPerElement(e){return Ka(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return za(e.size),Ka(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new tl(...[Qa,...e])}constructor(...e){e.forEach((e=>this._assign(e))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return tl.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return tl.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=Ja("Accessor",e,el)).type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"==typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const nl={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},rl={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:nl},il={removedProps:nl};class ol extends Ya{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/tl.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/tl.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Ja("Buffer",e,rl),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=Ja("Buffer",e,il))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new tl(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:r=0}=e,i=e.byteLength||e.length;za(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?(Ws(this.gl),this.gl.bufferSubData(this.target,n,t,r,i)):this.gl.bufferSubData(o,n,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:n=0,size:r}){const{gl:i}=this;return Ws(i),i.bindBuffer(36662,e.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,t,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:r=0}={}){Ws(this.gl);const i=Ka(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),s=n;let a,l;e?(l=e.length,a=l-s):(a=Math.min(o,r||o),l=s+a);const c=Math.min(o,a);return za((r=r||c)<=c),e=e||new i(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,n,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,n,r):(za(0===n),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,n=e.byteLength+t){za(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const i=Xa(e);return za(i),this.setAccessor(new tl(this.accessor,{type:i})),this}_setByteLength(e,t=this.usage){za(e>=0),this._trackDeallocatedMemory();let n=e;0===e&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=e/Ka(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new tl(this.accessor,{type:Xa(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return Bs.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Bs.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Bs.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Bs.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new tl(this.accessor,e),this}}const sl={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},al={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},ll={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},cl=[9729,9728],ul=Gs.CO.WebGLBuffer||function(){};class hl extends Ya{static isSupported(e,t={}){const{format:n,linearFiltering:r}=t;let i=!0;return n&&(i=i&&function(e,t){const n=sl[t];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=Hs(e)&&n.gl2||n.gl1;return"string"==typeof r?e.getExtension(r):r}(e,n),i=i&&(!r||function(e,t){const n=sl[t];switch(n&&n.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,n))),i}constructor(e,t){const{id:n=Ha("texture"),handle:r,target:i}=t;super(e,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then((t=>this.initialize(Object.assign({},e,{pixels:t,data:t})))),this;const n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",(()=>this.initialize(e))),this;const{pixels:r=null,format:i=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:l={},textureUnit:c}=e;t||(t=r);let{width:u,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:m=!0}=e;const{depth:g=0}=e;return({width:u,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:i,type:f,dataFormat:d,compressed:p,data:t,width:u,height:h})),this.width=u,this.height=h,this.depth=g,this.format=i,this.type=f,this.dataFormat=d,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(Bs.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),m=!1,this._updateForNPOT(a)),this.mipmaps=m,this.setImageData({data:t,width:u,height:h,depth:g,format:i,type:f,dataFormat:d,border:o,mipmaps:m,parameters:l,compressed:p}),m&&this.generateMipmap(),this.setParameters(a),s&&(this.data=t),n&&(this._video={video:t,parameters:a,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:n=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(e={}){return this._isNPOT()?(Bs.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Sa(this.gl,e,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:r=0,format:i=this.format,border:o=this.border,offset:s=0,parameters:a={}}=e;let{data:l=null,type:c=this.type,width:u=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=e;l||(l=n),({type:c,dataFormat:d,compressed:f,width:u,height:h}=this._deduceParameters({format:i,type:c,dataFormat:d,compressed:f,data:l,width:u,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let m,g=null;if(({data:l,dataType:g}=this._getDataType({data:l,compressed:f})),Sa(this.gl,a,(()=>{switch(g){case"null":p.texImage2D(t,r,i,u,h,o,d,c,l);break;case"typed-array":p.texImage2D(t,r,i,u,h,o,d,c,l,s);break;case"buffer":m=Ws(p),m.bindBuffer(35052,l.handle||l),m.texImage2D(t,r,i,u,h,o,d,c,s),m.bindBuffer(35052,null);break;case"browser-object":Hs(p)?p.texImage2D(t,r,i,u,h,o,d,c,l):p.texImage2D(t,r,i,d,c,l);break;case"compressed":for(const[e,n]of l.entries())p.compressedTexImage2D(t,e,n.format,n.width,n.height,o,n.data);break;default:za(!1,"Unknown image data type")}})),l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const e=al[this.dataFormat]||4,t=ll[this.type]||1;this._trackAllocatedMemory(this.width*this.height*e*t,"Texture")}return this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:n=null,x:r=0,y:i=0,width:o=this.width,height:s=this.height,level:a=0,format:l=this.format,type:c=this.type,dataFormat:u=this.dataFormat,compressed:h=!1,offset:d=0,border:f=this.border,parameters:p={}}){if(({type:c,dataFormat:u,compressed:h,width:o,height:s}=this._deduceParameters({format:l,type:c,dataFormat:u,compressed:h,data:n,width:o,height:s})),za(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=t),n&&n.data){const e=n;n=e.data,o=e.shape[0],s=e.shape[1]}n instanceof ol&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),Sa(this.gl,p,(()=>{if(h)this.gl.compressedTexSubImage2D(e,a,r,i,o,s,l,n);else if(null===n)this.gl.texSubImage2D(e,a,r,i,o,s,u,c,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(e,a,r,i,o,s,u,c,n,d);else if(n instanceof ul){const t=Ws(this.gl);t.bindBuffer(35052,n),t.texSubImage2D(e,a,r,i,o,s,u,c,d),t.bindBuffer(35052,null)}else Hs(this.gl)?Ws(this.gl).texSubImage2D(e,a,r,i,o,s,u,c,n):this.gl.texSubImage2D(e,a,r,i,u,c,n)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return Bs.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ol?{data:e.handle,dataType:"buffer"}:e instanceof ul?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:r,height:i,dataFormat:o,type:s,compressed:a}=e;const l=sl[t];return o=o||l&&l.dataFormat,s=s||l&&l.types[0],a=a||l&&l.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:a,width:r,height:i,format:t,data:n}}_deduceImageSize(e,t,n){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},za(r,"Could not deduced texture size"),za(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),za(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:za(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(Hs(this.gl)||!this.width||!this.height||qa(this.width)&&qa(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===cl.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function dl(e,t){return za("string"==typeof e),e=""+e,new Promise(((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error(`Could not load image ${e}.`)),i.crossOrigin=t&&t.crossOrigin||"anonymous",i.src=e}catch(e){r(e)}}))}class fl extends hl{static isSupported(e,t){return hl.isSupported(e,t)}constructor(e,t={}){qs(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:dl(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const pl="EXT_color_buffer_float";var ml={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:pl,bpp:2},33327:{gl2:pl,bpp:4},34842:{gl2:pl,bpp:8},33326:{gl2:pl,bpp:4},33328:{gl2:pl,bpp:8},34836:{gl2:pl,bpp:16},35898:{gl2:pl,bpp:4}};class gl extends Ya{static isSupported(e,{format:t}={format:null}){return!t||function(e,t,n){const r=n[t];if(!r)return!1;const i=Hs(e)&&r.gl2||r.gl1;return"string"==typeof i?e.getExtension(i):i}(e,t,ml)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:n=1,samples:r=0}){return za(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Hs(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,n):this.gl.renderbufferStorage(36161,e,t,n),this.format=e,this.width=t,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*ml[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const yl="clear: bad arguments";function vl(e,{framebuffer:t=null,color:n=null,depth:r=null,stencil:i=null}={}){const o={};t&&(o.framebuffer=t);let s=0;n&&(s|=16384,!0!==n&&(o.clearColor=n)),r&&(s|=256,!0!==r&&(o.clearDepth=r)),i&&(s|=1024,!0!==r&&(o.clearStencil=r)),za(0!==s,yl),Sa(e,o,(()=>{e.clear(s)}))}const bl=[34069,34070,34071,34072,34073,34074];class wl extends hl{constructor(e,t={}){qs(e),super(e,Object.assign({},t,{target:34067})),this.initialize(t),Object.seal(this)}initialize(e={}){const{mipmaps:t=!0,parameters:n={}}=e;return this.opts=e,this.setCubeMapImageData(e).then((()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(n)})),this}subImage({face:e,data:t,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:e,data:t,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:e,height:t,pixels:n,data:r,border:i=0,format:o=6408,type:s=5121}){const{gl:a}=this,l=n||r,c=await Promise.all(bl.map((e=>{const t=l[e];return Promise.all(Array.isArray(t)?t:[t])})));this.bind(),bl.forEach(((n,r)=>{c[r].length>1&&!1!==this.opts.mipmaps&&Bs.warn(`${this.id} has mipmap and multiple LODs.`)(),c[r].forEach(((r,l)=>{e&&t?a.texImage2D(n,l,o,e,t,i,o,s,r):a.texImage2D(n,l,o,o,s,r)}))})),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:l=5121}=e,{gl:c}=this,u=i||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n})))):this.width||this.height?c.texImage2D(t,0,a,n,r,s,a,l,u):c.texImage2D(t,0,a,a,l,u),this}}wl.FACES=bl;class xl extends hl{static isSupported(e){return Hs(e)}constructor(e,t={}){Ws(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:n,height:r,depth:i=1,border:o=0,format:s,type:a=5121,offset:l=0,data:c,parameters:u={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Sa(this.gl,u,(()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,c),c instanceof ol&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,l))})),c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const e=al[this.dataFormat]||4,t=ll[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*e*t,"Texture")}return this.loaded=!0,this}}function El(e,t){za(e instanceof fl||e instanceof wl||e instanceof xl);const n=e.constructor,{gl:r,width:i,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u}=e;return new n(r,Object.assign({width:i,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u},t))}function _l(e,t){const{gl:n,width:r,height:i,id:o}=e;return new Pl(n,Object.assign({},t,{id:`framebuffer-for-${o}`,width:r,height:i,attachments:{36064:e}}))}function Sl(e,t={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=t;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:l,sourceType:c}=t;const{framebuffer:u,deleteFramebuffer:h}=Tl(e);za(u);const{gl:d,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===o&&null===f&&(o=1028),za(p[o]),c=c||p[o].type,s=function(e,t,n,r,i){if(e)return e;const o=Ka(t=t||5121,{clamped:!1}),s=function(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return za(!1),0}}(n);return new o(r*i*s)}(s,c,i,a,l),c=c||Xa(s);const m=d.bindFramebuffer(36160,f);return d.readPixels(n,r,a,l,i,c,s),d.bindFramebuffer(36160,m||null),h&&u.delete(),s}function Cl(e,{sourceAttachment:t=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=Sl(e,{sourceAttachment:t}),{width:i,height:o}=e;for(;o>n;)({data:r,width:i,height:o}=Za({data:r,width:i,height:o}));!function({data:e,width:t,height:n,bytesPerPixel:r=4,temp:i}){const o=t*r;i=i||new Uint8Array(o);for(let t=0;t<n/2;++t){const r=t*o,s=(n-t-1)*o;i.set(e.subarray(r,r+o)),e.copyWithin(r,s,s+o),e.set(i,s)}}({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const a=s.getContext("2d"),l=a.createImageData(i,o);return l.data.set(r),a.putImageData(l,0,0),s.toDataURL()}function Tl(e){return e instanceof Pl?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:_l(e),deleteFramebuffer:!0}}const Ol="Multiple render targets not supported";class Pl extends Ya{static isSupported(e,t={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=t;let i=!0;return n&&(i=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Pl(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ws(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ws(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:l}){if(za(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,n)for(const r in n){const i=n[r];(Array.isArray(i)?i[0]:i).resize({width:e,height:t})}else n=this._createDefaultAttachments(r,i,o,e,t);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:l}),n&&s&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(e={}){let{width:t,height:n}=e;if(null===this.handle)return za(void 0===t&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),t!==this.width&&n!==this.height&&Bs.log(2,`Resizing framebuffer ${this.id} to ${t}x${n}`)();for(const e in this.attachments)this.attachments[e].resize({width:t,height:n});return this.width=t,this.height=n,this}attach(e,{clearAttachments:t=!1,resizeAttachments:n=!0}={}){const r={};t&&Object.keys(this.attachments).forEach((e=>{r[e]=null})),Object.assign(r,e);const i=this.gl.bindFramebuffer(36160,this.handle);for(const e in r){za(void 0!==e,"Misspelled framebuffer binding point?");const t=Number(e),i=r[t];let o=i;if(o)if(o instanceof gl)this._attachRenderbuffer({attachment:t,renderbuffer:o});else if(Array.isArray(i)){const[e,n=0,r=0]=i;o=e,this._attachTexture({attachment:t,texture:e,layer:n,level:r})}else this._attachTexture({attachment:t,texture:o,layer:0,level:0});else this._unattach(t);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter((e=>!this.attachments[e])).forEach((e=>{delete this.attachments[e]}))}checkStatus(){const{gl:e}=this,t=this.getStatus();if(36053!==t)throw new Error(function(e){return(Pl.STATUS||{})[e]||`Framebuffer error ${e}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),n=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),n}clear(e={}){const{color:t,depth:n,stencil:r,drawBuffers:i=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||n||r)&&vl(this.gl,{color:t,depth:n,stencil:r}),i.forEach(((e,t)=>{!function(e,{framebuffer:t=null,buffer:n=6144,drawBuffer:r=0,value:i=[0,0,0,0]}={}){Ws(e),Sa(e,{framebuffer:t},(()=>{switch(n){case 6144:switch(i.constructor){case Int32Array:e.clearBufferiv(n,r,i);break;case Uint32Array:e.clearBufferuiv(n,r,i);break;case Float32Array:default:e.clearBufferfv(n,r,i)}break;case 6145:e.clearBufferfv(6145,0,[i]);break;case 6146:e.clearBufferiv(6146,0,[i]);break;case 34041:const[t,o]=i;e.clearBufferfi(34041,0,t,o);break;default:za(!1,yl)}}))}(this.gl,{drawBuffer:t,value:e})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return Bs.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return Bs.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return Bs.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return Bs.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return Bs.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return Bs.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:n=0,width:r,height:i}){const o=Ws(this.gl),s=o.bindFramebuffer(36008,this.handle);return 0===t&&0===n&&void 0===r&&void 0===i?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,n,r,i),o.bindFramebuffer(36008,s),this}getAttachmentParameter(e,t,n){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Ua(this.gl,r)),r}getAttachmentParameters(e=36064,t,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n)r[t?Ua(this.gl,i):i]=this.getAttachmentParameter(e,i,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),n={};for(const r of t){const t=Number(r);n[e?Ua(this.gl,t):t]=this.getAttachmentParameters(t,e)}return n}show(){return"undefined"!=typeof window&&window.open(Cl(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>Bs.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const n=Cl(this,{targetMaxHeight:100});return Bs.image({logLevel:e,message:t,image:n},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,r,i){let o=null;return e&&(o=o||{},o[36064]=new fl(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&n?(o=o||{},o[33306]=new gl(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new gl(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:i}),this.ownResources.push(o[36096])):n&&za(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof gl?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:n}=this;n.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:n,level:r}){const{gl:i}=this;switch(i.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Ws(i).framebufferTextureLayer(36160,e,t.target,r,n);break;case 34067:const o=function(e){return e<34069?e+34069:e}(n);i.framebufferTexture2D(36160,e,o,t.handle,r);break;case 3553:i.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:za(!1,"Illegal texture type")}i.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=Hs(n=this.gl)?n:null;var n;t?t.readBuffer(e):za(36064===e||1029===e,Ol),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,n=Ws(t);if(n)n.drawBuffers(e);else{const n=t.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(e):za(1===e.length&&(36064===e[0]||1029===e[0]),Ol)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(const t in Ml)void 0===e.luma.caps[t]&&(e.luma.caps[t]=Ll(e,t));return e.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Pl.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Al="TIMER_QUERY",kl="ELEMENT_INDEX_UINT32";var Ml={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],[Al]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],[kl]:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(e){const t=new fl(e,{format:6408,type:5126,dataFormat:6408}),n=new Pl(e,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),r=n.getStatus();return t.delete(),n.delete(),36053===r},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function Nl(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>Ll(e,t)))}function Ll(e,t){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[t]&&(e.luma.caps[t]=function(e,t){const n=Ml[t];let r;za(n,t);const i=Hs(e)&&n[1]||n[0];if("function"==typeof i)r=i(e);else if(Array.isArray(i)){r=!0;for(const t of i)r=r&&Boolean(e.getExtension(t))}else"string"==typeof i?r=Boolean(e.getExtension(i)):"boolean"==typeof i?r=i:za(!1);return r}(e,t)),e.luma.caps[t]||Bs.log(2,`Feature: ${t} not supported`)(),e.luma.caps[t]}class Rl{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:n}=this.source,{size:r}=t;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const e=t.elementOffset||0;for(let t=0;t<r;++t)i[t]=n[e+t]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var Il=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=r||e&&e.constructor||Float32Array,c=t*n+i;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,c)}let u;a&&(u=a*n+i);const h=this._allocate(l,c,s,u);return e&&o?h.set(e):s||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,n,r){let i=Math.max(Math.ceil(t*this.props.overAlloc),1);i>r&&(i=r);const o=this._pool,s=e.BYTES_PER_ELEMENT*i,a=o.findIndex((e=>e.byteLength>=s));if(a>=0){const t=new e(o.splice(a,1)[0],0,i);return n&&t.fill(0),t}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,i=t.findIndex((e=>e.byteLength>=r));i<0?t.push(n):(i>0||t.length<this.props.poolSize)&&t.splice(i,0,n),t.length>this.props.poolSize&&t.shift()}};Math.PI,Math.PI;const Dl={};function jl(e,{precision:t=Dl.precision||4}={}){return e=function(e){return Math.round(e/Dl.EPSILON)*Dl.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function Fl(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zl(e,t,n){return function(e,t,n){if(Fl(e)){n=n||((r=e).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<e.length;++r)n[r]=t(e[r],r,n);return n}var r;return t(e)}(e,(e=>Math.max(t,Math.min(n,e))))}function Bl(e,t,n){return Fl(e)?e.map(((e,r)=>Bl(e,t[r],n))):n*t+(1-n)*e}function Ul(e,t,n){const r=Dl.EPSILON;n&&(Dl.EPSILON=n);try{if(e===t)return!0;if(Fl(e)&&Fl(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!Ul(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):!(!Number.isFinite(e)||!Number.isFinite(t))&&Math.abs(e-t)<=Dl.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{Dl.EPSILON=r}}function Vl(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}Dl.EPSILON=1e-12,Dl.debug=!1,Dl.precision=4,Dl.printTypes=!1,Dl.printDegrees=!1,Dl.printRowMajor=!0;class Hl extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Array)){get ELEMENTS(){return Vl(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}to(e){return e===this?this:Fl(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Dl)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+jl(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Ul(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){void 0===n&&(n=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const i=e[r];this[r]=i+n*(t[r]-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Dl.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function ql(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function Wl(e,t,n=""){if(Dl.debug&&!function(e,t){if(e.length!==t)return!1;for(let t=0;t<e.length;++t)if(!Number.isFinite(e[t]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}const Gl={};function $l(e,t){Gl[e]||(Gl[e]=!0,console.warn("".concat(e," has been removed in version ").concat(t,", see upgrade guide for more information")))}class Yl extends Hl{get ELEMENTS(){return Vl(!1),0}copy(e){return Vl(!1),this}get x(){return this[0]}set x(e){this[0]=ql(e)}get y(){return this[1]}set y(e){this[1]=ql(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return ql(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return ql(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Vl(e>=0&&e<this.ELEMENTS,"index is out of range"),ql(this[e])}setComponent(e,t){return Vl(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Xl=1e-6,Kl="undefined"!=typeof Float32Array?Float32Array:Array;function Zl(){var e=new Kl(3);return Kl!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Jl(e,t,n){var r=new Kl(3);return r[0]=e,r[1]=t,r[2]=n,r}function Ql(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ec(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],l=n[2];return e[0]=i*l-o*a,e[1]=o*s-r*l,e[2]=r*a-i*s,e}function tc(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}function nc(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function rc(e,t,n){const r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o||1;return e[0]=(n[0]*r+n[4]*i+n[8]*o)/s,e[1]=(n[1]*r+n[5]*i+n[9]*o)/s,e[2]=(n[2]*r+n[6]*i+n[10]*o)/s,e}Zl();const ic=[0,0,0],oc={};class sc extends Yl{static get ZERO(){return oc.ZERO=oc.ZERO||Object.freeze(new sc(0,0,0,0))}constructor(e=0,t=0,n=0){super(-0,-0,-0),1===arguments.length&&Fl(e)?this.copy(e):(Dl.debug&&(ql(e),ql(t),ql(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Dl.debug&&(ql(e.x),ql(e.y),ql(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ql(e)}angle(e){return n=e,r=(t=this)[0],i=t[1],o=t[2],s=n[0],a=n[1],l=n[2],c=Math.sqrt(r*r+i*i+o*o)*Math.sqrt(s*s+a*a+l*l),u=c&&Ql(t,n)/c,Math.acos(Math.min(Math.max(u,-1),1));var t,n,r,i,o,s,a,l,c,u}cross(e){return ec(this,this,e),this.check()}rotateX({radians:e,origin:t=ic}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=ic}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=ic}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return tc(this,this,e),this.check()}transformAsVector(e){return rc(this,this,e),this.check()}transformByMatrix3(e){return nc(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=t[0],l=t[1],c=t[2],u=i*c-o*l,h=o*a-r*c,d=r*l-i*a,f=i*d-o*h,p=o*u-r*d,m=r*h-i*u,g=2*s;u*=g,h*=g,d*=g,f*=2,p*=2,m*=2,e[0]=a+u+f,e[1]=l+h+p,e[2]=c+d+m}(this,this,e),this.check()}}const ac=new sc;function lc(e,t,n,r){ac.set(e,t,n);const i=ac.len();return{distance:r/i,normal:new sc(-e/i,-t/i,-n/i)}}let cc;function uc(e,{size:t=1,startIndex:n=0,endIndex:r}){Number.isFinite(r)||(r=e.length);const i=(r-n)/t;cc=Il.allocate(cc,i,{type:Float32Array,size:2*t});let o=n,s=0;for(;o<r;){for(let n=0;n<t;n++){const r=e[o++];cc[s+n]=r,cc[s+n+t]=(a=r)-Math.fround(a)}s+=2*t}var a;return cc.subarray(0,i*t*2)}function hc(e){return e.stride||e.size*e.bytesPerElement}function dc(e,t){t.offset&&Is.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=hc(e),r=("vertexOffset"in t?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}function fc(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}const pc=[],mc=[];function gc(e,t=0,n=1/0){let r=pc;const i={index:-1,data:e,target:[]};return e?"function"==typeof e[Symbol.iterator]?r=e:e.length>0&&(mc.length=e.length,r=mc):r=pc,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function yc(e){return e&&e[Symbol.asyncIterator]}function vc(e,{size:t,stride:n,offset:r,startIndices:i,nested:o}){const s=e.BYTES_PER_ELEMENT,a=n?n/s:t,l=r?r/s:0,c=Math.floor((e.length-l)/a);return(n,{index:r,target:s})=>{if(!i){const n=r*a+l;for(let r=0;r<t;r++)s[r]=e[n+r];return s}const u=i[r],h=i[r+1]||c;let d;if(o){d=new Array(h-u);for(let n=u;n<h;n++){const r=n*a+l;s=new Array(t);for(let n=0;n<t;n++)s[n]=e[r+n];d[n-u]=s}}else if(a===t)d=e.subarray(u*t+l,h*t+l);else{d=new e.constructor((h-u)*t);let n=0;for(let r=u;r<h;r++){const i=r*a+l;for(let r=0;r<t;r++)d[n++]=e[i+r]}}return d}}function bc(e,t=(()=>!0)){return Array.isArray(e)?wc(e,t,[]):t(e)?[e]:[]}function wc(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?wc(i,t,n):t(i)&&n.push(i)}return n}function xc({target:e,source:t,start:n=0,count:r=1}){const i=t.length,o=r*i;let s=0;for(let r=n;s<i;s++)e[r++]=t[s];for(;s<o;)s<o-s?(e.copyWithin(n+s,n,n+s),s*=2):(e.copyWithin(n+s,n,n+o-s),s=o);return e}const Ec=[],_c=[[0,1/0]];function Sc({source:e,target:t,start:n=0,end:r,size:i,getData:o}){r=r||t.length;const s=e.length,a=r-n;if(s>a)return void t.set(e.subarray(0,a),n);if(t.set(e,n),!o)return;let l=s;for(;l<a;){const r=o(l,e);for(let e=0;e<i;e++)t[n+l]=r[e]||0,l++}}const Cc={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function Tc(e,t){return e?(Number.isFinite(e)&&(e={duration:e}),e.type=e.type||"interpolation",{...Cc[e.type],...t,...e}):null}function Oc(e,t){return t.getBuffer()?[t.getBuffer(),{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function Pc(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function Ac(e){e.push(e.shift())}function kc(e,t){const{doublePrecision:n,settings:r,value:i,size:o}=e,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:t*o)*s}function Mc({buffer:e,numInstances:t,attribute:n,fromLength:r,fromStartIndices:i,getData:o=(e=>e)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,l=n.byteOffset,c=n.startIndices,u=i&&c,h=kc(n,t),d=n.state.constant;if(!u&&r>=h)return;const f=d?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!d){const e=o;o=(t,r)=>n._normalizeConstant(e(t,r))}const p=d?(e,t)=>o(f,t):(e,t)=>o(f.subarray(e,e+a),t),m=e.getData({length:r}),g=new Float32Array(h);!function({source:e,target:t,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return Sc({source:e,target:t,size:n,getData:r}),t;let s=0,a=0;const l=r&&((e,t)=>r(e+a,t)),c=Math.min(i.length,o.length);for(let r=1;r<c;r++){const c=i[r]*n,u=o[r]*n;Sc({source:e.subarray(s,c),target:t,start:a,end:u,size:n,getData:l}),s=c,a=u}a<t.length&&Sc({source:[],target:t,start:a,size:n,getData:l})}({source:m,target:g,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),e.byteLength<g.byteLength+l&&e.reallocate(g.byteLength+l),e.subData({data:g,offset:l})}class Nc extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const n=t.logicalType||t.type,r=5130===n;let{defaultValue:i}=t;i=Number.isFinite(i)?[i]:i||new Array(this.size).fill(0),t.defaultValue=i;let o=n;r?o=5126:!o&&t.isIndexed?o=e&&function(e,t){return Nl(e,"ELEMENT_INDEX_UINT32")}(e)?5125:5123:o||(o=5126),t.logicalType=n,t.type=o;let s=function(e){switch(e){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(s=Float32Array),t.bytesPerElement=s.BYTES_PER_ELEMENT,this.defaultType=s,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new ol(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*hc(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Il.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(e,t){const n=dc(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(this.getAccessor(),t||{});return n[e]=new Rl(this,i.high),n["".concat(e,"64Low")]=r?new Rl(this,i.low):new Float32Array(this.size),n}if(t){const n=dc(this.getAccessor(),t);return{[e]:new Rl(this,n)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof ol&&(e={buffer:e});const n={...this.settings,...e};if(t.bufferAccessor=n,e.constant){let n=e.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n)),t.constant&&this._areValuesEqual(n,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=n}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const i=e.value instanceof Float64Array;n.type=e.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=hc(n)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=hc(n);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=uc(r,n));const s=r.byteLength+o+2*n.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:r,offset:o}),n.type=e.type||i.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:n=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?uc(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),offset:n*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:n}=this,r=n.allocatedValue,i=Il.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),t&&r&&o.subData({data:r instanceof Float64Array?uc(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||Is.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map((e=>(e+128)/255*2-1));case 5122:return new Float32Array(e).map((e=>(e+32768)/65535*2-1));case 5121:return new Float32Array(e).map((e=>e/255));case 5123:return new Float32Array(e).map((e=>e/65535));default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e)return t[n]=r[0],t;switch(i){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=i;for(;--o>=0;)t[n+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=t;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:_c,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition;return Tc(Array.isArray(t)?e[t.find((t=>e[t]))]:e[t],n)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===_c)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let o=0;o<r;o++){const r=e[o];r[1]<t[0]?(n.push(r),i=o+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=_c}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Ec}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==_c}),!0)}updateBuffer({numInstances:e,data:t,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:t,startRow:s,endRow:a,props:n,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,n]of i){const r=Number.isFinite(t)?this.getVertexOffset(t):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices){fc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor));const i=e.size&&e.size!==this.size;return n.binaryAccessor=vc(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const n in e)Object.assign(t,super.getShaderAttributes(n,e[n]));return t}_autoUpdater(e,{data:t,startRow:n,endRow:r,props:i,numInstances:o}){if(e.constant)return;const{settings:s,state:a,value:l,size:c,startIndices:u}=e,{accessor:h,transform:d}=s,f=a.binaryAccessor||("function"==typeof h?h:i[h]);fc("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let p=e.getVertexOffset(n);const{iterable:m,objectInfo:g}=gc(t,n,r);for(const t of m){g.index++;let n=f(t,g);if(d&&(n=d.call(this,n)),u){const t=(g.index<u.length-1?u[g.index+1]:o)-u[g.index];if(n&&Array.isArray(n[0])){let t=p;for(const r of n)e._normalizeValue(r,l,t),t+=c}else n&&n.length>c?l.set(n,p):(e._normalizeValue(n,g.target,0),xc({target:l,source:g.target,start:p,count:t}));p+=t*c}else e._normalizeValue(n,l,p),p+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let Lc={};function Rc(e){Is.level>0&&Lc[e]&&Lc[e].call(...arguments)}function Ic(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const Dc="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",jc=`#version 300 es\n${Dc}`;function Fc(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;return t.includes(r)&&i&&o?{qualifier:r,type:i,name:o.split(";")[0]}:null}function zc(e={}){const{version:t=100,input:n,inputType:r,output:i}=e;if(!n)return 300===t?jc:t>300?`#version ${t}\n${Dc}`:"void main() {gl_FragColor = vec4(0);}";const o=function(e,t){switch(t){case"float":return`vec4(${e}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${e}, 0.0, 1.0)`;case"vec3":return`vec4(${e}, 1.0)`;case"vec4":return e;default:return Ic(!1),null}}(n,r);return t>=300?`#version ${t} ${300===t?"es":""}\nin ${r} ${n};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${o};\n}`:`varying ${r} ${n};\nvoid main() {\n  gl_FragColor = ${o};\n}`}class Bc extends Ya{static isSupported(e){return Hs(e)}constructor(e,t={}){Ws(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Wa(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])})),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteSize:i,byteOffset:o}=this._getBufferParams(t);return n<0?(this.unused[e]=r,Bs.warn((()=>`${this.id} unused varying buffer ${e}`))(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,r,o,i),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,r;return e instanceof ol==0?(r=e.buffer,n=e.byteSize,t=e.byteOffset):r=e,void 0===t&&void 0===n||(t=t||0,n=n||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,n=0,r){const i=t&&t.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class Uc{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=t;return{attributes:Object.assign({},n,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],n=e?t[e]:null;return n?n instanceof ol?n:n.buffer:null}getData(e={}){const{varyingName:t}=e,n=this.getBuffer(t);return n?n.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&za(Hs(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const e in this.feedbackMap){const r=this.feedbackMap[e];e in t&&(n[r]=e)}Object.assign(n,e.feedbackBuffers);for(const e in n){const r=n[e];if("string"==typeof r){const i=t[r],{byteLength:o,usage:s,accessor:a}=i;n[e]=this._createNewBuffer(e,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const n=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:n})}_setupTransformFeedback(e,{model:t}){const{program:n}=t;e.transformFeedback=new Bc(this.gl,{program:n,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:t}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:e,feedbackBuffers:t})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),n=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];t[r]=e.feedbackBuffers[i],n[i]=e.sourceBuffers[r],za(n[i]instanceof ol)}return{sourceBuffers:t,feedbackBuffers:n}}_createNewBuffer(e,t){const n=new ol(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function Vc(e){let t=100;const n=e.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}const Hc="vs",qc="fs",Wc={[Hc]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[qc]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Gc="__LUMA_INJECT_DECLARATIONS__",$c=/void\s+main\s*\([^)]*\)\s*\{\n?/,Yc=/}\n?[^{}]*$/,Xc=[];function Kc(e,t,n,r=!1){const i=t===Hc;for(const t in n){const r=n[t];r.sort(((e,t)=>e.order-t.order)),Xc.length=r.length;for(let e=0,t=r.length;e<t;++e)Xc[e]=r[e].injection;const o=`${Xc.join("\n")}\n`;switch(t){case"vs:#decl":i&&(e=e.replace(Gc,o));break;case"vs:#main-start":i&&(e=e.replace($c,(e=>e+o)));break;case"vs:#main-end":i&&(e=e.replace(Yc,(e=>o+e)));break;case"fs:#decl":i||(e=e.replace(Gc,o));break;case"fs:#main-start":i||(e=e.replace($c,(e=>e+o)));break;case"fs:#main-end":i||(e=e.replace(Yc,(e=>o+e)));break;default:e=e.replace(t,(e=>e+o))}}return e=e.replace(Gc,""),r&&(e=e.replace(/\}\s*$/,(e=>e+Wc[t]))),e}function Zc(e){const t={};return Ic(Array.isArray(e)&&e.length>1),e.forEach((e=>{for(const n in e)t[n]=t[n]?`${t[n]}\n${e[n]}`:e[n]})),t}const Jc={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};const Qc={10241:9728,10240:9728,10242:33071,10243:33071};class eu{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),s=Object.assign({},e.uniforms),a=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];s[e]=n[t]}this._setSourceTextureParameters();const e=function({sourceTextureMap:e,targetTextureVarying:t,targetTexture:n}){const r={};let i,o;t&&(({width:i,height:o}=n),r[`transform_uSize_${t}`]=[i,o]);for(const t in e)({width:i,height:o}=e[t]),r[`transform_uSize_${t}`]=[i,o];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,e)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],n=Sl(t);if(!e)return n;const r=n.constructor,i=function(e){switch(e){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ic(!1),null}}(this.targetTextureType),o=new r(n.length*i/4);let s=0;for(let e=0;e<n.length;e+=4)for(let t=0;t<i;t++)o[s++]=n[e+t];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:n}=e;this._swapTexture=n,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:n}=e;if(n instanceof fl)return n;const r=t[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:n={},_targetTexture:r}=e,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:n,targetTexture:i}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach(((e,t,n)=>{n[t]=t})),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new ol(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:e,targetTexture:t}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:e,targetTexture:t})}}_updateBinding(e,t){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,n),i){e.targetTexture=i;const{width:t,height:n}=i,{framebuffer:r}=e;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:t,height:n})):e.framebuffer=new Pl(this.gl,{id:"transform-framebuffer",width:t,height:n,attachments:{36064:i}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const e in t)t[e].setParameters(Qc)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=El(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:o,inject:s,samplerTextureMap:a}=function({vs:e,sourceTextureMap:t,targetTextureVarying:n,targetTexture:r}){let i=Object.keys(t).length,o=null;const s={};let a=e,l={};if(i>0||n){const e=a.split("\n"),c=e.slice();if(e.forEach(((e,r,a)=>{if(i>0){const n=function(e,t){const n={},r=function(e){return Fc(e,["attribute","in"])}(e);if(!r)return null;const{type:i,name:o}=r;if(o&&t[o]){const t=`// ${e} => Replaced by Transform with a sampler`,{samplerName:r,sizeName:s,uniformDeclerations:a}=function(e){const t=`transform_uSampler_${e}`,n=`transform_uSize_${e}`;return{samplerName:t,sizeName:n,uniformDeclerations:`  uniform sampler2D ${t};\n  uniform vec2 ${n};`}}(o),l=function(e){switch(e){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ic(!1),null}}(i),c=`  ${i} ${o} = transform_getInput(${r}, ${s}).${l};\n`;return n[r]=o,{updatedLine:t,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(e,t);if(n){const{updatedLine:e,inject:t}=n;c[r]=e,l=Zc([l,t]),Object.assign(s,n.samplerTextureMap),i--}}n&&!o&&(o=function(e,t){const n=Fc(e,["varying","out"]);return n&&n.name===t?n.type:null}(e,n))})),n){za(r);const e=`transform_uSize_${n}`;l=Zc([l,{"vs:#decl":`uniform vec2 ${e};\n`,"vs:#main-start":`     vec2 transform_position = transform_getPos(${e});\n     gl_Position = vec4(transform_position, 0, 1.);\n`}])}a=c.join("\n")}return{vs:a,targetTextureType:o,inject:l,samplerTextureMap:s}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=Zc([e.inject||{},s]);return this.targetTextureType=o,this.samplerTextureMap=a,{vs:r,fs:e._fs||zc({version:Vc(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Jc].concat(e.modules||[]):e.modules,uniforms:i,inject:l}}}const tu={number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},array:{validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function nu(e){let t=ru(e);return"object"===t?e?"type"in e?Object.assign({},e,tu[e.type]):"value"in e?(t=ru(e.value),Object.assign({type:t},e,tu[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},tu[t])}function ru(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}class iu{constructor({name:e,vs:t,fs:n,dependencies:r=[],uniforms:i,getUniforms:o,deprecations:s=[],defines:a={},inject:l={},vertexShader:c,fragmentShader:u}){Ic("string"==typeof e),this.name=e,this.vs=t||c,this.fs=n||u,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(s),this.defines=a,this.injections=function(e){const t={vs:{},fs:{}};for(const n in e){let r=e[n];const i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),t[i][n]=r}return t}(l),i&&(this.uniforms=function(e){const t={};for(const n in e){const r=nu(e[n]);t[n]=r}return t}(i))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Ic(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach((n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(e){return e.forEach((e=>{"function"===e.type?e.regex=new RegExp(`\\b${e.old}\\(`):e.regex=new RegExp(`${e.type} ${e.old};`)})),e}_defaultGetUniforms(e={}){const t={},n=this.uniforms;for(const r in n){const i=n[r];r in e&&!i.private?(i.validate&&Ic(i.validate(e[r],i),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=i.value}return t}}function ou(e){return function(e){const t={},n={};return su({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort(((e,t)=>n[t]-n[e])).map((e=>t[e]))}(au(e))}function su({modules:e,level:t,moduleMap:n,moduleDepth:r}){if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const i of e)n[i.name]=i,(void 0===r[i.name]||r[i.name]<t)&&(r[i.name]=t);for(const i of e)i.dependencies&&su({modules:i.dependencies,level:t+1,moduleMap:n,moduleDepth:r})}function au(e,t){return e.map((e=>(e instanceof iu||(Ic("string"!=typeof e,`Shader module use by name is deprecated. Import shader module '${e}' and use it directly.`),Ic(e.name,"shader module has no name"),(e=new iu(e)).dependencies=au(e.dependencies)),e)))}const lu={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},cu={};Object.keys(lu).forEach((e=>{cu[e]=e}));const uu={};function hu(e,t,n={}){const r=lu[t];if(Ic(r,t),!function(e={}){const t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(t in uu)return uu[t];const i=`#extension GL_${r[0]} : ${n.behavior||"enable"}\nvoid main(void) {}`,o=e.createShader(35633);e.shaderSource(o,i),e.compileShader(o);const s=e.getShaderParameter(o,35713);return e.deleteShader(o),uu[t]=s,s}function du(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>function(e,t){const n=lu[t];Ic(n,t);const r=function(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}(e)&&n[1]||n[0],i="string"==typeof r?Boolean(e.getExtension(r)):r;return Ic(!1===i||!0===i),i}(e,t)))}function fu(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const pu=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],mu=[...pu,[fu("attribute"),"in $1"],[fu("varying"),"out $1"]],gu=[...pu,[fu("varying"),"in $1"]],yu=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],vu=[...yu,[fu("in"),"attribute $1"],[fu("out"),"varying $1"]],bu=[...yu,[fu("in"),"varying $1"]],wu=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,xu=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Eu(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}const _u={[Hc]:"vertex",[qc]:"fragment"};function Su(e,{id:t,source:n,type:r,modules:i,defines:o={},hookFunctions:s=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){Ic("string"==typeof n,"shader source must be a string");const h=r===Hc,d=n.split("\n");let f=100,p="",m=n;0===d[0].indexOf("#version ")?(f=300,p=d[0],m=d.slice(1).join("\n")):p=`#version ${f}`;const g={};i.forEach((e=>{Object.assign(g,e.getDefines())})),Object.assign(g,o);let y=c?`${p}\n${function({id:e,source:t,type:n}){return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${e}_${_u[n]}\n\n`:""}({id:t,source:n,type:r})}\n${function({type:e}){return`\n#define SHADER_TYPE_${_u[e].toUpperCase()}\n`}({type:r})}\n${function(e){const t=function(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||7936),r=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||7937),i=function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r);return{gpuVendor:i,vendor:n,renderer:r,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e);switch(t.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e)}\n${function(e,t,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return du(e,cu.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),du(e,cu.GLSL_DERIVATIVES)&&hu(e,cu.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),du(e,cu.GLSL_FRAG_DATA)&&hu(e,cu.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),du(e,cu.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(e)}\n${function(e={}){let t=0,n="";for(const r in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const i=e[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${e[r]}\n`)}return 0===t&&(n+="\n"),n}(g)}\n${h?"":"precision highp float;\n\n"}\n`:`${p}\n`;const v=function(e){const t={vs:{},fs:{}};return e.forEach((e=>{let n;"string"!=typeof e?(n=e,e=n.hook):n={},e=e.trim();const[r,i]=e.split(":"),o=e.replace(/\(.+/,"");t[r][o]=Object.assign(n,{signature:i})})),t}(s),b={},w={},x={};for(const e in a){const t="string"==typeof a[e]?{injection:a[e],order:0}:a[e],n=e.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const r=n[2],i=n[3];r?"decl"===i?w[e]=[t]:x[e]=[t]:b[e]=[t]}else x[e]=[t]}for(const e of i){u&&e.checkDeprecations(m,u),y+=e.getModuleSource(r,f);const t=e.injections[r];for(const e in t){const n=e.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?w:x;r[e]=r[e]||[],r[e].push(t[e])}else b[e]=b[e]||[],b[e].push(t[e])}}return y+="\n\n__LUMA_INJECT_DECLARATIONS__\n\n",y=Kc(y,r,w),y+=function(e,t){let n="";for(const r in e){const i=e[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),t[r]){const e=t[r];e.sort(((e,t)=>e.order-t.order));for(const t of e)n+=`  ${t.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}(v[r],b),y+=m,y=Kc(y,r,x),y=function(e,t,n){switch(t){case 300:return n?Eu(e,mu):function(e){const t=(e=Eu(e,gu)).match(wu);if(t){const n=t[1];e=e.replace(new RegExp("\\bgl_FragColor\\b","g"),n)}else{const t="fragmentColor";e=e.replace(xu,(e=>`out vec4 ${t};\n${e}`)).replace(new RegExp("\\bgl_FragColor\\b","g"),t)}return e}(e);case 100:return n?Eu(e,vu):function(e){const t=(e=Eu(e,bu)).match(wu);if(t){const n=t[1];e=e.replace(wu,"").replace(new RegExp(`\\b${n}\\b`,"g"),"gl_FragColor")}return e}(e);default:throw new Error(`unknown GLSL version ${t}`)}}(y,l?100:f,h),y}function Cu(e){return function(t){const n={};for(const r of e){const e=r.getUniforms(t,n);Object.assign(n,e)}return n}}const Tu={5126:Bu.bind(null,"uniform1fv",Nu,1,Uu),35664:Bu.bind(null,"uniform2fv",Nu,2,Uu),35665:Bu.bind(null,"uniform3fv",Nu,3,Uu),35666:Bu.bind(null,"uniform4fv",Nu,4,Uu),5124:Bu.bind(null,"uniform1iv",Lu,1,Uu),35667:Bu.bind(null,"uniform2iv",Lu,2,Uu),35668:Bu.bind(null,"uniform3iv",Lu,3,Uu),35669:Bu.bind(null,"uniform4iv",Lu,4,Uu),35670:Bu.bind(null,"uniform1iv",Lu,1,Uu),35671:Bu.bind(null,"uniform2iv",Lu,2,Uu),35672:Bu.bind(null,"uniform3iv",Lu,3,Uu),35673:Bu.bind(null,"uniform4iv",Lu,4,Uu),35674:Bu.bind(null,"uniformMatrix2fv",Nu,4,Vu),35675:Bu.bind(null,"uniformMatrix3fv",Nu,9,Vu),35676:Bu.bind(null,"uniformMatrix4fv",Nu,16,Vu),35678:zu,35680:zu,5125:Bu.bind(null,"uniform1uiv",Ru,1,Uu),36294:Bu.bind(null,"uniform2uiv",Ru,2,Uu),36295:Bu.bind(null,"uniform3uiv",Ru,3,Uu),36296:Bu.bind(null,"uniform4uiv",Ru,4,Uu),35685:Bu.bind(null,"uniformMatrix2x3fv",Nu,6,Vu),35686:Bu.bind(null,"uniformMatrix2x4fv",Nu,8,Vu),35687:Bu.bind(null,"uniformMatrix3x2fv",Nu,6,Vu),35688:Bu.bind(null,"uniformMatrix3x4fv",Nu,12,Vu),35689:Bu.bind(null,"uniformMatrix4x2fv",Nu,8,Vu),35690:Bu.bind(null,"uniformMatrix4x3fv",Nu,12,Vu),35678:zu,35680:zu,35679:zu,35682:zu,36289:zu,36292:zu,36293:zu,36298:zu,36299:zu,36300:zu,36303:zu,36306:zu,36307:zu,36308:zu,36311:zu},Ou={},Pu={},Au={},ku=[0];function Mu(e,t,n,r){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&(ku[0]=e,e=ku);const i=e.length;if(i%t&&Bs.warn(`Uniform size should be multiples of ${t}`,e)(),e instanceof n)return e;let o=r[i];o||(o=new n(i),r[i]=o);for(let t=0;t<i;t++)o[t]=e[t];return o}function Nu(e,t){return Mu(e,t,Float32Array,Ou)}function Lu(e,t){return Mu(e,t,Int32Array,Pu)}function Ru(e,t){return Mu(e,t,Uint32Array,Au)}function Iu(e,t,n){const r=Tu[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r().bind(null,e,t)}function Du(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function ju(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let n=0;n<t;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e):!!isFinite(e)||!0===e||!1===e||e instanceof hl||e instanceof gl||e instanceof Pl&&Boolean(e.texture)}function Fu(e,t,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(e[t]){const r=e[t];for(let e=0,t=n.length;e<t;++e)r[e]=n[e]}else e[t]=n.slice();else e[t]=n}function zu(){let e=null;return(t,n,r)=>{const i=e!==r;return i&&(t.uniform1i(n,r),e=r),i}}function Bu(e,t,n,r){let i=null,o=null;return(s,a,l)=>{const c=t(l,n),u=c.length;let h=!1;if(null===i)i=new Float32Array(u),o=u,h=!0;else{za(o===u,"Uniform length cannot change.");for(let e=0;e<u;++e)if(c[e]!==i[e]){h=!0;break}}return h&&(r(s,e,a,c),i.set(c)),h}}function Uu(e,t,n,r){e[t](n,r)}function Vu(e,t,n,r){e[t](n,!1,r)}function Hu(e,t="unnamed"){const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}function qu(e,t){let n="";for(let r=0;r<t.length;r++){const i=t[r];if((e[r+3]||e[r+2]||e[r+1])&&(n+=`${i}\n`,e[r+1])){const t=e[r+1],i=t.split(":",3),o=i[0],s=parseInt(i[1],10)||0;n+=Wu(`^^^ ${o}: ${t.substring(i.join(":").length+1).trim()}\n\n`,s)}}return n}function Wu(e,t){let n="";for(let e=0;e<t;++e)n+=" ";return`${n}${e}`}class Gu extends Ya{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return za(!1),"unknown"}}constructor(e,t){qs(e),za("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Hu(t.source,null)||t.id||Ha(`unnamed ${Gu.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=Hu(e,null);t&&(this.id=Ha(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${Gu.getTypeName(this.shaderType)}:${this.id}`}getName(){return Hu(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:n,warnings:r}=function(e,t,n,r){const i=e.split(/\r?\n/),o={},s={},a=r||Hu(t)||"(unnamed)",l=`${function(e){switch(e){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)} shader ${a}`;for(let t=0;t<i.length;t++){const n=i[t];if(n.length<=1)continue;const r=n.split(":"),a=r[0],c=parseInt(r[2],10);if(isNaN(c))throw new Error(`GLSL compilation error in ${l}: ${e}`);"WARNING"!==a?o[c]=n:s[c]=n}const c=function(e,t=1,n=": "){const r=e.split(/\r?\n/),i=String(r.length+t-1).length;return r.map(((e,r)=>{const o=String(r+t),s=o.length;return Wu(o,i-s)+n+e}))}(t);return{shaderName:l,errors:qu(o,c),warnings:qu(s,c)}}(e,this.source,this.shaderType,this.id);throw Bs.error(`GLSL compilation errors in ${t}\n${n}`)(),Bs.warn(`GLSL compilation warnings in ${t}\n${r}`)(),new Error(`GLSL compilation errors in ${t}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class $u extends Gu{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Yu extends Gu{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Xu=5126,Ku=5124,Zu=5125,Ju={[Xu]:[Xu,1,"float"],35664:[Xu,2,"vec2"],35665:[Xu,3,"vec3"],35666:[Xu,4,"vec4"],[Ku]:[Ku,1,"int"],35667:[Ku,2,"ivec2"],35668:[Ku,3,"ivec3"],35669:[Ku,4,"ivec4"],[Zu]:[Zu,1,"uint"],36294:[Zu,2,"uvec2"],36295:[Zu,3,"uvec3"],36296:[Zu,4,"uvec4"],35670:[Xu,1,"bool"],35671:[Xu,2,"bvec2"],35672:[Xu,3,"bvec3"],35673:[Xu,4,"bvec4"],35674:[Xu,8,"mat2"],35685:[Xu,8,"mat2x3"],35686:[Xu,8,"mat2x4"],35675:[Xu,12,"mat3"],35687:[Xu,12,"mat3x2"],35688:[Xu,12,"mat3x4"],35676:[Xu,16,"mat4"],35689:[Xu,16,"mat4x2"],35690:[Xu,16,"mat4x3"]};function Qu(e){const t=Ju[e];if(!t)return null;const[n,r]=t;return{type:n,components:r}}function eh(e,t){switch(e){case 5120:case 5121:case 5122:case 5123:e=Xu}for(const n in Ju){const[r,i,o]=Ju[n];if(r===e&&i===t)return{glType:n,name:o}}return null}class th{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getActiveAttrib(e.handle,r),s=t.getAttribLocation(e.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort(((e,t)=>e.location-t.location))}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Hs(t))return;const n=t.getProgramParameter(e.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort(((e,t)=>e.location-t.location))}_addAttribute(e,t,n,r){const{type:i,components:o}=Qu(n),s={type:i,size:r*o};this._inferProperties(e,t,s);const a={location:e,name:t,accessor:new tl(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[e]=a,this.attributeInfosByName[a.name]=a}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,r){const{type:i,components:o}=Qu(n),s={location:e,name:t,accessor:new tl({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const nh=35981,rh=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class ih extends Ya{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",rh),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:n,fs:r,varyings:i,bufferMode:o=nh}=e;return this.hash=t||"",this.vs="string"==typeof n?new $u(this.gl,{id:`${e.id}-vs`,source:n}):n,this.fs="string"==typeof r?new Yu(this.gl,{id:`${e.id}-fs`,source:r}):r,za(this.vs instanceof $u),za(this.fs instanceof Yu),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(Ws(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new th(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:s=!1,indexType:a=5123,instanceCount:l=0,isInstanced:c=l>0,vertexArray:u=null,transformFeedback:h,framebuffer:d,parameters:f={},uniforms:p,samplers:m}){if((p||m)&&(Bs.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p||{})),Bs.priority>=e){const r=d?d.id:"default",i=`mode=${Ua(this.gl,t)} verts=${n} instances=${l} indexType=${Ua(this.gl,a)} isInstanced=${c} isIndexed=${s} Framebuffer=${r}`;Bs.log(e,i)()}return za(u),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||c&&0===l||(u.bindForDraw(n,l,(()=>{if(void 0!==d&&(f=Object.assign({},f,{framebuffer:d})),h){const e=function(e){switch(e){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return za(!1),0}}(t);h.begin(e)}this._bindTextures(),Sa(this.gl,f,(()=>{s&&c?this.gl2.drawElementsInstanced(t,n,a,r,l):s&&Hs(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(t,i,o,n,a,r):s?this.gl.drawElements(t,n,a,r):c?this.gl2.drawArraysInstanced(t,r,n,l):this.gl.drawArrays(t,r,n)})),h&&h.end()})),0))}setUniforms(e={}){Bs.priority>=2&&function(e,t,n){for(const r in e){const i=e[r];if((!n||Boolean(n[r]))&&!ju(i))throw t=t?`${t} `:"",console.error(`${t} Bad uniform ${r}`,i),new Error(`${t} Bad uniform ${r}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const n=e[t],r=this._uniformSetters[t];if(r){let e=n,i=!1;if(e instanceof Pl&&(e=e.texture),e instanceof hl)if(i=this.uniforms[t]!==n,i){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=e,{textureIndex:i}=r;n.bind(i),e=i,this._textureUniforms[t]=n}else e=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(e)||i)&&Fu(this.uniforms,t,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const n=this._textureUniforms[t];n.update(),e=e&&n.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const e of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new $u({handle:e});break;case 35632:n.fs=new Yu({handle:e})}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=Ha(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Bs.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),Bs.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||Bs.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:r}=Du(n.name);let i=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Iu(e,i,n),n.size>1)for(let t=0;t<n.size;t++)i=e.getUniformLocation(this.handle,`${r}[${t}]`),this._uniformSetters[`${r}[${t}]`]=Iu(e,i,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class oh{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new oh(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find((t=>t.name===e.name))||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t)),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:n="",defines:r={},inject:i={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=e,l=this._getModuleList(e.modules),c=this._getHash(t),u=this._getHash(n),h=l.map((e=>this._getHash(e.name))).sort(),d=o.map((e=>this._getHash(e))),f=Object.keys(r).sort(),p=Object.keys(i).sort(),m=[],g=[];for(const e of f)m.push(this._getHash(e)),m.push(this._getHash(r[e]));for(const e of p)g.push(this._getHash(e)),g.push(this._getHash(i[e]));const y=`${c}/${u}D${m.join("/")}M${h.join("/")}I${g.join("/")}V${d.join("/")}H${this.stateHash}B${s}${a?"T":""}`;if(!this._programCache[y]){const e=function(e,t){const{vs:n,fs:r}=t,i=ou(t.modules||[]);return{gl:e,vs:Su(e,Object.assign({},t,{source:n,type:Hc,modules:i})),fs:Su(e,Object.assign({},t,{source:r,type:qc,modules:i})),getUniforms:Cu(i)}}(this.gl,{vs:t,fs:n,modules:l,inject:i,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new ih(this.gl,{hash:y,vs:e.vs,fs:e.fs,varyings:o,bufferMode:s}),this._getUniforms[y]=e.getUniforms||(e=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let e=0,i=this._defaultModules.length;e<i;++e){const i=this._defaultModules[e],o=i.name;t[r++]=i,n[o]=!0}for(let i=0,o=e.length;i<o;++i){const o=e[i],s=o.name;n[s]||(t[r++]=o,n[s]=!0)}return t.length=r,t}}let sh=null;class ah extends Ya{static isSupported(e,t={}){return!t.constantAttributeZero||Hs(e)||"Chrome"===function(e){if(!ps())return"Node";if(fs(e))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const n=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return n||r?"IE":_s.chrome?"Chrome":_s.safari?"Safari":_s.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ah(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ah.MAX_ATTRIBUTES=ah.MAX_ATTRIBUTES||e.getParameter(34921),ah.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:ah._setConstantFloatArray(e,t,n);break;case Int32Array:ah._setConstantIntArray(e,t,n);break;case Uint32Array:ah._setConstantUintArray(e,t,n);break;default:za(!1)}}constructor(e,t={}){const n=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ah.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return za(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,e?e.handle:null)})),this}setBuffer(e,t,n){if(34963===t.target)return this.setElementBuffer(t,n);const{size:r,type:i,stride:o,offset:s,normalized:a,integer:l,divisor:c}=n,{gl:u,gl2:h}=this;return e=Number(e),this.bind((()=>{u.bindBuffer(34962,t.handle),l?(za(Hs(u)),h.vertexAttribIPointer(e,r,i,o,s)):u.vertexAttribPointer(e,r,i,a,o,s),u.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)})),this}enable(e,t=!0){return!t&&0===e&&!ah.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind((()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e)))),this}getConstantBuffer(e,t){const n=this._normalizeConstantArrayValue(t),r=n.byteLength*e,i=n.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new ol(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const e=function(e,t){var n;return new e((n=e.BYTES_PER_ELEMENT*t,(!sh||sh.byteLength<n)&&(sh=new ArrayBuffer(n)),sh),0,t)}(t.constructor,i);!function({target:e,source:t,start:n=0,count:r=1}){const i=t.length,o=r*i;let s=0;for(let r=n;s<i;s++)e[r++]=t[s];for(;s<o;)s<o-s?(e.copyWithin(n+s,n,n+s),s*=2):(e.copyWithin(n+s,n,n+o-s),s=o)}({target:e,source:n,start:0,count:i}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:za(!1)}}static _setConstantIntArray(e,t,n){switch(za(Hs(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:za(!1)}}static _setConstantUintArray(e,t,n){switch(za(Hs(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:za(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return za(Number.isFinite(t)),this.bind((()=>34373===e?this.gl.getVertexAttribOffset(t,e):this.gl.getVertexAttrib(t,e)))}}const lh=/^(.+)__LOCATION_([0-9]+)$/,ch=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class uh{constructor(e,t={}){const n=t.id||t.program&&t.program.id;this.id=n,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ah(e),Ga(this,"VertexArray","v6.0",ch),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind((()=>{for(const t in e){const n=e[t];this._setAttribute(t,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,n={}){if(34963===t.target)return this.setElementBuffer(t,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return r>=0&&(this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,i)),this}setConstant(e,t,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},n));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ol(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ol&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof ol&&this.setBuffer(e,t)}})),this}bindForDraw(e,t,n){let r;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(e,t),r=n()})),r}_resolveLocationAndAccessor(e,t,n,r){const i={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,Bs.once(3,(()=>`unused value ${e} in ${this.id}`))(),i;const a=this._getAttributeInfo(s||o);if(!a)return i;const l=this.accessors[o]||{},c=tl.resolve(a.accessor,l,n,r),{size:u,type:h}=c;return za(Number.isFinite(u)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const n=lh.exec(e),r=n?n[1]:e,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof ol)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof ol){const n=t[0],r=t[1];this.setBuffer(e,n,r)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const n=t;this.setConstant(e,n)}else{if(!(t.buffer instanceof ol))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=t;this.setBuffer(e,n.buffer,n)}}}_setConstantAttributes(e,t){const n=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let e=1;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)r=this.values[e],ArrayBuffer.isView(r)&&this._setConstantAttribute(e,r)}_setConstantAttributeZero(e,t){if(ah.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){ah.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],r=this.accessors[t];if(!n)return;const{divisor:i}=r,o=i>0;if(e.isInstanced=e.isInstanced||o,n instanceof ol){const t=n;if(o){const n=t.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,n)}else{const n=t.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,n)}}}setElements(e=null,t={}){return Bs.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function hh(e,t={}){const{isInteger:n=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:n=16,size:r=1}=t;let i="[";for(let o=0;o<e.length&&o<n;++o)o>0&&(i+=","+(o%r==0?" ":"")),i+=hh(e[o],t);return`${i}${e.length>n?"...":"]"}`}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const r=e.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function dh(e,t,n,r){const{gl:i}=e;if(!t)return{[r]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",c=1,u=0,h=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),t instanceof ol){const e=t,{data:d,changed:f}=e.getDebugData();let p;return s=f?"*":"",a=d,h=e.byteLength,u=h/d.BYTES_PER_ELEMENT/c,n?p=`${n.divisor>0?"I ":"P "} ${u} (x${c}=${h} bytes ${Ua(i,l)})`:(o=!0,p=`${h} bytes`),{[r]:`${s}${hh(a,{size:c,isInteger:o})}`,"Format ":p}}return a=t,c=t.length,l=String(t.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[r]:`${hh(a,{size:c,isInteger:o})} (constant)`,"Format ":`${c}x${l} (constant)`}}function fh(e,t){const{type:n,size:r}=t,i=eh(n,r);return i?`${e} (${i.name})`:e}function ph({header:e="Uniforms",program:t,uniforms:n,undefinedOnly:r=!1}){za(t);const i=".*Matrix",o=t._uniformSetters,s={},a=Object.keys(o).sort();let l=0;for(const t of a)t.match(".*_.*")||t.match(i)||mh({table:s,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&l++;for(const t of a)t.match(i)&&mh({table:s,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&l++;for(const t of a)s[t]||mh({table:s,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&l++;let c=0;const u={};if(!r)for(const t in n){const r=n[t];s[t]||(c++,u[t]={Type:`NOT USED: ${r}`,[e]:hh(r)})}return{table:s,count:l,unusedTable:u,unusedCount:c}}function mh({table:e,header:t,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(e){return null!=e}(o);return!(i&&s||(e[r]={[t]:s?hh(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},0))}function gh(e){const{type:t,size:n}=e.accessor,r=eh(t,n);return r?`${r.name} ${e.name}`:e.name}const yh={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function vh(e,t){const{attributeMap:n=yh}=t||{};return n&&n[e]||e}function bh(e,t){let n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}za(Number.isFinite(t.size),`attribute ${e} needs size`)}const wh=()=>{},xh={};class Eh{constructor(e,t={}){const{id:n=Ha("model")}=t;za(Vs(e)),this.id=n,this.gl=e,this.id=t.id||Ha("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||oh.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},za(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return za(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return za(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(e,t,n){const r={};let i=t.indices;for(const n in t.attributes){const o=t.attributes[n],s=vh(n,undefined);if("indices"===n)i=o;else if(o.constant)r[s]=o.value;else{const t=o.value,i={...o};delete i.value,r[s]=[new ol(e,t),i],bh(n,i)}}if(i){const t=i.value||i;za(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new ol(e,{data:t,target:34963}),n]}return r}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Wa(e))return this;const t={};for(const n in e){const r=e[n];t[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return vl(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:r={},attributes:i={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=e;let l;this.setAttributes(i),this.updateModuleSettings(t),this.setUniforms(r),Bs.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&Bs.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:m}=this,{onBeforeRender:g=wh,onAfterRender:y=wh}=this.props;g(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(xh,e,{logPriority:l,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:u,indexType:h,isInstanced:p,instanceCount:m,offset:u?d:0}));return y(),Bs.priority>=2&&this._logDrawCallEnd(l,a,n),v}transform(e={}){const{discard:t=!0,feedbackBuffers:n,unbindModels:r=[]}=e;let{parameters:i}=e;n&&this._setFeedbackBuffers(n),t&&(i=Object.assign({},i,{35977:t})),r.forEach((e=>e.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},e,{parameters:i}))}finally{r.forEach((e=>e.vertexArray.bindBuffers()))}return this}render(e={}){return Bs.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;e=this.programManager.get({vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}za(e instanceof ih,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new uh(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof ol&&t.delete()}}_setAnimationProps(e){this.animated&&za(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Wa(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new Bc(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),Bs.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:Bs.level<=2})(),e}_logDrawCallEnd(e,t,n,r){if(void 0===e)return;const i=function({vertexArray:e,header:t="Attributes"}){if(!e.configuration)return{};const n={};e.elements&&(n.ELEMENT_ARRAY_BUFFER=dh(e,e.elements,null,t));const r=e.values;for(const i in r){const o=e._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=e.accessors[o.location];a&&(s=`${i}: ${fh(o.name,a)}`),n[s]=dh(e,r[i],a,t)}}return n}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=ph({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=ph({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&Bs.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&Bs.log("UNUSED UNIFORMS",Object.keys(s))();const u=function(e){const t={},n=`Accessors for ${e.id}`;for(const r of e.attributeInfos)r&&(t[`in ${gh(r)}`]={[n]:JSON.stringify(r.accessor)});for(const r of e.varyingInfos)r&&(t[`out ${gh(r)}`]={[n]:JSON.stringify(r.accessor)});return t}(this.vertexArray.configuration);Bs.table(e,i)(),Bs.table(e,o)(),Bs.table(e+1,u)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),Bs.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class _h{static isSupported(e){return Hs(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:n}=this;e&&e.delete(),t&&t.delete(),n&&n.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,n=this._updateDrawOptions(e);t&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)e=e||n.swap();za(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t){const t=n.getData(e);if(t)return t}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)n.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Eh(t,Object.assign({},e,{fs:e.fs||zc({version:Vc(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const e of n)t=e.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(e){return!(Wa(e.feedbackBuffers)&&Wa(e.feedbackMap)&&!(e.varyings&&e.varyings.length>0))})(t)&&(this.bufferTransform=new Uc(e,t)),function(e){return!(Wa(e._sourceTextures)&&!e._targetTexture&&!e._targetTextureVarying)}(t)&&(this.textureTransform=new eu(e,t)),za(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const e of n)t=Object.assign(t,e.getDrawOptions(t));return t}}function Sh(){}const Ch={onStart:Sh,onUpdate:Sh,onInterrupt:Sh,onEnd:Sh};class Th{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings={...Ch,...e},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Oh={interpolation:class{constructor({gl:e,attribute:t,timeline:n}){this.gl=e,this.type="interpolation",this.transition=new Th(n),this.attribute=t,this.attributeInTransition=new Nc(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(e,t){const n=Pc(t.size);return new _h(e,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new ol(e,r),new ol(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{gl:n,buffers:r,attribute:i}=this;Ac(r);const o={numInstances:t,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const e of r)Mc({buffer:e,...o});this.currentStartIndices=i.startIndices,this.currentLength=kc(i,t),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:Oc(0,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:e,settings:{duration:t,easing:n}}=this.transition,r=n(e/t);this.transform.run({uniforms:{time:r}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:n}){this.gl=e,this.type="spring",this.transition=new Th(n),this.attribute=t,this.attributeInTransition=new Nc(e,{...t.settings,normalized:!1}),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(e){return new fl(e,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(e,t){return new Pl(e,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}(e,this.texture),this.transform=function(e,t,n){const r=Pc(t.size);return new _h(e,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new ol(e,r),new ol(e,r),new ol(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:t,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const e of r)Mc({buffer:e,...o});this.currentStartIndices=i.startIndices,this.currentLength=kc(i,t),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:Oc(0,i)}})}update(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Ac(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),Sl(n)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Ph{constructor(e,{id:t,timeline:n}){this.id=t,this.gl=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=_h.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:n}){this.numInstances=n||1;for(const n in e){const r=e[n],i=r.getTransitionSetting(t);i&&this._updateAttribute(n,r,i)}for(const n in this.transitions){const r=e[n];r&&r.getTransitionSetting(t)||this._removeTransition(n)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void Is.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Oh[n.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Is.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const Ah="attributeManager.invalidate";class kh{constructor(e,{id:t="attribute-manager",stats:n,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Ph(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const n=e[t];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(e,t){const n=this._invalidateTrigger(e,t);Rc(Ah,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Rc(Ah,this,"all")}update({data:e,numInstances:t,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}={}){let a=!1;Rc("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const r in this.attributes){const l=this.attributes[r],c=l.settings.accessor;l.startIndices=n,i[r]&&Is.removed("props.".concat(r),"data.attributes.".concat(r))(),l.setExternalBuffer(o[r])||l.setBinaryValue(o[c],e.startIndices)||!o[c]&&l.setConstantValue(i[c])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:t,data:e,props:i,context:s})),this.needsRedraw|=l.needsRedraw()}a&&Rc("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in t){const o=t[i];o.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const n={};for(const r in e)t[r]||Object.assign(n,e[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(e,t,n={}){t&&Is.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const t in e){const r=e[t];this.attributes[t]=this._createAttribute(t,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,n){const r={...t,id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||n.instanced?1:t.divisor||0};return new Nc(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)}));this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,i=r[e];return i&&i.forEach((e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)})),i}_updateAttribute(e){const{attribute:t,numInstances:n}=e;Rc("attribute.updateStart",t),t.constant?t.setConstantValue(t.value):(t.allocate(n)&&Rc("attribute.allocate",t,n),t.updateBuffer(e)&&(this.needsRedraw=!0,Rc("attribute.updateEnd",t,n)))}}const Mh=1e-5;function Nh(e,t,n,r,i){const o=t-e;return(n-t)*i+-o*r+o+t}function Lh(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}const Rh={interpolation:class extends Th{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:i}}=this,o=i(e/r);this._value=Bl(t,n,o)}},spring:class extends Th{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:i=e,_currValue:o=e}=this;let s=function(e,t,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=Nh(e[s],t[s],n[s],r,i);return o}return Nh(e,t,n,r,i)}(i,o,t,n,r);const a=Lh(s,t),l=Lh(s,o);a<Mh&&l<Mh&&(s=t,this.end()),this._prevValue=o,this._currValue=s}}};class Ih{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=Tc(r)))return;const o=Rh[r.type];if(!o)return void Is.error("unsupported transition type '".concat(r.type,"'"))();const s=new o(this.timeline);s.start({...r,fromValue:t,toValue:n}),i.set(e,s)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const Dh={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:jh}=Dh;function Fh(e,t){if(!e.transitions)return null;const n={},r=Hh(e);for(const i in e.transitions){const o=r[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&Bh(e[i],t[i],o)&&(n[i]=!0)}return n}function zh({newProps:e,oldProps:t,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(t===e)return null;if("object"!=typeof e||null===e)return"".concat(i," changed shallowly");if("object"!=typeof t||null===t)return"".concat(i," changed shallowly");for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," added");const n=Bh(e[o],t[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(e,o)){const n=Bh(e[o],t[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return null}function Bh(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function Uh(e,t){if(null===t)return"oldProps is null, initial diff";const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let e=0;e<r.length;e++)if(!r[e].equals(n[e]))return!0;return!1}function Vh(e,t,n){let r=e.updateTriggers[n];r=null==r?{}:r;let i=t.updateTriggers[n];return i=null==i?{}:i,zh({oldProps:i,newProps:r,triggerName:n})}function Hh(e){const t=e[jh],n=t&&t.constructor;return n?n._propTypes:{}}function qh(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function Wh(e){let t,n={};return r=>{for(const i in r)if(!qh(r[i],n[i])){t=e(r),n=r;break}return t}}function Gh(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some((e=>"project64"===e.name)))){const e=n.modules.findIndex((e=>"project32"===e.name));e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r={...e.inject};for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}function $h(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=n*a-r*s,b=n*l-i*s,w=n*c-o*s,x=r*l-i*a,E=r*c-o*a,_=i*c-o*l,S=u*m-h*p,C=u*g-d*p,T=u*y-f*p,O=h*g-d*m,P=h*y-f*m,A=d*y-f*g,k=v*A-b*P+w*O+x*T-E*C+_*S;return k?(k=1/k,e[0]=(a*A-l*P+c*O)*k,e[1]=(i*P-r*A-o*O)*k,e[2]=(m*_-g*E+y*x)*k,e[3]=(d*E-h*_-f*x)*k,e[4]=(l*T-s*A-c*C)*k,e[5]=(n*A-i*T+o*C)*k,e[6]=(g*w-p*_-y*b)*k,e[7]=(u*_-d*w+f*b)*k,e[8]=(s*P-a*T+c*S)*k,e[9]=(r*T-n*P-o*S)*k,e[10]=(p*E-m*w+y*v)*k,e[11]=(h*w-u*E-f*v)*k,e[12]=(a*C-s*O-l*S)*k,e[13]=(n*O-r*C+i*S)*k,e[14]=(m*b-p*x-g*v)*k,e[15]=(u*x-h*b+d*v)*k,e):null}function Yh(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],b=n[0],w=n[1],x=n[2],E=n[3];return e[0]=b*r+w*a+x*h+E*m,e[1]=b*i+w*l+x*d+E*g,e[2]=b*o+w*c+x*f+E*y,e[3]=b*s+w*u+x*p+E*v,b=n[4],w=n[5],x=n[6],E=n[7],e[4]=b*r+w*a+x*h+E*m,e[5]=b*i+w*l+x*d+E*g,e[6]=b*o+w*c+x*f+E*y,e[7]=b*s+w*u+x*p+E*v,b=n[8],w=n[9],x=n[10],E=n[11],e[8]=b*r+w*a+x*h+E*m,e[9]=b*i+w*l+x*d+E*g,e[10]=b*o+w*c+x*f+E*y,e[11]=b*s+w*u+x*p+E*v,b=n[12],w=n[13],x=n[14],E=n[15],e[12]=b*r+w*a+x*h+E*m,e[13]=b*i+w*l+x*d+E*g,e[14]=b*o+w*c+x*f+E*y,e[15]=b*s+w*u+x*p+E*v,e}var Xh="undefined"!=typeof Float32Array?Float32Array:Array;function Kh(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),function(){var e;e=new Xh(4),Xh!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();const Zh=[0,0,0,0],Jh=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Qh=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ed=[0,0,0],td=[0,0,0],nd=Wh((function({viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:i}=e;let{viewMatrix:o,viewProjectionMatrix:s}=e,a=Zh,l=Zh,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=rd(e,t,n);return d&&(l=e.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Kh([],l,s),o=r||o,s=Yh([],i,o),s=Yh([],s,Jh)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(e,n,r),u=e.getDistanceScales(),h=[e.width*t,e.height*t],d=Kh([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,f={project_uCoordinateSystem:n,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:s.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:t,project_uFocalDistance:d,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:ed,project_uScale:e.scale,project_uViewProjectionMatrix:o,project_uCameraPosition:a};if(c){const t=e.getDistanceScales(c);switch(n){case Ds.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=t.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case Ds.LNGLAT:case Ds.LNGLAT_OFFSETS:e._pseudoMeters||(f.project_uCommonUnitsPerMeter=t.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=t.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case Ds.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return f}));function rd(e,t,n=td){n.length<3&&(n=[n[0],n[1],0]);let r,i=n,o=!0;switch(r=t===Ds.LNGLAT_OFFSETS||t===Ds.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case js.WEB_MERCATOR:t!==Ds.LNGLAT&&t!==Ds.CARTESIAN||(r=[0,0,0],o=!1);break;case js.WEB_MERCATOR_AUTO_OFFSET:t===Ds.LNGLAT?i=r:t===Ds.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case js.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case js.GLOBE:o=!1,r=null;break;default:o=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:o}}class id extends Hl{get ELEMENTS(){return Vl(!1),0}get RANK(){return Vl(!1),0}toString(){let e="[";if(Dl.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=ql(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let e=0;e<this.RANK;++e)t[e]=this[n+e];return t}setColumn(e,t){const n=e*this.RANK;for(let e=0;e<this.RANK;++e)this[n+e]=t[e];return this}}function od(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],b=n[0],w=n[1],x=n[2],E=n[3];return e[0]=b*r+w*a+x*h+E*m,e[1]=b*i+w*l+x*d+E*g,e[2]=b*o+w*c+x*f+E*y,e[3]=b*s+w*u+x*p+E*v,b=n[4],w=n[5],x=n[6],E=n[7],e[4]=b*r+w*a+x*h+E*m,e[5]=b*i+w*l+x*d+E*g,e[6]=b*o+w*c+x*f+E*y,e[7]=b*s+w*u+x*p+E*v,b=n[8],w=n[9],x=n[10],E=n[11],e[8]=b*r+w*a+x*h+E*m,e[9]=b*i+w*l+x*d+E*g,e[10]=b*o+w*c+x*f+E*y,e[11]=b*s+w*u+x*p+E*v,b=n[12],w=n[13],x=n[14],E=n[15],e[12]=b*r+w*a+x*h+E*m,e[13]=b*i+w*l+x*d+E*g,e[14]=b*o+w*c+x*f+E*y,e[15]=b*s+w*u+x*p+E*v,e}function sd(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}!function(){var e;e=new Kl(2),Kl!=Float32Array&&(e[0]=0,e[1]=0)}(),function(){var e;e=new Kl(4),Kl!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();const ad=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ld=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cd=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),ud={};class hd extends id{static get IDENTITY(){return ud.IDENTITY=ud.IDENTITY||Object.freeze(new hd(ad)),ud.IDENTITY}static get ZERO(){return ud.ZERO=ud.ZERO||Object.freeze(new hd(ld)),ud.ZERO}get INDICES(){return cd}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,o,s,a,l,c,u,h,d,f,p,m){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=m,this.check()}setRowMajor(e,t,n,r,i,o,s,a,l,c,u,h,d,f,p,m){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=t,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=m,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ad)}fromQuaternion(e){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,l=i+i,c=n*s,u=r*s,h=r*a,d=i*s,f=i*a,p=i*l,m=o*s,g=o*a,y=o*l;e[0]=1-h-p,e[1]=u+y,e[2]=d-g,e[3]=0,e[4]=u-y,e[5]=1-c-p,e[6]=f+m,e[7]=0,e[8]=d+g,e[9]=f-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:n,top:r,near:i,far:o}){return o===1/0?hd._computeInfinitePerspectiveOffCenter(this,e,t,n,r,i):function(e,t,n,r,i,o,s){var a=1/(n-t),l=1/(i-r),c=1/(o-s);e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*l,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0}(this,e,t,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,n,r,i,o){const s=2*o/(n-t),a=2*o/(i-r),l=(n+t)/(n-t),c=(i+r)/(i-r),u=-2*o;return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=u,e[15]=0,e}lookAt(e,t,n){return 1===arguments.length&&({eye:e,center:t,up:n}=e),function(e,t,n,r){var i,o,s,a,l,c,u,h,d,f,p=t[0],m=t[1],g=t[2],y=r[0],v=r[1],b=r[2],w=n[0],x=n[1],E=n[2];Math.abs(p-w)<Xl&&Math.abs(m-x)<Xl&&Math.abs(g-E)<Xl?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(u=p-w,h=m-x,d=g-E,i=v*(d*=f=1/Math.hypot(u,h,d))-b*(h*=f),o=b*(u*=f)-y*d,s=y*h-v*u,(f=Math.hypot(i,o,s))?(i*=f=1/f,o*=f,s*=f):(i=0,o=0,s=0),a=h*s-d*o,l=d*i-u*s,c=u*o-h*i,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),e[0]=i,e[1]=a,e[2]=u,e[3]=0,e[4]=o,e[5]=l,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=d,e[11]=0,e[12]=-(i*p+o*m+s*g),e[13]=-(a*p+l*m+c*g),e[14]=-(u*p+h*m+d*g),e[15]=1)}(this,e,t=t||[0,0,0],n=n||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:n,top:r,near:i=.1,far:o=500}){return function(e,t,n,r,i,o,s){var a=1/(t-n),l=1/(r-i),c=1/(o-s);e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(s+o)*c,e[15]=1}(this,e,t,n,r,i,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:n=1,near:r=.1,far:i=500}){if(e>2*Math.PI)throw Error("radians");const o=e/2,s=n*Math.tan(o),a=s*t;return(new hd).ortho({left:-a,right:a,bottom:-s,top:s,near:r,far:i})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(e,t,n,r,i){var o,s=1/Math.tan(t/2);e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r)}(this,e,n,r,i),this.check()}determinant(){return t=(e=this)[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],(t*s-n*o)*(h*g-d*m)-(t*a-r*o)*(u*g-d*p)+(t*l-i*o)*(u*m-h*p)+(n*a-r*s)*(c*g-d*f)-(n*l-i*s)*(c*m-h*f)+(r*l-i*a)*(c*p-u*f);var e,t,n,r,i,o,s,a,l,c,u,h,d,f,p,m,g}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const n=this.getScale(t||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const n=this.getScale(t||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=n*a-r*s,b=n*l-i*s,w=n*c-o*s,x=r*l-i*a,E=r*c-o*a,_=i*c-o*l,S=u*m-h*p,C=u*g-d*p,T=u*y-f*p,O=h*g-d*m,P=h*y-f*m,A=d*y-f*g,k=v*A-b*P+w*O+x*T-E*C+_*S;k&&(k=1/k,e[0]=(a*A-l*P+c*O)*k,e[1]=(i*P-r*A-o*O)*k,e[2]=(m*_-g*E+y*x)*k,e[3]=(d*E-h*_-f*x)*k,e[4]=(l*T-s*A-c*C)*k,e[5]=(n*A-i*T+o*C)*k,e[6]=(g*w-p*_-y*b)*k,e[7]=(u*_-d*w+f*b)*k,e[8]=(s*P-a*T+c*S)*k,e[9]=(r*T-n*P-o*S)*k,e[10]=(p*E-m*w+y*v)*k,e[11]=(h*w-u*E-f*v)*k,e[12]=(a*C-s*O-l*S)*k,e[13]=(n*O-r*C+i*S)*k,e[14]=(m*b-p*x-g*v)*k,e[15]=(u*x-h*b+d*v)*k)}(this,this),this.check()}multiplyLeft(e){return od(this,e,this),this.check()}multiplyRight(e){return od(this,this,e),this.check()}rotateX(e){return function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=s*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-o*r,e[9]=u*i-s*r,e[10]=h*i-a*r,e[11]=d*i-l*r}(this,this,e),this.check()}rotateY(e){return function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=s*i-u*r,e[2]=a*i-h*r,e[3]=l*i-d*r,e[8]=o*r+c*i,e[9]=s*r+u*i,e[10]=a*r+h*i,e[11]=l*r+d*i}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=s*i+u*r,e[2]=a*i+h*r,e[3]=l*i+d*r,e[4]=c*i-o*r,e[5]=u*i-s*r,e[6]=h*i-a*r,e[7]=d*i-l*r}(this,this,e),this.check()}rotateXYZ([e,t,n]){return this.rotateX(e).rotateY(t).rotateZ(n)}rotateAxis(e,t){return function(e,t,n,r){var i,o,s,a,l,c,u,h,d,f,p,m,g,y,v,b,w,x,E,_,S,C,T,O,P=r[0],A=r[1],k=r[2],M=Math.hypot(P,A,k);M<Xl||(P*=M=1/M,A*=M,k*=M,i=Math.sin(n),s=1-(o=Math.cos(n)),a=t[0],l=t[1],c=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],m=t[8],g=t[9],y=t[10],v=t[11],b=P*P*s+o,w=A*P*s+k*i,x=k*P*s-A*i,E=P*A*s-k*i,_=A*A*s+o,S=k*A*s+P*i,C=P*k*s+A*i,T=A*k*s-P*i,O=k*k*s+o,e[0]=a*b+h*w+m*x,e[1]=l*b+d*w+g*x,e[2]=c*b+f*w+y*x,e[3]=u*b+p*w+v*x,e[4]=a*E+h*_+m*S,e[5]=l*E+d*_+g*S,e[6]=c*E+f*_+y*S,e[7]=u*E+p*_+v*S,e[8]=a*C+h*T+m*O,e[9]=l*C+d*T+g*O,e[10]=c*C+f*T+y*O,e[11]=u*C+p*T+v*O,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?sd(this,this,e):sd(this,this,[e,e,e]),this.check()}translate(e){return function(e,t,n){var r,i,o,s,a,l,c,u,h,d,f,p,m=n[0],g=n[1],y=n[2];t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*m+a*g+h*y+t[12],e[13]=i*m+l*g+d*y+t[13],e[14]=o*m+c*g+f*y+t[14],e[15]=s*m+u*g+p*y+t[15])}(this,this,e),this.check()}transform(e,t){return 4===e.length?(t=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}(t||[-0,-0,-0,-0],e,this),Wl(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;switch(n){case 2:t=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}(t||[-0,-0],e,this);break;case 3:t=tc(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wl(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(e,t,n){const r=t[0],i=t[1],o=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/o,e[1]=(n[1]*r+n[5]*i)/o,e}(t||[-0,-0],e,this);break;case 3:t=rc(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wl(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}transformPoint(e,t){return $l("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return $l("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return $l("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}var dd=1e-6,fd="undefined"!=typeof Float32Array?Float32Array:Array;function pd(e,t){const n=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}([],t,e);return function(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n}(n,n,1/n[3]),n}function md(e,t){const n=e%t;return n<0?t+n:n}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),function(){var e;e=new fd(4),fd!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();const gd=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function yd(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],b=n[0],w=n[1],x=n[2],E=n[3];return e[0]=b*r+w*a+x*h+E*m,e[1]=b*i+w*l+x*d+E*g,e[2]=b*o+w*c+x*f+E*y,e[3]=b*s+w*u+x*p+E*v,b=n[4],w=n[5],x=n[6],E=n[7],e[4]=b*r+w*a+x*h+E*m,e[5]=b*i+w*l+x*d+E*g,e[6]=b*o+w*c+x*f+E*y,e[7]=b*s+w*u+x*p+E*v,b=n[8],w=n[9],x=n[10],E=n[11],e[8]=b*r+w*a+x*h+E*m,e[9]=b*i+w*l+x*d+E*g,e[10]=b*o+w*c+x*f+E*y,e[11]=b*s+w*u+x*p+E*v,b=n[12],w=n[13],x=n[14],E=n[15],e[12]=b*r+w*a+x*h+E*m,e[13]=b*i+w*l+x*d+E*g,e[14]=b*o+w*c+x*f+E*y,e[15]=b*s+w*u+x*p+E*v,e}function vd(e,t,n){var r,i,o,s,a,l,c,u,h,d,f,p,m=n[0],g=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*m+a*g+h*y+t[12],e[13]=i*m+l*g+d*y+t[13],e[14]=o*m+c*g+f*y+t[14],e[15]=s*m+u*g+p*y+t[15]),e}function bd(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function wd(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=t[0],b=t[1],w=t[2],x=t[3],E=t[4],_=t[5],S=t[6],C=t[7],T=t[8],O=t[9],P=t[10],A=t[11],k=t[12],M=t[13],N=t[14],L=t[15];return Math.abs(n-v)<=dd*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-b)<=dd*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=dd*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-x)<=dd*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-E)<=dd*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(a-_)<=dd*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(l-S)<=dd*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-C)<=dd*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-T)<=dd*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-O)<=dd*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(d-P)<=dd*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-A)<=dd*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(p-k)<=dd*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(m-M)<=dd*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-N)<=dd*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(y-L)<=dd*Math.max(1,Math.abs(y),Math.abs(L))}function xd(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Ed(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}!function(){var e;e=new fd(2),fd!=Float32Array&&(e[0]=0,e[1]=0)}();function _d(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}!function(){var e;e=new fd(3),fd!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0)}();const Sd=Math.PI,Cd=Sd/4,Td=Sd/180,Od=180/Sd,Pd=512;function Ad(e){return Math.pow(2,e)}function kd(e){return gd(e)}function Md([e,t]){_d(Number.isFinite(e)),_d(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const n=t*Td;return[Pd*(e*Td+Sd)/(2*Sd),Pd*(Sd+Math.log(Math.tan(Cd+.5*n)))/(2*Sd)]}function Nd([e,t]){const n=e/Pd*(2*Sd)-Sd,r=2*(Math.atan(Math.exp(t/Pd*(2*Sd)-Sd))-Cd);return[n*Od,r*Od]}function Ld({latitude:e,longitude:t,highPrecision:n=!1}){_d(Number.isFinite(e)&&Number.isFinite(t));const r={},i=Math.cos(e*Td),o=512/360,s=o/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[o,s,a],r.degreesPerUnit=[.703125,1/s,1/a],n){const t=Td*Math.tan(e*Td)/i,n=o*t/2,l=12790407194604047e-21*t,c=l/s*a;r.unitsPerDegree2=[0,n,l],r.unitsPerMeter2=[c,0,c]}return r}function Rd(e,t){const[n,r,i]=e,[o,s,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=Ld({longitude:n,latitude:r,highPrecision:!0}),u=Md(e);u[0]+=o*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const h=Nd(u),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function Id({height:e,pitch:t,bearing:n,altitude:r,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return vd(s,s,[0,0,-r]),function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=s*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-o*r,e[9]=u*i-s*r,e[10]=h*i-a*r,e[11]=d*i-l*r}(s,s,-t*Td),function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=s*i+u*r,e[2]=a*i+h*r,e[3]=l*i+d*r,e[4]=c*i-o*r,e[5]=u*i-s*r,e[6]=h*i-a*r,e[7]=d*i-l*r}(s,s,n*Td),bd(s,s,[i/=e,i,i]),o&&vd(s,s,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),s}function Dd({width:e,height:t,fovy:n=jd(1.5),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=jd(r));const a=.5*n*Td,l=Fd(n),c=i*Td,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:e/t,focalDistance:l,near:o,far:(Math.sin(c)*u+l)*s}}function jd(e){return 2*Math.atan(.5/e)*Od}function Fd(e){return.5/Math.tan(.5*e*Td)}function zd(e,t){const[n,r,i=0]=e;return _d(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),pd(t,[n,r,i,1])}function Bd(e,t,n=0){const[r,i,o]=e;if(_d(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return pd(t,[r,i,o,1]);const s=pd(t,[r,i,0,1]),a=pd(t,[r,i,1,1]),l=s[2],c=a[2];return Ed([],s,a,l===c?0:((n||0)-l)/(c-l))}function Ud({width:e,height:t,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:s=[0,0]}){const[[a,l],[c,u]]=n;Number.isFinite(o)?o={top:o,bottom:o,left:o,right:o}:_d(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const h=new Wd({width:e,height:t,longitude:0,latitude:0,zoom:0}),d=h.project([a,u]),f=h.project([c,l]),p=[Math.max(Math.abs(f[0]-d[0]),r),Math.max(Math.abs(f[1]-d[1]),r)],m=[e-o.left-o.right-2*Math.abs(s[0]),t-o.top-o.bottom-2*Math.abs(s[1])];_d(m[0]>0&&m[1]>0);const g=m[0]/p[0],y=m[1]/p[1],v=(o.right-o.left)/2/g,b=(o.bottom-o.top)/2/y,w=[(f[0]+d[0])/2+v,(f[1]+d[1])/2+b],x=h.unproject(w),E=Math.min(i,h.zoom+gd(Math.abs(Math.min(g,y))));return _d(Number.isFinite(E)),{longitude:x[0],latitude:x[1],zoom:E}}const Vd=Math.PI/180;function Hd(e,t=0){const{width:n,height:r,unproject:i}=e,o={targetZ:t},s=i([0,r],o),a=i([n,r],o);let l,c;return(e.fovy?.5*e.fovy*Vd:Math.atan(.5/e.altitude))>(90-e.pitch)*Vd-.01?(l=qd(e,0,t),c=qd(e,n,t)):(l=i([0,0],o),c=i([n,0],o)),[s,a,c,l]}function qd(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=pd(r,[t,0,1,1]),o=pd(r,[t,e.height,1,1]),s=Nd(Ed([],i,o,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2])));return s[2]=n,s}class Wd{constructor({width:e,height:t,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:l=null,position:c=null,nearZMultiplier:u=.02,farZMultiplier:h=1.01}={width:1,height:1}){e=e||1,t=t||1,null===l&&null===a?l=jd(a=1.5):null===l?l=jd(a):null===a&&(a=Fd(l));const d=Ad(i);a=Math.max(.75,a);const f=Ld({longitude:r,latitude:n}),p=Md([r,n]);p[2]=0,c&&function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2]}(p,p,function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}([],c,f.unitsPerMeter)),this.projectionMatrix=function({width:e,height:t,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:a,aspect:l,near:c,far:u}=Dd({width:e,height:t,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s}),h=function(e,t,n,r,i){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}([],a,l,c,u);return h}({width:e,height:t,pitch:o,fovy:l,nearZMultiplier:u,farZMultiplier:h}),this.viewMatrix=Id({height:t,scale:d,center:p,pitch:o,bearing:s,altitude:a}),this.width=e,this.height=t,this.scale=d,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=l,this.center=p,this.meterOffset=c||[0,0,0],this.distanceScales=f,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];yd(i,i,n),yd(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];bd(o,o,[e/2,-t/2,1]),vd(o,o,[1,-1,0]),yd(o,o,i);const s=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=n*a-r*s,b=n*l-i*s,w=n*c-o*s,x=r*l-i*a,E=r*c-o*a,_=i*c-o*l,S=u*m-h*p,C=u*g-d*p,T=u*y-f*p,O=h*g-d*m,P=h*y-f*m,A=d*y-f*g,k=v*A-b*P+w*O+x*T-E*C+_*S;return k?(k=1/k,e[0]=(a*A-l*P+c*O)*k,e[1]=(i*P-r*A-o*O)*k,e[2]=(m*_-g*E+y*x)*k,e[3]=(d*E-h*_-f*x)*k,e[4]=(l*T-s*A-c*C)*k,e[5]=(n*A-i*T+o*C)*k,e[6]=(g*w-p*_-y*b)*k,e[7]=(u*_-d*w+f*b)*k,e[8]=(s*P-a*T+c*S)*k,e[9]=(r*T-n*P-o*S)*k,e[10]=(p*E-m*w+y*v)*k,e[11]=(h*w-u*E-f*v)*k,e[12]=(a*C-s*O-l*S)*k,e[13]=(n*O-r*C+i*S)*k,e[14]=(m*b-p*x-g*v)*k,e[15]=(u*x-h*b+d*v)*k,e):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(e){return e instanceof Wd&&e.width===this.width&&e.height===this.height&&wd(e.projectionMatrix,this.projectionMatrix)&&wd(e.viewMatrix,this.viewMatrix)}project(e,{topLeft:t=!0}={}){const n=zd(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,o=t?i:this.height-i;return 2===e.length?[r,o]:[r,o,n[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,i,o]=e,s=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=Bd([r,s,o],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=Md(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=Nd(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return Md(e)}unprojectFlat(e){return Nd(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const n=Bd(t,this.pixelUnprojectionMatrix),r=xd([],Md(e),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],n));return Nd(xd([],this.center,r))}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=Ud(Object.assign({width:n,height:r,bounds:e},t));return new Wd({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(e){const t=this.getBoundingRegion(e),n=Math.min(...t.map((e=>e[0]))),r=Math.max(...t.map((e=>e[0])));return[[n,Math.min(...t.map((e=>e[1])))],[r,Math.max(...t.map((e=>e[1])))]]}getBoundingRegion(e={}){return Hd(this,e.z||0)}}const Gd=["longitude","latitude","zoom"],$d={curve:1.414,speed:1.2};function Yd(e,t,n){const r=(n=Object.assign({},$d,n)).curve,i=e.zoom,o=[e.longitude,e.latitude],s=Ad(i),a=t.zoom,l=[t.longitude,t.latitude],c=Ad(a-i),u=Md(o),h=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}([],Md(l),u),d=Math.max(e.width,e.height),f=d/c,p=(E=(x=h)[0],_=x[1],Math.hypot(E,_)*s),m=Math.max(p,.01),g=r*r,y=(f*f-d*d+g*g*m*m)/(2*d*g*m),v=(f*f-d*d-g*g*m*m)/(2*f*g*m),b=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(v*v+1)-v);var x,E,_;return{startZoom:i,startCenterXY:u,uDelta:h,w0:d,u1:p,S:(w-b)/r,rho:r,rho2:g,r0:b,r1:w}}const Xd=Math.PI/180,Kd=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Zd=[0,0,0],Jd={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Qd{constructor(e={}){const{id:t=null,x:n=0,y:r=0,width:i=1,height:o=1}=e;this.id=t||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(e),this._initProjectionMatrix(e),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?js.WEB_MERCATOR:js.WEB_MERCATOR_AUTO_OFFSET:js.IDENTITY}equals(e){return e instanceof Qd&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ul(e.projectionMatrix,this.projectionMatrix)&&Ul(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const n=zd(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,o=t?i:this.height-i;return 2===e.length?[r,o]:[r,o,n[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,i,o]=e,s=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=Bd([r,s,o],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return this.isGeospatial?Md(e):e}unprojectFlat(e){return this.isGeospatial?Nd(e):e}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,0],t),r=this.unproject([this.width,0],t),i=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(e=null){return e?Ld({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:n=1,height:r=1}){return e<this.x+this.width&&this.x<e+n&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(e){const t={};return t.left=lc(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),t.right=lc(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),t.bottom=lc(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),t.top=lc(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),t.near=lc(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),t.far=lc(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14]),t}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,t){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:e,fovyRadians:t,aspect:n,focalDistance:r,near:i,far:o}){return e?(new hd).orthographic({fovy:t,aspect:n,focalDistance:r,near:i,far:o}):(new hd).perspective({fovy:t,aspect:n,near:i,far:o})}_initViewMatrix(e){const{viewMatrix:t=Kd,longitude:n=null,latitude:r=null,zoom:i=null,position:o=null,modelMatrix:s=null,focalDistance:a=1,distanceScales:l=null}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:e}){_d(Number.isFinite(e));return kd(4003e4*Math.cos(e*Td))-9}({latitude:r})+Math.log2(a):0);const c=Math.pow(2,this.zoom);this.scale=c,this.distanceScales=this.isGeospatial?Ld({latitude:r,longitude:n}):l||Jd,this.focalDistance=a,this.distanceScales.metersPerUnit=new sc(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new sc(this.distanceScales.unitsPerMeter),this.position=Zd,this.meterOffset=Zd,o&&(this.position=o,this.modelMatrix=s,this.meterOffset=s?s.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=t,this.viewMatrix=(new hd).multiplyRight(this.viewMatrixUncentered).translate(new sc(this.center||Zd).negate())}_getCenterInWorld({longitude:e,latitude:t}){const{meterOffset:n,distanceScales:r}=this,i=new sc(this.projectPosition([e,t,0]));if(n){const e=new sc(n).scale(r.unitsPerMeter);i.add(e)}return i}_initProjectionMatrix(e){const{projectionMatrix:t=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=e;this.projectionMatrix=t||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*Xd,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var t;Yh(e,e,this.projectionMatrix),Yh(e,e,this.viewMatrix),this.viewProjectionMatrix=e,this.viewMatrixInverse=$h([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(t=this.viewMatrixInverse)[12],t[13],t[14]];const n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];!function(e,t,n){var r=n[0],i=n[1],o=n[2];e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}(n,n,[this.width/2,-this.height/2,1]),function(e,t,n){var r,i,o,s,a,l,c,u,h,d,f,p,m=n[0],g=n[1],y=n[2];t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*m+a*g+h*y+t[12],e[13]=i*m+l*g+d*y+t[13],e[14]=o*m+c*g+f*y+t[14],e[15]=s*m+u*g+p*y+t[15])}(n,n,[1,-1,0]),Yh(r,n,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=n,this.pixelUnprojectionMatrix=$h([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Is.warn("Pixel project matrix not invertible")()}}function ef(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}Qd.displayName="Viewport",function(){var e;e=new Xh(2),Xh!=Float32Array&&(e[0]=0,e[1]=0)}();const tf=Math.PI/180;function nf(e){return 512/4003e4/Math.cos(e*tf)}class rf extends Qd{constructor(e={}){const{latitude:t=0,longitude:n=0,zoom:r=11,pitch:i=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:l=!1,projectionMatrix:c,repeat:u=!1,worldOffset:h=0,legacyMeterSizes:d=!1}=e;let{width:f,height:p,altitude:m=1.5}=e;const g=Math.pow(2,r);let y;f=f||1,p=p||1;let v=null;c?(m=c[5]/2,y=jd(m)):(e.fovy?(y=e.fovy,m=Fd(y)):y=jd(m),v=Dd({width:f,height:p,pitch:i,fovy:y,nearZMultiplier:s,farZMultiplier:a}));let b=Id({height:p,pitch:i,bearing:o,scale:g,altitude:m});h&&(b=(new hd).translate([512*h,0,0]).multiplyLeft(b)),super({...e,width:f,height:p,viewMatrix:b,longitude:n,latitude:t,zoom:r,...v,fovy:y,focalDistance:m}),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=o,this.altitude=m,this.fovy=y,this.orthographic=l,this._subViewports=u?[]:null,this._pseudoMeters=d,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let e=t;e<=n;e++){const t=e?new rf({...this,worldOffset:e}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*nf(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/nf(n)]}addMetersToLngLat(e,t){return Rd(e,t)}panByPosition(e,t){const n=Bd(t,this.pixelUnprojectionMatrix),r=ef([],this.projectFlat(e),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],n)),i=ef([],this.center,r),[o,s]=this.unprojectFlat(i);return{longitude:o,latitude:s}}getBounds(e={}){const t=Hd(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=Ud({width:n,height:r,bounds:e,...t});return new rf({width:n,height:r,longitude:i,latitude:o,zoom:s})}}rf.displayName="WebMercatorViewport";function of(e,t,n=!1){const r=t.projectPosition(e);if(n&&t instanceof rf){const[n,i,o=0]=e,s=t.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function sf(e,{viewport:t,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:o}){let[s,a,l=0]=e;switch(n&&([s,a,l]=Kh([],[s,a,l,1],n)),r){case Ds.LNGLAT:return of([s,a,l],t,o);case Ds.LNGLAT_OFFSETS:return of([s+i[0],a+i[1],l+(i[2]||0)],t,o);case Ds.METER_OFFSETS:return of(Rd(i,[s,a,l]),t,o);default:return t.isGeospatial?[s+i[0],a+i[1],l+i[2]]:t.projectPosition([s,a,l])}}!function(){var e;e=new Xh(3),Xh!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0)}();const af={10241:9987,10240:9729,10242:33071,10243:33071},lf={},cf={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||ff(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>uf(e,t)},accessor:{validate(e,t){const n=pf(e);return"function"===n||n===pf(t.value)},equal:(e,t,n)=>"function"==typeof t||uf(e,t)},array:{validate:(e,t)=>t.optional&&!e||ff(e),equal:(e,t,n)=>n.compare?uf(e,t):e===t},function:{validate:(e,t)=>t.optional&&!e||"function"==typeof e,equal:(e,t,n)=>!n.compare||e===t},data:{transform:(e,t,n)=>{const{dataTransform:r}=n?n.props:{};return r&&e?r(e):e}},image:{transform:(e,t,n)=>function(e,t){const n=e.context&&e.context.gl;if(!n||!t)return null;if(t instanceof fl)return t;t.constructor&&"Object"!==t.constructor.name&&(t={data:t});let r=null;t.compressed&&(r={10241:t.data.length>1?9985:9729});const i=new fl(n,{...t,parameters:{...af,...r,...e.props.textureParameters}});return lf[i.id]=!0,i}(n,e),release:e=>{var t;(t=e)&&t instanceof fl&&lf[t.id]&&(t.delete(),delete lf[t.id])}}};function uf(e,t){if(e===t)return!0;if(!ff(e)||!ff(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function hf(e,t){switch(pf(t)){case"object":return df(e,t);case"array":return df(e,{type:"array",value:t,compare:!1});case"boolean":return df(e,{type:"boolean",value:t});case"number":return df(e,{type:"number",value:t});case"function":return df(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function df(e,t){return"type"in t?{name:e,...cf[t.type],...t}:"value"in t?{name:e,type:pf(t.value),...t}:{name:e,type:"object",value:t}}function ff(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function pf(e){return ff(e)?"array":null===e?"null":typeof e}const{COMPONENT:mf,ASYNC_ORIGINAL:gf,ASYNC_RESOLVED:yf,ASYNC_DEFAULTS:vf}=Dh;function bf(){const e=this,t=wf(e.constructor),n=Object.create(t);n[mf]=e,n[gf]={},n[yf]={};for(let e=0;e<arguments.length;++e){const t=arguments[e];for(const e in t)n[e]=t[e]}return Object.freeze(n),n}function wf(e){return _f(e,"_mergedDefaultProps")||(function(e){if(!e.prototype)return;const t=Object.getPrototypeOf(e),n=wf(t),r=function(e){const t={},n={},r={};for(const[i,o]of Object.entries(e))if(o&&o.deprecatedFor)r[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const e=hf(i,o);t[i]=e,n[i]=e.value}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(_f(e,"defaultProps")||{}),i=function(e,t,n){const r=Object.create(null);Object.assign(r,t,e);const i=function(e){const t=_f(e,"layerName")||_f(e,"componentName");return t||Is.once(0,"".concat(e.name,".componentName not specified"))(),t||e.name}(n);return delete e.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,e),o={...t._propTypes,...r.propTypes};!function(e,t){const n={},r={};for(const e in t){const i=t[e],{name:o,value:s}=i;i.async&&(n[o]=s,r[o]=xf(o))}e[vf]=n,e[gf]={},Object.defineProperties(e,r)}(i,o);const s={...t._deprecatedProps,...r.deprecatedProps};(function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r="".concat(this.id,": ").concat(n);for(const r of t[n])Ef(this,r)||(this[r]=e);Is.deprecated(r,t[n].join("/"))()}})})(i,s),e._mergedDefaultProps=i,e._propTypes=o,e._deprecatedProps=s}(e),e._mergedDefaultProps)}function xf(e){return{enumerable:!0,set(t){"string"==typeof t||t instanceof Promise||yc(t)?this[gf][e]=t:this[yf][e]=t},get(){if(this[yf]){if(e in this[yf])return this[yf][e]||this[vf][e];if(e in this[gf]){const t=this[mf]&&this[mf].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[vf][e]}}return this[vf][e]}}}function Ef(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _f(e,t){return Ef(e,t)&&e[t]}const{ASYNC_ORIGINAL:Sf,ASYNC_RESOLVED:Cf,ASYNC_DEFAULTS:Tf}=Dh,Of=Object.freeze({});class Pf{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=Of,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[Cf]||{},n=e[Sf]||e,r=e[Tf]||{};for(const e in t){const n=t[e];this._createAsyncPropData(e,r[e]),this._updateAsyncProp(e,n),t[e]=this.getAsyncProp(e)}for(const e in n){const t=n[e];this._createAsyncPropData(e,r[e]),this._updateAsyncProp(e,t)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=t;r&&(t=r(i,{propName:e,layer:this.layer}))}t instanceof Promise?this._watchPromise(e,t):yc(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this.freezeAsyncOldProps();const n=this.asyncProps[e];t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];n.pendingLoadCount++;const r=n.pendingLoadCount;t.then((t=>{var i;t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===e&&o&&o(t,{propName:e,layer:this.layer})})).catch((t=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}))}async _resolveAsyncIterable(e,t){var n;"data"!==e&&this._setPropValue(e,t);const r=this.asyncProps[e];r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],s=0;for await(const n of t){const{dataTransform:t}=this.component?this.component.props:{};o=t?t(n,o):o.concat(n),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(e,o,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(o,{propName:e,layer:this.layer})}_postProcessValue(e,t){const n=e.type;return n&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Af,ASYNC_RESOLVED:kf,ASYNC_DEFAULTS:Mf}=Dh;let Nf=0;class Lf{constructor(){this.props=bf.apply(this,arguments),this.id=this.props.id,this.count=Nf++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}clone(e){const{props:t}=this,n={};for(const e in t[Mf])e in t[kf]?n[e]=t[kf][e]:e in t[Af]&&(n[e]=t[Af][e]);return new this.constructor({...t,...n,...e})}get stats(){return this.internalState.stats}_initState(){this.internalState=new Pf({})}}Lf.componentName="Component",Lf.defaultProps={};class Rf extends Pf{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const If=e=>"function"==typeof e,Df=e=>null!==e&&"object"==typeof e,jf=e=>Df(e)&&e.constructor==={}.constructor,Ff=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,zf=e=>"undefined"!=typeof Blob&&e instanceof Blob,Bf=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||Df(e)&&If(e.tee)&&If(e.cancel)&&If(e.getReader))(e)||(e=>Df(e)&&If(e.read)&&If(e.pipe)&&(e=>"boolean"==typeof e)(e.readable))(e);function Uf(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Vf(e){var t;return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions))}function Hf(e){var t,n;let r;return Uf(e,"null loader"),Uf(Vf(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=e[0],e={...e,options:{...e.options,...r}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const qf={};function Wf(e){for(const t in qf)if(e.startsWith(t)){const n=qf[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat("").concat(e)),e}const Gf=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,$f=/^([-\w.]+\/[-\w.+]+)/;function Yf(e){const t=$f.exec(e);return t?t[1]:e}function Xf(e){const t=Gf.exec(e);return t?t[1]:""}const Kf=/\?.*/;function Zf(e){if(Ff(e)){const t=Jf(e.url||"");return{url:t,type:Yf(e.headers.get("content-type")||"")||Xf(t)}}return zf(e)?{url:Jf(e.name||""),type:e.type||""}:"string"==typeof e?{url:Jf(e),type:Xf(e)}:{url:"",type:""}}function Jf(e){return e.replace(Kf,"")}async function Qf(e){if(Ff(e))return e;const t={},n=function(e){return Ff(e)?e.headers["content-length"]||-1:zf(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const{url:r,type:i}=Zf(e);i&&(t["content-type"]=i);const o=await async function(e){if("string"==typeof e)return"data:,".concat(e.slice(0,5));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null==t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){const t=function(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.byteLength;e++)t+=String.fromCharCode(n[e]);return btoa(t)}(e.slice(0,5));return"data:base64,".concat(t)}return null}(e);o&&(t["x-first-bytes"]=o),"string"==typeof e&&(e=(new TextEncoder).encode(e));const s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:r}),s}async function ep(e,t){if("string"==typeof e){e=Wf(e);let n=t;return null!=t&&t.fetch&&"function"!=typeof(null==t?void 0:t.fetch)&&(n=t.fetch),await fetch(e,n)}return await Qf(e)}function tp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const np=new Ns({id:"loaders.gl"});class rp{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const ip={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){tp(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},op={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function sp(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}const ap=()=>{const e=sp();return e.globalOptions=e.globalOptions||{...ip},e.globalOptions};function lp(e,t,n,r){return n=n||[],function(e,t){up(e,null,ip,op,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};up(r,n.id,i,o,t)}}(e,n=Array.isArray(n)?n:[n]),function(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new rp),dp(r,ap()),dp(r,t),r}(t,e,r)}function cp(e,t){const n=ap(),r=e||n;return"function"==typeof r.fetch?r.fetch:Df(r.fetch)?e=>ep(e,r):null!=t&&t.fetch?null==t?void 0:t.fetch:ep}function up(e,t,n,r,i){const o=t||"Top level",s=t?"".concat(t,"."):"";for(const a in e){const l=!t&&Df(e[a]),c="baseUri"===a&&!t,u="workerUrl"===a&&t;if(!(a in n)&&!c&&!u)if(a in r)np.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const e=hp(a,i);np.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(e))()}}}function hp(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '".concat(i.id,".").concat(t,"'?");const o=t.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(t,"'?"))}return r}function dp(e,t){for(const n in t)if(n in t){const r=t[n];jf(r)&&jf(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function fp(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document,"object"!=typeof process||"[object process]"!==String(process)||process.browser;const pp="undefined"!=typeof window&&void 0!==window.orientation,mp="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);function gp(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}mp&&parseFloat(mp[1]);const yp=new Map;function vp(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function bp(e,t=!0,n){const r=n||new Set;if(e)if(wp(e))r.add(e);else if(wp(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const n in e)bp(e[n],t,r);return void 0===n?Array.from(r):[]}function wp(e){return!!e&&(e instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&e instanceof MessagePort||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}const xp=()=>{};class Ep{static isSupported(){return"undefined"!=typeof Worker}constructor(e){tp(this,"name",void 0),tp(this,"source",void 0),tp(this,"url",void 0),tp(this,"terminated",!1),tp(this,"worker",void 0),tp(this,"onMessage",void 0),tp(this,"onError",void 0),tp(this,"_loadableURL","");const{name:t,source:n,url:r}=e;gp(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=xp,this.onError=e=>console.log(e),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=xp,this.onError=xp,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||bp(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function(e){gp(e.source&&!e.url||!e.source&&e.url);let t=yp.get(e.source||e.url);return t||(e.url&&(t=(n=e.url).startsWith("http")?vp("try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")):n,yp.set(e.url,t)),e.source&&(t=vp(e.source),yp.set(e.source,t))),gp(t),t;var n}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}}class _p{constructor(e,t){tp(this,"name",void 0),tp(this,"workerThread",void 0),tp(this,"isRunning",void 0),tp(this,"result",void 0),tp(this,"_resolve",void 0),tp(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){gp(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){gp(this.isRunning),this.isRunning=!1,this._reject(e)}}class Sp{constructor(e){tp(this,"name","unnamed"),tp(this,"source",void 0),tp(this,"url",void 0),tp(this,"maxConcurrency",1),tp(this,"maxMobileConcurrency",1),tp(this,"onDebug",(()=>{})),tp(this,"reuseWorkers",!0),tp(this,"props",{}),tp(this,"jobQueue",[]),tp(this,"idleQueue",[]),tp(this,"count",0),tp(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t=((e,t,n)=>e.done(n)),n=((e,t)=>e.error(t))){const r=new Promise((r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new _p(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Ep({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return pp?this.maxMobileConcurrency:this.maxConcurrency}}const Cp={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Tp{static isSupported(){return Ep.isSupported()}static getWorkerFarm(e={}){return Tp._workerFarm=Tp._workerFarm||new Tp({}),Tp._workerFarm.setProps(e),Tp._workerFarm}constructor(e){tp(this,"props",void 0),tp(this,"workerPools",new Map),this.props={...Cp},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props={...this.props,...e};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new Sp({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function Op(e,t){return!!Tp.isSupported()&&e.worker&&(null==t?void 0:t.worker)}async function Pp(e,t,n,r,i){const o=e.id,s=function(e,t={}){const n=t[e.id]||{},r="".concat(e.id,"-worker.js");let i=n.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i="modules/".concat(e.module,"/dist/").concat(r)),!i){let t=e.version;"latest"===t&&(t="beta");const n=t?"@".concat(t):"";i="https://unpkg.com/@loaders.gl/".concat(e.module).concat(n,"/dist/").concat(r)}return gp(i),i}(e,n),a=Tp.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n));const l=await a.startJob("process-on-worker",Ap.bind(null,i));l.postMessage("process",{input:t,options:n});const c=await l.result;return await c.result}async function Ap(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:i,input:o,options:s}=r;try{const n=await e(o,s);t.postMessage("done",{id:i,result:n})}catch(e){const n=e instanceof Error?e.message:"unknown error";t.postMessage("error",{id:i,error:n})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function kp(e){return e&&"object"==typeof e&&e.isBuffer}function Mp(e){if(kp(e))return kp(t=e)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Np(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let e=0;e<r.length;++e)if(r[e]!==i[e])return!1;return!0}async function Lp(e){const t=[];for await(const n of e)t.push(n);return function(...e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),n=t.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(n);let i=0;for(const e of t)r.set(e,i),i+=e.byteLength;return r.buffer}(...t)}tp(Tp,"_workerFarm",void 0),n(6070);const Rp=262144;"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const Ip=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),Dp="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);function jp(e,t){return Ip?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!=t&&t._streamReadAhead&&(r=n.read());const{done:i,value:o}=await e;if(i)return;yield Mp(o)}}catch(e){n.releaseLock()}}(e,t):async function*(e,t){for await(const t of e)yield Mp(t)}(e)}Dp&&parseFloat(Dp[1]);const Fp="Cannot convert supplied data type";async function zp(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||r)return function(e,t,n){if(t.text&&"string"==typeof e)return e;if((r=e)&&"object"==typeof r&&r.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}var r;if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(Fp)}(e,t);if(zf(e)&&(e=await Qf(e)),Ff(e)){const n=e;return await async function(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): ");try{const n=e.headers.get("Content-Type");let r=e.statusText;n.includes("application/json")&&(r+=" ".concat(await e.text())),t+=r,t=t.length>60?"".concat(t.slice(60),"..."):t}catch(e){}return t}(e);throw new Error(t)}}(n),t.binary?await n.arrayBuffer():await n.text()}if(Bf(e)&&(e=function(e,t){if("string"==typeof e)return function*(e,t){const n=(null==t?void 0:t.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),o=e.slice(r,r+t);r+=t,yield i.encode(o)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:n=Rp}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),o=new Uint8Array(e,r,t);new Uint8Array(i).set(o),r+=t,yield i}}(e,t);if(zf(e))return async function*(e,t){const n=(null==t?void 0:t.chunkSize)||1048576;let r=0;for(;r<e.size;){const t=r+n,i=await e.slice(r,t).arrayBuffer();r=t,yield i}}(e,t);if(Bf(e))return jp(e,t);if(Ff(e))return jp(e.body,t);throw new Error("makeIterator")}(e,n)),(i=e)&&"function"==typeof i[Symbol.iterator]||(e=>e&&"function"==typeof e[Symbol.asyncIterator])(e))return Lp(e);var i;throw new Error(Fp)}function Bp(e){const t=e&&e.lastIndexOf("/");return t>=0?e.substr(t+1):""}const Up=()=>{const e=sp();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry},Vp=/\.([^.]+)$/;function Hp(e,t=[],n,r){if(!qp(e))return null;if(t&&!Array.isArray(t))return Hf(t);let i=[];t&&(i=i.concat(t)),null!=n&&n.ignoreRegisteredLoaders||i.push(...Up()),function(e){for(const t of e)Hf(t)}(i);const o=function(e,t,n,r){const{url:i,type:o}=Zf(e),s=i||(null==r?void 0:r.url);let a=null;return null!=n&&n.mimeType&&(a=Gp(t,null==n?void 0:n.mimeType)),a=a||function(e,t){const n=t&&Vp.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,s),a=a||Gp(t,o),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"==typeof t){if($p(t,n))return n}else if(ArrayBuffer.isView(t)){if(Yp(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer&&Yp(t,0,n))return n;return null}(t,e),a=a||Gp(t,null==n?void 0:n.fallbackMimeType),a}(e,i,n,r);if(!(o||null!=n&&n.nothrow))throw new Error(Wp(e));return o}function qp(e){return!(e instanceof Response&&204===e.status)}function Wp(e){const{url:t,type:n}=Zf(e);let r="No valid loader found (";r+=t?"".concat(Bp(t),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=e?function(e,t=5){return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?Xp(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?Xp(e,0,t):""}(e):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Gp(e,t){for(const n of e){if(n.mimeTypes&&n.mimeTypes.includes(t))return n;if(t==="application/x.".concat(n.id))return n}return null}function $p(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function Yp(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(e,t,n,r){if(r instanceof ArrayBuffer)return Np(r,e,r.byteLength);switch(typeof r){case"function":return r(e,n);case"string":return r===Xp(e,t,r.length);default:return!1}}(e,t,n,r)))}function Xp(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let e=0;e<n;e++)i+=String.fromCharCode(r.getUint8(t+e));return i}async function Kp(e,t,n,r){fp(!r||"object"==typeof r),!t||Array.isArray(t)||Vf(t)||(r=void 0,n=t,t=void 0),e=await e,n=n||{};const{url:i}=Zf(e),o=function(e,t){if(!t&&e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:null}(t,r),s=await async function(e,t=[],n,r){if(!qp(e))return null;let i=Hp(e,t,{...n,nothrow:!0},r);if(i)return i;if(zf(e)&&(i=Hp(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!(i||null!=n&&n.nothrow))throw new Error(Wp(e));return i}(e,o,n);return s?(r=function(e,t,n=null){if(n)return n;const r={fetch:cp(t,e),...e};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:i,parse:Kp,loaders:o},n=lp(n,s,o,i),r),await async function(e,t,n,r){if(function(e,t="3.1.0"){fp(e,"no worker provided");e.version}(e),t=await zp(t,e,n),e.parseTextSync&&"string"==typeof t)return n.dataType="text",e.parseTextSync(t,n,r,e);if(Op(e,n))return await Pp(e,t,n,0,Kp);if(e.parseText&&"string"==typeof t)return await e.parseText(t,n,r,e);if(e.parse)return await e.parse(t,n,r,e);throw fp(!e.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(s,e,n,r)):null}async function Zp(e,t,n,r){Array.isArray(t)||Vf(t)||(n=t,t=void 0);const i=cp(n);let o=e;return"string"==typeof e&&(o=await i(e)),zf(e)&&(o=await i(e)),await Kp(o,t,n)}const Jp=2**24-1,Qp=Object.freeze([]),em=Wh((({oldViewport:e,viewport:t})=>e.equals(t)));let tm=new Uint8ClampedArray(0);const nm={data:{type:"data",value:Qp,async:!0},dataComparator:null,_dataDiff:{type:"function",value:e=>e&&e.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;i=i||n.getLoadOptions(),r=r||n.props.loaders,o&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(e);return l||i||(s.add({resourceId:e,data:Zp(e,r),persistent:!1}),l=!0),l?s.subscribe({resourceId:e,onChange:e=>n.internalState.reloadAsyncProp(t,e),consumerId:n.id,requestId:t}):Zp(e,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Ds.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,100*-e],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class rm extends Lf{toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}raiseError(e,t){var n,r,i,o;t&&(e.message="".concat(t,": ").concat(e.message)),(null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,e))||null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,e,this)}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(e=!0){this.internalState&&(this.internalState.needsRedraw=e)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(e){const{viewport:t}=this.context,n=sf(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=zd(n,t.pixelProjectionMatrix);return 2===e.length?[r,i]:[r,i,o]}unproject(e){const{viewport:t}=this.context;return t.unproject(e)}projectPosition(e){return function(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(e){const t={...e};let{coordinateSystem:n}=e;const{viewport:r,coordinateOrigin:i,fromCoordinateSystem:o,fromCoordinateOrigin:s}=e;return n===Ds.DEFAULT&&(n=r.isGeospatial?Ds.LNGLAT:Ds.CARTESIAN),void 0===o&&(t.fromCoordinateSystem=n),void 0===s&&(t.fromCoordinateOrigin=i),t.coordinateSystem=n,t}(t),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=rd(n,r,i),h=sf(e,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:u});u&&function(e,t,n){e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2]}(h,h,n.projectPosition(l||c));return h}(e,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ds.DEFAULT||e===Ds.LNGLAT||e===Ds.CARTESIAN}onHover(e,t){return!!this.props.onHover&&this.props.onHover(e,t)}onClick(e,t){return!!this.props.onClick&&this.props.onClick(e,t)}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){fc(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(e){for(const t of this.props.extensions)e=Gh(e,t.getShaders.call(this,t));return e}shouldUpdateState({oldProps:e,props:t,context:n,changeFlags:r}){return r.propsOrDataChanged}updateState({oldProps:e,props:t,context:n,changeFlags:r}){const i=this.getAttributeManager();if(r.dataChanged&&i){const{dataChanged:e}=r;if(Array.isArray(e))for(const t of e)i.invalidateAll(t);else i.invalidateAll()}const o=e.highlightedObjectIndex>=0||e.pickable,s=t.highlightedObjectIndex>=0||t.pickable;if(o!==s&&i){const{pickingColors:e,instancePickingColors:t}=i.attributes,n=e||t;n&&(s&&n.constant&&(n.constant=!1,i.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo({info:e,mode:t}){const{index:n}=e;return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}activateViewport(e){const t=this.internalState.viewport;this.internalState.viewport=e,t&&em({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all",t=""){const n=this.getAttributeManager();n&&("all"===e?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(e){const t=this.getAttributeManager();if(!t)return;const n=this.getNumInstances(e),r=this.getStartIndices(e);t.update({data:e.data,numInstances:n,startIndices:r,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const n=Math.floor(tm.length/3);if(this.internalState.usesPickingColorCache=!0,n<t){t>Jp&&Is.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),tm=Il.allocate(tm,t,{size:3,copy:!0,maxCount:Math.max(t,Jp)});const e=Math.floor(tm.length/3),r=[];for(let t=n;t<e;t++)this.encodePickingColor(t,r),tm[3*t+0]=r[0],tm[3*t+1]=r[1],tm[3*t+2]=r[2]}e.value=tm.subarray(0,3*t)}_setModelAttributes(e,t){const n=this.getAttributeManager(),r=e.userData.excludeAttributes||{},i=n.getShaderAttributes(t,r);e.setAttributes(i)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n,i=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;this.internalState.usesPickingColorCache&&n.value.buffer!==tm.buffer&&(n.value=tm.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(e){return void 0!==(e=e||this.props).numInstances?e.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(e){if(!function(e){return null!==e&&"object"==typeof e}(e))throw new Error("count(): argument not an object");if("function"==typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"==typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}(e.data)}getStartIndices(e){return void 0!==(e=e||this.props).startIndices?e.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Rc("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const e=this.needsUpdate();Rc("layer.update",this,e),e&&this._updateState()}_updateState(){const e=this.props,t=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||t,this.props=n;try{const n=this._getUpdateParams(),r=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(e){}for(const e of this.props.extensions)e.updateState.call(this,n,e);const i=this.getModels()[0]!==r[0];this._updateModules(n,i),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=t,this.props=e,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Rc("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}drawLayer({moduleParameters:e=null,uniforms:t={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;t.opacity=Math.pow(i,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:i}=this.props,o=i&&i(t)||[0,0];_a(this.context.gl,{polygonOffset:o}),Sa(this.context.gl,n,(()=>{const r={moduleParameters:e,uniforms:t,parameters:n,context:this.context};for(const e of this.props.extensions)e.draw.call(this,r,e);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(e){const{changeFlags:t}=this.internalState;for(const n in e)if(e[n]){let r=!1;"dataChanged"===n&&Array.isArray(t[n])&&(t[n]=Array.isArray(e[n])?t[n].concat(e[n]):e[n],r=!0),t[n]||(t[n]=e[n],r=!0),r&&Rc("layer.changeFlag",this,n,e)}const n=t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged;t.propsOrDataChanged=n,t.somethingChanged=n||e.viewportChanged||e.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(e,t){const n=function(e,t){const n=zh({newProps:e,oldProps:t,propTypes:Hh(e),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=e;return r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied"),n&&i&&(n=i(e.data,t.data)||n),n}(e,t);let i=!1;return r||(i=function(e,t){if(null===t)return"oldProps is null, initial diff";if("all"in e.updateTriggers&&Vh(e,t,"all"))return{all:!0};const n={};let r=!1;for(const i in e.updateTriggers)"all"!==i&&Vh(e,t,i)&&(n[i]=!0,r=n);return r}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Uh(e,t),transitionsChanged:Fh(e,t)}}(e,t);if(n.updateTriggersChanged)for(const e in n.updateTriggersChanged)n.updateTriggersChanged[e]&&this.invalidateAttribute(e);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,t[r],e[r],e.transitions[r]);return this.setChangeFlags(n)}validateProps(){!function(e){const t=Hh(e);for(const n in t){const r=t[n],{validate:i}=r;if(i&&!i(e[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}updateAutoHighlight(e){this.props.autoHighlight&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"==typeof n&&(t.pickingHighlightColor=n(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_updateModules({props:e,oldProps:t},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:o}=e;if(n||t.autoHighlight!==r||t.highlightedObjectIndex!==i||t.highlightColor!==o){const e={};r||(e.pickingSelectedColor=null),Array.isArray(o)&&(e.pickingHighlightColor=o),Number.isInteger(i)&&(e.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(e)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(e);return t=t||r,t}_getAttributeManager(){return new kh(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){fc(!this.internalState&&!this.state),fc(isFinite(this.props.coordinateSystem));const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Rf({attributeManager:e,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Is.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Ih(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(e){Rc("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.internalState.layer=this,this.state=t,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}rm.layerName="Layer",rm.defaultProps=nm;class im extends rm{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((e=>e.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id?(e.object=t.__source.object,e.index=t.__source.index,e):e}renderLayers(){return null}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"==typeof e){const t={data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}return e}getSubLayerProps(e={}){const{opacity:t,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:m,_subLayerProps:g}=this.props,y={opacity:t,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:m},v=g&&g[e.id],b=v&&v.updateTriggers,w=e.id||"sublayer";if(v){const t=this.constructor._propTypes,n=e.type?e.type._propTypes:{};for(const e in v){const r=n[e]||t[e];r&&"accessor"===r.type&&(v[e]=this.getSubLayerAccessor(v[e]))}}Object.assign(y,e,v),y.id="".concat(this.props.id,"-").concat(w),y.updateTriggers={all:this.props.updateTriggers.all,...e.updateTriggers,...b};for(const e of p){const t=e.getSubLayerProps.call(this,e);t&&Object.assign(y,t,{updateTriggers:Object.assign(y.updateTriggers,t.updateTriggers)})}return y}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:e}=this.internalState;const t=!e||this.needsUpdate();t&&(e=this.renderLayers(),e=bc(e,Boolean),this.internalState.subLayers=e),Rc("compositeLayer.renderLayers",this,t,e);for(const t of e)t.parent=this}}function om({data:e,getIndex:t,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=e.length;let a=s,l=s;for(let n=0;n<s;n++){const r=t(e[n]);if(a>n&&r>=i&&(a=n),r>=o){l=n;break}}let c=a;const u=l-a!==r.length,h=u&&e.slice(l);for(let t=0;t<r.length;t++)e[c++]=r[t];if(u){for(let t=0;t<h.length;t++)e[c++]=h[t];e.length=c}return{startRow:a,endRow:a+r.length}}im.layerName="CompositeLayer";const sm=Object.keys(Ds).map((e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(Ds[e],";"))).join(""),am=Object.keys(js).map((e=>"const int PROJECTION_MODE_".concat(e," = ").concat(js[e],";"))).join(""),lm=Object.keys(Fs).map((e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(Fs[e],";"))).join("");var cm="".concat(sm,"\n").concat(am,"\n").concat(lm,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n");const um={};var hm={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"}],vs:cm,getUniforms:function(e=um){return e.viewport?function({viewport:e,devicePixelRatio:t=1,modelMatrix:n=null,coordinateSystem:r=Ds.DEFAULT,coordinateOrigin:i,autoWrapLongitude:o=!1}={}){r===Ds.DEFAULT&&(r=e.isGeospatial?Ds.LNGLAT:Ds.CARTESIAN);const s=nd({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:i});return s.project_uWrapLongitude=o,s.project_uModelMatrix=n||Qh,s}(e):{}}},dm={name:"project32",dependencies:[hm],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"};const fm={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},pm={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(e=fm){const t={};if(void 0!==e.pickingSelectedColor)if(e.pickingSelectedColor){const n=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}else t.picking_uSelectedColorValid=0;if(e.pickingHighlightColor){const n=Array.from(e.pickingHighlightColor,(e=>e/255));Number.isFinite(n[3])||(n[3]=1),t.picking_uHighlightColor=n}return void 0!==e.pickingActive&&(t.picking_uActive=Boolean(e.pickingActive),t.picking_uAttribute=Boolean(e.pickingAttribute)),t}};var mm={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...pm};const gm={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class ym{static get DRAW_MODE(){return gm}constructor(e={}){const{id:t=Ha("geometry"),drawMode:n=gm.TRIANGLES,attributes:r={},indices:i=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,i),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const t in e){let n=e[t];n=ArrayBuffer.isView(n)?{value:n}:n,za(ArrayBuffer.isView(n.value),`${this._print(t)}: must be typed array or object with value as typed array`),"POSITION"!==t&&"positions"!==t||n.size||(n.size=3),"indices"===t?(za(!this.indices),this.indices=n):this.attributes[t]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const t in e){const r=e[t],{value:i,size:o,constant:s}=r;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return za(Number.isFinite(n)),n}}const{_parseImageNode:vm}=globalThis,bm="undefined"!=typeof Image,wm="undefined"!=typeof ImageBitmap,xm=Boolean(vm),Em=!!Ip||xm;function _m(e){const t=function(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}(e);if(!t)throw new Error("Not an image");return t}const Sm=/^data:image\/svg\+xml/,Cm=/\.svg((\?|#).*)?$/;function Tm(e){return e&&(Sm.test(e)||Cm.test(e))}function Om(e,t){if(Tm(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Pm(e,t,n){const r=function(e,t){if(Tm(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(e){throw new Error(e.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return Om(e,t)}(e,n),i=self.URL||self.webkitURL,o="string"!=typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;return n.src=e,t.image&&t.image.decode&&n.decode?(await n.decode(),n):await new Promise(((t,r)=>{try{n.onload=()=>t(n),n.onerror=t=>r(new Error("Could not load image ".concat(e,": ").concat(t)))}catch(e){r(e)}}))}(o||r,t)}finally{o&&i.revokeObjectURL(o)}}const Am={};let km=!0;const Mm=!1,Nm=!0;function Lm(e){const t=Rm(e);return function(e){const t=Rm(e);return t.byteLength>=24&&2303741511===t.getUint32(0,Mm)?{mimeType:"image/png",width:t.getUint32(16,Mm),height:t.getUint32(20,Mm)}:null}(t)||function(e){const t=Rm(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,Mm)&&255===t.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)e.add(t);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let i=2;for(;i+9<t.byteLength;){const e=t.getUint16(i,Mm);if(r.has(e))return{mimeType:"image/jpeg",height:t.getUint16(i+5,Mm),width:t.getUint16(i+7,Mm)};if(!n.has(e))return null;i+=2,i+=t.getUint16(i,Mm)}return null}(t)||function(e){const t=Rm(e);return t.byteLength>=10&&1195984440===t.getUint32(0,Mm)?{mimeType:"image/gif",width:t.getUint16(6,Nm),height:t.getUint16(8,Nm)}:null}(t)||function(e){const t=Rm(e);return t.byteLength>=14&&16973===t.getUint16(0,Mm)&&t.getUint32(2,Nm)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Nm),height:t.getUint32(22,Nm)}:null}(t)}function Rm(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const Im={id:"image",module:"images",name:"Images",version:"3.1.0",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{},o=function(e){switch(e){case"auto":case"data":return function(){if(wm)return"imagebitmap";if(bm)return"image";if(Em)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return wm||bm||Em;case"imagebitmap":return wm;case"image":return bm;case"data":return Em;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(r);let s;switch(o){case"imagebitmap":s=await async function(e,t,n){let r;r=Tm(n)?await Pm(e,t,n):Om(e,n);const i=t&&t.imagebitmap;return await async function(e,t=null){if(!function(e){for(const t in e||Am)return!1;return!0}(t)&&km||(t=null),t)try{return await createImageBitmap(e,t)}catch(e){console.warn(e),km=!1}return await createImageBitmap(e)}(r,i)}(e,t,i);break;case"image":s=await Pm(e,t,i);break;case"data":s=await async function(e,t){const{mimeType:n}=Lm(e)||{},r=globalThis._parseImageNode;return Uf(r),await r(e,n)}(e);break;default:Uf(!1)}return"data"===r&&(s=function(e){switch(_m(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}(s)),s},tests:[e=>Boolean(Lm(new DataView(e)))],options:{image:{type:"auto",decode:!0}}},Dm=e=>"function"==typeof e,jm=e=>null!==e&&"object"==typeof e,Fm=e=>jm(e)&&e.constructor==={}.constructor,zm=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,Bm=e=>"undefined"!=typeof Blob&&e instanceof Blob,Um=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||jm(e)&&Dm(e.tee)&&Dm(e.cancel)&&Dm(e.getReader))(e)||(e=>jm(e)&&Dm(e.read)&&Dm(e.pipe)&&(e=>"boolean"==typeof e)(e.readable))(e);function Vm(e){var t;return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions))}function Hm(e){var t,n;let r;return Uf(e,"null loader"),Uf(Vm(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=e[0],e={...e,options:{...e.options,...r}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const qm=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Wm=/^([-\w.]+\/[-\w.+]+)/;function Gm(e){const t=Wm.exec(e);return t?t[1]:e}function $m(e){const t=qm.exec(e);return t?t[1]:""}const Ym=/\?.*/;function Xm(e){if(zm(e)){const t=Km(e.url||"");return{url:t,type:Gm(e.headers.get("content-type")||"")||$m(t)}}return Bm(e)?{url:Km(e.name||""),type:e.type||""}:"string"==typeof e?{url:Km(e),type:$m(e)}:{url:"",type:""}}function Km(e){return e.replace(Ym,"")}async function Zm(e){if(zm(e))return e;const t={},n=function(e){return zm(e)?e.headers["content-length"]||-1:Bm(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const{url:r,type:i}=Xm(e);i&&(t["content-type"]=i);const o=await async function(e){if("string"==typeof e)return"data:,".concat(e.slice(0,5));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null==t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){const t=function(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.byteLength;e++)t+=String.fromCharCode(n[e]);return btoa(t)}(e.slice(0,5));return"data:base64,".concat(t)}return null}(e);o&&(t["x-first-bytes"]=o),"string"==typeof e&&(e=(new TextEncoder).encode(e));const s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:r}),s}async function Jm(e,t){if("string"==typeof e){e=Wf(e);let n=t;return null!=t&&t.fetch&&"function"!=typeof(null==t?void 0:t.fetch)&&(n=t.fetch),await fetch(e,n)}return await Zm(e)}const Qm=new Ns({id:"loaders.gl"});class eg{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const tg={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){tp(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ng={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function rg(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}const ig=()=>{const e=rg();return e.globalOptions=e.globalOptions||{...tg},e.globalOptions};function og(e,t,n,r){return n=n||[],function(e,t){ag(e,null,tg,ng,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};ag(r,n.id,i,o,t)}}(e,n=Array.isArray(n)?n:[n]),function(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new eg),cg(r,ig()),cg(r,t),r}(t,e,r)}function sg(e,t){const n=ig(),r=e||n;return"function"==typeof r.fetch?r.fetch:jm(r.fetch)?e=>Jm(e,r):null!=t&&t.fetch?null==t?void 0:t.fetch:Jm}function ag(e,t,n,r,i){const o=t||"Top level",s=t?"".concat(t,"."):"";for(const a in e){const l=!t&&jm(e[a]),c="baseUri"===a&&!t,u="workerUrl"===a&&t;if(!(a in n)&&!c&&!u)if(a in r)Qm.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const e=lg(a,i);Qm.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(e))()}}}function lg(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '".concat(i.id,".").concat(t,"'?");const o=t.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(t,"'?"))}return r}function cg(e,t){for(const n in t)if(n in t){const r=t[n];Fm(r)&&Fm(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function ug(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const hg=262144;function dg(e,t){return Ip?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!=t&&t._streamReadAhead&&(r=n.read());const{done:i,value:o}=await e;if(i)return;yield Mp(o)}}catch(e){n.releaseLock()}}(e,t):async function*(e,t){for await(const t of e)yield Mp(t)}(e)}const fg="Cannot convert supplied data type";async function pg(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||r)return function(e,t,n){if(t.text&&"string"==typeof e)return e;if((r=e)&&"object"==typeof r&&r.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}var r;if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(fg)}(e,t);if(Bm(e)&&(e=await Zm(e)),zm(e)){const n=e;return await async function(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): ");try{const n=e.headers.get("Content-Type");let r=e.statusText;n.includes("application/json")&&(r+=" ".concat(await e.text())),t+=r,t=t.length>60?"".concat(t.slice(60),"..."):t}catch(e){}return t}(e);throw new Error(t)}}(n),t.binary?await n.arrayBuffer():await n.text()}if(Um(e)&&(e=function(e,t){if("string"==typeof e)return function*(e,t){const n=(null==t?void 0:t.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),o=e.slice(r,r+t);r+=t,yield i.encode(o)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:n=hg}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),o=new Uint8Array(e,r,t);new Uint8Array(i).set(o),r+=t,yield i}}(e,t);if(Bm(e))return async function*(e,t){const n=(null==t?void 0:t.chunkSize)||1048576;let r=0;for(;r<e.size;){const t=r+n,i=await e.slice(r,t).arrayBuffer();r=t,yield i}}(e,t);if(Um(e))return dg(e,t);if(zm(e))return dg(e.body,t);throw new Error("makeIterator")}(e,n)),(i=e)&&"function"==typeof i[Symbol.iterator]||(e=>e&&"function"==typeof e[Symbol.asyncIterator])(e))return Lp(e);var i;throw new Error(fg)}const mg=/\.([^.]+)$/;function gg(e,t=[],n,r){if(!yg(e))return null;if(t&&!Array.isArray(t))return Hm(t);let i=[];t&&(i=i.concat(t)),null!=n&&n.ignoreRegisteredLoaders||i.push(...(()=>{const e=rg();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry})()),function(e){for(const t of e)Hm(t)}(i);const o=function(e,t,n,r){const{url:i,type:o}=Xm(e),s=i||(null==r?void 0:r.url);let a=null;return null!=n&&n.mimeType&&(a=bg(t,null==n?void 0:n.mimeType)),a=a||function(e,t){const n=t&&mg.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,s),a=a||bg(t,o),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"==typeof t){if(wg(t,n))return n}else if(ArrayBuffer.isView(t)){if(xg(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer&&xg(t,0,n))return n;return null}(t,e),a=a||bg(t,null==n?void 0:n.fallbackMimeType),a}(e,i,n,r);if(!(o||null!=n&&n.nothrow))throw new Error(vg(e));return o}function yg(e){return!(e instanceof Response&&204===e.status)}function vg(e){const{url:t,type:n}=Xm(e);let r="No valid loader found (";r+=t?"".concat(Bp(t),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=e?function(e,t=5){return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?Eg(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?Eg(e,0,t):""}(e):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function bg(e,t){for(const n of e){if(n.mimeTypes&&n.mimeTypes.includes(t))return n;if(t==="application/x.".concat(n.id))return n}return null}function wg(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function xg(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(e,t,n,r){if(r instanceof ArrayBuffer)return Np(r,e,r.byteLength);switch(typeof r){case"function":return r(e,n);case"string":return r===Eg(e,t,r.length);default:return!1}}(e,t,n,r)))}function Eg(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let e=0;e<n;e++)i+=String.fromCharCode(r.getUint8(t+e));return i}async function _g(e,t,n,r){ug(!r||"object"==typeof r),!t||Array.isArray(t)||Vm(t)||(r=void 0,n=t,t=void 0),e=await e,n=n||{};const{url:i}=Xm(e),o=function(e,t){if(!t&&e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:null}(t,r),s=await async function(e,t=[],n,r){if(!yg(e))return null;let i=gg(e,t,{...n,nothrow:!0},r);if(i)return i;if(Bm(e)&&(i=gg(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!(i||null!=n&&n.nothrow))throw new Error(vg(e));return i}(e,o,n);return s?(r=function(e,t,n=null){if(n)return n;const r={fetch:sg(t,e),...e};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:i,parse:_g,loaders:o},n=og(n,s,o,i),r),await async function(e,t,n,r){if(function(e,t="3.1.0"){ug(e,"no worker provided");e.version}(e),t=await pg(t,e,n),e.parseTextSync&&"string"==typeof t)return n.dataType="text",e.parseTextSync(t,n,r,e);if(Op(e,n))return await Pp(e,t,n,0,_g);if(e.parseText&&"string"==typeof t)return await e.parseText(t,n,r,e);if(e.parse)return await e.parse(t,n,r,e);throw ug(!e.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(s,e,n,r)):null}async function Sg(e,t,n,r){Array.isArray(t)||Vm(t)||(n=t,t=void 0);const i=sg(n);let o=e;return"string"==typeof e&&(o=await i(e)),Bm(e)&&(o=await i(e)),await _g(o,t,n)}const Cg=()=>{},Tg={10241:9987,10240:9729,10242:33071,10243:33071};function Og(e,t,n,r){return n===t.width&&r===t.height?t:(e.canvas.height=r,e.canvas.width=n,e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0,t.width,t.height,0,0,n,r),e.canvas)}function Pg(e){return e&&(e.id||e.url)}function Ag(e,t,n){for(let r=0;r<t.length;r++){const{icon:i,xOffset:o}=t[r];e[Pg(i)]={...i,x:o,y:n}}}class kg{constructor(e,{onUpdate:t=Cg,onError:n=Cg}){this.gl=e,this.onUpdate=t,this.onError=n,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Pg(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:n,iconMapping:r,data:i,getIcon:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(i))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}_updateAutoPacking(e){const t=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=gc(e);for(const e of i){o.index++;const i=t(e,o),s=Pg(i);if(!i)throw new Error("Icon is missing.");if(!i.url)throw new Error("Icon url is missing.");r[s]||n[s]&&i.url===n[s].url||(r[s]={...i,source:e,sourceIndex:o.index})}return r}(e,this._getIcon,this._mapping)||{});if(t.length>0){const{mapping:e,xOffset:n,yOffset:r,rowHeight:i,canvasHeight:o}=function({icons:e,buffer:t,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<e.length;l++){const c=e[l];if(!n[Pg(c)]){const{height:e,width:l}=c;r+l+t>s&&(Ag(n,a,i),r=0,i=o+i+t,o=0,a=[]),a.push({icon:c,xOffset:r}),r=r+l+t,o=Math.max(o,e)}}return a.length>0&&Ag(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:(l=o+i+t,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:t,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=e,this._xOffset=n,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new fl(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:Tg})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,n,r){const i=t.width,o=t.height,s=El(t,{width:n,height:r});return function(e,t,n={}){const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=n;const{framebuffer:d,deleteFramebuffer:f}=Tl(e);za(d);const{gl:p,handle:m}=d,g=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const y=p.bindFramebuffer(36160,m);za(t);let v=null;if(t instanceof hl&&(v=t,u=Number.isFinite(u)?u:v.width,h=Number.isFinite(h)?h:v.height,v.bind(0),t=v.target),g)switch(t){case 3553:case 34067:p.copyTexSubImage2D(t,o,a,l,r,i,u,h);break;case 35866:case 32879:Ws(p).copyTexSubImage3D(t,o,a,l,c,r,i,u,h)}else p.copyTexImage2D(t,o,s,r,i,u,h,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),f&&d.delete()}(t,s,{targetY:0,width:i,height:o}),t.delete(),s}(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(t)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const n of e)this._pendingCount++,Sg(n.url,Im,this._loadOptions).then((e=>{const r=Pg(n),{x:i,y:o,width:s,height:a}=this._mapping[r],l=Og(t,e,s,a);this._texture.setSubImageData({data:l,x:i,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()})).catch((e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})})).finally((()=>{this._pendingCount--}))}}const Mg=[0,0,0,255],Ng={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:Mg},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class Lg extends rm{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[dm,mm]})}initializeState(){this.state={iconManager:new kg(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Mg},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:e,props:t,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const r=this.getAttributeManager(),{iconAtlas:i,iconMapping:o,data:s,getIcon:a}=t,{iconManager:l}=this.state;l.setProps({loadOptions:t.loadOptions});let c=!1;if(i||this.internalState.isAsyncPropLoading("iconAtlas")?(e.iconAtlas!==t.iconAtlas&&l.setProps({iconAtlas:i,autoPacking:!1}),e.iconMapping!==t.iconMapping&&(l.setProps({iconMapping:o}),c=!0)):l.setProps({autoPacking:!0}),(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&l.setProps({data:s,getIcon:a}),c&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),n.extensionsChanged){var u;const{gl:e}=this.context;null===(u=this.state.model)||void 0===u||u.delete(),this.state.model=this._getModel(e),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,l=a.getTexture();l&&this.state.model.setUniforms(e).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:Fs[i],sizeScale:t,sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:s}).draw()}_getModel(e){return new Eh(e,{...this.getShaders(),id:this.props.id,geometry:new ym({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){const{onIconError:t}=this.getCurrentLayer().props;t?t(e):Is.error(e.error)()}getInstanceOffset(e){const t=this.state.iconManager.getIconMapping(e);return[t.width/2-t.anchorX||0,t.height/2-t.anchorY||0]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const t=this.state.iconManager.getIconMapping(e);return[t.x||0,t.y||0,t.width||0,t.height||0]}}Lg.layerName="IconLayer",Lg.defaultProps=Ng;const Rg=[0,0,0,255],Ig={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Rg},getLineColor:{type:"accessor",value:Rg},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Dg extends rm{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[dm,mm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:e,oldProps:t,changeFlags:n}){if(super.updateState({props:e,oldProps:t,changeFlags:n}),n.extensionsChanged){var r;const{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:t,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,stroked:o,filled:s,billboard:a,antialiasing:l,lineWidthUnits:c,lineWidthScale:u,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:s,billboard:a,antialiasing:l,radiusUnits:Fs[t],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,lineWidthUnits:Fs[c],lineWidthScale:u,lineWidthMinPixels:h,lineWidthMaxPixels:d}).draw()}_getModel(e){return new Eh(e,{...this.getShaders(),id:this.props.id,geometry:new ym({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}Dg.layerName="ScatterplotLayer",Dg.defaultProps=Ig;const jg=[];class Fg extends Lg{getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(e,{index:t,target:n})=>this.encodePickingColor(t,n)}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:r}=t;r!==n.outlineColor&&(r=r.map((e=>e/255)),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&Is.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state;e.uniforms={...e.uniforms,buffer:.75,outlineBuffer:r?Math.max(n,.75*(1-r)):-1,gamma:n,sdf:Boolean(t),outlineColor:i},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).map((e=>super.getInstanceOffset(e))):jg}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).map((e=>super.getInstanceIconFrame(e))):jg}}Fg.layerName="MultiIconLayer",Fg.defaultProps={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};var zg=n(5886),Bg=n.n(zg);const Ug=[];function Vg(e,t,n,r){let i=0;for(let o=t;o<n;o++){const t=e[o];let n=null;const s=r&&r[t];s&&(n=s.width),i+=n}return i}function Hg(e,t,n,r,i,o){let s=t,a=0;for(let l=t;l<n;l++){const t=Vg(e,l,l+1,i);a+t>r&&(s<l&&o.push(l),s=l,a=0),a+=t}return a}function qg(e,t,n,r,i=0,o){void 0===o&&(o=e.length);const s=[];return"break-all"===t?Hg(e,i,o,n,r,s):function(e,t,n,r,i,o){let s=t,a=t,l=t,c=0;for(let u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>a){let t=Vg(e,a,l,i);c+t>r&&(s<a&&(o.push(a),s=a,c=0),t>r&&(t=Hg(e,a,l,r,i,o),s=o[o.length-1])),a=l,c+=t}}(e,i,o,n,r,s),s}function Wg(e,t,n,r,i,o){let s=0,a=0;for(let o=t;o<n;o++){const t=e[o],n=r[t];n?(a||(a=n.height),i[o]=s+n.width/2,s+=n.width):(Is.warn("Missing character: ".concat(t," (").concat(t.codePointAt(0),")"))(),i[o]=s,s+=32)}o[0]=s,o[1]=a}function Gg(e,t,n,r,i){const o=(e=Array.from(e)).length,s=new Array(o),a=new Array(o),l=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,u=[0,0],h=[];let d=0,f=0,p=0;for(let m=0;m<=o;m++){const g=e[m];if("\n"!==g&&m!==o||(p=m),p>f){const o=c?qg(e,n,r,i,f,p):Ug;for(let n=0;n<=o.length;n++){const r=0===n?f:o[n-1],c=n<o.length?o[n]:p;Wg(e,r,c,i,s,h);for(let e=r;e<c;e++)a[e]=d+h[1]/2,l[e]=h[0];d+=h[1]*t,u[0]=Math.max(u[0],h[0])}f=p}"\n"===g&&(s[f]=0,a[f]=0,l[f]=0,f++)}return u[1]=d,{x:s,y:a,rowWidth:l,size:u}}const $g=function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),Yg="Monaco, monospace",Xg="normal",Kg=new class{constructor(e=5){this.limit=e,this.clear()}clear(){this._cache={},this._order=[]}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}_deleteCache(e){delete this._cache[e]}_deleteOrder(e){const t=this._order.findIndex((t=>t===e));t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}(3),Zg=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Jg(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function Qg(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="baseline",e.textAlign="left"}class ey{constructor(){this.props={fontFamily:Yg,fontWeight:Xg,characterSet:$g,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){Zg.forEach((t=>{t in e&&(this.props[t]=e[t])}));const t=this._key;this._key=this._getKey();const n=function(e,t){const n=Kg.get(e);if(!n)return t;const r=[],i=n.mapping;let o=Object.keys(i);o=new Set(o);let s=t;return s instanceof Array&&(s=new Set(s)),s.forEach((e=>{o.has(e)||r.push(e)})),r}(this._key,this.props.characterSet),r=Kg.get(this._key);if(r&&0===n.length)return void(this._key!==t&&(this._atlas=r));const i=this._generateFontAtlas(this._key,n,r);this._atlas=i,Kg.set(this._key,i)}_generateFontAtlas(e,t,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=1024);const h=u.getContext("2d");Qg(h,r,o,i);const{mapping:d,canvasHeight:f,xOffset:p,yOffset:m}=function({characterSet:e,getFontWidth:t,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,c=s,u=0;for(const s of e)if(!o[s]){const e=t(s,u++);c+e+2*r>i&&(c=0,l++),o[s]={x:c+r,y:a+l*(n+2*r)+r,width:e,height:n},c+=e+2*r}const h=n+2*r;return{mapping:o,xOffset:c,yOffset:a+l*h,canvasHeight:(d=a+(l+1)*h,Math.pow(2,Math.ceil(Math.log2(d))))};var d}({getFontWidth:e=>h.measureText(e).width,fontHeight:1.2*o,buffer:s,characterSet:t,maxCanvasWidth:1024,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==f){const e=h.getImageData(0,0,u.width,u.height);u.height=f,h.putImageData(e,0,0)}if(Qg(h,r,o,i),a){const e=new(Bg())(o,s,l,c,r,i),n=h.getImageData(0,0,e.size,e.size);for(const r of t)Jg(e.draw(r),n),h.putImageData(n,d[r].x-s,d[r].y+s)}else for(const e of t)h.fillText(e,d[e].x,d[e].y+.9*o);return{xOffset:p,yOffset:m,mapping:d,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(e," ").concat(t," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(e," ").concat(t," ").concat(n," ").concat(r)}}const ty={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class ny extends rm{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[dm,mm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:e,oldProps:t,changeFlags:n}){if(super.updateState({props:e,oldProps:t,changeFlags:n}),n.extensionsChanged){var r;const{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:t,sizeScale:n,sizeUnits:r,sizeMinPixels:i,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),this.state.model.setUniforms(e).setUniforms({billboard:t,stroked:Boolean(s),padding:a,sizeUnits:Fs[r],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:o}).draw()}_getModel(e){return new Eh(e,{...this.getShaders(),id:this.props.id,geometry:new ym({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}ny.layerName="TextBackgroundLayer",ny.defaultProps=ty;const ry={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},iy={start:1,middle:0,end:-1},oy={top:1,center:0,bottom:-1},sy=[0,0,0,255],ay=["fontSize","buffer","sdf","radius","cutoff"],ly={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:sy},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:$g},fontFamily:Yg,fontWeight:Xg,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:sy},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:sy},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class cy extends im{initializeState(){this.state={styleVersion:0,fontAtlasManager:new ey}}updateState({props:e,oldProps:t,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText),i=this.state.characterSet;r&&this._updateText();const o=i!==this.state.characterSet||this._fontChanged(t,e);o&&this._updateFontAtlas(t,e),(o||e.lineHeight!==t.lineHeight||e.wordBreak!==t.wordBreak||e.maxWidth!==t.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(e,t){const{fontSettings:n,fontFamily:r,fontWeight:i}=t,{fontAtlasManager:o,characterSet:s}=this.state;o.setProps({...ry,...n,characterSet:s,fontFamily:r,fontWeight:i})}_fontChanged(e,t){if(e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight)return!0;if(e.fontSettings===t.fontSettings)return!1;const n=e.fontSettings||{},r=t.fontSettings||{};return ay.some((e=>n[e]!==r[e]))}_updateText(){const{data:e,characterSet:t}=this.props,n=e.attributes&&e.attributes.getText;let r,{getText:i}=this.props,{startIndices:o}=e;const s="auto"===t&&new Set;if(n&&o){const{texts:t,characterCount:a}=function({value:e,length:t,stride:n,offset:r,startIndices:i,characterSet:o}){const s=e.BYTES_PER_ELEMENT,a=n?n/s:1,l=r?r/s:0,c=i[t]||Math.ceil((e.length-l)/a),u=o&&new Set,h=new Array(t);let d=e;if(a>1||l>0){d=new e.constructor(c);for(let t=0;t<c;t++)d[t]=e[t*a+l]}for(let e=0;e<t;e++){const t=i[e],n=i[e+1]||c,r=d.subarray(t,n);h[e]=String.fromCodePoint.apply(null,r),u&&r.forEach(u.add,u)}if(u)for(const e of u)o.add(String.fromCodePoint(e));return{texts:h,characterCount:c}}({...ArrayBuffer.isView(n)?{value:n}:n,length:e.length,startIndices:o,characterSet:s});r=a,i=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=gc(e);o=[0],r=0;for(const e of t){n.index++;const t=Array.from(i(e,n)||"");s&&t.forEach(s.add,s),r+=t.length,o.push(r)}}this.setState({getText:i,startIndices:o,numInstances:r,characterSet:s||t})}getBoundingRect(e,t){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,c=r(e,t)||"",{size:[u,h]}=Gg(c,s,i,o,n);return[(iy["function"==typeof a?a(e,t):a]-1)*u/2,(oy["function"==typeof l?l(e,t):l]-1)*h/2,u,h]}getIconOffsets(e,t){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,c=r(e,t)||"",{x:u,y:h,rowWidth:d,size:[f,p]}=Gg(c,s,i,o,n),m=iy["function"==typeof a?a(e,t):a],g=oy["function"==typeof l?l(e,t):l],y=u.length,v=new Array(2*y);let b=0;for(let e=0;e<y;e++){const t=(1-m)*(f-d[e])/2;v[b++]=(m-1)*f/2+t+u[e],v[b++]=(g-1)*p/2+h[e]}return v}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:p,getBorderColor:m,getBorderWidth:g,backgroundPadding:y,background:v,billboard:b,fontSettings:w,outlineWidth:x,outlineColor:E,sizeScale:_,sizeUnits:S,sizeMinPixels:C,sizeMaxPixels:T,transitions:O,updateTriggers:P}=this.props,A=this.getSubLayerClass("characters",Fg),k=this.getSubLayerClass("background",ny);return[v&&new k({getFillColor:p,getLineColor:m,getLineWidth:g,padding:y,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:b,sizeScale:_/this.state.fontAtlasManager.props.fontSize,sizeUnits:S,sizeMinPixels:C,sizeMaxPixels:T,transitions:O&&{getPosition:O.getPosition,getAngle:O.getAngle,getSize:O.getSize,getFillColor:O.getBackgroundColor,getLineColor:O.getBorderColor,getLineWidth:O.getBorderWidth,getPixelOffset:O.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset,getBoundingRect:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes?{length:a.length,attributes:a.attributes.background||{}}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new A({sdf:w.sdf,smoothing:Number.isFinite(w.smoothing)?w.smoothing:ry.smoothing,outlineWidth:x,outlineColor:E,iconAtlas:i,iconMapping:o,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:b,sizeScale:_*r,sizeUnits:S,sizeMinPixels:C*r,sizeMaxPixels:T*r,transitions:O&&{getPosition:O.getPosition,getAngle:O.getAngle,getColor:O.getColor,getSize:O.getSize,getPixelOffset:O.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:P.getText,getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset,getIconOffsets:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets.bind(this),getIcon:n})]}}cy.layerName="TextLayer",cy.defaultProps=ly;class uy{constructor(e={}){const{attributes:t={}}=e;this.typedArrayManager=Il,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e),Object.seal(this)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,i&&(fc(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(s))for(const e of s)this._rebuildGeometry(e);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}normalizeGeometry(e){return e}updateGeometryAttributes(e,t,n){throw new Error("Not implemented")}getGeometrySize(e){throw new Error("Not implemented")}getGeometryFromBuffer(e){const t=e.value||e;return fc(ArrayBuffer.isView(t)),vc(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices})}_allocate(e,t){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=t,n[s]=o.allocate(n[s],e,r)}}_forEachGeometry(e,t,n){const{data:r,getGeometry:i}=this,{iterable:o,objectInfo:s}=gc(r,t,n);for(const t of o)s.index++,e(i(t,s),s.index)}_rebuildGeometry(e){if(!this.data||!this.getGeometry)return;let{indexStarts:t,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((e,t)=>{e=this.normalizeGeometry(e),l[t]=e,n[t+1]=n[t]+this.getGeometrySize(e)}),s,a),r=n[n.length-1];else if(o.buffer instanceof ol){const e=o.stride||4*this.positionSize;n=i.startIndices,r=n[i.length]||o.buffer.byteLength/e}else{const e=o.value||o,t=o.stride/e.BYTES_PER_ELEMENT||this.positionSize;n=i.startIndices,r=n[i.length]||e.length/t}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((e,i)=>{e=l[i]||e,c.vertexStart=n[i],c.indexStart=t[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(e,c)}),s,a),this.vertexCount=t[t.length-1]}}function hy(e,t,n={}){const r=function(e,t={}){return Math.sign(function(e,t={}){const{start:n=0,end:r=e.length}=t,i=t.size||2;let o=0;for(let t=n,s=r-i;t<r;t+=i)o+=(e[t]-e[s])*(e[t+1]+e[s+1]),s=t;return o/2}(e,t))}(e,n);return r!==t&&(function(e,t){const{start:n=0,end:r=e.length,size:i=2}=t,o=(r-n)/i,s=Math.floor(o/2);for(let t=0;t<s;++t){const r=n+t*i,s=n+(o-1-t)*i;for(let t=0;t<i;++t){const n=e[r+t];e[r+t]=e[s+t],e[s+t]=n}}}(e,n),!0)}function dy(e,t,n,r,i=[]){let o,s;if(8&n)o=(r[3]-e[1])/(t[1]-e[1]),s=3;else if(4&n)o=(r[1]-e[1])/(t[1]-e[1]),s=1;else if(2&n)o=(r[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&n))return null;o=(r[0]-e[0])/(t[0]-e[0]),s=0}for(let n=0;n<e.length;n++)i[n]=(1&s)===n?r[s]:o*(t[n]-e[n])+e[n];return i}function fy(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function py(e,t){const n=t.length,r=e.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(e[r-n+o]!==t[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)e[r+i]=t[i];return!0}function my(e,t){const n=t.length;for(let r=0;r<n;r++)e[r]=t[r]}function gy(e,t,n,r,i=[]){const o=r+t*n;for(let t=0;t<n;t++)i[t]=e[o+t];return i}function yy(e,t={}){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=e.length}=t,l=(a-s)/n;let c=[];const u=[c],h=gy(e,0,n,s);let d,f;const p=xy(h,i,o,[]),m=[];py(c,h);for(let t=1;t<l;t++){for(d=gy(e,t,n,s,d),f=fy(d,p);f;){dy(h,d,f,p,m);const e=fy(m,p);e&&(dy(h,m,e,p,m),f=e),py(c,m),my(h,m),Ey(p,i,f),r&&c.length>n&&(c=[],u.push(c),py(c,h)),f=fy(d,p)}py(c,d),my(h,d)}return r?u:u[0]}function vy(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function by(e,t,n={}){if(!e.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n,a=[],l=[{pos:e,types:s&&new Array(e.length/r).fill(1),holes:t||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();_y(e,r,n[0]||e.length,c),u=xy(c[0],i,o,u);const h=fy(c[1],u);if(h){let i=wy(e,t,r,0,n[0]||e.length,u,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)i=wy(e,t,r,n[l],n[l+1]||e.length,u,h),i[0]&&(o.holes.push(o.pos.length),o.pos=vy(o.pos,i[0].pos),s&&(o.types=vy(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=vy(a.pos,i[1].pos),s&&(a.types=vy(a.types,i[1].types)))}else{const r={positions:e};s&&(r.edgeTypes=t),n.length&&(r.holeIndices=n),a.push(r)}}return a}function wy(e,t,n,r,i,o,s){const a=(i-r)/n,l=[],c=[],u=[],h=[],d=[];let f,p,m;const g=gy(e,a-1,n,r);let y=Math.sign(8&s?g[1]-o[3]:g[0]-o[2]),v=t&&t[a-1],b=0,w=0;for(let i=0;i<a;i++)f=gy(e,i,n,r,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),m=t&&t[r/n+i],p&&y&&y!==p&&(dy(g,f,s,o,d),py(l,d)&&u.push(v),py(c,d)&&h.push(v)),p<=0?(py(l,f)&&u.push(m),b-=p):u.length&&(u[u.length-1]=0),p>=0?(py(c,f)&&h.push(m),w+=p):h.length&&(h[h.length-1]=0),my(g,f),y=p,v=m;return[b?{pos:l,types:t&&u}:null,w?{pos:c,types:t&&h}:null]}function xy(e,t,n,r){const i=Math.floor((e[0]-n[0])/t)*t+n[0],o=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=i,r[1]=o,r[2]=i+t,r[3]=o+t,r}function Ey(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function _y(e,t,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<n;r+=t){const t=e[r],n=e[r+1];i=t<i?t:i,o=t>o?t:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function Sy(e,t,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=t){const t=Math.abs(e[s]);t>i&&(i=t,o=s-1)}return o}function Cy(e,t,n,r,i=85.051129){const o=e[n],s=e[r-t];if(Math.abs(o-s)>180){const r=gy(e,0,t,n);r[0]+=360*Math.round((s-o)/360),py(e,r),r[1]=Math.sign(r[1])*i,py(e,r),r[0]=o,py(e,r)}}function Ty(e,t,n,r){let i,o=e[0];for(let s=n;s<r;s+=t){i=e[s];const t=i-o;(t>180||t<-180)&&(i-=360*Math.round(t/360)),e[s]=o=i}}function Oy(e,t){let n;const r=e.length/t;for(let i=0;i<r&&(n=e[i*t],(n+180)%360==0);i++);const i=360*-Math.round(n/360);if(0!==i)for(let n=0;n<r;n++)e[n*t]+=i}class Py extends uy{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):()=>null}normalizeGeometry(e){return this.normalize?function(e,t,n,r){let i=e;if(Array.isArray(e[0])){const n=e.length*t;i=new Array(n);for(let n=0;n<e.length;n++)for(let r=0;r<t;r++)i[n*t+r]=e[n][r]||0}return n?yy(i,{size:t,gridResolution:n}):r?function(e,t={}){const{size:n=2,startIndex:r=0,endIndex:i=e.length,normalize:o=!0}=t,s=e.slice(r,i);Ty(s,n,0,i-r);const a=yy(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const e of a)Oy(e,n);return a}(i,{size:t}):i}(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}get(e){return this.attributes[e]}getGeometrySize(e){if(Array.isArray(e[0])){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&Array.isArray(e[0]))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const{segmentTypes:n}=this.attributes,r=this.isClosed(e),{vertexStart:i,geometrySize:o}=t;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:r,geometrySize:i}=t,o=new Array(3);for(let t=r,s=0;s<i;t++,s++)this.getPointOnPath(e,s,o),n[3*t]=o[0],n[3*t+1]=o[1],n[3*t+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,n=[]){const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const i=t*r;return n[0]=e[i],n[1]=e[i+1],n[2]=3===r&&e[i+2]||0,n}isClosed(e){if(!this.normalize)return this.opts.loop;const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}const Ay=[0,0,0,255],ky={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:Ay},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},My={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class Ny extends rm{getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[dm,mm]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:My,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:My,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:My,defaultValue:Ay},instancePickingColors:{size:3,type:5121,accessor:(e,{index:t,target:n})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,n)}}),this.setState({pathTesselator:new Py({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&Is.removed("getDashArray","PathStyleExtension")()}updateState({oldProps:e,props:t,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:i.getPath,buffers:i,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var i;const{gl:e}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(e),r.invalidateAll()}}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,{data:r}=this.props;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:n,billboard:r,miterLimit:i,widthUnits:o,widthScale:s,widthMinPixels:a,widthMaxPixels:l}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(t),capType:Number(n),billboard:r,widthUnits:Fs[o],widthScale:s,miterLimit:i,widthMinPixels:a,widthMaxPixels:l}).draw()}_getModel(e){return new Eh(e,{...this.getShaders(),id:this.props.id,geometry:new ym({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}Ny.layerName="PathLayer",Ny.defaultProps=ky;var Ly="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";const Ry={lightSources:{}};function Iy({color:e=[0,0,0],intensity:t=1}={}){return e.map((e=>e*t/255))}const Dy={name:"lights",vs:Ly,fs:Ly,getUniforms:function e(t=Ry){if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:e,pointLights:t=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=e?Iy(e):[0,0,0],t.forEach(((e,t)=>{r[`lighting_uPointLight[${t}].color`]=Iy(e),r[`lighting_uPointLight[${t}].position`]=e.position,r[`lighting_uPointLight[${t}].attenuation`]=e.attenuation||[1,0,0]})),r.lighting_uPointLightCount=t.length,n.forEach(((e,t)=>{r[`lighting_uDirectionalLight[${t}].color`]=Iy(e),r[`lighting_uDirectionalLight[${t}].direction`]=e.direction})),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const n={pointLights:[],directionalLights:[]};for(const e of t.lights||[])switch(e.type){case"ambient":n.ambientLight=e;break;case"directional":n.directionalLights.push(e);break;case"point":n.pointLights.push(e)}return e({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}};const jy={};const Fy={name:"gouraud-lighting",dependencies:[Dy],vs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_VERTEX:1},getUniforms:function(e=jy){if(!("material"in e))return{};const{material:t}=e;return t?function(e){const{ambient:t=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((e=>e/255))}}(t):{lighting_uEnabled:!1}}};var zy=n(1106),By=n.n(zy);const Uy={isClosed:!0};function Vy(e,t,n,r,i){let o=t;const s=n.length;for(let t=0;t<s;t++)for(let i=0;i<r;i++)e[o++]=n[t][i]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let t=0;t<r;t++)e[o++]=n[0][t]||0;return Uy.start=t,Uy.end=o,Uy.size=r,hy(e,i,Uy),o}function Hy(e,t,n,r,i=0,o,s){const a=(o=o||n.length)-i;if(a<=0)return t;let l=t;for(let t=0;t<a;t++)e[l++]=n[i+t];if(!function(e,t,n,r){for(let i=0;i<t;i++)if(e[n+i]!==e[r-t+i])return!1;return!0}(n,r,i,o))for(let t=0;t<r;t++)e[l++]=n[i+t];return Uy.start=t,Uy.end=l,Uy.size=r,hy(e,s,Uy),l}class qy extends uy{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;t&&(this.vertexCount=(t.value||t).length)}normalizeGeometry(e){if(this.normalize){if(e=function(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],r=[];if(e.positions){const{positions:i,holeIndices:o}=e;if(o){let e=0;for(let s=0;s<=o.length;s++)e=Hy(n,e,i,t,o[s-1],o[s],0===s?1:-1),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=i}if(Number.isFinite(e[0]))return Hy(n,0,e,t,0,n.length,1),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let i=0;for(const[o,s]of e.entries())i=Vy(n,i,s,t,0===o?1:-1),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return Vy(n,0,e,t,1),n}(e,this.positionSize),this.opts.resolution)return by(e.positions||e,e.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return function(e,t,n={}){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n;t=t||[];const s=[],a=[];let l=0,c=0;for(let i=0;i<=t.length;i++){const o=t[i]||e.length,u=c,h=Sy(e,r,l,o);for(let t=h;t<o;t++)s[c++]=e[t];for(let t=l;t<h;t++)s[c++]=e[t];Ty(s,r,u,c),Cy(s,r,u,c,n.maxLatitude),l=o,a[i]=c}a.pop();const u=by(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const e of u)Oy(e.positions,r);return u}(e.positions||e,e.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return e}getGeometrySize(e){if(Array.isArray(e)&&!Number.isFinite(e[0])){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return(e.positions||e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):()=>null}updateGeometryAttributes(e,t){if(Array.isArray(e)&&!Number.isFinite(e[0]))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(e,{geometryIndex:t,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a)return;let l=r;const c=function(e,t,n){let r=null;e.holeIndices&&(r=e.holeIndices.map((e=>e/t)));let i=e.positions||e;if(n){const e=i.length;i=i.slice();const r=[];for(let o=0;o<e;o+=t){r[0]=i[o],r[1]=i[o+1];const e=n(r);i[o]=e[0],i[o+1]=e[1]}}return By()(i,r,t)}(e,this.positionSize,this.opts.preproject);a=s.allocate(a,r+c.length,{copy:!0});for(let e=0;e<c.length;e++)a[l++]=c[e]+n;o[t+1]=r+c.length,i.indices=a}_updatePositions(e,{vertexStart:t,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r)return;const o=e.positions||e;for(let e=t,s=0;s<n;e++,s++){const t=o[s*i],n=o[s*i+1],a=i>2?o[s*i+2]:0;r[3*e]=t,r[3*e+1]=n,r[3*e+2]=a}}_updateVertexValid(e,{vertexStart:t,geometrySize:n}){const{attributes:{vertexValid:r},positionSize:i}=this,o=e&&e.holeIndices;if(e&&e.edgeTypes?r.set(e.edgeTypes,t):r.fill(1,t,t+n),o)for(let e=0;e<o.length;e++)r[t+o[e]/i-1]=0;r[t+n-1]=0}}var Wy="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Gy="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(Wy,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),$y="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(Wy,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");const Yy=[0,0,0,255],Xy={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Yy},getLineColor:{type:"accessor",value:Yy},material:!0},Ky={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class Zy extends rm{getShaders(e){return super.getShaders({vs:"top"===e?Gy:$y,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[dm,Fy,mm]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:t}=this.context;let{coordinateSystem:n}=this.props;t.isGeospatial&&n===Ds.DEFAULT&&(n=Ds.LNGLAT),this.setState({numInstances:0,polygonTesselator:new qy({preproject:n===Ds.LNGLAT&&t.projectFlat,fp64:this.use64bitPositions(),IndexType:!e||Nl(e,kl)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),i=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ky,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,transition:Ky,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ky,accessor:"getFillColor",defaultValue:Yy,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ky,accessor:"getLineColor",defaultValue:Yy,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(e,{index:t,target:n})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,{data:r}=this.props;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,l={...e,extruded:Boolean(t),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(l),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(l).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager();var o;(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((e=>e.delete())),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:t,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new Eh(e,{...n,id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new Eh(e,{...this.getShaders("side"),id:"".concat(t,"-side"),geometry:new ym({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Zy.layerName="SolidPolygonLayer",Zy.defaultProps=Xy;const Jy={circle:{type:Dg,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Lg,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:cy,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Qy={type:Ny,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},ev={type:Zy,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function tv({type:e,props:t}){const n={};for(const r in t)n[r]=e.defaultProps[t[r]];return n}function nv(e,t){const{transitions:n,updateTriggers:r}=e.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in t){const s=t[o];let a=e.props[o];o.startsWith("get")&&(a=e.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function rv(e,t,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=e.length}=n;for(let n=i;n<o;n++){const i=e[n];Is.assert(i&&i.geometry,"GeoJSON does not have geometry");const{geometry:o}=i;if("GeometryCollection"===o.type){Is.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:e}=o;for(let o=0;o<e.length;o++)iv(e[o],r,t,i,n)}else iv(o,r,t,i,n)}return r}function iv(e,t,n,r,i){const{type:o,coordinates:s}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(function(e,t){let n=ov[e];for(Is.assert(n,"Unknown GeoJSON type ".concat(e));t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(o,s))switch(o){case"Point":a.push(n({geometry:e},r,i));break;case"MultiPoint":s.forEach((e=>{a.push(n({geometry:{type:"Point",coordinates:e}},r,i))}));break;case"LineString":l.push(n({geometry:e},r,i));break;case"MultiLineString":s.forEach((e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"Polygon":c.push(n({geometry:e},r,i)),s.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"MultiPolygon":s.forEach((e=>{c.push(n({geometry:{type:"Polygon",coordinates:e}},r,i)),e.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}))}))}else Is.warn("".concat(o," coordinates are malformed"))()}const ov={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function sv(e){return e.geometry.coordinates}const av={...tv(Jy.circle),...tv(Jy.icon),...tv(Jy.text),...tv(Qy),...tv(ev),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class lv extends im{initializeState(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&Is.removed("getLineDashArray","PathStyleExtension")()}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const n=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:o}=e,s=function(e,t){const n={points:null,lines:null,polygons:null};for(const r in n){const i=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let e=0;e<i.length;e++)t(i[e],o),n[r][3*e+0]=o[0],n[r][3*e+1]=o[1],n[r][3*e+2]=o[2]}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(e.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:e,changeFlags:t}){const n=function(e){if(Array.isArray(e))return e;switch(Is.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return Is.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(e.data),r=this.getSubLayerRow.bind(this);let i={};const o={};if(Array.isArray(t.dataChanged)){const e=this.state.features;for(const t in e)i[t]=e[t].slice(),o[t]=[];for(const s of t.dataChanged){const t=rv(n,r,s);for(const n in e)o[n].push(om({data:i[n],getIndex:e=>e.__source.index,dataRange:s,replace:t[n]}))}}else i=rv(n,r);const s=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=e;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=sv,n.lines.data=i,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=sv,n.polygons.data=o,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=sv,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=sv,n}(i,o);this.setState({features:i,featuresDiff:o,layerProps:s})}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),n=e.sourceLayer.id.startsWith(t);for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,ev.type);if(i){const o=nv(this,ev.props),s=e&&t;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!e&&t&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,Qy.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,Qy.type);if(o||s){const e=nv(this,Qy.props);return[o&&new o(e,this.getSubLayerProps({id:r,updateTriggers:e.updateTriggers}),n.polygonsOutline),s&&new s(e,this.getSubLayerProps({id:i,updateTriggers:e.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex((e=>e.__source.index===r)));const i=new Set(e.split("+")),o=[];for(const e of i){const n="points-".concat(e),i=Jy[e],s=i&&this.shouldRenderSubLayer(n,t.points.data)&&this.getSubLayerClass(n,i.type);if(s){const e=nv(this,i.props);o.push(new s(e,this.getSubLayerProps({id:n,updateTriggers:e.updateTriggers,highlightedObjectIndex:r}),t.points))}}return o}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"==typeof e?(t,n)=>{const{data:r,index:i}=n,o=function(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){const r={properties:{...e.properties[t]}};for(const t in e.numericProps)r.properties[t]=e.numericProps[t].value[n];return r}(e,r,n):null}(r,i);return e(o,n)}:super.getSubLayerAccessor(e)}}lv.layerName="GeoJsonLayer",lv.defaultProps=av;let cv=1,uv=1;class hv{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,o=cv++,s={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const e of t)this._setChannelTime(e,this.time);const n=this.animations.values();for(const e of n){const{animation:t,channel:n}=e;t.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=uv++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}class dv{constructor(e,t,n){this.id=e,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"==typeof e&&(r=Zp(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=e)})).catch((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)}))):(this.isLoaded=!0,this._error=null,this._content=e);for(const e of this._subscribers)e.onChange(this.getData())}}class fv{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[e];i?i.setData(t,n):(i=new dv(e,t,this._context),this._resources[e]=i),i.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const e in t){const n=t[e];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;e.startsWith(o)&&(i[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const s=i[e];if(this._track(n,r,s,t),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const i=this._consumers,o=i[e]=i[e]||{},s=o[t]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[t]=s,s.onChange=r,s.resource=n,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const pv=[hm],mv=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function gv(e){const t=oh.getDefaultProgramManager(e);for(const e of pv)t.addDefaultModule(e);for(const e of mv)t.addShaderHook(e);return t}const yv=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class vv{constructor(e,{deck:t,stats:n,viewport:r,timeline:i}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new fv({gl:e,protocol:"deck://"}),this.context={...yv,layerManager:this,gl:e,deck:t,programManager:e&&gv(e),stats:n||new Da({id:"deck.gl"}),viewport:r||new Qd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new hv,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter((t=>e.find((e=>0===t.id.indexOf(e))))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Rc("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=bc(e,Boolean);for(const t of e)t.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return Rc("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const t of e)n[t.id]?Is.warn("Multiple old layers with same id ".concat(t.id))():n[t.id]=t;const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let i=!1;for(const e of r)if(e.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(e,t,n){for(const r of e){r.context=this.context;const e=t[r.id];null===e&&Is.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let i=null;try{this._debug&&e!==r&&r.validateProps(),e?(this._transferLayerState(e,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),i=r.isComposite&&r.getSubLayers()}catch(e){this._handleError("matching",e,r)}i&&this._updateSublayersRecursively(i,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}function bv(e,t){if(e===t)return!0;if(!e||!t)return!1;for(const n in e){const r=e[n],i=t[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&bv(r,i)))return!1}return!0}class wv{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter((t=>t.containsPixel(e))):this._viewports}getViews(){const e={};return this.views.forEach((t=>{e[t.id]=t})),e}getView(e){return"string"==typeof e?this.views.find((t=>t.id===e)):e}getViewState(e){const t=this.getView(e),n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=e.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=bc(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!bv(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Is.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>e._getViewport(t,{width:t.width,height:t.height}),...t})}_updateController(e,t,n,r){let i=e.controller;return i?(i={...t,...e.props,...i,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(e,i),r):null}_rebuildViewports(){const{width:e,height:t,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=n.length;o--;){const s=n[o],a=this.getViewState(s),l=s.makeViewport({width:e,height:t,viewState:a});let c=r[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,l,c),this._viewports.unshift(l)}for(const e in r)r[e]&&!this.controllers[e]&&r[e].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)}))}_diffViews(e,t){return e.length!==t.length||e.some(((n,r)=>!e[r].equals(t[r])))}}const xv=/([0-9]+\.?[0-9]*)(%|px)/;function Ev(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=e.match(xv);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function _v(e,t){return e.relative?Math.round(e.position*t):e.position}class Sv{constructor(e={}){const{id:t=null,x:n=0,y:r=0,width:i="100%",height:o="100%",viewportInstance:s,type:a=Qd}=e;fc(!s||s instanceof Qd),this.viewportInstance=s,this.id=t||this.constructor.displayName||"view",this.type=a,this.props={...e,id:this.id},this._parseDimensions({x:n,y:r,width:i,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):bv(this.props,e.props))}makeViewport({width:e,height:t,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:e,height:t});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions({width:e,height:t}){return{x:_v(this._x,e),y:_v(this._y,t),width:_v(this._width,e),height:_v(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),{...e,...t}):null}_getViewport(e,t){const{type:n}=this;return new n({...e,...this.props,...t})}_parseDimensions({x:e,y:t,width:n,height:r}){this._x=Ev(e),this._y=Ev(t),this._width=Ev(n),this._height=Ev(r)}}const Cv=()=>{},Tv={transitionEasing:e=>e,transitionInterruption:1,onTransitionStart:Cv,onTransitionInterrupt:Cv,onTransitionEnd:Cv};class Ov{constructor(e,t={}){this.ControllerState=e,this.props={...Tv,...t},this.propsInTransition=null,this.transition=new Th(t.timeline),this.onViewStateChange=t.onViewStateChange||Cv,this.onStateChange=t.onStateChange||Cv,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(e={...Tv,...e},this.props=e,this._shouldIgnoreViewportChange(n,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:i}=this.transition.settings,o={...n,...2===r?i:this.propsInTransition||n};this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(n),{transitionInterpolator:i}=t,o=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0===o)return;const s=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:s.start,endProps:s.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=e,a=s(t/o),l=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}class Pv{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare||Object.keys(t))if(!(n in e)||!(n in t)||!Ul(e[n],t[n]))return!1;return!0}initializeProps(e,t){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=e[n],i[n]=t[n];n={start:r,end:i}}else n={start:e,end:t};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(e,t,n){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach((t=>{const n=e[t];fc(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))}))}}const Av=["longitude","latitude","zoom","bearing","pitch"],kv=["longitude","latitude","zoom"];class Mv extends Pv{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:Av,extract:Av,required:kv}),this.opts=e}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(e),s=r(t),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=Bl(e[i]||0,t[i]||0,n);if(t.aroundPosition){const i=this.opts.makeViewport({...t,...r});Object.assign(r,i.panByPosition(t.aroundPosition,Bl(e.around,t.around,n)))}return r}}const Nv={transitionDuration:0},Lv={transitionDuration:300,transitionEasing:e=>e,transitionInterruption:1},Rv=e=>1-(1-e)*(1-e),Iv=["wheel"],Dv=["panstart","panmove","panend"],jv=["pinchstart","pinchmove","pinchend"],Fv=["tripanstart","tripanmove","tripanend"],zv=["doubletap"],Bv=["keydown"];class Uv extends class{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}{constructor({makeViewport:e,width:t,height:n,latitude:r,longitude:i,zoom:o,bearing:s=0,pitch:a=0,altitude:l=1.5,maxZoom:c=20,minZoom:u=0,maxPitch:h=60,minPitch:d=0,startPanLngLat:f,startZoomLngLat:p,startRotatePos:m,startBearing:g,startPitch:y,startZoom:v,normalize:b}={}){fc(Number.isFinite(i)),fc(Number.isFinite(r)),fc(Number.isFinite(o)),super({width:t,height:n,latitude:r,longitude:i,zoom:o,bearing:s,pitch:a,altitude:l,maxZoom:c,minZoom:u,maxPitch:h,minPitch:d,normalize:b}),this._state={startPanLngLat:f,startZoomLngLat:p,startRotatePos:m,startBearing:g,startPitch:y,startZoom:v},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const n=this._state.startPanLngLat||this._unproject(t);if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=e?this._calculateNewPitchAndBearing({...this._getRotationParams(e,r),startBearing:i,startPitch:o}):{bearing:i+t,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(e){const{width:t,height:n}=this._viewportProps;return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this._viewportProps;return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...e})}_applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=zl(r,n,t);const{maxPitch:i,minPitch:o,pitch:s}=e;e.pitch=zl(s,o,i);const{normalize:a=!0}=e;return a&&Object.assign(e,function({width:e,height:t,longitude:n,latitude:r,zoom:i,pitch:o=0,bearing:s=0}){(n<-180||n>180)&&(n=md(n+180,360)-180),(s<-180||s>180)&&(s=md(s+180,360)-180);const a=gd(t/512);if(i<=a)i=a,r=0;else{const e=t/2/Math.pow(2,i),n=Nd([0,e])[1];if(r<n)r=n;else{const t=Nd([0,512-e])[1];r>t&&(r=t)}}return{width:e,height:t,longitude:n,latitude:r,zoom:i,pitch:o,bearing:s}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:n,minZoom:r}=this._viewportProps;return zl(t+Math.log2(e),r,n)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:n,startPitch:r}){t=zl(t,-1,1);const{minPitch:i,maxPitch:o}=this._viewportProps;let s=r;return t>0?s=r+t*(o-r):t<0&&(s=r-t*(i-r)),{pitch:s,bearing:n+180*e}}_getRotationParams(e,t){const n=e[0]-t[0],r=e[1]-t[1],i=e[1],o=t[1],{width:s,height:a}=this._viewportProps,l=n/s;let c=0;return r>0?Math.abs(a-o)>5&&(c=r/(o-a)*1.2):r<0&&o>5&&(c=1-i/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:l,deltaScaleY:c}}}class Vv extends class{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Ov(e,{...t,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...Lv,transitionInterpolator:new Mv({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(e.type){case"panstart":return!n&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!n&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!n&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:n}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout((()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)}),e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(Iv,c&&n),this.toggleEvents(Dv,c&&(r||i)),this.toggleEvents(jv,c&&(s||a)),this.toggleEvents(Fv,c&&a),this.toggleEvents(zv,c&&o),this.toggleEvents(Bv,c&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach((e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))}))}updateViewport(e,t={},n={}){const r={...e.getViewportProps(),...t},i=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(n),i){const e=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,Nv,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,Nv,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Rv},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Nv,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Rv},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=e;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:t}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,Nv,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Nv,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Rv},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(n,Nv,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(t,Nv,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:n}=this;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let i=this.controllerState.rotateEnd();const o=Math.log2(e.scale),s=(o-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,o+s*t/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:Rv},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=s.rotateLeft(i),l.isRotating=!0):(a=s.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=s.rotateRight(i),l.isRotating=!0):(a=s.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?{...t,transitionInterpolator:new Mv({...e,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:t:Nv}}{constructor(e){e.dragMode=e.dragMode||"pan",super(Uv,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}class Hv extends Sv{constructor(e){super({...e,type:rf})}get controller(){return this._getControllerProps({type:Vv})}}Hv.displayName="MapView";const qv=[255,255,255],Wv=1;let Gv=0;class $v{constructor(e={}){const{color:t=qv}=e,{intensity:n=Wv}=e;this.id=e.id||"ambient-".concat(Gv++),this.color=t,this.intensity=n,this.type="ambient"}}const Yv=[255,255,255],Xv=1,Kv=[0,0,-1];let Zv=0;class Jv{constructor(e={}){const{color:t=Yv}=e,{intensity:n=Xv}=e,{direction:r=Kv}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-".concat(Zv++),this.color=t,this.intensity=n,this.type="directional",this.direction=new sc(r).normalize().toArray(),this.shadow=i}getProjectedLight(){return this}}class Qv{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props={...e}}preRender(){}getModuleParameters(){}cleanup(){}}class eb extends class{constructor(e,t={}){const{id:n="pass"}=t;this.id=n,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return _a(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:n,onViewportActive:r,clearCanvas:i=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;i&&function(e){_a(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),e.clear(16640)}(o);const s=[];for(const i of t){const t=i.viewport||i,a=n&&n[t.id];r(t);const l=this._getDrawLayerParams(t,e);e.view=a;const c=t.subViewports||[t];for(const t of c){e.viewport=t;const n=this._drawLayersInViewport(o,e,l);s.push(n)}}return s}_getDrawLayerParams(e,{layers:t,pass:n,layerFilter:r,effects:i,moduleParameters:o}){const s=[],a=tb(),l={viewport:e,isPicking:n.startsWith("picking"),renderPass:n},c={};for(let u=0;u<t.length;u++){const h=t[u],d=this._shouldDrawLayer(h,l,r,c),f={shouldDrawLayer:d,layerRenderIndex:a(h,d)};d&&(f.moduleParameters=this._getModuleParameters(h,i,n,o),f.layerParameters=this.getLayerParameters(h,u,e)),s[u]=f}return s}_drawLayersInViewport(e,{layers:t,pass:n,viewport:r,view:i},o){const s=function(e,{viewport:t}){const n=e.canvas?e.canvas.clientHeight||e.canvas.height:100,r=t,i=Ca(e);return[r.x*i,(n-r.y-r.height)*i,r.width*i,r.height*i]}(e,{viewport:r});if(i&&i.props.clear){const t=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;Sa(e,{scissorTest:!0,scissor:s},(()=>vl(e,t)))}const a={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};_a(e,{viewport:s});for(let e=0;e<t.length;e++){const i=t[e],{shouldDrawLayer:s,layerRenderIndex:l,moduleParameters:c,layerParameters:u}=o[e];if(s&&i.props.pickable&&a.pickableCount++,i.isComposite)a.compositeCount++;else if(s){a.visibleCount++,c.viewport=r;try{i.drawLayer({moduleParameters:c,uniforms:{layerIndex:l},parameters:u})}catch(e){i.raiseError(e,"drawing ".concat(i," to ").concat(n))}}}return a}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!this.shouldDrawLayer(e)||!e.props.visible)return!1;t.layer=e;let i=e.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(t))return!1;t.layer=i,i=i.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,n,r){const i=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ca(this.gl)});if(t)for(const n of t)Object.assign(i,n.getModuleParameters(e));return Object.assign(i,this.getModuleParameters(e,t),r)}}function tb(e=0,t={}){const n={},r=(i,o)=>{const s=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in t)&&r(i.parent,!1),l in n){const e=n[l]=n[l]||tb(t[l],t);c=e(i,o),n[a]=e}else Number.isFinite(s)?(c=s+(t[l]||0),n[a]=null):c=e;return o&&c>=e&&(e=c+1),t[a]=c,c};return r}class nb extends eb{constructor(e,t){super(e,t),this.shadowMap=new fl(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new gl(e,{format:33189,width:1,height:1}),this.fbo=new Pl(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;Sa(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=e.viewports[0],r=Ca(this.gl),i=n.width*r,o=n.height*r;i===t.width&&o===t.height||t.resize({width:i,height:o}),super.render({...e,target:t,pass:"shadow"})}))}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const rb=Wh((function({viewport:e,center:t}){return new hd(e.viewProjectionMatrix).invert().transform(t)})),ib=Wh((function({viewport:e,shadowMatrices:t}){const n=[],r=e.pixelUnprojectionMatrix,i=e.isGeospatial?void 0:1,o=[[0,0,i],[e.width,0,i],[0,e.height,i],[e.width,e.height,i],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map((e=>function(e,t){const[n,r,i]=e,o=Bd([n,r,i],t);return Number.isFinite(i)?o:[o[0],o[1],0]}(e,r)));for(const r of t){const t=r.clone().translate(new sc(e.center).negate()),i=o.map((e=>t.transform(e))),s=(new hd).ortho({left:Math.min(...i.map((e=>e[0]))),right:Math.max(...i.map((e=>e[0]))),bottom:Math.min(...i.map((e=>e[1]))),top:Math.max(...i.map((e=>e[1]))),near:Math.min(...i.map((e=>-e[2]))),far:Math.max(...i.map((e=>-e[2])))});n.push(s.multiplyRight(r))}return n})),ob=[0,0,0,1],sb=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];var ab={name:"shadow",dependencies:[hm],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(e={},t={})=>{if(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0){const{shadowEnabled:n=!0}=e;return n&&e.shadowMatrices&&e.shadowMatrices.length>0?function(e={},t={}){const n={shadow_uDrawShadowMap:Boolean(e.drawToShadowMap),shadow_uUseShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,shadow_uColor:e.shadowColor||ob,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},r=rb({viewport:e.viewport,center:t.project_uCenter}),i=[],o=ib({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let n=0;n<e.shadowMatrices.length;n++){const s=o[n],a=s.clone().translate(new sc(e.viewport.center).negate());t.project_uCoordinateSystem===Ds.LNGLAT&&t.project_uProjectionMode===js.WEB_MERCATOR?(o[n]=a,i[n]=r):(o[n]=s.clone().multiplyRight(sb),i[n]=a.transform(r))}for(let t=0;t<o.length;t++)n["shadow_uViewProjectionMatrices[".concat(t,"]")]=o[t],n["shadow_uProjectCenters[".concat(t,"]")]=i[t],e.shadowMaps&&e.shadowMaps.length>0?n["shadow_uShadowMap".concat(t)]=e.shadowMaps[t]:n["shadow_uShadowMap".concat(t)]=e.dummyShadowMap;return n}(e,t):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}};const lb={color:[255,255,255],intensity:1},cb=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ub=[0,0,0,200/255];class hb extends Qv{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=ub,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((e=>e.shadow))}preRender(e,{layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=oh.getDefaultProgramManager(e),ab&&this.programManager.addDefaultModule(ab)),this.dummyShadowMap||(this.dummyShadowMap=new fl(e,{width:1,height:1}));for(let e=0;e<this.shadowPasses.length;e++)this.shadowPasses[e].render({layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:o,moduleParameters:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((t=>t.getProjectedLight({layer:e}))),pointLights:this.pointLights.map((t=>t.getProjectedLight({layer:e})))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(ab),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const n=(new hd).lookAt({eye:new sc(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new nb(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new $v(lb),this.directionalLights.push(new Jv(cb[0]),new Jv(cb[1])))}}const db=new hb;class fb{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length===this.effects.length&&bv(e.effects,this.effects)||(this.setEffects(e.effects),this._needsRedraw="effects changed"))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some((e=>e instanceof hb))||this._internalEffects.push(db)}}class pb extends eb{}const mb={blendFunc:[1,0,32771,0],blendEquation:32774};class gb extends eb{render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:i,pickingFBO:o,deviceRect:{x:s,y:a,width:l,height:c},pass:u="picking",redrawReason:h,pickZ:d}){const f=this.gl;this.pickZ=d;const p=!d&&{byLayer:new Map,byAlpha:[]};this._colors=p;const m=Sa(f,{scissorTest:!0,scissor:[s,a,l,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...mb,blend:!d},(()=>super.render({target:o,layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:i,pass:u,redrawReason:h})));return this._colors=null,{decodePickingColor:p&&yb.bind(null,p),stats:m}}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,n){const r={...e.props.parameters};return this.pickZ?r.blend=!1:(Object.assign(r,mb),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let o;if(r.has(t)){const e=r.get(t);e.viewports.push(n),o=e.a}else if(o=r.size+1,o<=255){const e={a:o,layer:t,viewports:[n]};r.set(t,e),i[o]=e}else Is.warn("Too many pickable layers, only picking the first 255")(),o=0;return[0,0,0,o/255]}(this._colors,e,n)),r}}function yb(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class vb{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new pb(e),this.pickLayersPass=new gb(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||Pl.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const n=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render({...e,target:n});this._postRender(e.effects,e),this.renderCount++,Rc("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let n=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Pl(this.gl),new Pl(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of e)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=t.target,i.postRender(this.gl,r);break}const e=i.postRender(this.gl,r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const bb={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function wb({pickedColors:e,decodePickingColor:t,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){if(e){const{x:s,y:a,width:l,height:c}=o;let u=i*i,h=-1,d=0;for(let t=0;t<c;t++){const i=t+a-r,o=i*i;if(o>u)d+=4*l;else for(let t=0;t<l;t++){if(e[d+3]-1>=0){const e=t+s-n,r=e*e+o;r<=u&&(u=r,h=d)}d+=4}}if(h>=0){const n=e.slice(h,h+4),r=t(n);if(r){const e=Math.floor(h/4/l),t=h/4-e*l;return{...r,pickedColor:n,pickedX:s+t,pickedY:a+e}}Is.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return bb}function xb({pickInfo:e,viewports:t,pixelRatio:n,x:r,y:i,z:o}){let s=t[0];t.length>1&&(s=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}((null==e?void 0:e.pickedViewports)||t,{x:r,y:i}));const a=s&&s.unproject([r-s.x,i-s.y],{targetZ:o});return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:null,pixelRatio:n}}function Eb(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:i}=e,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=t,l=s?[s]:[];if("hover"===r){const e=n.index,t=n.layerId,r=s&&s.props.id;if(r!==t||a!==e){if(r!==t){const e=i.find((e=>e.props.id===t));e&&l.unshift(e)}n.layerId=r,n.index=a,n.info=null}}const c=xb(e),u=new Map;return u.set(null,c),l.forEach((e=>{let t={...c};e===s&&(t.color=o,t.index=a,t.picked=!0),t=_b({layer:e,info:t,mode:r}),e===s&&"hover"===r&&(n.info=t),u.set(t.layer.id,t),"hover"===r&&t.layer.updateAutoHighlight(t)})),u}function _b({layer:e,info:t,mode:n}){for(;e&&t;){const r=t.layer||null;t.sourceLayer=r,t.layer=e,t=e.getPickingInfo({info:t,mode:n,sourceLayer:r}),e=e.parent}return t}class Sb{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new gb(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find((e=>e.id===o)):null,l=s&&r.find((e=>e.id===s))||r[0],c=l&&l.unproject([e-l.x,t-l.y]),u={x:e,y:t,viewport:l,coordinate:c,layer:a};return{...i,...u}}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Pl(e),Pl.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Pl(e),this.depthFBO.attach({36064:new fl(e,{format:Hs(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter((e=>e.isPickable()&&!e.isComposite));return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:c}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:xb({viewports:n,x:r,y:i})};this._resizeBuffer();const u=Ca(this.gl),h=Ta(this.gl,[r,i],!0),d=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],f=Math.round(o*u),{width:p,height:m}=this.pickingFBO,g=this._getPickingRect({deviceX:d[0],deviceY:d[1],deviceRadius:f,deviceWidth:p,deviceHeight:m});let y;const v=[],b=new Set;for(let o=0;o<s;o++){const h=wb({...g&&this._drawAndSample({layers:e,views:t,viewports:n,onViewportActive:c,deviceRect:g,pass:"picking:".concat(a),redrawReason:a}),deviceX:d[0],deviceY:d[1],deviceRadius:f,deviceRect:g});let p;h.pickedLayer&&l&&this.depthFBO&&(p=this._drawAndSample({layers:[h.pickedLayer],views:t,viewports:n,onViewportActive:c,deviceRect:{x:h.pickedX,y:h.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0}).pickedColors[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]),h.pickedLayer&&o+1<s&&(b.add(h.pickedLayer),h.pickedLayer.disablePickingIndex(h.pickedObjectIndex)),y=Eb({pickInfo:h,lastPickedInfo:this.lastPickedInfo,mode:a,layers:e,viewports:n,x:r,y:i,z:p,pixelRatio:u});for(const e of y.values())e.layer&&v.push(e);if(!h.pickedColor)break}for(const e of b)e.restorePickingColors();return{result:v,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:n,x:r,y:i,width:o=1,height:s=1,mode:a="query",maxObjects:l=null,onViewportActive:c}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const u=Ca(this.gl),h=Ta(this.gl,[r,i],!0),d=h.x,f=h.y+h.height,p=Ta(this.gl,[r+o,i+s],!0),m=p.x+p.width,g=p.y,y={x:d,y:g,width:m-d,height:f-g},v=function({pickedColors:e,decodePickingColor:t}){const n=new Map;if(e)for(let r=0;r<e.length;r+=4)if(e[r+3]-1>=0){const i=e.slice(r,r+4),o=i.join(",");if(!n.has(o)){const e=t(i);e?n.set(o,{...e,pickedColor:i}):Is.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:e,views:t,viewports:n,onViewportActive:c,deviceRect:y,pass:"picking:".concat(a),redrawReason:a})),b=new Map,w=Number.isFinite(l);for(let e=0;e<v.length&&!(w&&b.size>=l);e++){const t=v[e];let n={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:i,width:o,height:s,pixelRatio:u};n=_b({layer:t.pickedLayer,info:n,mode:a}),b.has(n.object)||b.set(n.object,n)}return Array.from(b.values())}_drawAndSample({layers:e,views:t,viewports:n,onViewportActive:r,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){const l=a?this.depthFBO:this.pickingFBO,{decodePickingColor:c}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:r,pickingFBO:l,deviceRect:i,pass:o,redrawReason:s,pickZ:a}),{x:u,y:h,width:d,height:f}=i,p=new(a?Float32Array:Uint8Array)(d*f*4);return Sl(l,{sourceX:u,sourceY:h,sourceWidth:d,sourceHeight:f,target:p}),{pickedColors:p,decodePickingColor:c}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,e-n),s=Math.max(0,t-n),a=Math.min(r,e+n+1)-o,l=Math.min(i,t+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const Cb={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class Tb{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Cb),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,n){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}var Ob={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const Pb="8.6.5",Ab=Gs.CO.deck&&Gs.CO.deck.VERSION;if(Ab&&Ab!==Pb)throw new Error("deck.gl - multiple versions detected: ".concat(Ab," vs ").concat(Pb));Ab||(Is.log(1,"deck.gl ".concat(Pb))(),Gs.CO.deck=Object.assign(Gs.CO.deck||{},{VERSION:Pb,version:Pb,log:Is,_registerLoggers:function(e){Lc=e}}),function(e){const t=Up();e=Array.isArray(e)?e:[e];for(const n of e){const e=Hf(n);t.find((t=>e===t))||t.unshift(e)}}([Ob,[Im,{imagebitmap:{premultiplyAlpha:"none"}}]]));var kb=Gs.CO.deck;class Mb extends Ya{static isSupported(e,t=[]){const n=Hs(e),r=Nl(e,Al);let i=n||r;for(const e of t)switch(e){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:za(!1)}return i}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return Mb.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Nb=(0,Gs.jU)()&&"undefined"!=typeof document;let Lb=0;class Rb{constructor(e={}){const{onCreateContext:t=(e=>Na(e)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Fa.get("animation-loop-"+Lb++)}=e;let{useDevicePixels:p=!0}=e;"useDevicePixelRatio"in e&&(Bs.deprecated("useDevicePixelRatio","useDevicePixels")(),p=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:o,onError:s,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return za("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Mb.isSupported(this.gl,["timers"])?new Mb(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())}));return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return Bs.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Nb?new Promise(((e,t)=>{Nb&&"complete"===document.readyState?e(document):window.addEventListener("load",(()=>{e(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):(t=e,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t));var t}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):(t=e,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60));var t}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?La(this.props.gl,e):this.onCreateContext(e),!Vs(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");_a(this.gl,oa),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(e,t={}){if(e.canvas)return void function(e,t,n){let r="width"in n?n.width:e.canvas.clientWidth,i="height"in n?n.height:e.canvas.clientHeight;r&&i||(Bs.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,r=e.canvas.width||1,i=e.canvas.height||1),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const o=e.luma.canvasSizeInfo;if(o.clientWidth!==r||o.clientHeight!==i||o.devicePixelRatio!==t){let n=t;const o=Math.floor(r*n),s=Math.floor(i*n);e.canvas.width=o,e.canvas.height=s,e.drawingBufferWidth===o&&e.drawingBufferHeight===s||(Bs.warn("Device pixel ratio clamped")(),n=Math.min(e.drawingBufferWidth/r,e.drawingBufferHeight/i),e.canvas.width=Math.floor(r*n),e.canvas.height=Math.floor(i*n)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:t})}}(e,function(e){const t="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(e)?e<=0?1:e:e?t:1}(t.useDevicePixels),t);const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Pl(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Ib=n(1272),Db=n.n(Ib);const jb={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(t,n){for(let n=0;n<t.length;n++)if(t[n].pointerId===e.pointerId)return!0;return!1}(n)||n.push(e)),t.call(this,e)}}(Db().PointerEventInput),Db().MouseInput.prototype.handler=function(e){let t=jb[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const Fb=Db().Manager;var zb=Db();const Bb=zb?[[zb.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[zb.Rotate,{enable:!1}],[zb.Pinch,{enable:!1}],[zb.Swipe,{enable:!1}],[zb.Pan,{threshold:0,enable:!1}],[zb.Press,{enable:!1}],[zb.Tap,{event:"doubletap",taps:2,enable:!1}],[zb.Tap,{event:"anytap",enable:!1}],[zb.Tap,{enable:!1}]]:null,Ub={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Vb={doubletap:["tap"]},Hb={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},qb={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Wb={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Gb={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},$b="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Yb="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let Xb=!1;try{const e={get passive(){return Xb=!0,!0}};Yb.addEventListener("test",e,e),Yb.removeEventListener("test",e,e)}catch(e){}const Kb=-1!==$b.indexOf("firefox"),{WHEEL_EVENTS:Zb}=qb,Jb="wheel",Qb=4.000244140625;class ew{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.events=Zb.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((t=>e.addEventListener(t,this.handleEvent,!!Xb&&{passive:!1})))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===Jb&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Yb.WheelEvent&&(Kb&&e.deltaMode===Yb.WheelEvent.DOM_DELTA_PIXEL&&(t/=Yb.devicePixelRatio),e.deltaMode===Yb.WheelEvent.DOM_DELTA_LINE&&(t*=40));const n={x:e.clientX,y:e.clientY};0!==t&&t%Qb==0&&(t=Math.floor(t/Qb)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,n)}_onWheel(e,t,n){this.callback({type:Jb,center:n,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:tw}=qb,nw="pointermove",rw="pointerover",iw="pointerout",ow="pointerleave";class sw{constructor(e,t,n={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=tw.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===nw&&(this.enableMoveEvent=t),e===rw&&(this.enableOverEvent=t),e===iw&&(this.enableOutEvent=t),e===ow&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:rw,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:iw,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:ow,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:nw,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:aw}=qb,lw="keydown",cw="keyup";class uw{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=aw.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=n.tabIndex||0,e.style.outline="none",this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===lw&&(this.enableDownEvent=t),e===cw&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:lw,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:cw,srcEvent:e,key:e.key,target:e.target}))}}const hw="contextmenu";class dw{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===hw&&(this.options.enable=t)}handleEvent(e){this.options.enable&&this.callback({type:hw,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const fw={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},pw={srcElement:"root",priority:0};class mw{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},pw,n):pw;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const l={type:e,handler:t,srcElement:n.srcElement,priority:n.priority};r&&(l.once=!0),i&&(l.passive=!0),o.push(l),this._active=this._active||!l.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=l.priority);)c--;a.splice(c+1,0,l)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===e&&o.handler===t){n.splice(i,1);const e=r.get(o.srcElement);e.splice(e.indexOf(o),1),0===e.length&&r.delete(o.srcElement)}}this._active=n.some((e=>!e.passive))}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l(Object.assign({},e,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&o.push(n[s]),t)break}for(let e=0;e<o.length;e++){const{type:t,handler:n}=o[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(e){const t=fw[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r,which:i}=e.srcEvent;let o=!1,s=!1,a=!1;return 4===t||2===t&&!Number.isFinite(n)?(o=1===i,s=2===i,a=3===i):2===t?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===t&&(o=0===r,s=1===r,a=2===r),{leftButton:o,middleButton:s,rightButton:a}}(e),function(e,t){const{srcEvent:n}=e;if(!e.center&&!Number.isFinite(n.clientX))return null;const r=e.center||{x:n.clientX,y:n.clientY},i=t.getBoundingClientRect(),o=i.width/t.offsetWidth||1,s=i.height/t.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-i.left-t.clientLeft)/o,y:(r.y-i.top-t.clientTop)/s}}}(e,t),{handled:!1,rootElement:t})}}const gw={events:null,recognizers:null,recognizerOptions:{},Manager:Fb,touchAction:"none",tabIndex:0};class yw{constructor(e=null,t={}){this.options=Object.assign({},gw,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:n}=t;n&&this.on(n)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||Bb}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Ub).forEach((e=>{const t=this.manager.get(e);t&&Ub[e].forEach((e=>{t.recognizeWith(e)}))}));for(const e in t.recognizerOptions){const n=this.manager.get(e);if(n){const r=t.recognizerOptions[e];delete r.enable,n.set(r)}}this.wheelInput=new ew(e,this._onOtherEvent,{enable:!1}),this.moveInput=new sw(e,this._onOtherEvent,{enable:!1}),this.keyInput=new uw(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new dw(e,this._onOtherEvent,{enable:!1});for(const[e,t]of this.events)t.isEmpty()||(this._toggleRecognizer(t.recognizerName,!0),this.manager.on(e,t.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const i=Vb[e];i&&!this.options.recognizers&&i.forEach((i=>{const o=n.get(i);t?(o.requireFailure(e),r.dropRequireFailure(i)):o.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!=typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,r,i);return}const{manager:o,events:s}=this,a=Gb[e]||e;let l=s.get(a);l||(l=new mw(this),s.set(a,l),l.recognizerName=Wb[a]||a,o&&o.on(a,l.handleEvent)),l.add(e,t,n,r,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,r=Gb[e]||e,i=n.get(r);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:e}=i;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_onBasicInput(e){const{srcEvent:t}=e,n=Hb[t.type];n&&this.manager.emit(n,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function vw(){}const bw={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:vw,onResize:vw,onViewStateChange:vw,onInteractionStateChange:vw,onBeforeRender:vw,onAfterRender:vw,onLoad:vw,onError:(e,t)=>Is.error(e)(),_onMetrics:null,getCursor:({isDragging:e})=>e?"grabbing":"grab",debug:!1,drawPickingColors:!1};class ww{constructor(e){e={...bw,...e},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Is.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Gs.qs)()&&Is.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Da({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Il.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Is.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Is.removed("onLayerClick","onClick")(),e.initialViewState&&!bv(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||n||r||i||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const i=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),fc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:n}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,n=e.clientHeight||e.height;return(t!==this.width||n!==this.height)&&(this.width=t,this.height=n,!0)}_createAnimationLoop(e){const{width:t,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:c,autoResizeDrawingBuffer:u}=e;return new Rb({width:t,height:n,useDevicePixels:c,autoResizeDrawingBuffer:u,autoResizeViewport:!1,gl:r,onCreateContext:e=>Na({...i,...e,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:e=>this._setGLContext(e.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Hv({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=n,i=!1;for(const n of t)r=n,i=n.layer.onHover(n,e.event);if(!i&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const e=this.props.getTooltip(r);this.tooltip.setTooltip(e,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,La(e,{enable:!0,copyState:!0})),this.tooltip=new Tb(this.canvas),_a(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new hv;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new yw(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const e in zs)this.eventManager.on(e,this._onEvent);this.viewManager=new wv({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new vv(e,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new fb,this.deckRenderer=new vb(e),this.deckPicker=new Sb(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:n}=this.layerManager.context;_a(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:n})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Is.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=zs[e.type],n=e.offsetCenter;if(!t||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[t.handler]||o.props[t.handler]),a=this.props[t.handler];let l=!1;s&&(l=s.call(o,i,e)),!l&&a&&a(i,e)}_onPointerDown(e){const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=Fa.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}ww.getPropTypes=function(e){return{id:e.string,width:e.oneOfType([e.number,e.string]),height:e.oneOfType([e.number,e.string]),layers:e.oneOfType([e.object,e.array]),layerFilter:e.func,views:e.oneOfType([e.object,e.array]),viewState:e.object,effects:e.arrayOf(e.instanceOf(Qv)),controller:e.oneOfType([e.func,e.bool,e.object]),gl:e.object,glOptions:e.object,parameters:e.object,pickingRadius:e.number,useDevicePixels:e.oneOfType([e.bool,e.number]),touchAction:e.string,eventRecognizerOptions:e.object,onWebGLInitialized:e.func,onResize:e.func,onViewStateChange:e.func,onInteractionStateChange:e.func,onBeforeRender:e.func,onAfterRender:e.func,onLoad:e.func,onError:e.func,debug:e.bool,drawPickingColors:e.bool,_framebuffer:e.object,_animate:e.bool,_pickable:e.bool,_typedArrayManagerProps:e.object}},ww.defaultProps=bw,ww.VERSION=kb.VERSION;var xw="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function Ew(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}function _w(t){return t?"function"==typeof t?(0,e.createElement)(Sv,{},t):Array.isArray(t)?t.map(_w):t.type===e.Fragment?_w(t.props.children):(Ew(t.type,Sv),t):t}const Sw={position:"absolute",zIndex:-1};function Cw(t,n){return t?"function"==typeof t?t(n):Array.isArray(t)?t.map((e=>Cw(e,n))):function(e){const t=e&&e.type,n=t&&t.defaultProps;return n&&n.mapStyle}(t)?(n.style=Sw,(0,e.cloneElement)(t,n)):function(e){const t=e&&e.type;return t&&t.deckGLViewProps}(t)?(0,e.cloneElement)(t,n):t:t}const Tw={mixBlendMode:null};function Ow(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const Pw=(0,e.forwardRef)(((t,n)=>{const r=(0,e.useRef)({}).current,[i,o]=(0,e.useState)(0);r.forceUpdate=o;const s=(0,e.useRef)(null),a=(0,e.useRef)(null),l=(0,e.useMemo)((()=>function({children:t,layers:n,views:r}){const i=[],o=[],s={};return e.Children.forEach(_w(t),(e=>{if(e){const t=e.type;if(Ew(t,rm)){const n=function(e,t){const n={},r=e.defaultProps||{};for(const e in t)r[e]!==t[e]&&(n[e]=t[e]);return new e(n)}(t,e.props);o.push(n)}else i.push(e);if(t!==Sv&&Ew(t,Sv)&&e.props.id){const n=new t(e.props);s[n.id]=n}}})),Object.keys(s).length>0&&(Array.isArray(r)?r.forEach((e=>{s[e.id]=e})):r&&(s[r.id]=r),r=Object.values(s)),{layers:n=o.length>0?[...o,...n]:n,children:i,views:r}}(t)),[t.layers,t.views,t.children]);let c=!0;const u=e=>c&&t.viewState?(r.viewStateUpdateRequested=e,null):(r.viewStateUpdateRequested=null,t.onViewStateChange(e)),h=e=>{c?r.interactionStateUpdateRequested=e:(r.interactionStateUpdateRequested=null,t.onInteractionStateChange(e))},d=(0,e.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:h};return r.deck&&r.deck.setProps(e),e}),[t]);(0,e.useEffect)((()=>(r.deck=function(e,t){const n=new(t.Deck||ww)({...t,style:null,width:"100%",height:"100%",_customRender:t=>{e.redrawReason=t;const r=n.viewManager.getViewports();e.lastRenderedViewports!==r?e.forceUpdate((e=>e+1)):Ow(e)}});return n}(r,{...d,parent:s.current,canvas:a.current}),()=>r.deck.finalize())),[]),xw((()=>{Ow(r);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=r;e&&u(e),t&&h(t)})),(0,e.useImperativeHandle)(n,(()=>function(e){const t={pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)};return Object.defineProperty(t,"deck",{get:()=>e.deck}),t}(r)),[]);const{viewManager:f}=r.deck||{},p=f&&f.getViewports(),{ContextProvider:m,width:g,height:y,id:v,style:b}=t,{containerStyle:w,canvasStyle:x}=(0,e.useMemo)((()=>function({width:e,height:t,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:e,height:t},i={left:0,top:0};if(n)for(const e in n)e in Tw?i[e]=n[e]:r[e]=n[e];return{containerStyle:r,canvasStyle:i}}({width:g,height:y,style:b})),[g,y,b]);if(!r.viewStateUpdateRequested&&r.lastRenderedViewports===p||r.version!==i){r.lastRenderedViewports=p,r.version=i;const t=function({children:t,deck:n,ContextProvider:r}){const{viewManager:i}=n||{};if(!i||!i.views.length)return[];const o={},s=i.views[0].id;for(const e of t){let t=s,n=e;Ew(e.type,Sv)&&(t=e.props.id||s,n=e.props.children);const r=i.getViewport(t),a=i.getViewState(t);if(r){const{x:e,y:i,width:s,height:l}=r;n=Cw(n,{x:e,y:i,width:s,height:l,viewport:r,viewState:a}),o[t]||(o[t]={viewport:r,children:[]}),o[t].children.push(n)}}return Object.keys(o).map((t=>{const{viewport:i,children:s}=o[t],{x:a,y:l,width:c,height:u}=i,h={position:"absolute",left:a,top:l,width:c,height:u},d="view-".concat(t),f=(0,e.createElement)("div",{key:d,id:d,style:h},...s);if(r){const o={viewport:i,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:e=>{e.viewId=t,n._onViewStateChange(e)}};return(0,e.createElement)(r,{key:d,value:o},f)}return f}))}({children:l.children,deck:r.deck,ContextProvider:m}),n=(0,e.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:x});r.control=(0,e.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:s,style:w},[n,t])}return c=!1,r.control}));Pw.propTypes=ww.getPropTypes(s()),Pw.defaultProps=ww.defaultProps;var Aw=Pw;class kw{constructor({x:e,y:t,z:n}){this.x=e,this.y=t,this.z=n,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||Is.error("byteLength not defined in tile data")(),e}async _loadData({getData:e,requestScheduler:t,onLoad:n,onError:r}){const{x:i,y:o,z:s,bbox:a}=this,l=this._loaderId;this._abortController=new AbortController;const{signal:c}=this._abortController,u=await t.scheduleRequest(this,(e=>e.isSelected?1:-1));if(!u)return void(this._isCancelled=!0);if(this._isCancelled)return void u.done();let h,d=null;try{d=await e({x:i,y:o,z:s,bbox:a,signal:c})}catch(e){h=e||!0}finally{u.done()}l===this._loaderId&&(this._loader=void 0,this.content=d,!this._isCancelled||d?(this._isLoaded=!0,this._isCancelled=!1,h?r(h,this):n(this)):this._isLoaded=!1)}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}}const Mw=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Nw=new sc,Lw=new sc;class Rw{constructor(e=[0,0,0],t=[0,0,0],n=null){n=n||Nw.copy(e).add(t).scale(.5),this.center=new sc(n),this.halfDiagonal=new sc(t).subtract(this.center),this.minimum=new sc(e),this.maximum=new sc(t)}clone(){return new Rw(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,n=Lw.from(e.normal),r=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),i=this.center.dot(n)+e.distance;return i-r>0?Mw.INSIDE:i+r<0?Mw.OUTSIDE:Mw.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=Nw.from(e).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(t.x)-n.x,r>0&&(i+=r*r),r=Math.abs(t.y)-n.y,r>0&&(i+=r*r),r=Math.abs(t.z)-n.z,r>0&&(i+=r*r),i}}const Iw=new sc,Dw=new sc;class jw{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new sc,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=Iw.from(t),this.center=(new sc).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new jw(this.center,this.radius)}union(e){const t=this.center,n=this.radius,r=e.center,i=e.radius,o=Iw.copy(r).subtract(t),s=o.magnitude();if(n>=s+i)return this.clone();if(i>=s+n)return e.clone();const a=.5*(n+s+i);return Dw.copy(o).scale((-n+a)/s).add(t),this.center.copy(Dw),this.radius=a,this}expand(e){const t=(e=Iw.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(o,s,a),e[2]=Math.hypot(l,c,u),e}(Iw,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=Iw.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,r=e.normal.dot(t)+e.distance;return r<-n?Mw.OUTSIDE:r<n?Mw.INTERSECTING:Mw.INSIDE}}function Fw(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1],p=n[2],m=n[3],g=n[4],y=n[5],v=n[6],b=n[7],w=n[8];return e[0]=d*r+f*s+p*c,e[1]=d*i+f*a+p*u,e[2]=d*o+f*l+p*h,e[3]=m*r+g*s+y*c,e[4]=m*i+g*a+y*u,e[5]=m*o+g*l+y*h,e[6]=v*r+b*s+w*c,e[7]=v*i+b*a+w*u,e[8]=v*o+b*l+w*h,e}function zw(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}const Bw=Object.freeze([1,0,0,0,1,0,0,0,1]),Uw=Object.freeze([0,0,0,0,0,0,0,0,0]),Vw=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Hw={};class qw extends id{static get IDENTITY(){return Hw.IDENTITY=Hw.IDENTITY||Object.freeze(new qw(Bw)),Hw.IDENTITY}static get ZERO(){return Hw.ZERO=Hw.ZERO||Object.freeze(new qw(Uw)),Hw.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Vw}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,n,r,i,o,s,a,l){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,n,r,i,o,s,a,l){return this[0]=e,this[1]=r,this[2]=s,this[3]=t,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return t=(e=this)[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],t*(c*o-s*l)+n*(-c*i+s*a)+r*(l*i-o*a);var e,t,n,r,i,o,s,a,l,c}identity(){return this.copy(Bw)}fromQuaternion(e){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,l=i+i,c=n*s,u=r*s,h=r*a,d=i*s,f=i*a,p=i*l,m=o*s,g=o*a,y=o*l;e[0]=1-h-p,e[3]=u-y,e[6]=d+g,e[1]=u+y,e[4]=1-c-p,e[7]=f-m,e[2]=d-g,e[5]=f+m,e[8]=1-c-h}(this,e),this.check()}transpose(){return function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,d=-u*o+a*l,f=c*o-s*l,p=n*h+r*d+i*f;p&&(p=1/p,e[0]=h*p,e[1]=(-u*r+i*c)*p,e[2]=(a*r-i*s)*p,e[3]=d*p,e[4]=(u*n-i*l)*p,e[5]=(-a*n+i*o)*p,e[6]=f*p,e[7]=(-c*n+r*l)*p,e[8]=(s*n-r*o)*p)}(this,this),this.check()}multiplyLeft(e){return Fw(this,e,this),this.check()}multiplyRight(e){return Fw(this,this,e),this.check()}rotate(e){return function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(n),f=Math.cos(n);e[0]=f*r+d*s,e[1]=f*i+d*a,e[2]=f*o+d*l,e[3]=f*s-d*r,e[4]=f*a-d*i,e[5]=f*l-d*o,e[6]=c,e[7]=u,e[8]=h}(this,this,e),this.check()}scale(e){return Array.isArray(e)?zw(this,this,e):zw(this,this,[e,e,e]),this.check()}translate(e){return function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1];e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=d*r+f*s+c,e[7]=d*i+f*a+u,e[8]=d*o+f*l+h}(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}(t||[-0,-0],e,this);break;case 3:t=nc(t||[-0,-0,-0],e,this);break;case 4:t=function(e,t,n){const r=t[0],i=t[1],o=t[2];return e[0]=n[0]*r+n[3]*i+n[6]*o,e[1]=n[1]*r+n[4]*i+n[7]*o,e[2]=n[2]*r+n[5]*i+n[8]*o,e[3]=t[3],e}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wl(t,e.length),t}transformVector(e,t){return $l("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return $l("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return $l("Matrix3.transformVector"),this.transform(e,t)}}function Ww(){var e=new Kl(4);return Kl!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Gw(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function $w(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+s*a+i*c-o*l,e[1]=i*u+s*l+o*a-r*c,e[2]=o*u+s*c+r*l-i*a,e[3]=s*u-r*a-i*l-o*c,e}var Yw,Xw,Kw,Zw,Jw=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)},Qw=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},ex=(Yw=Zl(),Xw=Jl(1,0,0),Kw=Jl(0,1,0),function(e,t,n){var r=Ql(t,n);return r<-.999999?(ec(Yw,Xw,t),function(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}(Yw)<1e-6&&ec(Yw,Kw,t),function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o}(Yw,Yw),Gw(e,Yw,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(ec(Yw,t,n),e[0]=Yw[0],e[1]=Yw[1],e[2]=Yw[2],e[3]=1+r,function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=o*s,e}(e,e))});Ww(),Ww(),Zw=new Kl(9),Kl!=Float32Array&&(Zw[1]=0,Zw[2]=0,Zw[3]=0,Zw[5]=0,Zw[6]=0,Zw[7]=0),Zw[0]=1,Zw[4]=1,Zw[8]=1;const tx=[0,0,0,1];class nx extends Hl{constructor(e=0,t=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromMatrix3(e){return function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*s+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+s]-t[3*s+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[s]=(t[3*s+i]+t[3*i+s])*n}}(this,e),this.check()}identity(){return function(e){e[0]=0,e[1]=0,e[2]=0,e[3]=1}(this),this.check()}fromAxisRotation(e,t){return Gw(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ql(e)}get y(){return this[1]}set y(e){this[1]=ql(e)}get z(){return this[2]}set z(e){this[2]=ql(e)}get w(){return this[3]}set w(e){this[3]=ql(e)}len(){return Jw(this)}lengthSquared(){return Qw(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}(this,e)}rotationTo(e,t){return ex(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3]}(this,this,e),this.check()}calculateW(){return function(e,t){var n=t[0],r=t[1],i=t[2];e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=o*a}(this,this),this.check()}lerp(e,t,n){return function(e,t,n,r){var i=t[0],o=t[1],s=t[2],a=t[3];e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e[3]=a+r*(n[3]-a)}(this,e,t,n),this.check()}multiplyRight(e,t){return Vl(!t),$w(this,this,e),this.check()}multiplyLeft(e,t){return Vl(!t),$w(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+s*a,e[1]=i*l+o*a,e[2]=o*l-i*a,e[3]=s*l-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l-o*a,e[1]=i*l+s*a,e[2]=o*l+r*a,e[3]=s*l-i*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+i*a,e[1]=i*l-r*a,e[2]=o*l+s*a,e[3]=s*l-o*a}(this,this,e),this.check()}scale(e){return function(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n}(this,this,e),this.check()}slerp(e,t,n){switch(arguments.length){case 1:({start:e=tx,target:t,ratio:n}=arguments[0]);break;case 2:[t,n]=arguments,e=this}return function(e,t,n,r){var i,o,s,a,l,c=t[0],u=t[1],h=t[2],d=t[3],f=n[0],p=n[1],m=n[2],g=n[3];(o=c*f+u*p+h*m+d*g)<0&&(o=-o,f=-f,p=-p,m=-m,g=-g),1-o>Xl?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,l=Math.sin(r*i)/s):(a=1-r,l=r),e[0]=a*c+l*f,e[1]=a*u+l*p,e[2]=a*h+l*m,e[3]=a*d+l*g}(this,e,t,n),this.check()}transformVector4(e,t=e){return function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],l=n[2],c=n[3],u=c*r+a*o-l*i,h=c*i+l*r-s*o,d=c*o+s*i-a*r,f=-s*r-a*i-l*o;e[0]=u*c+f*-s+h*-l-d*-a,e[1]=h*c+f*-a+d*-s-u*-l,e[2]=d*c+f*-l+u*-a-h*-s,e[3]=t[3]}(t,e,this),Wl(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const rx=new sc,ix=new sc,ox=new sc,sx=new sc,ax=new sc,lx=new sc,cx=new sc;class ux{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new sc).from(e),this.halfAxes=new qw(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new sc(e).len(),new sc(t).len(),new sc(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new sc(e).normalize(),i=new sc(t).normalize(),o=new sc(n).normalize();return(new nx).fromMatrix3(new qw([...r,...i,...o]))}fromCenterHalfSizeQuaternion(e,t,n){const r=new nx(n),i=(new qw).fromQuaternion(r);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new sc).from(e),this.halfAxes=i,this}clone(){return new ux(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new jw){const t=this.halfAxes,n=t.getColumn(0,ox),r=t.getColumn(1,sx),i=t.getColumn(2,ax),o=rx.copy(n).add(r).add(i);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,r=this.halfAxes,i=n.x,o=n.y,s=n.z,a=Math.abs(i*r[0]+o*r[1]+s*r[2])+Math.abs(i*r[3]+o*r[4]+s*r[5])+Math.abs(i*r[6]+o*r[7]+s*r[8]),l=n.dot(t)+e.distance;return l<=-a?Mw.OUTSIDE:l>=a?Mw.INSIDE:Mw.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=ix.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,ox),i=n.getColumn(1,sx),o=n.getColumn(2,ax),s=r.magnitude(),a=i.magnitude(),l=o.magnitude();r.normalize(),i.normalize(),o.normalize();let c,u=0;return c=Math.abs(t.dot(r))-s,c>0&&(u+=c*c),c=Math.abs(t.dot(i))-a,c>0&&(u+=c*c),c=Math.abs(t.dot(o))-l,c>0&&(u+=c*c),u}computePlaneDistances(e,t,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,ox),l=s.getColumn(1,sx),c=s.getColumn(2,ax),u=lx.copy(a).add(l).add(c).add(o),h=cx.copy(u).subtract(e);let d=t.dot(h);return r=Math.min(d,r),i=Math.max(d,i),u.copy(o).add(a).add(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),u.copy(o).add(a).subtract(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),u.copy(o).add(a).subtract(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(u).subtract(a).add(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(u).subtract(a).add(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(u).subtract(a).subtract(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(u).subtract(a).subtract(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),n[0]=r,n[1]=i,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,ox);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,sx);n.transformAsPoint(e);const r=this.halfAxes.getColumn(2,ax);return r.transformAsPoint(e),this.halfAxes=new qw([...t,...n,...r]),this}getTransform(){throw new Error("not implemented")}}const hx=new sc,dx=new sc;class fx{constructor(e=[0,0,1],t=0){this.normal=new sc,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Vl(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=hx.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,r){return this.normal.set(e,t,n),Vl(Ul(this.normal.len(),1)),this.distance=r,this}clone(e){return new fx(this.normal,this.distance)}equals(e){return Ul(this.distance,e.distance)&&Ul(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=dx.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e,t=[0,0,0]){e=hx.from(e);const n=this.getPointDistance(e),r=dx.copy(this.normal).scale(n);return e.subtract(r).to(t)}}const px=[new sc([1,0,0]),new sc([0,1,0]),new sc([0,0,1])],mx=new sc,gx=new sc;new fx(new sc(1,0,0),0);class yx{static get MASK_OUTSIDE(){return 4294967295}static get MASK_INSIDE(){return 0}static get MASK_INDETERMINATE(){return 2147483647}constructor(e=[]){this.planes=e,Vl(this.planes.every((e=>e instanceof fx)))}fromBoundingSphere(e){this.planes.length=2*px.length;const t=e.center,n=e.radius;let r=0;for(const e of px){let i=this.planes[r],o=this.planes[r+1];i||(i=this.planes[r]=new fx),o||(o=this.planes[r+1]=new fx);const s=mx.copy(e).scale(-n).add(t);e.dot(s),i.fromPointNormal(s,e);const a=mx.copy(e).scale(n).add(t),l=gx.copy(e).negate();l.dot(a),o.fromPointNormal(a,l),r+=2}return this}computeVisibility(e){Vl(e);let t=Mw.INSIDE;for(const n of this.planes)switch(e.intersectPlane(n)){case Mw.OUTSIDE:return Mw.OUTSIDE;case Mw.INTERSECTING:t=Mw.INTERSECTING}return t}computeVisibilityWithPlaneMask(e,t){if(Vl(e,"boundingVolume is required."),Vl(Number.isFinite(t),"parentPlaneMask is required."),t===yx.MASK_OUTSIDE||t===yx.MASK_INSIDE)return t;let n=yx.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&0==(t&o))continue;const s=r[i],a=e.intersectPlane(s);if(a===Mw.OUTSIDE)return yx.MASK_OUTSIDE;a===Mw.INTERSECTING&&(n|=o)}return n}}new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,new sc,Math.PI;Math.PI,Math.PI,Math.PI,Math.PI;const vx=new qw,bx=new qw,wx=new qw,xx=new qw,Ex=new qw;const _x=[1,0,0],Sx=[2,2,1];function Cx(e){let t=0;for(let n=0;n<3;++n){const r=e[vx.getElementIndex(Sx[n],_x[n])];t+=2*r*r}return Math.sqrt(t)}function Tx(e,t){let n=0,r=1;for(let t=0;t<3;++t){const i=Math.abs(e[vx.getElementIndex(Sx[t],_x[t])]);i>n&&(r=t,n=i)}const i=_x[r],o=Sx[r];let s=1,a=0;if(Math.abs(e[vx.getElementIndex(o,i)])>1e-15){const t=(e[vx.getElementIndex(o,o)]-e[vx.getElementIndex(i,i)])/2/e[vx.getElementIndex(o,i)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),s=1/Math.sqrt(1+n*n),a=n*s}return qw.IDENTITY.to(t),t[vx.getElementIndex(i,i)]=t[vx.getElementIndex(o,o)]=s,t[vx.getElementIndex(o,i)]=a,t[vx.getElementIndex(i,o)]=-a,t}const Ox=new sc,Px=new sc,Ax=new sc,kx=new sc,Mx=new sc,Nx=new qw,Lx={diagonal:new qw,unitary:new qw},Rx=512,Ix=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Dx=Ix.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),jx=Dx.concat([[.25,.5],[.75,.5]]);class Fx{constructor(e,t,n){this.x=e,this.y=t,this.z=n}get children(){if(!this._children){const e=2*this.x,t=2*this.y,n=this.z+1;this._children=[new Fx(e,t,n),new Fx(e,t+1,n),new Fx(e+1,t,n),new Fx(e+1,t+1,n)]}return this._children}update(e){const{viewport:t,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:o,bounds:s,offset:a,project:l}=e,c=this.getBoundingVolume(r,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){let{z:e}=this;if(e<o&&e>=i){const n=c.distanceTo(t.cameraPosition)*t.scale/t.height;e+=Math.floor(Math.log2(n))}if(e>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const t of this.children)t.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds([e,t,n,r]){const i=Math.pow(2,this.z),o=Rx/i;return this.x*o<n&&this.y*o<r&&(this.x+1)*o>e&&(this.y+1)*o>t}getBoundingVolume(e,t,n){if(n){const t=this.z<1?jx:this.z<2?Dx:Ix,r=[];for(const i of t){const t=qx(this.x+i[0],this.y+i[1],this.z);t[2]=e[0],r.push(n(t)),e[0]!==e[1]&&(t[2]=e[1],r.push(n(t)))}return function(e,t=new ux){if(!e||0===e.length)return t.halfAxes=new qw([0,0,0,0,0,0,0,0,0]),t.center=new sc,t;const n=e.length,r=new sc(0,0,0);for(const t of e)r.add(t);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,l=0,c=0,u=0;for(const t of e){const e=Ox.copy(t).subtract(r);o+=e.x*e.x,s+=e.x*e.y,a+=e.x*e.z,l+=e.y*e.y,c+=e.y*e.z,u+=e.z*e.z}o*=i,s*=i,a*=i,l*=i,c*=i,u*=i;const h=Nx;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=l,h[5]=c,h[6]=a,h[7]=c,h[8]=u;const{unitary:d}=function(e,t={}){let n=0,r=0;const i=bx,o=wx;i.identity(),o.copy(e);const s=1e-20*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(o);for(;r<10&&Cx(o)>s;)Tx(o,xx),Ex.copy(xx).transpose(),o.multiplyRight(xx),o.multiplyLeft(Ex),i.multiplyRight(xx),++n>2&&(++r,n=0);return t.unitary=i.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}(h,Lx),f=t.halfAxes.copy(d);let p=f.getColumn(0,Ax),m=f.getColumn(1,kx),g=f.getColumn(2,Mx),y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,b=-Number.MAX_VALUE,w=Number.MAX_VALUE,x=Number.MAX_VALUE,E=Number.MAX_VALUE;for(const t of e)Ox.copy(t),y=Math.max(Ox.dot(p),y),v=Math.max(Ox.dot(m),v),b=Math.max(Ox.dot(g),b),w=Math.min(Ox.dot(p),w),x=Math.min(Ox.dot(m),x),E=Math.min(Ox.dot(g),E);p=p.multiplyByScalar(.5*(w+y)),m=m.multiplyByScalar(.5*(x+v)),g=g.multiplyByScalar(.5*(E+b)),t.center.copy(p).add(m).add(g);const _=Px.set(y-w,v-x,b-E).multiplyByScalar(.5),S=new qw([_[0],0,0,0,_[1],0,0,0,_[2]]);return t.halfAxes.multiplyRight(S),t}(r)}const r=Math.pow(2,this.z),i=Rx/r,o=this.x*i+t*Rx,s=Rx-(this.y+1)*i;return new Rw([o,s,e[0]],[o+i,s+i,e[1]])}}const zx=512,Bx=[-1/0,-1/0,1/0,1/0],Ux={type:"url",value:null,validate:(e,t)=>t.optional&&null===e||"string"==typeof e||Array.isArray(e)&&e.every((e=>"string"==typeof e)),equals:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}};function Vx(e,t){const n=[t.transformPoint([e[0],e[1]]),t.transformPoint([e[2],e[1]]),t.transformPoint([e[0],e[3]]),t.transformPoint([e[2],e[3]])];return[Math.min(...n.map((e=>e[0]))),Math.min(...n.map((e=>e[1]))),Math.max(...n.map((e=>e[0]))),Math.max(...n.map((e=>e[1])))]}function Hx(e,t){return Math.pow(2,e)*zx/t}function qx(e,t,n){const r=Hx(n,zx),i=e/r*360-180,o=Math.PI-2*Math.PI*t/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function Wx(e,t,n,r){const i=Hx(n,r);return[e/i*zx,t/i*zx]}function Gx(e,t,n,r,i=512){if(e.isGeospatial){const[e,i]=qx(t,n,r),[o,s]=qx(t+1,n+1,r);return{west:e,north:i,east:o,south:s}}const[o,s]=Wx(t,n,r,i),[a,l]=Wx(t+1,n+1,r,i);return{left:o,top:s,right:a,bottom:l}}function $x({viewport:e,maxZoom:t,minZoom:n,zRange:r,extent:i,tileSize:o=512,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let c=e.isGeospatial?Math.round(e.zoom+Math.log2(zx/o))+l:Math.ceil(e.zoom)+l;if(Number.isFinite(n)&&c<n){if(!i)return[];c=n}Number.isFinite(t)&&c>t&&(c=t);let u=i;return s&&a&&i&&!e.isGeospatial&&(u=Vx(i,s)),e.isGeospatial?function(e,t,n,r){const i=e.resolution?e.projectPosition:null,o=Object.values(e.getFrustumPlanes()).map((({normal:e,distance:t})=>new fx(e.clone().negate(),t))),s=new yx(o),a=e.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=e.pitch<=60?t:0;if(r){const[e,t,n,i]=r,o=Md([e,i]),s=Md([n,t]);r=[o[0],Rx-o[1],s[0],Rx-s[1]]}const h=new Fx(0,0,0),d={viewport:e,project:i,cullingVolume:s,elevationBounds:[l,c],minZ:u,maxZ:t,bounds:r,offset:0};if(h.update(d),e.subViewports&&e.subViewports.length>1){for(d.offset=-1;h.update(d)&&!(--d.offset<-3););for(d.offset=1;h.update(d)&&!(++d.offset>3););}return h.getSelected()}(e,c,r,i):function(e,t,n,r,i){const o=function(e,t,n){let r;return r=e.getBounds(),e.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(e,0,r),s=Hx(t,n),[a,l,c,u]=function(e,t,n){return n?Vx(e,n).map((e=>e*t/zx)):e.map((e=>e*t/zx))}(o,s,i),h=[];for(let e=Math.floor(a);e<c;e++)for(let n=Math.floor(l);n<u;n++)h.push({x:e,y:n,z:t});return h}(e,c,o,u||Bx,a)}const Yx={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class Xx{constructor(e={}){tp(this,"props",void 0),tp(this,"stats",void 0),tp(this,"activeRequestCount",0),tp(this,"requestQueue",[]),tp(this,"requestMap",new Map),tp(this,"deferredUpdate",null),this.props={...Yx,...e},this.stats=new Da({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t=(()=>0)){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},r=new Promise((e=>(n.resolve=e,n)));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:n}=e;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort(((e,t)=>e.priority-t.priority))}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0&&(e.resolve(null),1))}}const Kx="best-available";class Zx{constructor(e){this.opts=e,this.onTileLoad=e=>{this.opts.onTileLoad(e),this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this._requestScheduler=new Xx({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles.every((e=>e.isLoaded))}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e,{zRange:t,modelMatrix:n}={}){const r=new hd(n),i=!r.equals(this._modelMatrix);if(!e.equals(this._viewport)||i){i&&(this._modelMatrixInverse=n&&r.clone().invert(),this._modelMatrix=n&&r),this._viewport=e;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map((e=>this._getTile(e,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}getTileIndices({viewport:e,maxZoom:t,minZoom:n,zRange:r,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return $x({viewport:e,maxZoom:t,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:i,modelMatrixInverse:o,zoomOffset:l})}getTileMetadata({x:e,y:t,z:n}){const{tileSize:r}=this.opts;return{bbox:Gx(this._viewport,e,t,n,r)}}getParentIndex(e){return e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),e.z-=1,e}updateTileStates(){this._updateTileStates(this.selectedTiles);const{maxRequests:e}=this.opts,t=[];let n=0,r=!1;for(const e of this._cache.values()){const i=Boolean(1&e.state);e.isVisible!==i&&(r=!0,e.isVisible=i),e.isSelected=5===e.state,e.isLoading&&(n++,e.isSelected||t.push(e))}if(e>0)for(;n>e&&t.length>0;)t.shift().abort(),n--;return r}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children.length=0;for(const t of e.values()){const e=this._getNearestAncestor(t.x,t.y,t.z);t.parent=e,e&&e.children.push(t)}}_updateTileStates(e){const{_cache:t}=this,n=this.opts.refinementStrategy||Kx;for(const e of t.values())e.state=0;for(const t of e)t.state=5;if("never"!==n){for(const t of e)Qx(t,n);for(const t of e)Jx(t)&&eE(t)}}_resizeCache(){const{_cache:e,opts:t}=this,n=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize||1/0;if(e.size>n||this._cacheByteSize>r){for(const[i,o]of e)if(o.isVisible||(this._cacheByteSize-=t.maxCacheByteSize?o.byteLength:0,e.delete(i),this.opts.onTileUnload(o)),e.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((e,t)=>e.z-t.z)),this._dirty=!1)}_getTile({x:e,y:t,z:n},r){const i="".concat(e,",").concat(t,",").concat(n);let o=this._cache.get(i),s=!1;return!o&&r?(o=new kw({x:e,y:t,z:n}),Object.assign(o,this.getTileMetadata(o)),s=!0,this._cache.set(i,o),this._dirty=!0):o&&o.needsReload&&(s=!0),s&&o.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),o}_getNearestAncestor(e,t,n){const{_minZoom:r=0}=this;let i={x:e,y:t,z:n};for(;i.z>r;){i=this.getParentIndex(i);const e=this._getTile(i);if(e)return e}return null}}function Jx(e){let t=e;for(;t;){if(!1&t.state)return!0;if(t.isLoaded)return!1;t=t.parent}return!0}function Qx(e,t){let n,r=3;for(;n=e.parent;){if(e.isLoaded&&(r=4,t===Kx))return;n.state=Math.max(n.state,r),e=n}}function eE(e){for(const t of e.children)t.state=Math.max(t.state,3),t.isLoaded||eE(t)}const tE={data:[],dataComparator:Ux.equals,renderSubLayers:{type:"function",value:e=>new lv(e),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:e=>{},compare:!1},onTileUnload:{type:"function",value:e=>{},compare:!1},onTileError:{type:"function",value:e=>console.error(e),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Kx,zRange:null,maxRequests:6,zoomOffset:0};class nE extends im{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e;null===(e=this.state.tileset)||void 0===e||e.finalize()}get isLoaded(){const{tileset:e}=this.state;return e.selectedTiles.every((e=>e.isLoaded&&e.layers&&e.layers.every((e=>e.isLoaded))))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,changeFlags:t}){let{tileset:n}=this.state;const r=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions(e)),i?n.reloadAll():this.state.tileset.tiles.forEach((e=>{e.layers=null}))):(n=new Zx(this._getTilesetOptions(e)),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(e){const{tileSize:t,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:a,maxRequests:l,zoomOffset:c}=e;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:a,tileSize:t,refinementStrategy:i,extent:o,maxRequests:l,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:t,modelMatrix:n}=this.props,r=e.update(this.context.viewport,{zRange:t,modelMatrix:n}),{isLoaded:i}=e,o=this.state.isLoaded!==i,s=this.state.frameNumber!==r;i&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,e.isVisible&&this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,t.isVisible&&this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:n,fetch:r}=this.props,{signal:i}=e;return e.url=function(e,t){if(!e||!e.length)return null;Array.isArray(e)&&(e=e[Math.abs(t.x+t.y)%e.length]);const{x:n,y:r,z:i}=t;return e.replace("{x}",n).replace("{y}",r).replace("{z}",i).replace("{-y}",Math.pow(2,i)-r-1)}(t,e),n?n(e):e.url?r(e.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:t}){return e.tile=t.props.tile,e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map((e=>{const t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)t&&e.layers[0]&&Object.keys(t).some((n=>e.layers[0].props[n]!==t[n]))&&(e.layers=e.layers.map((e=>e.clone(t))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.x,"-").concat(e.y,"-").concat(e.z),data:e.content,_offset:0,tile:e});e.layers=bc(n,Boolean).map((n=>n.clone({tile:e,...t})))}return e.layers}))}filterSubLayer({layer:e}){return e.props.tile.isVisible}}nE.layerName="TileLayer",nE.defaultProps=tE;const rE=new Uint16Array([0,2,1,0,3,2]),iE=new Float32Array([0,1,0,0,1,0,1,1]);function oE(e,t,n){return Bl(Bl(e[0],e[1],n),Bl(e[3],e[2],n),t)}var sE="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");const aE={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Ds.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class lE extends rm{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:sE,modules:[dm,mm]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:e=>e.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:e=>e.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:e=>e.value=this.state.mesh.texCoords,noAlloc:t}})}updateState({props:e,oldProps:t,changeFlags:n}){if(n.extensionsChanged){var r;const{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}const i=this.getAttributeManager();if(e.bounds!==t.bounds){const e=this.state.mesh,t=this._createMesh();this.state.model.setVertexCount(t.vertexCount);for(const n in t)e&&e[n]!==t[n]&&i.invalidate(n);this.setState({mesh:t,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo({info:e}){const{image:t}=this.props;if(!e.color||!t)return e.bitmap=null,e;const{width:n,height:r}=t;e.index=0;const i=function(e){const[t,n,r]=e;return[(t+(15&r)/16)/256,(n+(240&r)/256)/256]}(e.color),o=[Math.floor(i[0]*n),Math.floor(i[1]*r)];return e.bitmap={size:{width:n,height:r},uv:i,pixel:o},e}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let t=e;return Number.isFinite(e[0])&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),function(e,t){if(!t)return function(e){const t=new Float64Array(12);for(let n=0;n<e.length;n++)t[3*n+0]=e[n][0],t[3*n+1]=e[n][1],t[3*n+2]=e[n][2]||0;return{vertexCount:6,positions:t,indices:rE,texCoords:iE}}(e);const n=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),r=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),i=Math.ceil(n/t)+1,o=Math.ceil(r/t)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(i*o*2),c=new Float64Array(i*o*3);let u=0,h=0;for(let t=0;t<i;t++){const n=t/(i-1);for(let r=0;r<o;r++){const i=r/(o-1),s=oE(e,n,i);c[3*u+0]=s[0],c[3*u+1]=s[1],c[3*u+2]=s[2]||0,l[2*u+0]=n,l[2*u+1]=1-i,t>0&&r>0&&(a[h++]=u-o,a[h++]=u-o-1,a[h++]=u-1,a[h++]=u-o,a[h++]=u-1,a[h++]=u),u++}}return{vertexCount:s,positions:c,indices:a,texCoords:l}}(t,this.context.viewport.resolution)}_getModel(e){return e?new Eh(e,{...this.getShaders(),id:this.props.id,geometry:new ym({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:t,moduleParameters:n}=e,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:l,transparentColor:c,tintColor:u}=this.props;n.pickingActive&&s||a&&r&&r.setUniforms(t).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:c.map((e=>e/255)),tintColor:u.slice(0,3).map((e=>e/255)),coordinateConversion:i,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:n}=Ds;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!Number.isFinite(n[0]))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?e:t;if(r=r===e?e:t,r===e&&i===t)return{coordinateConversion:-1,bounds:n};if(r===t&&i===e){const e=Md([n[0],n[1]]),t=Md([n[2],n[3]]);return{coordinateConversion:1,bounds:[e[0],e[1],t[0],t[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}lE.layerName="BitmapLayer",lE.defaultProps=aE;const cE=["bearing","pitch"],uE={speed:1.2,curve:1.414};class hE extends Pv{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),this.props={...uE,...e}}interpolateProps(e,t,n){const r=function(e,t,n,r={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:l,u1:c,S:u,rho:h,rho2:d,r0:f}=Yd(e,t,r);if(c<.01){for(const r of Gd){const o=e[r],s=t[r];i[r]=(p=n)*s+(1-p)*o}return i}var p;const m=n*u,g=Math.cosh(f)/Math.cosh(f+h*m),y=l*((Math.cosh(f)*Math.tanh(f+h*m)-Math.sinh(f))/d)/c,v=o+kd(1/g),b=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}([],a,y);xd(b,b,s);const w=Nd(b);return i.longitude=w[0],i.latitude=w[1],i.zoom=v,i}(e,t,n,this.props);for(const i of cE)r[i]=Bl(e[i]||0,t[i]||0,n);return r}getDuration(e,t){let{transitionDuration:n}=t;return"auto"===n&&(n=function(e,t,n={}){n=Object.assign({},$d,n);const{screenSpeed:r,speed:i,maxDuration:o}=n,{S:s,rho:a}=Yd(e,t,n),l=1e3*s;let c;return c=Number.isFinite(r)?l/(r/a):l/i,Number.isFinite(o)&&c>o?0:c}(e,t,this.props)),n}}function dE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fE extends We{constructor(){super(...arguments),dE(this,"state",{ready:!1}),dE(this,"onDeltaCombined",(()=>{}))}onMount(){}render(){var t,{style:n={},className:r="",min:i,max:o,value:s,label:a,onChange:l,step:c}=this.props;return e.createElement("div",{className:"slidecontainer flex-col"+r,style:n},a&&e.createElement("div",{className:"mb-p25 text-gray-400"},a),e.createElement("input",{type:"range",min:i,max:o,value:null!==(t=null!=s?s:i)&&void 0!==t?t:o,step:Math.min(1,null!=c?c:Math.abs(i-o)/60),className:"slider",id:"myRange",onChange:l}))}}function pE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mE(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?pE(Object(t),!0).forEach((function(n){vE(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pE(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function gE(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function yE(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){gE(a,r,i,o,s,"next",e)}function s(e){gE(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function vE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}"undefined"!=typeof window&&window.devicePixelRatio;class bE extends We{constructor(){var e;super(...arguments),e=this,vE(this,"state",{basemap:{opacity:.2,desaturate:0},dataOpacity:1,initialView:{latitude:51.47,longitude:.45,zoom:4,bearing:0,pitch:0},mouseDown:!1,autoZoom:!1}),vE(this,"onDelta",(e=>{null!=e&&e.geoJsonLayers&&this.state.autoZoom&&this.fitBounds()})),vE(this,"fitBounds",function(){var t=yE((function*(){var t,n,r,i,o=null===(t=e.ref)||void 0===t||null===(n=t.deck)||void 0===n||null===(r=n.getViewports)||void 0===r||null===(i=r.call(n))||void 0===i?void 0:i[0],s=yield e.props.onGetFullExtent();if(o&&s){e.transitioning=!0;try{var a=[[Math.max(s[0][0],-179.9),Math.max(s[0][1],-89.9)],[Math.min(s[1][0],179.9),Math.min(s[1][1],89.9)]],l=new rf(o),{longitude:c,latitude:u,zoom:h}=o.fitBounds(a,{padding:20});l=mE(mE({},o),{},{longitude:c,latitude:u,zoom:Math.min(h,15),transitionInterpolator:new hE({speed:2}),transitionDuration:800,onTransitionEnd:()=>{e.transitioning=!1,e.onViewStateChange(l)}}),e.setState({initialView:l})}catch(t){console.error(t),e.transitioning=!1}}}));return function(){return t.apply(this,arguments)}}()),vE(this,"isHovering",!1)}onViewStateChange(e){var{onMapStateChange:t,mapStateChangeDebounce:n}=this.props;!this.transitioning&&t&&e&&(this.viewStateDebounce&&window.clearTimeout(this.viewStateDebounce),this.viewStateDebounce=setTimeout((()=>{var n=new rf(e),r=n.unproject([0,0]),i=n.unproject([n.width,n.height]),o=[r[0],i[1]],s=[i[0],r[1]];t(mE(mE({},e),{},{extent:[...o,...s]})),this.viewStateDebounce=null}),n||300))}render(){var t,n,r=this,{geoJsonLayers:i=[],onHover:o,initialState:s={},onLoad:a,onClick:l,tileURLs:c,tileSize:u,tileAttribution:h}=this.props,{basemap:d,dataOpacity:f=1,initialView:p,mouseDown:m,autoZoom:g}=this.state;if(!c)return null;var y=i.map((e=>new lv({id:e.id,data:{type:"FeatureCollection",features:e.features},filled:!0,pointRadiusMinPixels:2,pointRadiusScale:1,getPointRadius:e=>{var t,n;return null!==(t=null===(n=e.properties)||void 0===n?void 0:n.radius)&&void 0!==t?t:1},extruded:!!e.elevation,getElevation:e.elevation||0,getFillColor:t=>{var n;return(null===(n=t.properties)||void 0===n?void 0:n.fillColor)||e.fillColor||[200,0,80,255]},getLineColor:e.lineColor||[200,0,80,255],lineWidthMinPixels:2,widthScale:22,lineWidth:e=>{var t,n;return null!==(t=null===(n=e.properties)||void 0===n?void 0:n.lineWidth)&&void 0!==t?t:1},pickable:!0,autoHighlight:!0,onClick:e.onClick,opacity:f}))),v=[xE(mE(mE({},d),{},{tileURLs:c,tileSize:u})),...y];return e.createElement("div",{className:"relative f-1",ref:e=>{e&&(this.refRoot=e)},onMouseDown:()=>{this.setState({mouseDown:!0})},onMouseUp:()=>{this.setState({mouseDown:!1})}},(null==h?void 0:h.title)&&e.createElement("div",{className:"text-ellipsis noselect rounded font-14",style:{position:"absolute",right:0,bottom:0,maxHeight:"1.5em",zIndex:1,backdropFilter:"blur(6px)",padding:"4px"}},e.createElement("a",{href:h.url,target:"_blank"},null==h?void 0:h.title)),e.createElement(Aw,{key:"".concat(null===(t=this.refRoot)||void 0===t?void 0:t.offsetWidth,"_").concat(null===(n=this.refRoot)||void 0===n?void 0:n.offsetHeight),ref:e=>{e&&(this.ref=e)},onLoad:()=>{null==a||a({fitBounds:this.fitBounds,getExtent:()=>{var e,t,n=new rf(null===(e=this.ref)||void 0===e||null===(t=e.deck)||void 0===t?void 0:t.viewState);return[n.unproject([0,0]),n.unproject([n.width,n.height])]}})},controller:!0,initialViewState:this.transitioning?p:mE(mE({},p),s),width:"100%",height:"100%",layers:v,getCursor:e=>{var{isDragging:t}=e;return t?"grabbing":this.isHovering?"pointer":"grab"},onClick:l,onHover:m?void 0:e=>{var{object:t,x:n,y:r}=e;if(o&&JSON.stringify(t||{})!==JSON.stringify(this.currHoverObject||{})){var i=this.refRoot.getBoundingClientRect(),s={x:n,y:r,xScreen:i.x+n,yScreen:i.y+r};this.isHovering=!!t,this.currHoverObject=t?mE({},t):t,o(t||void 0,s)}return null},onViewStateChange:e=>{var{viewState:t}=e;this.onViewStateChange(t)}}),e.createElement("div",{className:"map-controls-right ",style:{position:"absolute",right:0,top:0,bottom:0}},window.isMobileDevice&&e.createElement(et,{iconPath:re,style:{marginLeft:"-4em"}}),e.createElement(fE,{label:"Basemap opacity "+"".concat(d.opacity.toFixed(1)),min:0,max:1,value:d.opacity,onChange:e=>{this.setState({basemap:mE(mE({},d),{},{opacity:+e.target.value})})}}),e.createElement(fE,{label:"Basemap desaturate "+"".concat(d.desaturate.toFixed(1)),min:-15,max:15,value:d.desaturate,onChange:e=>{this.setState({basemap:mE(mE({},d),{},{desaturate:+e.target.value})})}}),e.createElement(fE,{label:"Data opacity",min:0,max:1,value:f,onChange:e=>{this.setState({dataOpacity:+e.target.value})}}),e.createElement("div",{className:"w-full"},e.createElement(et,{title:"Zoom to data extent",iconPath:pe,style:{background:"white"},className:"b b-gray-200 mt-1",disabledInfo:g?"Must disable Auto zoom to data extent":void 0,onClick:function(){var e=yE((function*(){r.fitBounds()}));return function(){return e.apply(this,arguments)}}()},"Zoom to data extent"),e.createElement(et,{title:"Auto zoom to data extent",iconPath:pe,color:g?"action":void 0,style:{background:"white"},className:"b b-gray-200 mt-1",onClick:function(){var e=yE((function*(){r.setState({autoZoom:!g})}));return function(){return e.apply(this,arguments)}}()},"Auto Zoom to data extent"))))}}var wE=[];function xE(){var{opacity:e=1,desaturate:t=22,tileURLs:n=wE,onTilesLoad:r=null,showBorder:i=!1,tileSize:o=256,asMVT:s=!1}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return n&&Array.isArray(n)&&n.find((e=>"string"==typeof e))||(n=wE),new nE({opacity:e,desaturate:t,transparentColor:[255,255,255,255],data:n,maxRequests:20,pickable:!0,onViewportLoad:r,autoHighlight:i,highlightColor:[60,60,60,40],minZoom:0,maxZoom:19,tileSize:o,renderSubLayers:e=>{var{bbox:{west:t,south:n,east:r,north:o}}=e.tile;return[new lE(e,{data:null,image:e.data,bounds:[t,n,r,o]}),i&&new Ny({id:"".concat(e.id,"-border"),visible:e.visible,data:[[[t,o],[t,n],[r,n],[r,o],[t,o]]],getPath:e=>e,getColor:[255,0,0],widthMinPixels:4})]}})}function EE(){}function _E(e){return null==e?EE:function(){return this.querySelector(e)}}function SE(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function CE(){return[]}function TE(e){return null==e?CE:function(){return this.querySelectorAll(e)}}function OE(e){return function(){return this.matches(e)}}function PE(e){return function(t){return t.matches(e)}}var AE=Array.prototype.find;function kE(){return this.firstElementChild}var ME=Array.prototype.filter;function NE(){return Array.from(this.children)}function LE(e){return new Array(e.length)}function RE(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function IE(e){return function(){return e}}function DE(e,t,n,r,i,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new RE(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function jE(e,t,n,r,i,o,s){var a,l,c,u=new Map,h=t.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=t[a])&&(f[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new RE(e,o[a]);for(a=0;a<h;++a)(l=t[a])&&u.get(f[a])===l&&(i[a]=l)}function FE(e){return e.__data__}function zE(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function BE(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}RE.prototype={constructor:RE,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var UE="http://www.w3.org/1999/xhtml",VE={svg:"http://www.w3.org/2000/svg",xhtml:UE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function HE(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),VE.hasOwnProperty(t)?{space:VE[t],local:e}:e}function qE(e){return function(){this.removeAttribute(e)}}function WE(e){return function(){this.removeAttributeNS(e.space,e.local)}}function GE(e,t){return function(){this.setAttribute(e,t)}}function $E(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function YE(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function XE(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function KE(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ZE(e){return function(){this.style.removeProperty(e)}}function JE(e,t,n){return function(){this.style.setProperty(e,t,n)}}function QE(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function e_(e,t){return e.style.getPropertyValue(t)||KE(e).getComputedStyle(e,null).getPropertyValue(t)}function t_(e){return function(){delete this[e]}}function n_(e,t){return function(){this[e]=t}}function r_(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function i_(e){return e.trim().split(/^|\s+/)}function o_(e){return e.classList||new s_(e)}function s_(e){this._node=e,this._names=i_(e.getAttribute("class")||"")}function a_(e,t){for(var n=o_(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function l_(e,t){for(var n=o_(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function c_(e){return function(){a_(this,e)}}function u_(e){return function(){l_(this,e)}}function h_(e,t){return function(){(t.apply(this,arguments)?a_:l_)(this,e)}}function d_(){this.textContent=""}function f_(e){return function(){this.textContent=e}}function p_(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function m_(){this.innerHTML=""}function g_(e){return function(){this.innerHTML=e}}function y_(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function v_(){this.nextSibling&&this.parentNode.appendChild(this)}function b_(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function w_(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===UE&&t.documentElement.namespaceURI===UE?t.createElement(e):t.createElementNS(n,e)}}function x_(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function E_(e){var t=HE(e);return(t.local?x_:w_)(t)}function __(){return null}function S_(){var e=this.parentNode;e&&e.removeChild(this)}function C_(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function T_(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function O_(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function P_(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function A_(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function k_(e,t,n){var r=KE(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function M_(e,t){return function(){return k_(this,e,t)}}function N_(e,t){return function(){return k_(this,e,t.apply(this,arguments))}}s_.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var L_=[null];function R_(e,t){this._groups=e,this._parents=t}function I_(){return new R_([[document.documentElement]],L_)}R_.prototype=I_.prototype={constructor:R_,select:function(e){"function"!=typeof e&&(e=_E(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=t[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=e.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new R_(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return SE(e.apply(this,arguments))}}(e):TE(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s,a=t[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(e.call(s,s.__data__,c,a)),i.push(s));return new R_(r,i)},selectChild:function(e){return this.select(null==e?kE:function(e){return function(){return AE.call(this.children,e)}}("function"==typeof e?e:PE(e)))},selectChildren:function(e){return this.selectAll(null==e?NE:function(e){return function(){return ME.call(this.children,e)}}("function"==typeof e?e:PE(e)))},filter:function(e){"function"!=typeof e&&(e=OE(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new R_(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,FE);var n=t?jE:DE,r=this._parents,i=this._groups;"function"!=typeof e&&(e=IE(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,f=zE(e.call(u,u&&u.__data__,c,r)),p=f.length,m=a[c]=new Array(p),g=s[c]=new Array(p),y=l[c]=new Array(d);n(u,h,m,g,y,f,t);for(var v,b,w=0,x=0;w<p;++w)if(v=m[w]){for(w>=x&&(x=w+1);!(b=g[x])&&++x<p;);v._next=b||null}}return(s=new R_(s,r))._enter=a,s._exit=l,s},enter:function(){return new R_(this._enter||this._groups.map(LE),this._parents)},exit:function(){return new R_(this._exit||this._groups.map(LE),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=n[l],h=r[l],d=u.length,f=a[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<i;++l)a[l]=n[l];return new R_(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=BE);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new R_(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],s=0,a=o.length;s<a;++s)(i=o[s])&&e.call(i,i.__data__,s,o);return this},attr:function(e,t){var n=HE(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?WE:qE:"function"==typeof t?n.local?XE:YE:n.local?$E:GE)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?ZE:"function"==typeof t?QE:JE)(e,t,null==n?"":n)):e_(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?t_:"function"==typeof t?r_:n_)(e,t)):this.node()[e]},classed:function(e,t){var n=i_(e+"");if(arguments.length<2){for(var r=o_(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?h_:t?c_:u_)(n,t))},text:function(e){return arguments.length?this.each(null==e?d_:("function"==typeof e?p_:f_)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?m_:("function"==typeof e?y_:g_)(e)):this.node().innerHTML},raise:function(){return this.each(v_)},lower:function(){return this.each(b_)},append:function(e){var t="function"==typeof e?e:E_(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:E_(e),r=null==t?__:"function"==typeof t?t:_E(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(S_)},clone:function(e){return this.select(e?T_:C_)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=O_(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?A_:P_,r=0;r<s;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?N_:M_)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};var D_=I_,j_={value:()=>{}};function F_(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new z_(r)}function z_(e){this._=e}function B_(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function U_(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function V_(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=j_,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}z_.prototype=F_.prototype={constructor:z_,on:function(e,t){var n,r=this._,i=B_(e+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=i[o]).type)r[n]=V_(r[n],e.name,t);else if(null==t)for(n in r)r[n]=V_(r[n],e.name,null);return this}for(;++o<s;)if((n=(e=i[o]).type)&&(n=U_(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new z_(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var H_,q_,W_=F_,G_=0,$_=0,Y_=0,X_=0,K_=0,Z_=0,J_="object"==typeof performance&&performance.now?performance:Date,Q_="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function eS(){return K_||(Q_(tS),K_=J_.now()+Z_)}function tS(){K_=0}function nS(){this._call=this._time=this._next=null}function rS(e,t,n){var r=new nS;return r.restart(e,t,n),r}function iS(){K_=(X_=J_.now())+Z_,G_=$_=0;try{!function(){eS(),++G_;for(var e,t=H_;t;)(e=K_-t._time)>=0&&t._call.call(void 0,e),t=t._next;--G_}()}finally{G_=0,function(){for(var e,t,n=H_,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:H_=t);q_=e,sS(r)}(),K_=0}}function oS(){var e=J_.now(),t=e-X_;t>1e3&&(Z_-=t,X_=e)}function sS(e){G_||($_&&($_=clearTimeout($_)),e-K_>24?(e<1/0&&($_=setTimeout(iS,e-J_.now()-Z_)),Y_&&(Y_=clearInterval(Y_))):(Y_||(X_=J_.now(),Y_=setInterval(oS,1e3)),G_=1,Q_(iS)))}function aS(e,t,n){var r=new nS;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}nS.prototype=rS.prototype={constructor:nS,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?eS():+n)+(null==t?0:+t),this._next||q_===this||(q_?q_._next=this:H_=this,q_=this),this._call=e,this._time=n,sS()},stop:function(){this._call&&(this._call=null,this._time=1/0,sS())}};var lS=W_("start","end","cancel","interrupt"),cS=[];function uS(e,t,n,r,i,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(l){var c,u,h,d;if(1!==n.state)return a();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return aS(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[c])}if(aS((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=rS((function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:lS,tween:cS,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function hS(e,t){var n=fS(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function dS(e,t){var n=fS(e,t);if(n.state>3)throw new Error("too late; already running");return n}function fS(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pS(e,t){var n,r,i,o=e.__transition,s=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete e.__transition}}var mS,gS=180/Math.PI,yS={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vS(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*gS,skewX:Math.atan(l)*gS,scaleX:s,scaleY:a}}function bS(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,r,i,o,s,a){if(e!==i||r!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:xn(e,i)},{i:l-2,x:xn(r,o)})}else(i||o)&&s.push("translate("+i+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:xn(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:xn(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,s.skewX,a,l),function(e,t,n,r,o,s){if(e!==n||t!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:xn(e,n)},{i:a-2,x:xn(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var wS=bS((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yS:vS(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),xS=bS((function(e){return null==e?yS:(mS||(mS=document.createElementNS("http://www.w3.org/2000/svg","g")),mS.setAttribute("transform",e),(e=mS.transform.baseVal.consolidate())?vS((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):yS)}),", ",")",")");function ES(e,t){var n,r;return function(){var i=dS(this,e),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function _S(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=dS(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function SS(e,t,n){var r=e._id;return e.each((function(){var e=dS(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return fS(e,r).value[t]}}function CS(e,t){var n;return("number"==typeof t?xn:t instanceof en?yn:(n=en(t))?(t=n,yn):Cn)(e,t)}function TS(e){return function(){this.removeAttribute(e)}}function OS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function PS(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function AS(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function kS(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttribute(e)}}function MS(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function NS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function LS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function RS(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&LS(e,i)),n}return i._value=t,i}function IS(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&NS(e,i)),n}return i._value=t,i}function DS(e,t){return function(){hS(this,e).delay=+t.apply(this,arguments)}}function jS(e,t){return t=+t,function(){hS(this,e).delay=t}}function FS(e,t){return function(){dS(this,e).duration=+t.apply(this,arguments)}}function zS(e,t){return t=+t,function(){dS(this,e).duration=t}}function BS(e,t){if("function"!=typeof t)throw new Error;return function(){dS(this,e).ease=t}}function US(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?hS:dS;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}var VS=D_.prototype.constructor;function HS(e){return function(){this.style.removeProperty(e)}}function qS(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function WS(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&qS(e,o,n)),r}return o._value=t,o}function GS(e){return function(t){this.textContent=e.call(this,t)}}function $S(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&GS(r)),t}return r._value=e,r}var YS=0;function XS(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function KS(){return++YS}var ZS=D_.prototype;XS.prototype=function(e){return D_().transition(e)}.prototype={constructor:XS,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=_E(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=r[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=e.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,uS(h[d],t,n,d,h,fS(a,n)));return new XS(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=TE(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,c=r[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=e.call(l,l.__data__,h,c),p=fS(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&uS(d,t,n,m,f,p);o.push(f),s.push(l)}return new XS(o,s,t,n)},selectChild:ZS.selectChild,selectChildren:ZS.selectChildren,filter:function(e){"function"!=typeof e&&(e=OE(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new XS(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,c=t[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<r;++a)s[a]=t[a];return new XS(s,this._parents,this._name,this._id)},selection:function(){return new VS(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=KS(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=fS(s,t);uS(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new XS(r,this._parents,e,n)},call:ZS.call,nodes:ZS.nodes,node:ZS.node,size:ZS.size,empty:ZS.empty,each:ZS.each,on:function(e,t){var n=this._id;return arguments.length<2?fS(this.node(),n).on.on(e):this.each(US(n,e,t))},attr:function(e,t){var n=HE(e),r="transform"===n?xS:CS;return this.attrTween(e,"function"==typeof t?(n.local?MS:kS)(n,r,SS(this,"attr."+e,t)):null==t?(n.local?OS:TS)(n):(n.local?AS:PS)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=HE(e);return this.tween(n,(r.local?RS:IS)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?wS:CS;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=e_(this,e),s=(this.style.removeProperty(e),e_(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}(e,r)).on("end.style."+e,HS(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var s=e_(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=e_(this,e)),s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a))}}(e,r,SS(this,"style."+e,t))).each(function(e,t){var n,r,i,o,s="style."+t,a="end."+s;return function(){var l=dS(this,e),c=l.on,u=null==l.value[s]?o||(o=HS(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var s=e_(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,WS(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(SS(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,$S(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=fS(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?ES:_S)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?DS:jS)(t,e)):fS(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?FS:zS)(t,e)):fS(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(BS(t,e)):fS(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;dS(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=dS(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t})),0===i&&o()}))},[Symbol.iterator]:ZS[Symbol.iterator]};var JS={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function QS(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}D_.prototype.interrupt=function(e){return this.each((function(){pS(this,e)}))},D_.prototype.transition=function(e){var t,n;e instanceof XS?(t=e._id,e=e._name):(t=KS(),(n=JS).time=eS(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&uS(s,e,t,c,a,n||QS(s,t));return new XS(r,this._parents,e,t)};const{abs:eC,max:tC,min:nC}=Math;function rC(e){return{type:e}}function iC(e){return"string"==typeof e?new R_([[document.querySelector(e)]],[document.documentElement]):new R_([[e]],L_)}function oC(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}["w","e"].map(rC),["n","s"].map(rC),["n","w","e","s","nw","ne","sw","se"].map(rC);const sC={passive:!1},aC={capture:!0,passive:!1};function lC(e){e.stopImmediatePropagation()}function cC(e){e.preventDefault(),e.stopImmediatePropagation()}function uC(e){var t=e.document.documentElement,n=iC(e).on("dragstart.drag",cC,aC);"onselectstart"in t?n.on("selectstart.drag",cC,aC):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function hC(e,t){var n=e.document.documentElement,r=iC(e).on("dragstart.drag",null);t&&(r.on("click.drag",cC,aC),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var dC=e=>()=>e;function fC(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function pC(e){return!e.ctrlKey&&!e.button}function mC(){return this.parentNode}function gC(e,t){return null==t?{x:e.x,y:e.y}:t}function yC(){return navigator.maxTouchPoints||"ontouchstart"in this}function vC(e){return function(){return e}}function bC(e){return 1e-6*(e()-.5)}function wC(e){return e.index}function xC(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function EC(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,s,a,l,c,u,h,d,f=e._root,p={data:r},m=e._x0,g=e._y0,y=e._x1,v=e._y1;if(!f)return e._root=p,e;for(;f.length;)if((c=t>=(o=(m+y)/2))?m=o:y=o,(u=n>=(s=(g+v)/2))?g=s:v=s,i=f,!(f=f[h=u<<1|c]))return i[h]=p,e;if(a=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===a&&n===l)return p.next=f,i?i[h]=p:e._root=p,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(c=t>=(o=(m+y)/2))?m=o:y=o,(u=n>=(s=(g+v)/2))?g=s:v=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return i[d]=f,i[h]=p,e}function _C(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function SC(e){return e[0]}function CC(e){return e[1]}function TC(e,t,n){var r=new OC(null==t?SC:t,null==n?CC:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function OC(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function PC(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}fC.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var AC=TC.prototype=OC.prototype;AC.copy=function(){var e,t,n=new OC(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=PC(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=PC(t));return n},AC.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return EC(this.cover(t,n),t,n,e)},AC.addAll=function(e){var t,n,r,i,o=e.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(s[n]=r,a[n]=i,r<l&&(l=r),r>u&&(u=r),i<c&&(c=i),i>h&&(h=i));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)EC(this,s[n],a[n],e[n]);return this},AC.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s,a,l=i-n||1,c=this._root;n>e||e>=i||r>t||t>=o;)switch(a=(t<r)<<1|e<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},AC.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},AC.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},AC.find=function(e,t,n){var r,i,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new _C(m,u,h,d,f)),null==n?n=1/0:(u=e-n,h=t-n,d=e+n,f=t+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(m.length){var g=(i+s)/2,y=(o+a)/2;p.push(new _C(m[3],g,y,s,a),new _C(m[2],i,y,g,a),new _C(m[1],g,o,s,y),new _C(m[0],i,o,g,y)),(c=(t>=y)<<1|e>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var v=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),w=v*v+b*b;if(w<n){var x=Math.sqrt(n=w);u=e-x,h=t-x,d=e+x,f=t+x,r=m.data}}return r},AC.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n,r,i,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+g)/2))?p=a:g=a,(u=s>=(l=(m+y)/2))?m=l:y=l,t=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):t?(i?t[h]=i:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},AC.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},AC.root=function(){return this._root},AC.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},AC.visit=function(e){var t,n,r,i,o,s,a=[],l=this._root;for(l&&a.push(new _C(l,this._x0,this._y0,this._x1,this._y1));t=a.pop();)if(!e(l=t.node,r=t.x0,i=t.y0,o=t.x1,s=t.y1)&&l.length){var c=(r+o)/2,u=(i+s)/2;(n=l[3])&&a.push(new _C(n,c,u,o,s)),(n=l[2])&&a.push(new _C(n,r,u,c,s)),(n=l[1])&&a.push(new _C(n,c,i,o,u)),(n=l[0])&&a.push(new _C(n,r,i,c,u))}return this},AC.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new _C(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,s=t.x0,a=t.y0,l=t.x1,c=t.y1,u=(s+l)/2,h=(a+c)/2;(o=i[0])&&n.push(new _C(o,s,a,u,h)),(o=i[1])&&n.push(new _C(o,u,a,l,h)),(o=i[2])&&n.push(new _C(o,s,h,u,c)),(o=i[3])&&n.push(new _C(o,u,h,l,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},AC.x=function(e){return arguments.length?(this._x=e,this):this._x},AC.y=function(e){return arguments.length?(this._y=e,this):this._y};const kC=4294967296;function MC(e){return e.x}function NC(e){return e.y}var LC=Math.PI*(3-Math.sqrt(5));function RC(e){var t,n,r,i=vC(.1);function o(e){for(var i,o=0,s=t.length;o<s;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function s(){if(t){var o,s=t.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=vC(null==e?0:+e)),o.initialize=function(e){t=e,s()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:vC(+e),s(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:vC(+t),s(),o):e},o}var IC=Math.sqrt(50),DC=Math.sqrt(10),jC=Math.sqrt(2);function FC(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=IC?10:o>=DC?5:o>=jC?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=IC?10:o>=DC?5:o>=jC?2:1)}function zC(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function BC(e){let t=e,n=e,r=e;function i(e,t,i=0,o=e.length){if(i<o){if(0!==n(t,t))return o;do{const n=i+o>>>1;r(e[n],t)<0?i=n+1:o=n}while(i<o)}return i}return 2!==e.length&&(t=(t,n)=>e(t)-n,n=zC,r=(t,n)=>zC(e(t),n)),{left:i,center:function(e,n,r=0,o=e.length){const s=i(e,n,r,o-1);return s>r&&t(e[s-1],n)>-t(e[s],n)?s-1:s},right:function(e,t,i=0,o=e.length){if(i<o){if(0!==n(t,t))return o;do{const n=i+o>>>1;r(e[n],t)<=0?i=n+1:o=n}while(i<o)}return i}}}const UC=BC(zC),VC=UC.right;UC.left,BC((function(e){return null===e?NaN:+e})).center;var HC=VC;function qC(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function WC(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function GC(){}var $C=.7,YC=1/$C,XC="\\s*([+-]?\\d+)\\s*",KC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ZC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JC=/^#([0-9a-f]{3,8})$/,QC=new RegExp("^rgb\\("+[XC,XC,XC]+"\\)$"),eT=new RegExp("^rgb\\("+[ZC,ZC,ZC]+"\\)$"),tT=new RegExp("^rgba\\("+[XC,XC,XC,KC]+"\\)$"),nT=new RegExp("^rgba\\("+[ZC,ZC,ZC,KC]+"\\)$"),rT=new RegExp("^hsl\\("+[KC,ZC,ZC]+"\\)$"),iT=new RegExp("^hsla\\("+[KC,ZC,ZC,KC]+"\\)$"),oT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function sT(){return this.rgb().formatHex()}function aT(){return this.rgb().formatRgb()}function lT(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=JC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?cT(t):3===n?new fT(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?uT(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?uT(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=QC.exec(e))?new fT(t[1],t[2],t[3],1):(t=eT.exec(e))?new fT(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=tT.exec(e))?uT(t[1],t[2],t[3],t[4]):(t=nT.exec(e))?uT(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=rT.exec(e))?yT(t[1],t[2]/100,t[3]/100,1):(t=iT.exec(e))?yT(t[1],t[2]/100,t[3]/100,t[4]):oT.hasOwnProperty(e)?cT(oT[e]):"transparent"===e?new fT(NaN,NaN,NaN,0):null}function cT(e){return new fT(e>>16&255,e>>8&255,255&e,1)}function uT(e,t,n,r){return r<=0&&(e=t=n=NaN),new fT(e,t,n,r)}function hT(e){return e instanceof GC||(e=lT(e)),e?new fT((e=e.rgb()).r,e.g,e.b,e.opacity):new fT}function dT(e,t,n,r){return 1===arguments.length?hT(e):new fT(e,t,n,null==r?1:r)}function fT(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function pT(){return"#"+gT(this.r)+gT(this.g)+gT(this.b)}function mT(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function gT(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function yT(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new bT(e,t,n,r)}function vT(e){if(e instanceof bT)return new bT(e.h,e.s,e.l,e.opacity);if(e instanceof GC||(e=lT(e)),!e)return new bT;if(e instanceof bT)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new bT(s,a,l,e.opacity)}function bT(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function wT(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function xT(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}qC(GC,lT,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:sT,formatHex:sT,formatHsl:function(){return vT(this).formatHsl()},formatRgb:aT,toString:aT}),qC(fT,dT,WC(GC,{brighter:function(e){return e=null==e?YC:Math.pow(YC,e),new fT(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?$C:Math.pow($C,e),new fT(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pT,formatHex:pT,formatRgb:mT,toString:mT})),qC(bT,(function(e,t,n,r){return 1===arguments.length?vT(e):new bT(e,t,n,null==r?1:r)}),WC(GC,{brighter:function(e){return e=null==e?YC:Math.pow(YC,e),new bT(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?$C:Math.pow($C,e),new bT(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new fT(wT(e>=240?e-240:e+120,i,r),wT(e,i,r),wT(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var ET=e=>()=>e;function _T(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):ET(isNaN(e)?t:e)}var ST=function e(t){var n=function(e){return 1==(e=+e)?_T:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):ET(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=dT(e)).r,(t=dT(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),s=_T(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function CT(e){return function(t){var n,r,i=t.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=dT(t[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=e(o),s=e(s),a=e(a),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=a(e),r+""}}}function TT(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=RT(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=o[n](e);return s}}function OT(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function PT(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function AT(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=RT(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}CT((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return xT((n-r/t)*t,s,i,o,a)}})),CT((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return xT((n-r/t)*t,i,o,s,a)}}));var kT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,MT=new RegExp(kT.source,"g");function NT(e,t){var n,r,i,o=kT.lastIndex=MT.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=kT.exec(e))&&(r=MT.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:PT(n,r)})),o=MT.lastIndex;return o<t.length&&(i=t.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function LT(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function RT(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?ET(t):("number"===i?PT:"string"===i?(n=lT(t))?(t=n,ST):NT:t instanceof lT?ST:t instanceof Date?OT:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?TT:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?AT:PT:LT))(e,t)}function IT(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function DT(e){return+e}var jT=[0,1];function FT(e){return e}function zT(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function BT(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=zT(i,r),o=n(s,o)):(r=zT(r,i),o=n(o,s)),function(e){return o(r(e))}}function UT(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=zT(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=HC(e,t,1,r)-1;return o[n](i[n](t))}}function VT(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function HT(){return function(){var e,t,n,r,i,o,s=jT,a=jT,l=RT,c=FT;function u(){var e,t,n,l=Math.min(s.length,a.length);return c!==FT&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?UT:BT,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),a,l)))(e(c(t)))}return h.invert=function(n){return c(t((o||(o=r(a,s.map(e),PT)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,DT),u()):s.slice()},h.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},h.rangeRound=function(e){return a=Array.from(e),l=IT,u()},h.clamp=function(e){return arguments.length?(c=!!e||FT,u()):c!==FT},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}()(FT,FT)}function qT(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var WT,GT=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $T(e){if(!(t=GT.exec(e)))throw new Error("invalid format: "+e);var t;return new YT({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function YT(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function XT(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function KT(e){return(e=XT(Math.abs(e)))?e[1]:NaN}function ZT(e,t){var n=XT(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}$T.prototype=YT.prototype,YT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var JT={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ZT(100*e,t),r:ZT,s:function(e,t){var n=XT(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(WT=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+XT(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function QT(e){return e}var eO,tO,nO,rO=Array.prototype.map,iO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oO(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,i,o,s,a=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(s=FC(e,t,n))||!isFinite(s))return[];if(s>0){let n=Math.round(e/s),r=Math.round(t/s);for(n*s<e&&++n,r*s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(e*s),r=Math.round(t*s);for(n/s<e&&++n,r/s>t&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)/s}return r&&o.reverse(),o}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var i,o=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=IC?i*=10:o>=DC?i*=5:o>=jC&&(i*=2),t<e?-i:i}(e,t,n);switch((r=$T(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(KT(t)/3)))-KT(Math.abs(e)))}(o,s))||(r.precision=i),nO(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,KT(t)-KT(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-KT(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return tO(r)}(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(i=l,l=c,c=i,i=s,s=a,a=i);u-- >0;){if((i=FC(l,c,n))===r)return o[s]=l,o[a]=c,t(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function sO(){var e=HT();return e.copy=function(){return VT(e,sO())},qT.apply(e,arguments),oO(e)}eO=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?QT:(t=rO.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?QT:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(rO.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=$T(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):JT[v]||(void 0===g&&(g=12),y=!0,v="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",x=JT[v],E=/[defgprs%]/.test(v);function _(e){var i,o,l,d=b,_=w;if("c"===v)_=x(e)+_,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,_=("s"===v?iO[8+WT/3]:"")+_+(S&&"("===h?")":""),E)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){_=(46===l?s+e.slice(i+1):e.slice(i))+_,e=e.slice(0,i);break}}m&&!f&&(e=r(e,1/0));var C=d.length+e.length+_.length,T=C<p?new Array(p-C+1).join(t):"";switch(m&&f&&(e=r(T+e,T.length?p-_.length:1/0),T=""),n){case"<":e=d+e+_+T;break;case"=":e=d+T+e+_;break;case"^":e=T.slice(0,C=T.length>>1)+d+e+_+T.slice(C);break;default:e=T+d+e+_}return a(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:h,formatPrefix:function(e,t){var n=h(((e=$T(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(KT(t)/3))),i=Math.pow(10,-r),o=iO[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),tO=eO.format,nO=eO.formatPrefix;const aO=Math.PI,lO=2*aO,cO=1e-6,uO=lO-cO;function hO(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function dO(){return new hO}hO.prototype=dO.prototype={constructor:hO,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-e,l=r-t,c=o-e,u=s-t,h=c*c+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>cO)if(Math.abs(u*a-l*c)>cO&&i){var d=n-o,f=r-s,p=a*a+l*l,m=d*d+f*f,g=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((aO-Math.acos((p+h-m)/(2*g*y)))/2),b=v/y,w=v/g;Math.abs(b-1)>cO&&(this._+="L"+(e+b*c)+","+(t+b*u)),this._+="A"+i+","+i+",0,0,"+ +(u*d>c*f)+","+(this._x1=e+w*a)+","+(this._y1=t+w*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),l=e+s,c=t+a,u=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>cO||Math.abs(this._y1-c)>cO)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%lO+lO),h>uO?this._+="A"+n+","+n+",0,1,"+u+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>cO&&(this._+="A"+n+","+n+",0,"+ +(h>=aO)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var fO=dO,pO=Array.prototype.slice;function mO(e){return function(){return e}}function gO(e){return e[0]}function yO(e){return e[1]}function vO(e){return e.source}function bO(e){return e.target}function wO(e){var t=vO,n=bO,r=gO,i=yO,o=null;function s(){var s,a=pO.call(arguments),l=t.apply(this,a),c=n.apply(this,a);if(o||(o=s=fO()),e(o,+r.apply(this,(a[0]=l,a)),+i.apply(this,a),+r.apply(this,(a[0]=c,a)),+i.apply(this,a)),s)return o=null,s+""||null}return s.source=function(e){return arguments.length?(t=e,s):t},s.target=function(e){return arguments.length?(n=e,s):n},s.x=function(e){return arguments.length?(r="function"==typeof e?e:mO(+e),s):r},s.y=function(e){return arguments.length?(i="function"==typeof e?e:mO(+e),s):i},s.context=function(e){return arguments.length?(o=null==e?null:e,s):o},s}function xO(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}function EO(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+i)/2,r,n,r,i)}function _O(e){return((e=Math.exp(e))+1/e)/2}var SO=function e(t,n,r){function i(e,i){var o,s,a=e[0],l=e[1],c=e[2],u=i[0],h=i[1],d=i[2],f=u-a,p=h-l,m=f*f+p*p;if(m<1e-12)s=Math.log(d/c)/t,o=function(e){return[a+e*f,l+e*p,c*Math.exp(t*e*s)]};else{var g=Math.sqrt(m),y=(d*d-c*c+r*m)/(2*c*n*g),v=(d*d-c*c-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(v*v+1)-v);s=(w-b)/t,o=function(e){var r,i=e*s,o=_O(b),u=c/(n*g)*(o*(r=t*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[a+u*f,l+u*p,c*o/_O(t*i+b)]}}return o.duration=1e3*s*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4),CO=e=>()=>e;function TO(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function OO(e,t,n){this.k=e,this.x=t,this.y=n}OO.prototype={constructor:OO,scale:function(e){return 1===e?this:new OO(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new OO(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var PO=new OO(1,0,0);function AO(e){e.stopImmediatePropagation()}function kO(e){e.preventDefault(),e.stopImmediatePropagation()}function MO(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function NO(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function LO(){return this.__zoom||PO}function RO(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function IO(){return navigator.maxTouchPoints||"ontouchstart"in this}function DO(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function jO(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function FO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zO(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?FO(Object(t),!0).forEach((function(n){BO(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):FO(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function BO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}OO.prototype;class UO extends e.Component{render(){var t,n,{className:r="",style:i={},items:o,onReorder:s,onClose:a,selectedValue:l,checkedValues:c,anchorRef:u,anchorContent:h}=this.props,d=e.createElement("ul",{className:"list-comp f-1 o-auto min-h-0 min-w-0 no-scroll-bar"+r,role:"list",ref:e=>{e&&(this.refList=e)},style:zO({padding:0},i)},o.length?o.map(((t,n)=>e.createElement("li",{key:n,role:"listitem",draggable:!!s,onDrag:s?e=>{var t=e.currentTarget,n=t.parentElement;t.style.display="none",Array.from(n.children).map(((t,r)=>{var i=t.getBoundingClientRect(),o=e.clientY>i.y&&e.clientY<i.y+i.height,s=o?"".concat(35,"px"):"";s!==t.style.paddingTop&&(t.style.paddingTop=s),o&&(n._targetIdx=r)}));var r=n.getBoundingClientRect();e.clientY>r.y+r.height?n.scrollTop+=10:e.clientY<r.y&&(n.scrollTop-=10)}:void 0,onDragEnd:s?function(){var e,t=(e=function*(e){var t,r,i,a=e.currentTarget,l=a.parentElement,c=l._targetIdx,u=o.slice(0);t=n,r=c,i=u.splice(t,1)[0],u.splice(r,0,i),yield s(u),setTimeout((()=>{Array.from(l.children).map((e=>{e.style.paddingTop=""})),a.style.display="flex"}),1)},function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){jO(a,r,i,o,s,"next",e)}function s(e){jO(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))});return function(){return t.apply(this,arguments)}}():void 0,className:"flex-row  p-p5 pointer "+(t.key===l?" selected ":""),onClick:t.onPress?e=>t.onPress(e):void 0,onKeyUp:t.onPress?e=>{"Enter"===e.key&&t.onPress(e)}:void 0},t.content||e.createElement(e.Fragment,null,t.contentLeft||null,e.createElement("label",{className:"mr-p5 f-1 flex-row pointer noselect",style:t.style},t.node||t.label||t.key),t.contentRight||null,c?e.createElement(it,{className:"f-0",checked:c.includes(t.key),style:{marginRight:"12px"}}):null)))):e.createElement("div",{className:"p-p5"},"No results"));return u&&(t=u,n=d),h&&(t=this.popupAnchor,n=e.createElement("div",{className:"list-comp w-fit flex-col bg-white",style:{padding:0,margin:0,textDecoration:"none",listStyle:"none"}},e.createElement("div",{ref:e=>{e&&(this.popupAnchor=e)},className:"f-0 min-h-0 min-w-0 m-p5 flex-row jc-start "},n),d)),t&&n?e.createElement(pt,{open:!0,rootStyle:{padding:0},anchorEl:t,positioning:"beneath-left",clickCatchStyle:{opacity:0},onClose:a,contentClassName:"rounded",focusTrap:!1},n):t||n?null:d}}function VO(){return VO=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},VO.apply(this,arguments)}function HO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qO(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?HO(Object(t),!0).forEach((function(n){$O(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):HO(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function WO(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function GO(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){WO(a,r,i,o,s,"next",e)}function s(e){WO(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function $O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YO=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0,r=n;if(n&&t){var i=(r=n.slice(0)).findIndex((e=>"*"===e));-1<i&&r.splice(i,0,...t.map((e=>e.name)));var o=r.findIndex((e=>"**"===e));-1<o&&r.splice(o,0,...t.filter((e=>{var t;return null===(t=e.references)||void 0===t?void 0:t.ftable})).map((e=>({name:e.references.ftable,fieldConfigs:["*"]})))),r=r.filter((e=>!["*","**"].includes(e)))}var s=t=>({name:t.name,label:t.label,renderValue:"uuid"===t.udt_name?t=>e.createElement("div",{className:"pointer",title:"Click to copy ID",onClick:()=>{navigator.clipboard.writeText(t)}},t?t.slice(0,5):t,"..."):["postcode","post_code"].includes(t.name)?n=>n?e.createElement("a",{className:"flex-col",target:"_blank",href:"https://www.google.com/maps/search/".concat(n)},e.createElement("span",null,KM.renderValue(t,n))):KM.renderValue(t,n):"boolean"===t.tsDataType?t=>e.createElement(it,{title:(t||"NULL").toString(),checked:t,className:"no-pointer-events",readOnly:!0}):void 0}),a=r?r.map((e=>{if("string"!=typeof e)return e;var n=t.find((t=>t.name===e));return n?s(n):void console.error("Could not find column ".concat(e,". Incorrect name or not allowed"))})).filter((e=>e)):t.map((e=>s(e)));return a};class XO extends We{constructor(){var e;super(...arguments),e=this,$O(this,"state",{editMode:!1,columns:void 0,variant:void 0}),$O(this,"onDelta",GO((function*(){var{tableName:t,db:n,columns:r}=e.props;if(!e.state.columns){var i=r;r?e.setState({columns:r}):i=yield n[t].getColumns(),e.setState({columns:i})}})))}render(){var{tableName:t,db:n,defaultData:r,onChange:i,className:o="",style:s={},disableVariantToggle:a=!1,hideColumns:l,fieldConfigs:c,footer:u=null,enableInsert:h=!1,includeMedia:d,title:f,smartFormProps:p={},excludeNulls:m,tables:g}=this.props,{columns:y,editMode:v}=this.state,b="row-wrap",w=this.state.variant||this.props.variant||b;if(!y)return e.createElement(Xe,null);var x,E=y.find((e=>e.is_pkey&&r[e.name]));E&&r[E.name]&&(x={[E.name]:r[E.name]});var _=null==n?void 0:n[t],S={view:!(!(null==_?void 0:_.find)||!x),delete:!(!(null==_?void 0:_.delete)||!x)};S=qO(qO({},S),{},x?{update:!!i||!(!(null==_?void 0:_.update)||!x)}:{insert:null!=_&&_.insert});var C,T="row-wrap"===w?"flex-row-wrap ai-center":"row"===w?"flex-row ai-center":"flex-col ai-start ";v&&(C=e.createElement(pt,{open:!0,rootStyle:{padding:0},contentClassName:"",onClose:()=>{this.setState({editMode:!1})}},e.createElement(lo,VO({db:n,tables:g,tableName:t,onChange:i,rowFilter:x,confirmUpdates:!0,hideChangesOptions:!0,enableInsert:h,includeMedia:d},p,{onClose:()=>{this.setState({editMode:!1})}}))));var O=l?y.filter((e=>l.includes(e.name))):y,P=(XO.parseFieldConfigs(c)||YO(O||this.props.columns)).filter((e=>!e.hide)).map((e=>({name:e.name,col:O.find((t=>e.name===t.name)),fc:e}))).filter((e=>{var{name:t,fc:n}=e;return(null==n?void 0:n.render)||!m||null!==r[t]})).map(((t,n)=>{var i,o,s,{name:a,fc:l,col:c}=t;return e.createElement("div",{key:n,className:"flex-col mr-p5 mt-p5 p-p5 o-auto "+((null==l?void 0:l.className)||""),style:null==l?void 0:l.style},e.createElement("div",{className:"font-12 text-gray-400 noselect",title:c.udt_name||""},(null==l?void 0:l.label)||(null==c?void 0:c.label)),(null==l||null===(i=l.render)||void 0===i?void 0:i.call(l,r[a],r))||e.createElement("div",{className:"font-16 text-gray-800 mt-p5"},null!==(o=null==l||null===(s=l.renderValue)||void 0===s?void 0:s.call(l,r[a],r))&&void 0!==o?o:KM.renderValue(c,r[a])))}));return e.createElement(e.Fragment,null,C,e.createElement("div",{className:"card bg-white relative "+T+" ".concat(o," ")+(a?"":" pointer "),style:qO({padding:window.isMobileDevice?".25em":"1em"},s),onClick:a?void 0:()=>{var e=this.state.variant||"row";this.setState({variant:"row"===e?"col":"col"===e?b:"row"})}},S.update||S.delete||S.view?e.createElement(et,{className:"f-0 absolute ",style:{top:"0.25em",right:"0.25em"},iconPath:S.update||S.delete?ye:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z",onClick:()=>{this.setState({editMode:!0})}}):null,e.createElement("div",{className:"flex-col min-w-0 min-h-0 f-1"},e.createElement("div",{className:"f-0"},f),e.createElement("div",{className:"o-auto f-1 min-w-0 min-h-0 "+T},P),null==u?void 0:u(r))))}}function KO(){return KO=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},KO.apply(this,arguments)}function ZO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function JO(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ZO(Object(t),!0).forEach((function(n){tP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ZO(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function QO(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function eP(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){QO(a,r,i,o,s,"next",e)}function s(e){QO(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function tP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nP(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new rP(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function rP(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return rP=function(e){this.s=e,this.n=e.next},rP.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new rP(e)}$O(XO,"parseFieldConfigs",((e,t)=>{if(e){if("*"===e&&(e=["*"]),!Array.isArray(e))throw"Expecting an array of fieldConfigs";var n=[];e.slice(0).forEach((e=>{"string"==typeof e?t?n=n.concat(YO(t,[e])):n.push({name:e}):n.push(e)}));var r=n.find(((e,t)=>n.find(((n,r)=>e.name===n.name&&t!==r))));return r&&console.log("Duplicate field config name found: "+r.name),n}}));class iP extends We{constructor(){var t;super(...arguments),t=this,tP(this,"state",{items:[],tableInfo:void 0,joinedInfo:{},tableColumns:void 0,insertMode:!1,detailedFilter:[]}),tP(this,"loaded",!1),tP(this,"onDataChanged",(()=>{this.setData()})),tP(this,"setData",eP((function*(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:t.state.fieldConfigs,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.state.tableInfo,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t.state.tableColumns;if(n){var{tableName:o,db:s,dataItems:a,select:l,limit:c,disableSubscribe:u}=t.props,{detailedFilter:h=[]}=t.state,{orderByKey:d,orderAsc:f}=t.getSort(),p=ki((null===(e=t.props.detailedFilter)||void 0===e?void 0:e.value)||h);if(!a&&null!=s&&s[o]){var m=JSON.stringify(p),g=JSON.stringify({orderByKey:d,orderAsc:f});t.dataRequest={filterStr:m,orderByStr:g};var y=l,v=function(){var e=eP((function*(e,t,n){var i,o,a,l,c,u=e.slice(0),h={},d=!1,f=!1;try{for(var p,m=function*(){var e=p.value;if("fieldConfigs"in e){if(e.name===r.media_table_name)h[e.name]={id:1,name:1,url:1,content_type:1};else if(h[e.name]=e.select,!e.select){var n,i=yield null===(n=s[e.name])||void 0===n?void 0:n.getColumns();h[e.name]=yield v(XO.parseFieldConfigs(e.fieldConfigs,i),i,e.name)}}else e.select?h[e.name]=e.select:t.find((t=>t.name===e.name&&t.select))&&(h[e.name]=1)},g=nP(u);d=!(p=yield g.next()).done;d=!1)yield*m()}catch(e){f=!0,c=e}finally{try{d&&null!=g.return&&(yield g.return())}finally{if(f)throw c}}(null!==(i=s[n])&&void 0!==i&&i.update||null!==(o=s[n])&&void 0!==o&&o.insert||null!==(a=s[n])&&void 0!==a&&a.delete||null!==(l=s[n])&&void 0!==l&&l.find)&&t.filter((e=>e.is_pkey)).map((e=>{e.is_pkey&&!h[e.name]&&(h[e.name]=1)}));return h}));return function(){return e.apply(this,arguments)}}(),b={};d&&(b={orderBy:{[d]:!!f}}),Number.isFinite(c)&&0<c&&(b=JO(JO({},b),{},{limit:c})),!y&&n&&(y=yield v(n,i,o));var w=e=>{t.dataRequest.filterStr===m&&t.dataRequest.orderByStr===g&&t.setState({items:e})};if(!u&&s[o].subscribe){var x,E;t.setState({loadingData:!0}),null!==(x=t.itemsSub)&&void 0!==x&&x[o]&&(yield null===(E=t.itemsSub)||void 0===E?void 0:E[o].unsubscribe()),t.itemsSub[o]=yield s[o].subscribe(p,JO({select:y},b),(e=>{w(e),t.setState({loadingData:!1})})),yield Promise.all(n.map(function(){var e=eP((function*(e){var n;"fieldConfigs"in e&&e.fieldConfigs&&(null===(n=t.itemsSub)||void 0===n||!n[e.name])&&(t.itemsSub[e.name]=yield s[e.name].subscribe({},{limit:0},(()=>{t.setData(),t.setState({loadingData:!1})})))}));return function(){return e.apply(this,arguments)}}()))}else{t.setState({loadingData:!0});var _=yield s[o].find(p,JO({select:y},b));t.setState({items:_,loadingData:!1})}}else a&&t.setState({items:a})}}))),tP(this,"itemsSub",{}),tP(this,"onDelta",function(){var e=eP((function*(e,n){var{tableName:r,db:i,dataItems:o,fieldConfigs:s,detailedFilter:a}=t.props;if(r&&i&&!i[r]&&console.error("Invalid/Dissallowed tableName given to SmartCardView -> "+r),t.loaded&&(e&&"detailedFilter"in e||e&&"fieldConfigs"in e||null!=e&&e.dataItems||null!=e&&e.select||n&&("orderByKey"in n||"orderAsc"in n||"filter"in n||"detailedFilter"in n)))t.setData();else if(null!=i&&i[r]&&!t.loaded){var l=t.props.tableInfo||t.state.tableInfo,c={},u=t.state.tableColumns;if(!t.loaded){t.loaded=!0,l=l||(yield i[r].getInfo()),u=t.props.columns||(yield i[r].getColumns());var h={},d=XO.parseFieldConfigs(s||["*"],u);d&&(yield Promise.all(d.map(function(){var e=eP((function*(e){if("fieldConfigs"in e){var t,n,r=yield null===(t=i[e.name])||void 0===t?void 0:t.getInfo(),o=yield null===(n=i[e.name])||void 0===n?void 0:n.getColumns();h=JO(JO({},h),{},{[e.name]:{tableInfo:r,tableColumns:o}})}}));return function(){return e.apply(this,arguments)}}()))),t.setData(d,l,u),c={tableInfo:l,tableColumns:u,joinedInfo:h,fieldConfigs:d},t.setState(c)}}}));return function(){return e.apply(this,arguments)}}()),tP(this,"renderMedia",(t=>{var{file:n,i:r,onDelete:i,style:o={},onClick:s}=t,{type:a="",url:l,name:c}=n,u=null;if(l){var h={maxWidth:"100%",maxHeight:"100%"};a.startsWith("image")?u=e.createElement("img",{loading:"lazy",src:l,style:h}):a.startsWith("video")?u=e.createElement("video",{style:h,controls:!0,src:l}):a.startsWith("audio")&&(u=e.createElement("audio",{style:h,controls:!0,src:l}))}return e.createElement("div",{key:r,className:"m-p5 relative flex-col b b-gray-300 ",style:JO({width:"150px",height:"150px"},o)},s?e.createElement("div",{className:"absolute w-full h-full pointer",style:{zIndex:1},onClick:e=>{e.stopPropagation(),e.preventDefault(),s()}}):null,i?e.createElement(et,{style:{position:"absolute",top:"10px",right:"10px",zIndex:2,backgroundColor:"white"},className:"shadow",iconPath:oe,title:"Remove file",onClick:()=>{i()}}):null,e.createElement("div",{className:"f-1 min-w-0 min-h-0 flex-row ai-center"},u),c?e.createElement("div",{className:"f-0 noselect p-p5 text-gray-500 font-14 absolute w-full",style:{position:"absolute",zIndex:1,bottom:0,color:"white",background:"linear-gradient(to bottom, rgb(255 255 255 / 0%) 0%,#00000075 70%)"}},c):null)})),tP(this,"getSort",(()=>{var{fieldConfigs:e}=this.state,{sortableFields:t}=this.props,{orderByKey:n=(null==t?void 0:t[0]),orderAsc:r=!0}=this.state;return e&&(!n||null!=e&&e.find((e=>e.name===n)))?{orderByKey:n,orderAsc:r}:{}}))}onUnmount(){Object.values(this.itemsSub).map((e=>null==e?void 0:e.unsubscribe()))}render(){var t,n,{tableName:r,depth:i=0,footer:o,db:s,includeMedia:a,title:l,smartFormProps:c={},variant:u="row-wrap",sortableFields:h,smartCardProps:d,filterFields:f,tables:p,w:m}=this.props,{items:g,joinedInfo:y,tableInfo:v,tableColumns:b,insertMode:w,fieldConfigs:x,loadingData:E}=this.state,{orderByKey:_,orderAsc:S}=((null===(t=this.props.detailedFilter)||void 0===t?void 0:t.value)||this.state.detailedFilter,this.getSort());if(!v||!x)return null;var C=b.find((e=>e.is_pkey&&x.find((t=>t.name===e.name&&!t.select))));if(null!=v&&v.is_media)return e.createElement(e.Fragment,null,void 0,e.createElement("div",{className:"flex-row f-1 o-auto min-w-0 min-h-o",style:{maxHeight:"500px"}},e.createElement(eo,{media:g.map((e=>JO(JO({},e),{},{id:e.id,url:e.url,content_type:e.content_type,name:e.original_name})))})));var T,O=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return i?JO(JO({},e),{},{boxShadow:"unset",borderRadius:"unset"},t):e}(this.props.style,{border:"unset"});w&&null!=c&&c.enableInsert&&(T=e.createElement(lo,KO({asPopup:!0,db:s,tables:p,tableName:r,hideChangesOptions:!0,defaultData:void 0,includeMedia:a},c,{onClose:e=>{var t;e&&(null!==(t=this.props)&&void 0!==t&&t.onDataChanged?this.props.onDataChanged():this.setData()),this.setState({insertMode:!1})}})));var P=[];x.forEach((e=>{var t=null==h?void 0:h.includes(e.name);return t&&"fieldConfigs"in e?(console.error("Cannot sort by a joined table field: "+e.name),!1):(t&&P.push({name:e.name,label:e.label}),t)})),b.map((e=>{null!=h&&h.includes(e.name)&&!P.some((t=>t.name===e.name))&&P.push({name:e.name,label:e.label})}));var A=null!=c&&c.enableInsert&&null!=s&&null!==(n=s[r])&&void 0!==n&&n.insert?e.createElement(et,{className:"f-0 mr-2 shadow mt-p5 absolute b b-active",style:{backgroundColor:"white",right:"1em",bottom:"1em",zIndex:2},iconPath:we,onClick:()=>{this.setState({insertMode:!0})},variant:"outline",color:"action"}):null,k=P.length?e.createElement("div",{className:"ml-auto flex-row min-h-0 f-0 relative ai-center mt-p5"},e.createElement(eN,{id:"orderbycomp",buttonClassName:"shadow",label:"Sort by",asRow:!0,value:_,fullOptions:P.map((e=>({key:e.name,label:e.label||e.name}))),onChange:e=>{this.setState({orderByKey:e})}}),e.createElement(et,{iconPath:S?"M3 11H15V13H3M3 18V16H21V18M3 6H9V8H3Z":"M3,13H15V11H3M3,6V8H21V6M3,18H9V16H3V18Z",onClick:()=>{this.setState({orderAsc:!S})}})):null,M=(x||[]).filter((e=>!("fieldConfigs"in e)||e.render)),N=(x||[]).filter((e=>"fieldConfigs"in e&&!e.render));return e.createElement("div",{className:"flex-col min-h-0 f-1 relative  ",style:{}},m&&e.createElement(Mo,{w:m,db:s,tables:p,leftContent:T,rightContent:k}),A,e.createElement("div",{className:"flex-col o-auto f-1 relative p-1 pt-0"},E&&e.createElement(Xe,{variant:"cover",delay:1}),g.length&&i?e.createElement("div",{className:"bottom-fader"}):null,g.map(((t,n)=>e.createElement("div",{key:C&&t[C.name]||n,className:"flex-col "+(n?" mt-1 ":"")+(parent?"":" card ")+(i?" b b-gray-300 ":""),style:{}},e.createElement(XO,KO({tables:p,db:s,tableName:r,style:O,defaultData:t,variant:u,disableVariantToggle:!0,includeMedia:a,title:l&&l(t,b),fieldConfigs:M},d,{smartFormProps:c,footer:()=>{var n;return e.createElement("div",{className:"flex-col "},N.map(((n,r)=>{var o,l,c;return e.createElement("div",{key:"j"+r,className:"flex-col mt-p5 "+(parent?"":"p-1")},e.createElement("div",{className:"mb-p25 mt-p5 p-p5 font-bold noselect"},n.label||n.name),e.createElement(iP,{db:s,tableName:n.name,style:{border:"unset",padding:0},dataItems:t[n.name],fieldConfigs:n.fieldConfigs,columns:null==y||null===(o=y[n.name])||void 0===o?void 0:o.tableColumns,depth:i+1,includeMedia:a,smartFormProps:n.smartFormProps,excludeNulls:null==n||null===(l=n.smartCardProps)||void 0===l?void 0:l.excludeNulls,smartCardProps:null==n?void 0:n.smartCardProps,onDataChanged:(null===(c=this.props)||void 0===c?void 0:c.onDataChanged)||this.onDataChanged}))})),null==d||null===(n=d.footer)||void 0===n?void 0:n.call(d,t))}})),null==o?void 0:o(t,b))))))}}function oP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sP(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?oP(Object(t),!0).forEach((function(n){cP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oP(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function aP(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function lP(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){aP(a,r,i,o,s,"next",e)}function s(e){aP(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function cP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uP(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new hP(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function hP(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return hP=function(e){this.s=e,this.n=e.next},hP.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new hP(e)}class dP extends We{constructor(){var t;super(...arguments),t=this,cP(this,"state",{loadingLayers:!1,loading:!1,wSync:null,minimised:!1,lqs:[],error:null,showError:!1,hoverObj:void 0,hoverCoords:void 0,hovData:void 0,layerExtras:{},bytesPerSec:0}),cP(this,"goToDataExtent",lP((function*(){var e;try{var n,r;(e=yield t.getDataExtent())&&(null===(n=t.d.w)||void 0===n||n.$update({options:{extent:e.flat()}},{deepMerge:!0}),null===(r=t.map)||void 0===r||r.fitBounds(e))}catch(e){var i;return(null===(i=t.state.error)||void 0===i?void 0:i.toString())!==e.toString()&&t.setState({error:e,showError:!0}),void console.error(e)}}))),cP(this,"gettingExtent",!1),cP(this,"onDelta",function(){var e=lP((function*(e,n,r){var i=sP(sP(sP({},e),n),r),o={};if(t.d.w){var s,a,l;t.gettingExtent||null!==(s=t.d.w.options)&&void 0!==s&&s.extent||null===(a=t.props.layerQueries)||void 0===a||!a.length||(t.gettingExtent=!0,setTimeout((()=>{t.mounted&&(t.goToDataExtent(),t.gettingExtent=!1)}),600));var c=null===(l=i.w)||void 0===l?void 0:l.options,u=Object.keys(c||{});if(Object.keys(i.w||{}),i&&(null!=i&&i.layerExtras||i.layerQueries||i.joinFilter||c||u.includes("refresh"))&&(t.setLayerData(),u.includes("refresh"))){var{refresh:h}=t.d.w.options;t.autoRefreshInterval&&(clearInterval(t.autoRefreshInterval),t.autoRefreshInterval=void 0),"Interval"===(null==h?void 0:h.type)&&null!=h&&h.intervalSeconds&&(t.autoRefreshInterval=setInterval((()=>{t.setLayerData()}),1e3*h.intervalSeconds))}}dM(o)||t.setState(o)}));return function(){return e.apply(this,arguments)}}()),cP(this,"layerSubs",[]),cP(this,"getFilter",((e,t)=>{var{geomColumn:n,filter:r,joinFilter:i,tableName:o}=e,s=i,a={["".concat(n,".&&.st_makeenvelope")]:t};return{finalFilter:s||(r?{$and:[a,r]}:a),finalFilterWOextent:s||r||{}}})),cP(this,"getSQL",(function(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.sql)throw"No SQL";var i=(null===(n=e.sql)||void 0===n?void 0:n.trim())+"";i.endsWith(";")&&(i=i.slice(0,i.length-1)),i="SELECT ".concat(t," FROM ( \n  ").concat(i," \n ) t LIMIT ").concat(r);var o=sP(sP({},e.parameters),{},{geomColumn:e.geomColumn});return{sql:i,args:o}})),cP(this,"getDataExtent",lP((function*(){var e,n,r,i,o,s,a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],{db:l}=t.props,c=!1,u=!1;try{for(var h,d=uP(t.props.layerQueries);c=!(h=yield d.next()).done;c=!1){var f,p,m,g,y,v,b,w,x=h.value;if("tableName"in x){var{tableName:E,geomColumn:_}=x,{finalFilterWOextent:S}=t.getFilter(x,[]);o=yield l[E].findOne(S,{select:{e:{$ST_Extent:[_]}}})}else{var C=t.getSQL(x,"ST_Extent(${geomColumn:name}::geometry) as e");try{o=yield l.sql(C.sql,C.args,{returnType:"row"})}catch(e){console.error(e)}}if(null===(f=o)||void 0===f||!f.e)return void(a&&alert("No data to zoom to"));var[[T,O],[P,A]]=null===(p=o)||void 0===p||null===(m=p.e)||void 0===m||null===(g=m.slice(4,-1))||void 0===g?void 0:g.split(",").map((e=>e.split(" ").map((e=>+e))));e=Math.min(null!==(y=e)&&void 0!==y?y:T,T),r=Math.max(null!==(v=r)&&void 0!==v?v:P,P),n=Math.min(null!==(b=n)&&void 0!==b?b:O,O),i=Math.max(null!==(w=i)&&void 0!==w?w:A,A)}}catch(e){u=!0,s=e}finally{try{c&&null!=d.return&&(yield d.return())}finally{if(u)throw s}}return void 0===e?void 0:[[e,n],[r,i]]}))),cP(this,"dataSignature",""),cP(this,"lastDataRequest",Date.now()),cP(this,"setLayerData",lP((function*(){var e,n,r,i,o,{db:s,layerQueries:a=[]}=t.props,{w:l}=t.d,c=(null==l||null===(e=l.options)||void 0===e?void 0:e.extent)||[-180,-90,180,90],u={},h=1e5,{bytesPerSec:d,loadingLayers:f}=t.state;if(s&&l&&null!=l&&null!==(n=l.options)&&void 0!==n&&n.extent)try{t.setState({loadingLayers:!0}),t.lastDataRequest=Date.now(),t.layerSubs.filter((e=>!a.find((t=>"tableName"in t&&t.tableName===e.tableName&&JSON.stringify(t.filter)===e.filter)))).map((e=>{e.sub.unsubscribe()})),Date.now();var p=yield Promise.all(a.map(function(){var e=lP((function*(e){var n,r,i,o,a,u,{geomColumn:f,sourceW:p}=e,m=!1;if("tableName"in e){var g,y,v,b,w,x,E,_,S,{tableName:C,geomColumn:T,filter:O}=sP({},e);a=C,u=T;var P=(null==l||null===(g=l.options)||void 0===g?void 0:g.zoom)||1,A=t.getFilter(e,c),k=Date.now(),M=yield s[C].findOne(A.finalFilter,{select:{c:{$ST_AsGeoJSON:[T]}}}),N=(Date.now()-k)/1e3;d=4*JSON.stringify(M||{}).length/N;var L={select:{$rowhash:1,l:{$ST_AsGeoJSON:[T]}},limit:h};if(!M||!t.ref)return{id:"tbl"+Date.now(),features:[],pickable:!0,stroked:!0,filled:!0};var R=Math.abs(c[0]-c[2]),I=Math.abs(c[1]-c[3]),D=t.ref.offsetWidth,j=t.ref.offsetHeight,F=(Math.min(D,j),Math.min(R,I));if((null==M||null===(y=M.c)||void 0===y||!y.type.endsWith("Point"))&&30<((null==M||null===(v=M.c)||void 0===v?void 0:v.coordinates)||[]).flat().flat().flat().length){var z=(7<P?sO().range([0,.005]).domain([9,7]).clamp(!0):sO().range([.005,.05]).domain([7,1]).clamp(!0))(P);0<z&&(L={select:{$rowhash:1,l:{$ST_Simplify:[T,z]}},limit:h})}var B=jo.getDataRequestSignature(sP({filter:A.finalFilter},L));if(B===t.dataSignature)return{duplicate:!0};var U=yield s[C].size(A.finalFilter);if(m=+U/1e3/d>(null!==(b=null===(w=t.d)||void 0===w||null===(x=w.w)||void 0===x||null===(E=x.options)||void 0===E?void 0:E.secondWaitTime)&&void 0!==b?b:2)){var V,H,q=sO().range([20,300]).domain([.001,.1]),W=sO().range([.07,5e-4]).domain([.886,.007166])(F);(o=yield s[C].find(A.finalFilter,{select:{c:{$countAll:[]},l:{$ST_SnapToGrid:[T,W]}},limit:h})).forEach((e=>{var t,n,{c:r}=e;V=Math.min(null!==(t=V)&&void 0!==t?t:+r,+r),H=Math.max(null!==(n=H)&&void 0!==n?n:+r,+r)}));var G=q(F),$=sO().range([1,G]).domain([V,H]);o=o.map((e=>sP(sP({},e),{},{radius:$(+e.c)})))}else{var Y=sO().range([1,10,80,100]).domain([20,14,10,1]).clamp(!0);i=yield s[C].find(A.finalFilter,L);var X=Y(P);i=i.map((e=>sP(sP({},e),{},{radius:X})))}o&&(o=o.filter((e=>{var t,n;return null===(t=e.l)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.length}))),i&&(i=i.filter((e=>{var t,n;return null===(t=e.l)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.length}))),t.dataSignature=B;var K,Z,J,Q=O||{},ee=JSON.stringify(Q);s[C].subscribe&&"Realtime"===(null===(_=l.options)||void 0===_||null===(S=_.refresh)||void 0===S?void 0:S.type)&&!t.layerSubs.find((e=>e.filter===ee&&e.tableName===C))&&t.layerSubs.push({tableName:C,filter:ee,sub:yield s[C].subscribe(Q,{limit:2,throttle:1e3*(null!==(K=null===(Z=l.options)||void 0===Z||null===(J=Z.refresh)||void 0===J?void 0:J.throttleSeconds)&&void 0!==K?K:0)},(()=>{t.setLayerData()}))})}else if("sql"in e){if(!s.sql)return void console.error("Not enough privileges to run query");var{sql:te,parameters:ne}=e,re=te.trim()+"";re.endsWith(";")&&(re=re.slice(0,re.length-1));var ie='SELECT md5(((t.*))::text) as "$rowhash", ST_AsGeoJSON(ST_SetSRID(${geomColumn:name}, 4326))::json as l FROM ( \n'+re+"\n ) t LIMIT "+h;i=yield s.sql(ie,sP(sP({},ne),{},{geomColumn:f}),{returnType:"rows"})}var oe=i||o||[];oe=oe.filter((e=>e.l));var se=oe.find((e=>"object"!=typeof e.l));se&&(console.error("Bad GeoJSON data. Expecting type object but got -> "+typeof se.l,se),oe=[]);var{layerExtras:ae}=t.state,le=(null==ae||null===(n=ae[e.wid])||void 0===n?void 0:n.color)||e.fillColor,ce=(null==ae||null===(r=ae[e.wid])||void 0===r?void 0:r.color)||e.lineColor;return{id:"sql"+Date.now(),features:oe.map((e=>({type:"Feature",geometry:e.l,properties:sP(sP({radius:+e.radius||1},e),{},{tableName:a,geomColumn:u,fillColor:(()=>{var n,r;!m&&p.table_name&&p.columns&&p.columns.filter((e=>{var t,n;return(null===(t=e.style)||void 0===t?void 0:t.type)&&"None"!==(null===(n=e.style)||void 0===n?void 0:n.type)}));var{clickedItem:i}=t.state;return null!==(n=e.l)&&void 0!==n&&null!==(r=n.type)&&void 0!==r&&r.includes("Polygon")?le.slice(0,3).concat([200]):le})()})}))),pickable:!0,stroked:!0,filled:!0,elevation:e.elevation,fillColor:e=>e.properties.fillColor,lineColor:ce,getLineColor:()=>[22,22,22,222],getLineWidth:()=>1211,lineWidth:1222}}));return function(){return e.apply(this,arguments)}}()));u={layers:p}}catch(e){o=e}null!==(r=u)&&void 0!==r&&null!==(i=r.layers)&&void 0!==i&&i.some((e=>e.duplicate))&&delete u.layers,t.setState(sP(sP({},u),{},{loadingLayers:!1,error:o,bytesPerSec:d}))}))),cP(this,"onHover",function(){var e=lP((function*(e,n){var{db:r,tables:i}=t.props;t.hoveredObj=e;var o=JSON.stringify(e);if(t.hovering){if(t.hovering.hoverObjStr===o)return;clearTimeout(t.hovering.timeout)}e?t.hovering={hoverObj:sP({},e),hoverObjStr:o,timeout:setTimeout(lP((function*(){var s;if((null===(s=t.hovering)||void 0===s?void 0:s.hoverObjStr)===o){var a,{tableName:l,$rowhash:c,sql:u,c:h}=e.properties;if(h)a={Count:h};else if(l){var d=i.find((e=>e.name===l));if(d){var f=d.columns.filter((e=>["geography","geometry"].includes(e.udt_name))).reduce(((e,t)=>sP(sP({},e),{},{[t.name]:0})),{});a=yield r[l].findOne({$rowhash:c},{select:f})}}t.hovering=void 0,t.setState({hoverObj:e,hoverCoords:n,hovData:a})}})),300)}:(t.hovering=void 0,t.setState({hoverObj:e,hoverCoords:n,hovData:void 0}))}));return function(){return e.apply(this,arguments)}}()),cP(this,"getMenu",(t=>{var n,r,i,o,s,a,l,c,u,h,{layerQueries:d=[]}=this.props,{tileURL:f,bytesPerSec:p}=this.state,m=[];Array.isArray(t.columns)&&(m=t.columns.filter((e=>{var t;return"None"!==(null===(t=e.style)||void 0===t?void 0:t.type)}))),null==t||t.options;var g,y={};m.length&&(y={Color:{leftIconPath:"M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z",content:e.createElement(eN,{label:"Bin size",variant:"div",className:"w-fit b b-gray-300 mb-1",options:m.map((e=>{var{name:t}=e;return t})),value:null===(g=this.d.w.options)||void 0===g?void 0:g.colorField,onChange:e=>{var t;null===(t=this.d.w)||void 0===t||t.$update({options:{colorField:e}},{deepMerge:!0})}})}});var v=null!==(n=t.options)&&void 0!==n&&null!==(r=n.tileURLs)&&void 0!==r&&r.length?null===(i=t.options)||void 0===i?void 0:i.tileURLs:wE;return e.createElement(yr,{variant:"vertical",compactMode:!0,contentClass:"p-1",items:sP(sP({"Auto Refresh":{leftIconPath:"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z",content:si(t)},Basemap:{leftIconPath:ge,content:e.createElement("div",{className:"flex-col"},e.createElement(aN,{type:"text",label:"Attribution",autoComplete:"off",asColumn:!0,value:null==t||null===(o=t.options)||void 0===o||null===(s=o.tileAttribution)||void 0===s?void 0:s.title,onChange:e=>{var n;t.$update({options:{tileAttribution:sP(sP({},(null==t||null===(n=t.options)||void 0===n?void 0:n.tileAttribution)||{}),{},{title:e})}},{deepMerge:!0})}}),e.createElement(aN,{type:"url",label:"Attribution URL",autoComplete:"off",asColumn:!0,value:null==t||null===(a=t.options)||void 0===a||null===(l=a.tileAttribution)||void 0===l?void 0:l.url,onChange:e=>{var n;t.$update({options:{tileAttribution:sP(sP({},(null==t||null===(n=t.options)||void 0===n?void 0:n.tileAttribution)||{}),{},{url:e})}},{deepMerge:!0})}}),e.createElement("div",{className:"ta-left text-gray-600 font-medium mt-1"},"Tile URLs"),v.map(((n,r)=>e.createElement("div",{key:r,className:"flex-row ai-center py-p5 o-auto"},e.createElement(et,{iconPath:le,color:"danger",onClick:()=>{t.$update({options:{tileURLs:v.filter((e=>e!==n))}},{deepMerge:!0})}}),e.createElement(Mr,{variant:"naked",value:n})))),e.createElement("div",{className:"ta-left text-gray-400"},"Delete all tiles to restore default"),e.createElement("div",{className:"flex-row mt-1"},e.createElement(aN,{type:"text",asTextArea:!0,value:f,onChange:e=>{this.setState({tileURL:e})}}),e.createElement(et,{iconPath:we,color:"action",onClick:()=>{var e=Array.from(new Set([...v,f]));t.$update({options:{tileURLs:e}},{deepMerge:!0}),this.setState({tileURL:""})}})),e.createElement(aN,{className:" mt-1",label:"Tile size",asColumn:!0,value:(null==t||null===(c=t.options)||void 0===c?void 0:c.tileSize)||256,options:[16,32,64,128,256,512,1024],onChange:e=>{t.$update({options:{tileSize:e}},{deepMerge:!0})}}))},Layers:{leftIconPath:"M12,18.54L19.37,12.8L21,14.07L12,21.07L3,14.07L4.62,12.81L12,18.54M12,16L3,9L12,2L21,9L12,16M12,4.53L6.26,9L12,13.47L17.74,9L12,4.53Z",content:e.createElement("div",{className:"flex-col"},d.map(((t,n)=>{var r,i,o,s;return"sql"in t&&t.sql?s=e.createElement(e.Fragment,null,e.createElement(Mr,{className:"mt-p25",variant:"naked",label:"SQL",value:t.sql}),e.createElement(Mr,{className:"mt-p25",variant:"naked",label:"Column",value:t.geomColumn})):"tableName"in t&&(s=e.createElement(e.Fragment,null,e.createElement(Mr,{className:"mt-p25",variant:"naked",label:"Table",value:t.tableName}),e.createElement(Mr,{className:"mt-p25",variant:"naked",label:"Column",value:t.geomColumn}))),e.createElement("div",{key:n,className:"flex-col ta-left p-1 b b-gray-300 rounded m-1"},e.createElement(Mr,{className:"mt-p25",variant:"naked",label:"ID",value:t.wid}),s,e.createElement(cr,{style:{flex:"none"},label:"Layer color",className:"w-fit mt-p5",value:null!==(r=null===(i=this.state.layerExtras)||void 0===i||null===(o=i[t.wid])||void 0===o?void 0:o.colorStr)&&void 0!==r?r:t.color,onChange:(e,n)=>{this.setState({layerExtras:sP(sP({},this.state.layerExtras),{},{[t.wid]:{color:n,colorStr:e}})})}}))})))}},y),{},{Settings:{leftIconPath:se,content:e.createElement("div",null,e.createElement(Mr,{className:"w-fit",variant:"naked",label:"Approx speed (MB/s)",value:(p/1e3).toFixed(1)}),e.createElement(aN,{className:"mt-1",asColumn:!0,type:"number",label:"Wait time in seconds",hint:"Will aggregate/simplify if data load takes longer than this",value:null!==(u=null==t||null===(h=t.options)||void 0===h?void 0:h.secondWaitTime)&&void 0!==u?u:2,inputProps:{min:0},onChange:e=>{var t,n;null===(t=this.d)||void 0===t||null===(n=t.w)||void 0===n||n.$update({options:{secondWaitTime:e}},{deepMerge:!0})}}))}})})}))}onMount(){var{db:e,w:t}=this.props;if(e&&!this.state.wSync){var n=t.$cloneSync(((e,t)=>{this.setData({w:e},{w:t})}));this.setState({wSync:n})}}onUnmount(){var e,t;null===(e=this.state.wSync)||void 0===e||null===(t=e.$unsync)||void 0===t||t.call(e),this.layerSubs.map((e=>{e.sub.unsubscribe()}))}render(){var t,n,r,i,{minimised:o=!1,layers:s=[],loadingLayers:a,error:l,showError:c,clickedItem:u,hoverCoords:h,hovData:d}=this.state,{w:f}=this.d,{onClickRow:p}=this.props;if(!f)return null;c&&(i=e.createElement(pt,{open:!0,onClose:()=>{this.setState({showError:!1})}},e.createElement("div",{className:"bg-white"},e.createElement(Fe,{error:l}))));var m,g=null;if(d&&h){var{xScreen:y,yScreen:v}=h;g=e.createElement(pt,{open:!0,clickCatchStyle:{display:"none"},anchorXY:{x:y,y:v},positioning:"tooltip",contentClassName:"p-p5"},e.createElement("div",{className:"bg-white o-auto flex-col"},Object.keys(d).map((t=>{var n=["string","number"].includes(typeof d[t])?"".concat(d[t]):JSON.stringify(d[t],null,2);return 20<n.length&&(n=n.slice(0,30)+"..."),e.createElement("div",{key:t,className:"flex-row ai-center",style:{marginBottom:"4px"}},e.createElement("div",{className:"text-medium text-gray font-12",style:{color:"var(--gray-400)",fontWeight:"bold"}},t,":"),e.createElement("div",{className:"ml-p5"},n))}))))}(a||l)&&(m=e.createElement("div",{className:"flex-row relative",style:{position:"absolute",top:"1em",left:"1em",zIndex:22}},a?e.createElement(Xe,{delay:100}):null,l?e.createElement(et,{className:"text-red-500",iconPath:J,onClick:()=>{this.setState({showError:!0})}}):null));var b=e.createElement(e.Fragment,null,g,i,o?null:e.createElement("div",{className:"relative f-1 flex-col o-hidden",ref:e=>{e&&(this.ref=e)},onPointerLeave:()=>{this.ref.style.cursor="default",this.onHover()}},m,e.createElement(bE,{onLoad:e=>{this.setLayerData(),this.map=e},onClick:e=>{var t,n,r,i,o=null==e||null===(t=e.object)||void 0===t||null===(n=t.properties)||void 0===n?void 0:n.$rowhash;p(o?{$rowhash:o}:void 0,null==e||null===(r=e.object)||void 0===r||null===(i=r.properties)||void 0===i?void 0:i.tableName),this.setState({clickedItem:null==e?void 0:e.object})},tileURLs:((null==f||null===(t=f.options)||void 0===t?void 0:t.tileURLs)||[]).map((e=>e.replaceAll("{Z}","{z}").replaceAll("{X}","{x}").replaceAll("{Y}","{y}"))),tileSize:(null==f||null===(n=f.options)||void 0===n?void 0:n.tileSize)||256,tileAttribution:null==f||null===(r=f.options)||void 0===r?void 0:r.tileAttribution,initialState:(null==f?void 0:f.options)||{},geoJsonLayers:s||[],onMapStateChange:e=>{var t,{extent:n,latitude:r,longitude:i,zoom:o,pitch:s,bearing:a}=e;null!=f&&null!==(t=f.options)&&void 0!==t&&t.extent&&f.$update({options:sP(sP({},f.options),{},{extent:n,latitude:r,longitude:i,zoom:o,pitch:s,bearing:a})},{deepMerge:!0})},onHover:this.onHover,onGetFullExtent:this.getDataExtent})));return e.createElement(Eo,{w:f,getMenu:this.getMenu},b)}}var fP=(e,t)=>{var n=null;for(var r in e)(null===n||e[r]<e[n])&&!t.includes(r)&&(n=r);return n};function pP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mP(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?pP(Object(t),!0).forEach((function(n){vP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pP(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function gP(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function yP(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){gP(a,r,i,o,s,"next",e)}function s(e){gP(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function vP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bP=[{key:"auto",label:"Auto"},{key:"year",label:"1 Year"},{key:"month",label:"1 Month"},{key:"week",label:"1 Week"},{key:"day",label:"1 Day"},{key:"8hour",label:"8 Hours"},{key:"4hour",label:"4 Hours"},{key:"2hour",label:"2 Hours"},{key:"hour",label:"1 Hour"},{key:"30minute",label:"30 Minutes"},{key:"15minute",label:"15 Minutes"},{key:"5minute",label:"5 Minutes"},{key:"minute",label:"1 Minute"},{key:"30second",label:"30 Seconds"},{key:"15second",label:"15 Seconds"},{key:"5second",label:"5 Seconds"},{key:"second",label:"1 Second"},{key:"millisecond",label:"1 Millisecond"},{key:"5millisecond",label:"5 Milliseconds"},{key:"10millisecond",label:"10 Milliseconds"},{key:"100millisecond",label:"100 Milliseconds"},{key:"250millisecond",label:"250 Milliseconds"},{key:"500millisecond",label:"500 Milliseconds"}],wP=[{label:"Count All",func:"$countAll"},{label:"Min",func:"$min"},{label:"Max",func:"$max"},{label:"Sum",func:"$sum"},{label:"Avg",func:"$avg"}];class xP extends We{constructor(){var t;super(...arguments),t=this,vP(this,"state",{resetExtent:0,xExtent:void 0,extent:void 0,loadingLayers:!1,loading:!1,wSync:null,layers:[],error:null,columns:[]}),vP(this,"onDelta",function(){var e=yP((function*(e,n,r){var i,o,s=Object.keys(mP(mP(mP({},e),n),r)),a={};(null!=r&&null!==(i=r.w)&&void 0!==i&&null!==(o=i.options)&&void 0!==o&&o.binSize||s&&["layerQueries","joinFilter","w","statType","statColumn","resetExtent","extent","db","dataAge"].find((e=>s.includes(e))))&&t.setLayerData(s),dM(a)||t.setState(a)}));return function(){return e.apply(this,arguments)}}()),vP(this,"getBin",((e,t)=>{var n=+new Date(t)-+new Date(e),r=n/31536e6,i=365*r,o=24*i,s=60*o,a=60*s,l=1e3*a,c={year:r,month:12*r,week:52*r,day:i,"8hour":o/8,"4hour":o/4,"2hour":o/2,hour:o,"30minute":s/30,"15minute":s/15,"5minute":s/5,minute:s,"30second":a/30,"15second":a/15,"5second":a/5,second:a,millisecond:l,"5millisecond":l/5,"10millisecond":l/10,"100millisecond":l/100,"250millisecond":l/250,"500millisecond":l/500},u=Object.keys(c).map((e=>({key:e,delta:c[e]-900,absDelta:Math.abs(c[e]-900)}))).filter((e=>0>e.delta)).sort(((e,t)=>e.absDelta-t.absDelta)),h="hour";return u.length&&(h=u[0].key),0>=n&&(h="millisecond"),h})),vP(this,"d",{lCols:{},w:void 0,extent:void 0,dataAge:0}),vP(this,"setDataAge",(e=>{this.dataAge=e,this.settingDataAge||(this.settingDataAge=setTimeout((()=>{this.setData({dataAge:this.dataAge}),this.settingDataAge=null}),300))})),vP(this,"setLayerData",yP((function*(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],{db:r,layerQueries:i=[]}=t.props,{extent:o}=t.state,{w:s}=t.d;if(s&&r){if(null===(e=s.options)||void 0===e||!e.statType)return void s.$update({options:{statType:"Count All"}},{deepMerge:!0});var a,l,{statType:c}=s.options,u={};try{t.setState({loadingLayers:!0});var h=yield Promise.all(i.map(function(){var e=yP((function*(e){var i=[],s=[],{dateColumn:l,tableName:u,sql:h,joinFilter:d,statColumn:f}=e;if(u){var p,m,g,y={$countAll:[]};if(f&&c&&"Count All"!==c){var v=wP.find((e=>e.label===c));v&&(y={[v.func]:[f]})}var b,w=36e5;if(o){var{leftDate:x,rightDate:E}=o;b={$and:[{[l]:{$gte:new Date(+x-w)}},{[l]:{$lte:new Date(+E+w)}}]}}var _=JSON.stringify(d),S=d;r[u].subscribe&&(!t.dataSub||t.dataSubFilter!==_)&&(t.dataSubFilter=_,t.dataSub&&(yield t.dataSub.unsubscribe()),t.dataSub=yield r[u].subscribe(S||{},{select:"",throttle:500},(()=>{t.setDataAge(Date.now())})));var C={$and:[S,b].filter((e=>e))},{min:T,max:O}=yield r[u].findOne(C,{select:{min:{$min:[l]},max:{$max:[l]}}}).catch(console.error),P=null===(p=t.d)||void 0===p||null===(m=p.w)||void 0===m||null===(g=m.options)||void 0===g?void 0:g.binSize,A=P?1e3:void 0,k={value:y,date:{["$date_trunc_"+(P||(o?t.getBin(o.leftDate,o.rightDate):t.getBin(T,O)))]:[l]}},M=yield r[u].findOne(S,{select:k,orderBy:{date:1}}).catch(console.error),N=yield r[u].findOne(S,{select:k,orderBy:{date:-1}}).catch(console.error);if((i=yield r[u].find(C,{select:k,orderBy:{date:1},limit:null!=A?A:905})).length){var L=i[0],R=i[i.length-1];M&&L.date!==M[l]&&(M.value=L.value,i.unshift(M)),N&&R.date!==N[l]&&(N.value=R.value,i.push(N))}if(i.map((e=>mP(mP({},e),{},{value:+e.value}))),!t.d.lCols[u]||n.includes("db")){var I=yield r[u].getColumns().catch(console.error);I&&(t.d.lCols[u]=I)}s=t.d.lCols[u]}else if(h){var D,j,F;if(!r.sql)return void console.error("Not enough privileges to run query");var z=null===(D=t.d)||void 0===D||null===(j=D.w)||void 0===j||null===(F=j.options)||void 0===F?void 0:F.binSize,B=h.trim()+"";B.endsWith(";")&&(B=B.slice(0,B.length-1));var U=(0,Cr.asName)(l);if(!z){var V="SELECT MIN(".concat(U,") as min, MAX(").concat(U,") as max FROM (\n")+B+"\n ) t",H=yield r.sql(V,{dateColumn:l},{returnType:"rows"}),{min:q,max:W}=H[0];a=[new Date(q),new Date(W)],z=t.getBin(new Date(q),new Date(W))}var G="COUNT(*)";if(f&&c&&"Count All"!==c){var $=wP.find((e=>e.label===c));$&&(G=$.label+(0,Cr.asName)(f))}z=(z||"day").replace(/[0-9]/g,""),s=(yield r.sql(" SELECT * FROM (\n"+B+"\n ) t LIMIT 0 ")).fields.map((e=>mP(mP({},e),{},{key:e.name,label:e.name,subLabel:e.dataType,udt_name:e.dataType})));var Y="SELECT date_trunc(${bin}, "+"".concat(U,") as date, ").concat(G," as value FROM (\n")+B+"\n ) t \n\nGROUP BY date_trunc(${bin}, "+U+" ) \n ORDER BY date ";console.log(yield r.sql(Y,{dateColumn:l,bin:z,statField:G},{returnType:"statement"})),i=yield r.sql(Y,{dateColumn:l,bin:z,statField:G},{returnType:"rows"}),console.log(i.length)}return{color:e.color||"red",getYLabel:e=>{var{value:t,min:n,max:r}=e;return"".concat(n===r?t:t.toFixed(Math.max(2,2-Math.round(Math.log10(Math.abs(r-n))))))},data:i,cols:s}}));return function(){return e.apply(this,arguments)}}()));u={layers:h}}catch(e){l=e,console.error(e)}t.setState(mP(mP({},u),{},{xExtent:a,loadingLayers:!1,error:l}))}}))),vP(this,"getMenu",(t=>{var{statType:n,binSize:r="auto",groupByColumn:i}=t.options||{},{layers:o=[]}=this.state,{layerQueries:s}=this.props;return e.createElement("div",{className:"flex-col w-full f-1 p-1"},s.map(((t,s)=>{var a,l=(o&&o[s]?o[s].cols:[]).map((e=>mP(mP({},e),{},{label:e.name})));(l=l.filter((e=>e.label!==t.dateColumn&&"number"===e.tsDataType)))&&l.length&&"Count All"!==n&&(a=e.createElement(eN,{label:"Numeric field",variant:"div",className:"w-fit mb-1  mt-1",options:l.map((e=>e.label)),value:t.statColumn,onChange:e=>{console.log(e),t.updateOptions({statColumn:e})}}));var c,u=l.filter((e=>e.name!==t.statColumn&&e.name!==t.dateColumn&&["string","boolean","number"].includes(e.tsDataType)));return u.length&&(c=e.createElement(eN,{label:"Group by field",variant:"div",className:"w-fit mb-1  mt-1",options:u.map((e=>e.label)),value:i,onChange:e=>{console.log(c),console.log("This should update the link"),t.updateOptions({groupByColumn:e})}})),e.createElement("div",{key:s,className:"flex-col"},e.createElement(eN,{label:"Bin size",variant:"div",className:"w-fit  ",fullOptions:bP,value:r,onChange:e=>{this.d.w.$update({options:{binSize:e}},{deepMerge:!0})}}),e.createElement(eN,{label:"Aggregation type",variant:"div",className:"w-fit mt-1",options:wP.filter((e=>l.length||"$countAll"===e.func)).map((e=>e.label)),value:n,onChange:e=>{this.d.w.$update({options:{statType:e}},{deepMerge:!0})}}),a,c)})))})),vP(this,"chartRef",{})}onMount(){var e=this;return yP((function*(){var{db:t,dbs:n,id:r,w:i}=e.props;if(t&&!e.state.wSync){var o=yield i.$cloneSync(((t,n)=>{e.setData({w:t},{w:n})}));e.setState({wSync:o})}}))()}onUnmount(){var e,t;null===(e=this.state.wSync)||void 0===e||null===(t=e.$unsync)||void 0===t||t.call(e)}setExt(e){this.ext=e,this.settingExtent&&clearTimeout(this.settingExtent),this.settingExtent=setTimeout((()=>{this.setState({extent:this.ext}),this.settingExtent=null}),500)}render(){var t,n,{layers:r=[],loadingLayers:i,error:o,xExtent:s,extent:a}=this.state,{onClose:l,titleIcon:c,layerQueries:u,dbs:h}=this.props,{w:d}=this.d;if(!d)return e.createElement(Xe,{className:"m-auto f-1"});o&&(t=e.createElement(Tt,{button:e.createElement(et,{className:"text-red-500",iconPath:J}),open:!0,onClose:()=>{this.setState({showError:!1})}},e.createElement("div",{className:"bg-white"},e.createElement(Fe,{error:o})))),(i||o)&&(n=e.createElement("div",{className:"flex-row relative f-1 m-auto ",style:{position:"absolute",top:"1em",left:"1em",zIndex:22}},i?e.createElement(Xe,{className:"m-auto f-1",delay:100}):null,t));var f=!(!a||!s||Object.values(a).join()===s.join()),p=e.createElement(e.Fragment,null,e.createElement("div",{ref:e=>{e&&(this.menuAnchor=e)},style:{width:"1px",height:"1px"}}),e.createElement("div",{className:"relative f-1 flex-col min-h-0 min-w-0 noselect "},n,f?e.createElement(et,{title:"Zoom out to data extent",style:{position:"absolute",right:0,top:0,zIndex:1},iconPath:"M20,2H4C2.89,2 2,2.89 2,4V20C2,21.11 2.89,22 4,22H20C21.11,22 22,21.11 22,20V4C22,2.89 21.11,2 20,2M20,20H4V4H20M13,8V10H11V8H9L12,5L15,8M16,15V13H14V11H16V9L19,12M10,13H8V15L5,12L8,9V11H10M15,16L12,19L9,16H11V14H13V16",onClick:()=>{this.chartRef&&(this.chartRef.setView({xO:0,xScale:1,yO:0,yScale:1}),this.setState({extent:void 0}))}}):null,e.createElement(TM,{layers:r,chartRef:e=>{this.chartRef=e},onExtentChange:e=>{this.setExt(e)}})));return e.createElement(Eo,{w:d,getMenu:this.getMenu},p)}}function EP(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function _P(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){EP(a,r,i,o,s,"next",e)}function s(e){EP(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function SP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function CP(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?SP(Object(t),!0).forEach((function(n){TP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SP(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function TP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OP{constructor(e,t){var n=this;TP(this,"onChange",(()=>{})),TP(this,"makeTree",((e,t)=>{var n=e;return t?(delete n.isRoot,n.parent=t):n.isRoot=!0,e.items&&e.items.map((e=>{this.makeTree(e,n)})),n})),TP(this,"remove",(function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],r=n._filter((t=>t.id===e&&t.parent));r.map((e=>{e.parent.items=e.parent.items.filter((t=>t!==e))})),t||n.onChange(n.getLayout())})),TP(this,"getLayout",(()=>{var e=t=>(delete t.parent,t.items&&(t.items=t.items.map(e)),t),t=e(CP({},this.tree));return this.build(JSON.parse(JSON.stringify(t))),JSON.parse(JSON.stringify(t))})),TP(this,"_filter",(e=>{var t=n=>{var r=[];return e(n)&&r.push(n),n.items&&n.items.map((e=>{r=r.concat(t(e))})),r};return t(this.tree)})),TP(this,"refresh",(function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];n.build(n.getLayout());var t=n._filter((e=>"item"===e.type));t.concat(t.map((e=>e.parent))).filter((e=>e)).map((e=>{for(var t=CP({},e);t.parent&&!t.parent.isRoot&&t.parent.items&&1===t.parent.items.length;)t=t.parent;t.parent&&(t.parent.items=t.parent.items.map((n=>n===t?e:n)))}));var r=n.getLayout();n.build(r);for(var i=()=>n._filter((e=>!(!e.parent||e.parent.type!==e.type)));i().length;)i().map((e=>{if(e.parent&&e.parent.type===e.type){var t=e.parent.items.findIndex((t=>t===e));e.parent.items.splice(t,1,...e.items)}n.build(n.getLayout())}));for(var o=()=>n._filter((e=>"item"!==e.type&&e.parent&&e.items&&0===e.items.length));o().length;){o().map((e=>{e.parent.items=e.parent.items.filter((t=>t.id!=e.id))}));var s=n.getLayout();n.build(s)}e||n.onChange(n.getLayout())})),TP(this,"update",(e=>{e.map((e=>{var t=this._filter((t=>t.id==e.id)),n=t[0];1===t.length?Object.keys(e).map((t=>{n[t]=e[t]})):console.log("Found duplicate items. will not update")})),this.onChange(this.getLayout())})),TP(this,"find",(e=>this._filter((t=>t.id==e))[0])),TP(this,"getLeafs",(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:()=>!0;return n._filter((e=>!("items"in e)||!e.items.length&&e.parent)).filter(e)})),TP(this,"findFunc",(e=>this._filter(e)[0])),TP(this,"moveTo",((e,t,n,r)=>{var i=this.find(e);this.build(this.getLayout()),this.remove(e,!0);var o=this.find(t);if(i&&o)if(o.parent){var s=o.parent.items.findIndex((e=>e.id==t));o.parent.type===n?(o.parent.items.splice(r?s:s+1,0,i),o.parent.items=o.parent.items.map((e=>(e.size=100/Math.max(1,o.parent.items.length),e)))):(i.size=50,o.size=50,o.parent.items[s]={id:Date.now(),type:n,size:Math.min(...o.parent.items.map((e=>e.size)))||50,items:r?[i,o]:[o,i]},o={id:Date.now(),size:o.size||50,type:n,items:r?[i,o]:[o,i]})}else o.type===n&&o.items?(i.size=o&&o.items&&o.items.length?o.items[0].size:50,r?o.items.unshift(i):o.items.push(i)):(i.size=50,o.size=50,o.isRoot=!1,o={id:Date.now(),size:100,isRoot:!0,type:n,items:r?[i,o]:[o,i]},this.layout=o,this.tree=this.makeTree(o));this.refresh()})),this.build(e),this.onChange=t}build(e){var t=JSON.parse(JSON.stringify(CP({},e)));this.layout=t,this.tree=this.makeTree(t)}}class PP extends We{constructor(){var t;super(...arguments),t=this,TP(this,"state",{layout:void 0,targetStyle:{display:"none"}}),TP(this,"onDelta",(e=>{var{layout:t,children:n}=this.props;if(e&&("layout"in e||"children"in e)){if(t&&(this.treeLayout=new OP(CP({},t),this.onChange)),(!t||t.items&&0===t.items.length)&&n.length)return setTimeout((()=>{this.onChange({id:1,type:"col",size:100,items:n.map(((e,t)=>({id:e.props["data-key"]||t,title:e.props["data-title"],type:"item",size:20})))})}),0),null;var r=this.getItems(t).map((e=>e.id)),i=n.filter((e=>!r.includes(e.props["data-key"]))),o=Array.from(new Set(r.filter((e=>!n.find((t=>t.props["data-key"]==e))))));if(t&&"items"in t){var s=this.treeLayout.getLeafs((e=>"items"in e&&!e.items.length));if(s.length)return void s.map((e=>{for(var t,n=e;n;)t=n.parent,this.treeLayout.remove(n.id),n=t&&"items"in t&&!t.items.length&&!t.isRoot?t:void 0}))}if(t&&i.length&&setTimeout((()=>{var e=CP({},t);if("col"===e.type){var n=e.items.reduce(((e,t)=>e+t.size),0);e.items=[...i.map(((e,t)=>({id:e.props["data-key"]||t,title:e.props["data-title"],type:"item",size:n/i.length}))),...e.items]}else e.size=50,e={id:1,type:"col",size:100,isRoot:!0,items:i.map(((e,t)=>({id:e.props["data-key"]||t,title:e.props["data-title"],type:"item",size:50/i.length}))).concat(e)};this.onChange(e)}),0),t&&n.length&&o.length)return void o.map((e=>{this.treeLayout.remove(e)}))}})),TP(this,"setTarget",(e=>{this.setState({targetStyle:e})})),TP(this,"getRoot",(()=>this.ref)),TP(this,"onChange",(function(e){var n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],{onChange:r}=t.props;r&&!n?(r(CP({},e)),t.setState({layout:void 0})):t.setState({layout:e})})),TP(this,"getItems",(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:t.state.layout,n=[];if(e){if("item"===e.type)return[e];n=n.concat(...e.items.map(t.getItems))}return n})),TP(this,"renderGrid",(function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,{children:i,header:o,headerIcons:s=[],layout:a,onClose:l,_ref:c}=t.props,u=e.Children.toArray(i),h=null;if(!(n=n||a)||!u.length)return null;if("item"===n.type){var d=u.find((e=>e.props["data-key"]==n.id)),f=u.find((e=>e.props["data-key"]==n.id&&"header-icons"===e.props["data-type"]))||s.find((e=>e.props["data-key"]==n.id));return e.createElement(MP,{key:r,title:d?d.props["data-title"]:"",layout:n,header:o,headerIcon:f,setTarget:t.setTarget,getRoot:t.getRoot,onClose:l,moveTo:(e,n,r,i)=>{t.treeLayout.moveTo(e,n,r,i)},onChange:e=>{t.onChange(e)},hasSiblings:u.some((e=>e.props["data-key"]!=n.id))},d)}var p=n.items.map(((e,n)=>t.renderGrid(e,n)));if(h=[],"tab"===n.type){var m=n;m.items[0]||(h=null);var g=m.items;if(!g||!g.length)return null;var y=g[0].id,v=u.find((e=>e.props["data-key"]==y)),b=s.find((e=>e.props["data-key"]==y));v||(h=null);var w=m.items.filter((e=>e.id!=y));h=e.createElement(MP,{key:r,title:v?v.props["data-title"]:"",headerIcon:b,siblingTabs:w,onClickSibling:e=>{t.treeLayout.moveTo(e,n.id,"tab",!0)},hasSiblings:u.some((e=>e.props["data-key"]!=n.id)),layout:n.items[0],header:o,setTarget:t.setTarget,getRoot:t.getRoot,onClose:l,moveTo:(e,n,r,i)=>{t.treeLayout.moveTo(e,n,r,i)},onChange:e=>{t.onChange(e)}},v)}else p.map(((r,i)=>{h.push(r),i<p.length-1&&h.push(e.createElement(AP,{key:"resizer"+i,type:n.type,onChange:(e,n)=>{t.treeLayout.update([e,n])}}))}));return e.createElement("div",{ref:e=>{e&&(t.ref=e,c&&c(e))},key:r,"data-box-type":n.type,"data-box-id":n.id,className:" flex-"+n.type+" silver-grid-box min-w-0 min-h-0",style:{flex:n.size,display:"flex"}},h)}))}render(){var{targetStyle:t}=this.state,{style:n={},className:r="",overlay:i}=this.props;return e.createElement("div",{ref:e=>{e&&(this.ref=e)},className:"silver-grid-component relative  "+r,style:CP({display:"flex",flex:1,height:"100%",width:"100%"},n)},this.renderGrid(),e.createElement("div",{key:"silver-grid-target",ref:e=>{e&&(this.refTarget=e)},className:" absolute silver-grid-target b",style:CP(CP({},t),{},{zIndex:232,transition:".2s all ease-in-out",background:"#dcffffb3"})}),i)}}class AP extends We{onDelta(){var{onChange:e}=this.props,t=this.ref;!t||null!=t&&t._hasListeners||(t._hasListeners=!0,AM(this.ref,{onPanEnd:()=>{var{prev:t,next:n}=this.sizes;e(t,n),this.sizes=void 0},onPanStart:()=>{},onRelease:()=>{this.ref.style.background="transparent"},onPress:()=>{this.ref.style.background="#00e1cc",uM(15)},onPan:e=>{var t,n,{type:r}=this.props,{nextElementSibling:i,previousElementSibling:o,parentElement:s}=this.ref,a=i,l=o,c=(s.getBoundingClientRect(),l.getBoundingClientRect()),u=a.getBoundingClientRect(),h=c.x,d=(u.x,u.width,c.y),f=(u.y,u.height,this.ref.getBoundingClientRect().width/2),p=this.ref.getBoundingClientRect().height/2,m=+getComputedStyle(l).flexGrow+ +getComputedStyle(a).flexGrow;if("row"===r){var g=(c.width+u.width)/m;n=m-(t=(e.x-h-f)/g)}else{var y=(c.height+u.height)/m;n=m-(t=(e.y-d-p)/y)}l.style.flex="".concat(t),a.style.flex="".concat(n),this.sizes={prev:{id:l.dataset.boxId,size:t},next:{id:a.dataset.boxId,size:n}}}}))}render(){var t=kP()?"20px":"4px",{type:n}=this.props,r={width:"col"===n?"100%":t,height:"col"===n?t:"100%",cursor:"col"===n?"ns-resize":"ew-resize",opacity:.4,zIndex:2,margin:kP()?"col"===n?"-8px 0":"0 -8px":""};return e.createElement("div",{ref:e=>{e&&(this.ref=e)},style:r,className:"silver-grid-resizer noselect "})}}function kP(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}class MP extends We{constructor(){var t;super(...arguments),t=this,TP(this,"state",{zIndex:1,fullscreen:!1}),TP(this,"loaded",!1),TP(this,"close",_P((function*(){var{onClose:e,layout:n}=t.props;e&&(yield e(n.id))}))),TP(this,"hasSiblingFullScreened",(()=>{var{getRoot:e}=this.props;return!!(this.ref&&e()&&e().querySelector('[data-box-type="item"].fullscreen')&&e().querySelector('[data-box-type="item"].fullscreen')!==this.ref)})),TP(this,"minimise",(()=>{})),TP(this,"getSiblingTabs",(()=>{var{siblingTabs:t,onClickSibling:n}=this.props;return n&&t&&t.length?e.createElement("div",{className:"f-1 flex-row o-auto no-scroll-bar",onWheel:e=>{e.currentTarget.scrollLeft+=e.deltaY}},t.map(((t,r)=>{var i=t.title||t.id;return e.createElement("div",{key:r,onClick:()=>{n(t.id)},style:{height:"37px",marginTop:"4px",padding:".5em .75em",lineHeight:"24px",maxWidth:"40%"},title:i+"",className:"f-0 min-w-0 ws-nowrap text-ellipsis bg-gray-200 p-p5  "},i)}))):null}))}onUpdated(){var e,{header:t,setTarget:n,moveTo:r}=this.props,i=null===(e=this.ref)||void 0===e?void 0:e.closest(".silver-grid-component");!this.loaded&&i&&(this.loaded=!0,AM(this.refHeader||this.ref.querySelector("."+t.move),{onPress:()=>{this.props.hasSiblings&&uM(15)},onPanStart:()=>{this.props.hasSiblings&&(this.ref.style.display="none")},onPanEnd:()=>{if(this.props.hasSiblings){try{this.ref.style.display="flex",n({display:"none"}),this.ref.style.opacity="";var{position:e,node:t}=this.target,i="col",o=!0;"tabDist"===e?(i="tab",o=!0):"leftDist"===e?(i="row",o=!0):"rightDist"===e?(i="row",o=!1):"topDist"===e?(i="col",o=!0):"bottomDist"===e&&(i="col",o=!1);var s=t.dataset.boxId;r(this.props.layout.id,s,i,o)}catch(e){console.error(e)}this.target=void 0}},onPan:e=>{if(this.props.hasSiblings){var{x:t,y:r}=e,o=Array.from(i.querySelectorAll("[data-box-type]")).map((e=>{var n,i=e.getBoundingClientRect(),o=1/0;e.classList.contains("silver-grid-item")&&(n=e.querySelector(":scope > .silver-grid-item-header").getBoundingClientRect(),o=Math.hypot(t-(n.x+n.width/2),r-(n.y+n.height/2)));var s=Math.hypot(t-(i.x+.25*i.width),r-(i.y+.5*i.height)),a=Math.hypot(t-(i.x+.75*i.width),r-(i.y+.5*i.height)),l=Math.hypot(t-(i.x+.5*i.width),r-(i.y+.25*i.height)),c=Math.hypot(t-(i.x+.5*i.width),r-(i.y+.75*i.height));return{node:e,rect:i,hr:n,tabDist:o,leftDist:s,rightDist:a,topDist:l,bottomDist:c,minDist:Math.min(o,s,a,l,c)}})).sort(((e,t)=>e.minDist-t.minDist));this.ref.style.opacity="0.3";var s=i.getBoundingClientRect(),a=o[0],l=a.rect,c=l.x-s.x,u=l.y-s.y,h=l.width/2,d=l.height;this.target={node:a.node,position:"leftDist"},a.leftDist===a.minDist?(c=l.x-s.x,u=l.y-s.y,h=l.width/2,d=l.height,this.target.position="leftDist"):a.rightDist===a.minDist?(c=l.x-s.x+l.width/2,u=l.y-s.y,h=l.width/2,d=l.height,this.target.position="rightDist"):a.topDist===a.minDist?(c=l.x-s.x,u=l.y-s.y,h=l.width,d=l.height/2,this.target.position="topDist"):a.bottomDist===a.minDist?(c=l.x-s.x,u=l.y-s.y+l.height/2,h=l.width,d=l.height/2,this.target.position="bottomDist"):a.tabDist===a.minDist&&(c=a.hr.x-s.x,u=a.hr.y-s.y,h=a.hr.width,d=a.hr.height,this.target.position="tabDist");var f=this.ref.getBoundingClientRect();a.node===this.ref||c-2>=f.x-s.x&&c+h+2<=f.x-s.x+f.width&&u-2>=f.y-s.y&&u+d+2<=f.y-s.y+f.height||n({display:"block",width:"".concat(h,"px"),height:"".concat(d,"px"),transform:"translate(".concat(c,"px, ").concat(u,"px)"),border:"2px dashed #2d81ff"})}}}))}render(){var{children:t,header:n,layout:r,headerIcon:i,title:o}=this.props,{zIndex:s,fullscreen:a}=this.state,l=t;return l?(n||(l=e.createElement(e.Fragment,null,e.createElement("div",{className:"silver-grid-item-header flex-row b b-gray-100 bg-gray-100 pointer f-0 noselect relative ai-center"},e.createElement("div",{className:"silver-grid-item-header--icon flex-row f-0 o-hidden"},i),e.createElement("div",{className:" flex-row f-1 min-w-0 ws-nowrap ai-center"},e.createElement("div",{ref:e=>{e&&(this.refHeader=e)},className:"silver-grid-item-header--title p-p5 f-0 text-ellipsis bg-white noselect ",style:{height:window.isMobileDevice?"32px":"40px",marginTop:"2px",maxWidth:"60%"}}),this.getSiblingTabs()),e.createElement(et,{className:"f-0",iconPath:a?"M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z":"M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z",onClick:()=>{this.setState({fullscreen:!a})}}),e.createElement(et,{className:"f-0",iconPath:oe,onClick:this.close})),t)),e.createElement("div",{ref:e=>{e&&(this.ref=e)},className:"silver-grid-box silver-grid-item bg-white f-1 flex-col min-w-0 min-h-0 "+(a?" fullscreen ":" "),"data-box-id":r.id,"data-box-type":"item",onMouseEnter:()=>{this.hasSiblingFullScreened()||this.setState({zIndex:2})},onMouseLeave:()=>{this.hasSiblingFullScreened()||this.setState({zIndex:1})},style:{flex:r.size,overflow:"auto",zIndex:a?2:s}},l)):null}}function NP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class LP extends We{constructor(){super(...arguments),NP(this,"state",{}),NP(this,"d",{})}render(){var{onLinkTable:t,w:n,tables:r}=this.props,{linkTablePath:i}=this.state;return null==i||i[i.length-1],e.createElement("div",{className:"flex-col ai-start"},e.createElement(_o,{className:"w-full",tableName:n.table_name,tables:r,onLinkTable:t,onSelect:e=>{this.setState({linkTablePath:e})}}))}}var RP=(e,t,n,r)=>{if(e.id!==t.wid){var i=((e,t)=>{var n=e.filter((e=>[e.w1_id,e.w2_id].includes(t.id))),r=n.map((e=>[e])),i=!1,o=20,s=function(){for(var t=!1,s=[],a=r.length,l=function(i){var o=r[i],a=((e,t,n)=>{var r=t[t.length-1],i=1<t.length?t.slice(-1).map((e=>[e.w1_id,e.w2_id])).flat():[];return e.filter((e=>[e.w1_id,e.w2_id].some((e=>[r.w1_id,r.w2_id].filter((e=>!i.includes(e))).includes(e)))&&!t.some((t=>t.id===e.id))&&!n.some((t=>t.id===e.id))))})(e,o,n);t=t||!!a.length,1<a.length&&a.slice(1).map((e=>{s.push([...o,e])})),a.length&&(r[i]=[...o,a[0]])},c=0;c<a;c++)l(c);r=r.concat(s),i=!t,o--};do{s()}while(!i&&o);return r})(n,e),o=i.map((t=>((e,t,n)=>{var r=[];return t.map(((i,o)=>{var s=n.find((e=>i.w1_id===e.id)),a=n.find((e=>i.w2_id===e.id)),l=o===t.length-1,c=!!(!o&&i.w1_id===e.id||o&&[t[o-1].w1_id,t[o-1].w2_id].includes(i.w1_id)),u=[];"tablePath"in i.options&&(u=[...i.options.tablePath.slice(0)],!c&&u.reverse()),u=u.filter((e=>![s.table_name,a.table_name].includes(e))),r=[...r,c?s.table_name:a.table_name,...u],l&&(r=[...r,c?a.table_name:s.table_name])})),r})(e,t,r))),s=i.map((e=>e.flatMap((e=>[e.w1_id,e.w2_id])))).findIndex((n=>n.includes(e.id)&&n.includes(t.wid)));return-1<s?o[s].slice(1,o[s].lastIndexOf(t.table_name)+1):void 0}},IP=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;if(e.id!==(null==n?void 0:n.window_id)&&n){var o=RP(e,{wid:n.window_id,table_name:n.table_name},r,i);if(t===(null==n?void 0:n.table_name)||(null==o?void 0:o[0])===t)return n.row_filter;if(o)return{$existsJoined:{[o.join(".")]:n.row_filter}}}};function DP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jP(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?DP(Object(t),!0).forEach((function(n){BP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):DP(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function FP(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function zP(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){FP(a,r,i,o,s,"next",e)}function s(e){FP(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function BP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class UP extends We{constructor(){var e;super(...arguments),e=this,BP(this,"state",{loading:!0,joinTables:[],shapes:[],chartRef:void 0}),BP(this,"onDelta",function(){var t=zP((function*(){var t,n;null===(t=e.state.chartRef)||void 0===t||null===(n=t.render)||void 0===n||n.call(t,e.state.shapes||[])}));return function(){return t.apply(this,arguments)}}())}onMount(){var e=this;return zP((function*(){var t,n,{w:r,db:i,links:o,gridRef:s,windows:a,tables:l}=e.props,c=[],u=[];if(r.table_name){var h=UP.getMyLinks(o,r,a),d=a.filter((e=>!e.closed&&!e.deleted&&h.some((t=>[t.w1_id,t.w2_id].includes(e.id))))),f=l.find((e=>e.name===r.table_name));c=null==f?void 0:f.joins.map((e=>e.tableName)).filter((e=>!d.some((t=>t.table_name===e))));var p=[];s.querySelectorAll("[data-box-id][data-box-type='item']").forEach((e=>{var t=e.dataset.boxId,n=e.getBoundingClientRect(),r=a.find((e=>e.id===t));p.push({id:t,rect:n,w:r})}));var m,g=h.find((e=>{var t;return null==e||null===(t=e.options)||void 0===t?void 0:t.color}));if(g){var y=lM[g.options.colorKey];y&&(m=y)}h.map((e=>{var t=p.find((t=>t.id===e.w1_id)),n=p.find((t=>t.id===e.w2_id)),r=e=>[e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2];if(t&&n){var i,s,c,h=t=>{return"table"===t.type?t.table_name:"map"===t.type?"(".concat(null==e||null===(n=e.options)||void 0===n?void 0:n.geomColumn,")"):"timechart"===t.type?"(".concat(null==e||null===(r=e.options)||void 0===r?void 0:r.dateColumn,")"):void 0;var n,r},d={font:"20px Arial",textAlign:"center",elevation:12,background:{fillStyle:"white",borderRadius:12,padding:12}};u.push({type:"multiline",coords:[r(t),r(n)],lineWidth:6,strokeStyle:m.get(1)}),u.push(jP({id:1,type:"text",coords:r(t),fillStyle:"black",text:h(t.w)},d)),u.push(jP({id:3,type:"text",coords:r(n),fillStyle:"black",text:h(n.w)},d));var f=[],g=a.find((e=>e.id===t.id)),y=a.find((e=>e.id===n.id)),v=null===(i=window.document.body.querySelector("[data-box-id='".concat(g.id,"']")))||void 0===i?void 0:i.getBoundingClientRect(),b=null===(s=window.document.body.querySelector("[data-box-id='".concat(y.id,"']")))||void 0===s?void 0:s.getBoundingClientRect(),w=!!(v&&b&&v.y<b.y),x=!!(v&&b&&v.x>b.x),E=Math.abs(v.y-b.y)>Math.abs(v.x-b.x)?"y":"x",_=RP(g,{wid:y.id,table_name:y.table_name},o,a);_.length||(_=RP(y,{wid:g.id,table_name:g.table_name},o,a).slice(0).reverse()),g.table_name&&(_=[g.table_name,..._]),f=_.flatMap(((e,t)=>{if(t<_.length-1){var n=l.find((t=>t.name===e));if(n){var r=n.joins.find((e=>e.tableName===_[t+1]));if(r){var i={text:"("+r.on.join(", ")+")",color:"blue"};return 2<_.length&&t?[{text:e,color:"black"},i]:i}}}})).filter((e=>e));var S=!1;if(w||"y"!==E?x&&"x"===E&&(f=f.slice(0).reverse()):S=!0,S&&(f=f.slice(0).reverse()),null!==(c=f)&&void 0!==c&&c.length){var C=r(t),T=r(n);f.map(((e,t)=>{var{text:n,color:r}=e;u.push({id:22+t,type:"text",coords:[Math.round((C[0]+T[0])/2),Math.round((C[1]+T[1])/2+2.5*t*16)],fillStyle:r,font:"16px Arial",textAlign:"center",elevation:12,background:{fillStyle:"white",borderRadius:12,padding:10,strokeStyle:null!=r?r:"gray",lineWidth:1},text:n})}))}}}))}null===(t=e.chartRef)||void 0===t||null===(n=t.render)||void 0===n||n.call(t,u),e.setState({loading:!1,joinTables:c,shapes:u})}))()}render(){var{loading:t,joinTables:n,shapes:r}=this.state,{onClose:i,anchorEl:o,onLinkTable:s,tables:a,w:l}=this.props;if(t)return e.createElement(Xe,null);var c=a.some((e=>e.name===l.table_name&&e.joins.length));return e.createElement(e.Fragment,null,e.createElement(pt,{open:!0,onClose:i,title:c?"Add referenced table":void 0,collapsible:!0,anchorEl:o,clickCatchStyle:{opacity:0,zIndex:14},contentStyle:c?{paddingTop:0}:{display:"none"},rootStyle:{zIndex:14}},c&&e.createElement(LP,{w:l,tables:a,onLinkTable:(e,t)=>{s(e,t),i()}})),e.createElement(PM,{className:"h-full w-full",style:{position:"absolute",inset:0,zIndex:14,backdropFilter:"blur(1px)",backgroundColor:"#80808030"},setRef:e=>{this.chartRef=e,this.setState({chartRef:e})}}))}}function VP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HP(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?VP(Object(t),!0).forEach((function(n){WP(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):VP(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function qP(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function WP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}BP(UP,"getMyLinks",((e,t,n)=>{var r=(e,t)=>t.filter((t=>[t.w1_id,t.w2_id].some((t=>e.some((e=>[e.w1_id,e.w2_id].includes(t))))))),i=e.filter((e=>[e.w1_id,e.w2_id].every((e=>n.some((t=>e===t.id&&!t.closed&&!t.deleted)))))),o=i.filter((e=>[e.w1_id,e.w2_id].includes(t.id))),s=o,a=[...o];do{s=o=r(s,i.filter((e=>!a.find((t=>t.id===e.id))))),a=a.concat(o)}while(o.length);return a}));class GP extends We{constructor(){var t;super(...arguments),t=this,WP(this,"state",{loading:!1,wSync:null,error:null,showError:!1}),WP(this,"onDelta",function(){var e,n=(e=function*(e,n,r){var i=HP(HP(HP({},e),n),r);console.log(i);var{db:o,w:s}=t.props;if(o&&!t.state.wSync){var a=s.$cloneSync(((e,n)=>{t.d.w,t.setData({w:e},{w:n}),t.setState({w:e})}));t.setState({wSync:a})}},function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){qP(a,r,i,o,s,"next",e)}function s(e){qP(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))});return function(){return n.apply(this,arguments)}}()),WP(this,"getMenu",(t=>{var n,{db:r,table:i,tables:o,dbs:s}=this.props,{nested_tables:a}=t;return a&&(n={},Object.entries(a).map((i=>{var[s,a]=i;n[s]={content:e.createElement("div",{className:"flex-col p-1"},e.createElement("div",{className:"flex-col p-p5 text-gray-400 ta-left"},"Nested table (",s,")"),e.createElement(et,{onClick:()=>{var e=HP({},t.nested_tables);delete e[s],t.$update({nested_tables:HP({},e)})}}),e.createElement(Wr,{w:t,db:r,tableName:t.table_name,tables:o,nestedTable:s}))}}))),e.createElement(yr,{compactMode:!0,variant:"vertical",items:{Title:{content:e.createElement("div",{className:"flex-col p-1"},e.createElement(aN,{value:t.name,onChange:e=>{t.$update({name:e})}}))},Columns:{content:e.createElement("div",{className:"flex-col p-1"},e.createElement("div",{className:"flex-col p-p5 text-gray-400 ta-left"},"Root table (",t.table_name,")"),e.createElement(Wr,{w:t,db:r,tableName:t.table_name,tables:o}))}}})}))}onMount(){}onUnmount(){var e,t;null===(e=this.state.wSync)||void 0===e||null===(t=e.$unsync)||void 0===t||t.call(e)}render(){var t,n,{loading:r,error:i,showError:o}=this.state,{w:s}=this.state,{db:a,table:l,tables:c,dbs:u}=this.props;if(!s)return e.createElement("div",{className:"relative"},e.createElement(Xe,{variant:"cover"}));i&&(t=e.createElement("div",{className:"flex-row relative",style:{position:"absolute",top:"1em",left:"1em",zIndex:22}},i?e.createElement(et,{className:"text-red-500",iconPath:J,onClick:()=>{this.setState({showError:!0})}}):null)),o&&(n=e.createElement(pt,{open:!0,onClose:()=>{this.setState({showError:!1})}},e.createElement("div",{className:"bg-white"},e.createElement(Fe,{error:i}))));var h=(s.columns||[]).filter((e=>e.show)).map((e=>e.computedConfig?{name:e.computedConfig.column,label:e.name,select:{[e.computedConfig.funcName]:[e.computedConfig.column]},renderValue:e=>e}:e.name)),d=Object.keys(s.nested_tables||{}).map((e=>{var t=c.find((t=>t.name===e));return{name:e,tableInfo:t.info,tableColumns:t.columns,fieldConfigs:s.nested_tables[e].cols.map((e=>e.computedConfig?{name:e.computedConfig.column,label:e.name,select:{[e.computedConfig.funcName]:[e.computedConfig.column]},renderValue:e=>e}:e.name))}})),f=e.createElement(e.Fragment,null,n,e.createElement("div",{className:"relative f-1 flex-col min-h-0 min-w-0 o-auto bg-gray-200",ref:e=>{e&&(this.ref=e)}},t,e.createElement(iP,{db:a,w:s,tableName:s.table_name,tables:c,style:{padding:"1em"},fieldConfigs:[...h,...d],sortableFields:l.columns.map((e=>e.name)),filterFields:l.columns.map((e=>e.name)),smartFormProps:{enableInsert:!0},detailedFilter:{value:s.filter||[],onChange:e=>{var t;null===(t=this.d.w)||void 0===t||t.$update({filter:e})}}})));return e.createElement(Eo,{w:s,getMenu:this.getMenu},f)}}var $P=n(6381),YP=n.n($P);function XP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KP(Object(n),!0).forEach((function(t){XP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function JP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eA(Object(n),!0).forEach((function(t){QP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}function rA(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(n,[].concat(i,r))}}}function iA(e){return{}.toString.call(e).includes("Object")}function oA(e){return"function"==typeof e}var sA=rA((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),aA=function(e,t){return iA(t)||sA("changeType"),Object.keys(t).some((function(t){return!function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)}))&&sA("changeField"),t},lA=function(e){oA(e)||sA("selectorType")},cA=function(e){oA(e)||iA(e)||sA("handlerType"),iA(e)&&Object.values(e).some((function(e){return!oA(e)}))&&sA("handlersType")},uA=function(e){var t;e||sA("initialIsRequired"),iA(e)||sA("initialType"),t=e,Object.keys(t).length||sA("initialContent")};function hA(e,t){return oA(t)?t(e.current):t}function dA(e,t){return e.current=tA(tA({},e.current),t),t}function fA(e,t,n){return oA(t)?t(e.current):Object.keys(n).forEach((function(n){var r;return null===(r=t[n])||void 0===r?void 0:r.call(t,e.current[n])})),n}var pA,mA,gA={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};uA(e),cA(t);var n={current:e},r=rA(fA)(n,t),i=rA(dA)(n),o=rA(aA)(e),s=rA(hA)(n);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return lA(e),e(n.current)}function l(e){nA(r,i,o,s)(e)}return[a,l]}},yA=gA,vA={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},bA=(pA=function(e,t){throw new Error(e[t]||e.default)},function e(){for(var t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=pA.length?pA.apply(this,r):function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.apply(t,[].concat(r,i))}})(vA),wA={config:function(e){return e||bA("configIsRequired"),function(e){return{}.toString.call(e).includes("Object")}(e)||bA("configType"),e.urls?(console.warn(vA.deprecation),{paths:{vs:e.urls.monacoBase}}):e}},xA=wA,EA=function e(t,n){return Object.keys(n).forEach((function(r){n[r]instanceof Object&&t[r]&&Object.assign(n[r],e(t[r],n[r]))})),ZP(ZP({},t),n)},_A={type:"cancelation",msg:"operation is manually canceled"},SA=function(e){var t=!1,n=new Promise((function(n,r){e.then((function(e){return t?r(_A):n(e)})),e.catch(r)}));return n.cancel=function(){return t=!0},n},CA=(2,function(e){if(Array.isArray(e))return e}(mA=yA.create({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.28.1/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),2!==n.length);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(mA)||function(e,t){if(e){if("string"==typeof e)return JP(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?JP(e,2):void 0}}(mA)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),TA=CA[0],OA=CA[1];function PA(e){return document.body.appendChild(e)}function AA(e){var t,n,r=TA((function(e){return{config:e.config,reject:e.reject}})),i=(t="".concat(r.config.paths.vs,"/loader.js"),n=document.createElement("script"),t&&(n.src=t),n);return i.onload=function(){return e()},i.onerror=r.reject,i}function kA(){var e=TA((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){MA(t),e.resolve(t)}),(function(t){e.reject(t)}))}function MA(e){TA().monaco||OA({monaco:e})}var NA=new Promise((function(e,t){return OA({resolve:e,reject:t})})),LA={config:function(e){OA((function(t){return{config:EA(t.config,xA.config(e))}}))},init:function(){if(!TA((function(e){return{isInitialized:e.isInitialized}})).isInitialized){if(window.monaco&&window.monaco.editor)return MA(window.monaco),SA(Promise.resolve(window.monaco));(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}})(PA,AA)(kA),OA({isInitialized:!0})}return SA(NA)},__getMonacoInstance:function(){return TA((function(e){return e.monaco}))}},RA=LA;function IA(){return IA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},IA.apply(this,arguments)}const DA={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var jA=function({content:t}){return e.createElement("div",{style:DA},t)},FA={display:"flex",position:"relative",textAlign:"initial"},zA={width:"100%"},BA={display:"none"};function UA({width:t,height:n,isEditorReady:r,loading:i,_ref:o,className:s,wrapperProps:a}){return e.createElement("section",IA({style:{...FA,width:t,height:n}},a),!r&&e.createElement(jA,{content:i}),e.createElement("div",{ref:o,style:{...zA,...!r&&BA},className:s}))}UA.propTypes={width:s().oneOfType([s().number,s().string]).isRequired,height:s().oneOfType([s().number,s().string]).isRequired,loading:s().oneOfType([s().element,s().string]).isRequired,isEditorReady:s().bool.isRequired,className:s().string,wrapperProps:s().object};var VA=UA,HA=(0,e.memo)(VA),qA=function(t){(0,e.useEffect)(t,[])},WA=function(t,n,r=!0){const i=(0,e.useRef)(!0);(0,e.useEffect)(i.current||!r?()=>{i.current=!1}:t,n)};function GA(){}function $A(e,t,n,r){return function(e,t){return e.editor.getModel(YA(e,t))}(e,r)||function(e,t,n,r){return e.editor.createModel(t,n,r&&YA(e,r))}(e,t,n,r)}function YA(e,t){return e.Uri.parse(t)}function XA({original:t,modified:n,language:r,originalLanguage:i,modifiedLanguage:o,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:l,keepCurrentModifiedModel:c,theme:u,loading:h,options:d,height:f,width:p,className:m,wrapperProps:g,beforeMount:y,onMount:v}){const[b,w]=(0,e.useState)(!1),[x,E]=(0,e.useState)(!0),_=(0,e.useRef)(null),S=(0,e.useRef)(null),C=(0,e.useRef)(null),T=(0,e.useRef)(v),O=(0,e.useRef)(y);qA((()=>{const e=RA.init();return e.then((e=>(S.current=e)&&E(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>_.current?function(){const e=_.current.getModel();var t,n;l||null===(t=e.original)||void 0===t||t.dispose(),c||null===(n=e.modified)||void 0===n||n.dispose(),_.current.dispose()}():e.cancel()})),WA((()=>{const e=_.current.getModifiedEditor();e.getOption(S.current.editor.EditorOption.readOnly)?e.setValue(n):n!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),e.pushUndoStop())}),[n],b),WA((()=>{_.current.getModel().original.setValue(t)}),[t],b),WA((()=>{const{original:e,modified:t}=_.current.getModel();S.current.editor.setModelLanguage(e,i||r),S.current.editor.setModelLanguage(t,o||r)}),[r,i,o],b),WA((()=>{S.current.editor.setTheme(u)}),[u],b),WA((()=>{_.current.updateOptions(d)}),[d],b);const P=(0,e.useCallback)((()=>{O.current(S.current);const e=$A(S.current,t,i||r,s),l=$A(S.current,n,o||r,a);_.current.setModel({original:e,modified:l})}),[r,n,o,t,i,s,a]),A=(0,e.useCallback)((()=>{_.current=S.current.editor.createDiffEditor(C.current,{automaticLayout:!0,...d}),P(),S.current.editor.setTheme(u),w(!0)}),[d,u,P]);return(0,e.useEffect)((()=>{b&&T.current(_.current,S.current)}),[b]),(0,e.useEffect)((()=>{!x&&!b&&A()}),[x,b,A]),e.createElement(HA,{width:p,height:f,isEditorReady:b,loading:h,_ref:C,className:m,wrapperProps:g})}XA.propTypes={original:s().string,modified:s().string,language:s().string,originalLanguage:s().string,modifiedLanguage:s().string,originalModelPath:s().string,modifiedModelPath:s().string,keepCurrentOriginalModel:s().bool,keepCurrentModifiedModel:s().bool,theme:s().string,loading:s().oneOfType([s().element,s().string]),options:s().object,width:s().oneOfType([s().number,s().string]),height:s().oneOfType([s().number,s().string]),className:s().string,wrapperProps:s().object,beforeMount:s().func,onMount:s().func},XA.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:GA,onMount:GA};const KA=new Map;function ZA({defaultValue:t,defaultLanguage:n,defaultPath:r,value:i,language:o,path:s,theme:a,line:l,loading:c,options:u,overrideServices:h,saveViewState:d,keepCurrentModel:f,width:p,height:m,className:g,wrapperProps:y,beforeMount:v,onMount:b,onChange:w,onValidate:x}){const[E,_]=(0,e.useState)(!1),[S,C]=(0,e.useState)(!0),T=(0,e.useRef)(null),O=(0,e.useRef)(null),P=(0,e.useRef)(null),A=(0,e.useRef)(b),k=(0,e.useRef)(v),M=(0,e.useRef)(null),N=(0,e.useRef)(i),L=function(t){const n=(0,e.useRef)();return(0,e.useEffect)((()=>{n.current=t}),[t]),n.current}(s);qA((()=>{const e=RA.init();return e.then((e=>(T.current=e)&&C(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>{return O.current?(null===(t=M.current)||void 0===t||t.dispose(),f?d&&KA.set(s,O.current.saveViewState()):null===(n=O.current.getModel())||void 0===n||n.dispose(),void O.current.dispose()):e.cancel();var t,n}})),WA((()=>{const e=$A(T.current,t||i,n||o,s);e!==O.current.getModel()&&(d&&KA.set(L,O.current.saveViewState()),O.current.setModel(e),d&&O.current.restoreViewState(KA.get(s)))}),[s],E),WA((()=>{O.current.updateOptions(u)}),[u],E),WA((()=>{O.current.getOption(T.current.editor.EditorOption.readOnly)?O.current.setValue(i):i!==O.current.getValue()&&(O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),O.current.pushUndoStop())}),[i],E),WA((()=>{T.current.editor.setModelLanguage(O.current.getModel(),o)}),[o],E),WA((()=>{void 0!==l&&O.current.revealLine(l)}),[l],E),WA((()=>{T.current.editor.setTheme(a)}),[a],E);const R=(0,e.useCallback)((()=>{k.current(T.current);const e=s||r,l=$A(T.current,i||t,n||o,e);O.current=T.current.editor.create(P.current,{model:l,automaticLayout:!0,...u},h),d&&O.current.restoreViewState(KA.get(e)),T.current.editor.setTheme(a),_(!0)}),[t,n,r,i,o,s,u,h,d,a]);return(0,e.useEffect)((()=>{E&&A.current(O.current,T.current)}),[E]),(0,e.useEffect)((()=>{!S&&!E&&R()}),[S,E,R]),N.current=i,(0,e.useEffect)((()=>{var e,t;E&&w&&(null===(e=M.current)||void 0===e||e.dispose(),M.current=null===(t=O.current)||void 0===t?void 0:t.onDidChangeModelContent((e=>{const t=O.current.getValue();N.current!==t&&w(t,e)})))}),[E,w]),(0,e.useEffect)((()=>{if(E){const e=T.current.editor.onDidChangeMarkers((e=>{var t;const n=null===(t=O.current.getModel())||void 0===t?void 0:t.uri;if(n&&e.find((e=>e.path===n.path))){const e=T.current.editor.getModelMarkers({resource:n});null==x||x(e)}}));return()=>{null==e||e.dispose()}}}),[E,x]),e.createElement(HA,{width:p,height:m,isEditorReady:E,loading:c,_ref:P,className:g,wrapperProps:y})}ZA.propTypes={defaultValue:s().string,defaultPath:s().string,defaultLanguage:s().string,value:s().string,language:s().string,path:s().string,theme:s().string,line:s().number,loading:s().oneOfType([s().element,s().string]),options:s().object,overrideServices:s().object,saveViewState:s().bool,keepCurrentModel:s().bool,width:s().oneOfType([s().number,s().string]),height:s().oneOfType([s().number,s().string]),className:s().string,wrapperProps:s().object,beforeMount:s().func,onMount:s().func,onChange:s().func,onValidate:s().func},ZA.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:GA,onMount:GA,onValidate:GA};var JA,QA=ZA,ek=(0,e.memo)(QA);function tk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?tk(Object(t),!0).forEach((function(n){rk(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tk(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function rk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ik(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function ok(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ok(Object(t),!0).forEach((function(n){ak(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ok(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function ak(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lk(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function ck(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){lk(a,r,i,o,s,"next",e)}function s(e){lk(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}RA.config({paths:{vs:"/vs"}});var uk={storageService:{get(){},remove(){},getBoolean:e=>!("expandSuggestionDocs"!==e),store(){},onWillSaveState(){},onDidChangeStorage(){}}},hk="myCustomTheme";null==RA||null===(JA=RA.init)||void 0===JA||JA.call(RA).then((e=>{e.editor.defineTheme(hk,{base:"vs",inherit:!0,colors:{},rules:[{token:"string.sql",foreground:"#e200e2"},{token:"identifier",foreground:"#6c06ab"},{token:"complexIdentifiers",foreground:"#6c06ab"}]})})).catch((e=>console.error("An error occurred during initialization of Monaco: ",e)));var dk=e=>e.getModel().getValueInRange(e.getSelection());class fk extends e.Component{constructor(){var e;super(...arguments),e=this,ak(this,"state",{value:"",editorMounter:!1}),ak(this,"getMonaco",ck((function*(){return e._monaco||(e._monaco=yield RA.init()),e._monaco}))),ak(this,"loadedActions",!1),ak(this,"loadedSuggestions",!1),ak(this,"loadedFuncs",!1),ak(this,"onUpdate",function(){var t=ck((function*(){var{error:t,getFuncDef:n,value:r,sql:i}=sk({},e.props),o=yield e.getMonaco();r&&!e.curVal&&(e.curVal=r,e.setState({value:r})),e.editor&&!e.loadedActions&&(e.loadedActions=!0,e.editor.addAction({id:"googleSearch",label:"Search with Google",contextMenuGroupId:"navigation",run:e=>{window.open("https://www.google.com/search?q="+dk(e))}}),e.editor.addAction({id:"googleSearchPG",label:"Search with Google Postgres",contextMenuGroupId:"navigation",run:e=>{window.open("https://www.google.com/search?q=postgres+"+dk(e))}})),e.editor&&n&&!e.loadedFuncs&&(function(e,t){var n;e.languages.registerSignatureHelpProvider("sql",{signatureHelpTriggerCharacters:["(",","],provideSignatureHelp:(n=ck((function*(e,n){var r=e.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:n.lineNumber,endColumn:n.column}),i=r.lastIndexOf("(");if(r.lastIndexOf(")")>i)return null;var o=e.getWordUntilPosition(e.getPositionAt(i)),s=r.slice(i+1).split(",").length-1,a={};if(a.activeParameter=s,a.activeSignature=0,o){var l=yield t(o.word,s);return a.signatures=l.map((e=>({label:"".concat(e.name,"(").concat(e.arg_list_str,")"),documentation:e.description,parameters:e.args}))),{value:a,dispose:()=>{}}}})),function(){return n.apply(this,arguments)})})}(o,n),e.loadedFuncs=!0,e.editor.focus());var{suggestions:{suggestions:s,settingSuggestions:a}={}}=e.props;if(!e.loadedSuggestions&&s&&s.length&&(e.loadedSuggestions=!0,function(e){var t,n,{monaco:r,suggestions:i,settingSuggestions:o,sql:s}=e;if(!window.completionsAddedForSQL){window.completionsAddedForSQL="sql";var a=i.filter((e=>"schema"===e.type));r.languages.registerCompletionItemProvider("sql",{provideCompletionItems:(t=function*(e,t){function n(e){return e.map((e=>nk(nk({},e),{},{label:e.label,kind:h(e.type),insertText:e.insertText||e.label,detail:e.detail||"(".concat(e.type,")"),type:e.type,escapedParentName:e.escapedParentName,documentation:{value:e.documentation||"".concat(e.type," ").concat(e.detail||"")},sortText:"",filterText:void 0,insertTextRules:r.languages.CompletionItemInsertTextRule.InsertAsSnippet})))}function s(t){var n;return t&&1<=t.column&&1<=t.lineNumber?(n=e.getWordUntilPosition(nk(nk({},t),{},{column:t.startColumn-1})))&&!n.word&&-1<n.endColumn&&-1<n.startColumn?s(nk(nk({},t),{},{startColumn:t.startColumn-1})):n:null}function l(e){return e.split("").reverse().join("")}var c,u=r.languages.CompletionItemKind,h=e=>"function"===e?u.Function:"column"===e?u.Field:"table"===e?u.Value:"dataType"===e?u.Variable:"keyword"===e?u.Keyword:"extension"===e?u.Module:"schema"===e?u.Folder:"setting"===e?u.Property:u.Keyword,d=n(i),f=n(o),p=e.getWordUntilPosition(t),m=!1,g=s(nk(nk({},p),t));if(g&&s(nk(nk(nk({},p),t),{},{startColumn:g.startColumn})),p&&p.word){var y=(c=p.word)[0];m=y===y.toUpperCase()&&y!==y.toLowerCase()}var v,b=e.getOffsetAt(t),w=e.getValue(),x=(w.split("\n"),w.slice(0,b-(c||"").length).split("\n")),E=x.slice(-8).join("\n"),_=(x.slice(-2,-1)[0],x.slice(-1)[0]||""),S=" "+E+" ",C=w.slice(b).split("\n").slice(0,8).join("\n"),T="any",O=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n=l(e).toLowerCase();return t&&";"!==e||(n=" ".concat(n," ")),l(S.toLowerCase()).replace(/\n/g," ").indexOf(n)},P=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n=e.toLowerCase();return t&&";"!==e||(n=" ".concat(n," ")),C.replace(/\n/g," ").toLowerCase().indexOf(n)},A=["JOIN","SELECT","TABLE","SET","UPDATE","INTO","FROM","WHERE",";","\n"],k=void 0,M=void 0,N=-1;A.forEach((e=>{var t=E.toLowerCase().lastIndexOf(e.toLowerCase());t>N&&(M=e,N=t)}));var L,R,I,D,j=void 0,F=-1;if(E.toLowerCase().endsWith(" as ")||"join"===E.toLowerCase().trim().split(" ").slice(-2)[0])return{suggestions:[]};if(E.trim().endsWith(")"))d=d.filter((e=>"AS"===e.label)),T="any";else if(E.trim().endsWith("::"))T="data type";else if(g&&g.word&&(!c||(D=c[0])!=D.toUpperCase()||D==D.toLowerCase())||M)if(R=(L=g.word).toLowerCase(),["database"].includes(R))d=d.filter((e=>"database"===e.type)),T="any";else if(["user","owner"].includes(R))d=d.filter((e=>"role"===e.type)),T="any";else if(["references"].includes(R))d=d.filter((e=>"table"===e.type)),T="any";else if(["inner","left","outer","right"].includes(R))v=["JOIN"],T="command";else if(["rename"].includes(R))v=["TO","COLUMN"],T="command";else if(["add"].includes(R))v=["COLUMN","CONSTRAINT"],T="command";else if(["create","alter","drop"].includes(R))v=["TABLE","VIEW","FUNCTION","TRIGGER","SCHEMA","DATABASE","SYSTEM","EXTENSION","TYPE","COLUMN","ROLE","GROUP","USER"],T="command";else if("insert"===R)v=["INTO"],T="command";else{if(null!=S&&S.trim().toLowerCase().endsWith("insert into"))return{suggestions:d.filter((e=>"table"===e.type)).map((e=>(e.label+=" ...",e.insertText+=" (".concat(e.cols.map((e=>e.escaped_identifier)).join(", "),")"),e.kind=u.Snippet,e.sortText="public"===e.schema?"0a":"a",e)))};if("grant"===R||"revoke"===R)v=["ALL","SELECT","INSERT","UPDATE","DELETE","TRUNCATE","REFERENCES","TRIGGER","USAGE","EXECUTE","CREATE","CONNECT","TEMPORARY","TEMP"],T="command";else if("extension"===R)T="extension";else if(!S.toLowerCase().includes("update")&&_&&(_.toLowerCase().includes("show ")||_.toLowerCase().includes("set ")))d=f,T="any";else if("to"===R&&_&&(_.toLowerCase().includes("grant ")||_.toLowerCase().includes("revoke ")))d=d.filter((e=>"role"===e.type)),T="any";else if("table"===R&&_&&_.toLowerCase().includes("create ")&&"createtable"===_.toLowerCase().replace(/\s/g,""))v=["IF NOT EXISTS"],T="command";else if("raise"===R)v=["NOTICE"],T="command";else if("delete"===R)v=["FROM"],T="command";else if(["order","group"].includes(R))v=["BY"],T="command";else{var z=A.map((e=>({k:e,p:O(e)}))).filter((e=>-1<e.p)).sort(((e,t)=>e.p-t.p));if(z[0])if(k=z[0].k,z[0].p,z[1]&&(M=z[1].k,N=z[1].p),"select"===k.toLowerCase()){var B=[";","SELECT","DROP","UPDATE","ALTER","DELETE","CREATE"].map((e=>({k:e,p:P(e)}))).filter((e=>-1<e.p)).sort(((e,t)=>e.p-t.p));B[0]&&(j=B[0].k,F=B[0].p),T="column"}else if(";"===k||"\n"===k)T="command";else if(["SET","WHERE","BY","ON"].includes(k.toUpperCase()))T="column";else if(["UPDATE","FROM","INTO","TABLE","COLUMN","JOIN","REFERENCES"].includes(k.toUpperCase())){var U=a.find((e=>e.label===(null==g?void 0:g.word)));if(U)return{suggestions:d.filter((e=>"table"===e.type&&e.schema===U.label)).map((e=>(e.insertText=e.label+" ",e)))};T=R!==k.toLowerCase()&&"references"!==R?"column":"table"}}}else null!=S&&S.trim()||(T="command");return v&&v.length?{suggestions:d.filter((e=>"keyword"===e.type&&v.find((t=>t.toLowerCase()===e.label.toLowerCase())))).map((e=>(e.sortText=(v.findIndex((t=>t.toLowerCase()===e.label.toLowerCase()))+"").padStart(5,"0")+"a",e.insertText=e.label+" ",e)))}:(d=d.map((e=>{var t=nk({},e);t.sortText="yy";var n=hs.find((t=>t.label===e.label));if(n&&(t.sortText="xx",n.info&&(t.documentation={value:n.info})),"extension"===T&&e.type===T)t.sortText="a",I="a";else if("command"!==T||null!=n&&n.start_kwd)if("command"===T&&null!=n&&n.start_kwd)t.sortText="a",I="a";else if("column"===T&&["column","function"].includes(e.type)){var r="function"===e.type;if(t.sortText="public"===e.schema?r?"01b":"00b":r?"03b":"02b",e.escapedParentName)if(["select"].includes(k.toLowerCase())){var i=P(e.escapedParentName,!0);-1<i&&(!j||i<F)&&(t.sortText="".concat(i).padStart(6,"0")+"a")}else{var o=O(e.escapedParentName,!0);-1<o&&(!M||o<N)&&(t.sortText="".concat(o).padStart(6,"0")+"a")}}else if("table"!==T||"table"!==e.type&&"select"!==e.label.toLowerCase()){if("data type"===T&&"dataType"===e.type){var s;t.sortText=["numeric","integer","real","bigint","bool","geography","geometry","uuid","json","jsonb","text","tsvector","timestamp","timestamptz"].includes(null===(s=e.properties)||void 0===s?void 0:s.name)?"a":"b"===e.properties.typtype?"b":"c",I="b"}}else I="b",t.sortText="table"===e.type?"public"===e.schema?"0a":"a":"b";return t.filterText=t.label.toLowerCase(),"command"!==T&&"keyword"===e.type&&(t.filterText=t.label),"SELECT"===L&&""===C&&"column"===t.type&&(t.insertText+="$0\nFROM ".concat(t.escapedParentName,"\nLIMIT 200 "),t.label+=" ...",t.kind=u.Snippet),"function"===t.type||(t.insertText+=" "),t})),!m&&I&&(d=d.filter((e=>e.sortText<=I))),{suggestions:d})},n=function(){var e=this,n=arguments;return new Promise((function(r,i){function o(e){ik(a,r,i,o,s,"next",e)}function s(e){ik(a,r,i,o,s,"throw",e)}var a=t.apply(e,n);o(void 0)}))},function(){return n.apply(this,arguments)})})}}({monaco:o,suggestions:s,settingSuggestions:a,sql:i})),o&&e.editor&&JSON.stringify(e.error||{})!==JSON.stringify(t||{})){e.error=t;var l=e.editor.getModel();if(t){var c={};if("number"==typeof t.position){var u=t.position-1||1,h=t.length||10,d=e.editor.getSelection(),f=e.editor.getModel().getValueInRange(d);f&&(h=Math.max(1,Math.min(h,f.length)),u+=l.getOffsetAt({column:d.startColumn,lineNumber:d.startLineNumber}));var p=l.getPositionAt(u),m=l.getPositionAt(u+h);c={startLineNumber:p.lineNumber,startColumn:p.column,endLineNumber:m.lineNumber,endColumn:m.column},e.editor.setPosition(p),e.editor.revealLine(p.lineNumber),e.editor.revealLineInCenter(p.lineNumber)}o.editor.setModelMarkers(l,"test",[sk(sk({severity:0,message:"error.message",startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:5,code:"error.code"},t),c)])}else o.editor.setModelMarkers(l,"test",[])}}));return function(){return t.apply(this,arguments)}}()),ak(this,"onKeyDown",(e=>{var{onStopQuery:t}=this.props;if("Escape"===e.key&&t)e.preventDefault(),t();else if(("F5"===e.key||(e.ctrlKey||e.altKey)&&"e"===e.key)&&this.editor&&this.editor._domElement&&this.editor._domElement.contains(e.target)){e.preventDefault();var n=dk(this.editor);this.props.onRun(n||this.editor.getValue(),!!n)}})),ak(this,"onChange",(e=>{var{value:t="",onChange:n,debounce:r=300}=this.props;this.curVal=e,this.inDebounce&&window.clearTimeout(this.inDebounce),this.inDebounce=setTimeout((()=>{var t;n(e,null===(t=this.editor)||void 0===t?void 0:t.getPosition()),this.inDebounce=null}),r)}))}componentDidMount(){var e=this;document.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("beforeunload",function(){var t=ck((function*(){yield e.componentWillUnmount()}));return function(){return t.apply(this,arguments)}}(),!1),this.onUpdate()}componentDidUpdate(e){this.onUpdate(e)}componentWillUnmount(){var e=this;return ck((function*(){var t,n,r;document.removeEventListener("keydown",e.onKeyDown,!1),yield null===(t=(n=e.props).onUnmount)||void 0===t?void 0:t.call(n,e.editor,null===(r=e.editor)||void 0===r?void 0:r.getPosition())}))()}render(){var{value:t="",editorMounter:n}=this.state,{onMount:r}=this.props;return e.createElement("div",{className:"f-1 min-h-0 min-w-0 flex-col relative ",style:{opacity:n?void 0:0},onDragOver:e=>(e.preventDefault(),!1),onDrop:e=>{var t,n=e.dataTransfer.getData("text");n&&(n=" ".concat(n," "),null===(t=this.editor)||void 0===t||t.trigger("keyboard","type",{text:n}))}},e.createElement(ek,{className:"f-1 min-h-0",language:"sql",value:t,overrideServices:uk,options:sk({parameterHints:{enabled:!window.isMobileDevice},fixedOverflowWidgets:!0,theme:hk},uk),onMount:e=>{var t,n;r&&r({editor:e,getSelectedText:()=>dk(e)}),this.editor=e,e.onDidChangeModelContent((()=>{this.onChange(e.getValue())})),this.setState({editorMounter:!0}),this.props.cursorPosition&&(null===(t=this.editor)||void 0===t||t.setPosition(this.props.cursorPosition),null===(n=this.editor)||void 0===n||n.revealLineInCenter(Math.max(-5+(this.props.cursorPosition.lineNumber||1),1)))}}))}}function pk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?pk(Object(t),!0).forEach((function(n){vk(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pk(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function gk(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function yk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){gk(a,r,i,o,s,"next",e)}function s(e){gk(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function vk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bk extends We{constructor(){var e;super(...arguments),e=this,vk(this,"state",{runningQuery:!1,sql:"",loading:!1,totalRows:0,rows:void 0,sort:[],joins:[],filter:{},rowCount:0,cols:void 0,duration:0,w:null,error:"",popup:null,hideTable:!0,sqlError:null,rowPanel:null,rowDelta:null,onRowClick:null,commandResult:"",queryStartDate:void 0,filterPopup:!1,notifEventSub:void 0,notices:void 0,noticeSub:void 0}),vk(this,"d",{page:1,pageSize:qM(Math.round(1.2*window.innerHeight/55)||25,zM),w:void 0,dataAge:0,wSync:void 0}),vk(this,"calculatedColWidths",!1),vk(this,"saveFunc",(e=>{"s"===e.key&&e.ctrlKey&&document.activeElement&&this.editorContainer&&this.editorContainer.contains(document.activeElement)&&(e.preventDefault(),this.saveQuery())})),vk(this,"loadingData",!1),vk(this,"currentDataRequestSignature",""),vk(this,"dataAge",0),vk(this,"onDelta",function(){var t=yk((function*(t,n,r){var i,o,s,a,l=mk(mk(mk({},t),n),r),{db:c,onClose:u}=e.props,{w:h,pageSize:d}=e.d||{},{table_name:f,table_oid:p,sort:m,filter:g}=h||{},y=m;mk({},g),h&&(!Array.isArray(y)&&(y=[]),c&&(l.db||!e.state.cols||ke(l,"w.columns"))&&(s={cols:[],onSort:(a=yk((function*(t){return e.setState({sort:t})})),function(){return a.apply(this,arguments)}),joins:[],loading:!1}),null!=l&&null!==(i=l.w)&&void 0!==i&&i.options&&"hideTable"in(null==l||null===(o=l.w)||void 0===o?void 0:o.options)&&(s=s||{}),s&&(f&&(s.runningQuery=!1),e.setState(s)))}));return function(){return t.apply(this,arguments)}}()),vk(this,"killQuery",yk((function*(){var{db:t}=e.props;if(t&&e._queryHashAlias){var n="SELECT pg_terminate_backend(pid) \n"+"FROM pg_stat_activity WHERE query ilike '".concat(e._queryHashAlias,"%' OR query = $1");console.log("killQuery...",yield t.sql("SELECT query, query ilike '${this._queryHashAlias}%' OR query = $1 FROM pg_stat_activity",[e.hashedSQL],{returnType:"rows"}),e.hashedSQL),console.time("killQuery");var r=yield t.sql(n,[e.hashedSQL]);console.timeEnd("killQuery"),console.log("killQuery...",r)}return!0}))),vk(this,"noticeEventListener",(e=>{var{notices:t=[]}=this.state;this.setState({notices:[mk(mk({},e),{},{received:(new Date).toISOString().replace("T"," ")}),...t]})})),vk(this,"notifEventListener",(e=>{var{rows:t}=this.state;this.setState({rows:[{payload:e,received:(new Date).toISOString().replace("T"," ")},...t]})})),vk(this,"runSQL",yk((function*(){var t,n,r,i,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.state.selected_sql||(null===(t=e.d)||void 0===t?void 0:t.w.sql),s=1<arguments.length?arguments[1]:void 0;if(!e.state.runningQuery){e.setState({runningQuery:!0});var a,{db:l}=e.props,{queryStartDate:c=new Date}=e.state,u=null===(n=e.d)||void 0===n?void 0:n.w,h=o.trimEnd(),d=!!s;d&&h.endsWith(";")&&(h=h.slice(0,-1)),e.getPagination(),e.hashedSQL=o,null===(r=e.state.notifEventSub)||void 0===r||null===(i=r.removeListener)||void 0===i||i.call(r);var f={runningQuery:!1,queryStartDate:void 0};try{var p,m=u.options||{};m&&m.hideTable&&u.$update({options:mk(mk({},m),{},{hideTable:!1})}),"number"!=typeof u.limit&&u.$update({limit:100});var g=u.limit||100;e.setState({sqlError:null});var y=h;if(d){e.hashedSQL=" SELECT * FROM (\n ".concat(y," \n ) t LIMIT 0");var{fields:v}=yield l.sql(e.hashedSQL),b=(s||[]).filter((e=>v[e.key])).map((e=>"".concat(e.key+1)+([1,!0].includes(e.asc)?" ASC ":" DESC "))).join(", ")||" TRUE ";try{yield l.sql(" SELECT * FROM (\n ".concat(y," \n ) t ORDER BY ").concat(b," LIMIT 0")),y=" SELECT * FROM (\n ".concat(y," \n ) t ORDER BY ").concat(b," LIMIT ").concat(g)}catch(e){y=" SELECT * FROM (\n ".concat(y," \n ) t LIMIT ").concat(g),u.$update({sort:[]}),alert("Cannot ORDER BY (".concat(b,") due to column name ambiguity"))}}e._queryHashAlias="--prostgles-"+wk(y+Date.now(),!0),e.hashedSQL=e._queryHashAlias+" \n"+y;var w="";e.setState({queryStartDate:new Date});var x=yield l.sql(e.hashedSQL,void 0,{returnType:"arrayMode"}),{rows:E,fields:_,duration:S=.001,command:C}=x;d=d||"SELECT"===C,x.addListener?(_=[{name:"payload",dataType:"json",format:"json"},{name:"received",dataType:"json",format:"json"}],E=[],a=yield x.addListener(e.notifEventListener)):(!_||!_.length)&&(w="".concat(C," command finished successfully!"));var T=mk(mk({},f),{},{loading:!1,onRowClick:null,sqlError:null,rowCount:E.length,sql:o,rows:E,duration:S,commandResult:w,notifEventSub:a,sort:s,queryEnded:Date.now(),cols:_.map(((e,t)=>mk(mk({},e),{},{idx:t,key:e.name,label:e.name,subLabel:e.dataType,udt_name:e.dataType,sortable:d&&!["xml","json"].includes(e.dataType)})))}),O=E.map((e=>e.reduce(((e,t,n)=>mk(mk({},e),{},{[n]:t})),{})));T.cols=jo.getColWidth(T.cols,O,"idx",null===(p=e.ref)||void 0===p?void 0:p.getBoundingClientRect().width),e.setState(T),u.$update({options:{sqlResultCols:T.cols,lastSQL:d?h:""}},{deepMerge:!0})}catch(t){console.error(t);var P=ke(t,"err_msg");"error: syntax error at end of input"===P&&(P+="\nHint: more commands expected at end of query");var A=ke(t,"err.hint"),k=ke(t,"err.detail"),M=ke(t,"err.where");P+=(A?" \n "+A:"")+(k?" \n "+k:"")+(M?" \n where: "+M:""),e.setState(mk(mk({},f),{},{notifEventSub:void 0,rows:[],cols:[],commandResult:"",duration:Math.min(1e-5,Date.now()-+c),sort:void 0,queryEnded:Date.now(),sqlError:{message:P,position:+ke(t,"err.position")-(e.hashedSQL||"").indexOf(o.trimEnd().slice(0,-1)),length:+ke(t,"err.length")}})),u.$update({options:{sqlResultCols:[]}},{deepMerge:!0})}}}))),vk(this,"getSelectedText",(()=>""))}onMount(){var e=this;return yk((function*(){var{db:t,dbs:n,w:r}=e.props;if(t&&!e.d.wSync){var i=r.$cloneSync(((t,n)=>{e.setData({w:t},{w:n})}));e.setData({wSync:i})}window.addEventListener("keydown",e.saveFunc,!1)}))()}onUnmount(){var e=this;return yk((function*(){var t,n,r,i,o,s,a;window.removeEventListener("keydown",e.saveFunc,!1),null===(t=e.d)||void 0===t||null===(n=t.wSync)||void 0===n||null===(r=n.$unsync)||void 0===r||r.call(n);var{notifEventSub:l,noticeSub:c}=e.state;null==l||null===(i=l.removeListener)||void 0===i||i.call(l),null==c||null===(o=c.removeListener)||void 0===o||o.call(c),yield null===(s=e.dataSub)||void 0===s||null===(a=s.unsubscribe)||void 0===a?void 0:a.call(s)}))()}saveQuery(){var e;this.d&&this.d.w&&null!==(e=this.d.w.sql)&&void 0!==e&&e.trim()&&xk(this.d.w.sql,this.d.w.name||"Query.sql","text/sql")}static getDataRequestSignature(e){if("sql"in e)return e.sql;var{filter:t,select:n,limit:r,offset:i}=e;return JSON.stringify({filter:t,select:n,limit:r,offset:i})}getPagination(){var{pageSize:e,page:t}=this.d;return{limit:e,offset:(t-1)*e}}render(){var t,n,r,i=this,{loading:o,totalRows:s,duration:a,rowDelta:l,rows:c=[],rowCount:u,joins:h,cols:d,popup:f,runningQuery:p,sqlError:m,sort:g,commandResult:y,queryStartDate:v,filterPopup:b,notifEventSub:w,notices:x,noticeSub:E,queryEnded:_}=this.state,{page:S,pageSize:C,w:T}=this.d,{db:O,onAddChart:P,dbs:A,suggestions:k,tables:M,setLinkMenu:N}=this.props;if(o||!T||!O)return e.createElement(Xe,{className:"m-auto"});var L=d||[],R=T.options||{},I=e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-col f-1 min-h-0 min-w-0 ",ref:e=>{e&&(this.ref=e)}},e.createElement("div",{ref:e=>{e&&(this.editorContainer=e)},className:"f-1 min-h-0 min-w-0 flex-col relative pt-1"},e.createElement(fk,{value:null===(t=this.d.w)||void 0===t?void 0:t.sql,sql:O.sql,suggestions:k,onMount:e=>{var{editor:t,getSelectedText:n}=e;this.getSelectedText=n},onUnmount:(e,t)=>{!function(e){var t,n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=mk(mk({},(null===(t=i.d)||void 0===t||null===(n=t.w)||void 0===n||null===(r=n.$get())||void 0===r?void 0:r.options)||{}),e);T.$update(mk(mk({},o),{},{options:s}),{deepMerge:!0})}({cursorPosition:t})},cursorPosition:null===(n=this.d.w)||void 0===n||null===(r=n.options)||void 0===r?void 0:r.cursorPosition,onChange:(e,t)=>{var n,r={sql:e},i=this.d.w.options||{};i.sqlChanged||(i.sqlChanged=!0),i=mk(mk({},i),{},{cursorPosition:t}),r.options=i,null===(n=this.d.w)||void 0===n||n.$update(r,{deepMerge:!0}),m&&this.setState({sqlError:null})},onRun:function(){var e=yk((function*(e,t){i.setState({selected_sql:t?e:""}),yield i.runSQL(e)}));return function(){return e.apply(this,arguments)}}(),onStopQuery:this.killQuery,error:m,getFuncDef:(e,t)=>as({db:O,name:e,minArgs:t})}),e.createElement("div",{className:"flex-row p-p5 text-gray-400 ai-center text-sm o-auto",style:{borderTop:"1px solid #0000000d"}},v?e.createElement(e.Fragment,null,e.createElement(et,{title:"Kill query",iconPath:Ee,onClick:this.killQuery}),e.createElement(Ek,{className:"p-p5 mr-1 noselect",title:"Query running time",from:v})):e.createElement(e.Fragment,null,w?e.createElement(et,{title:"Stop LISTEN",iconPath:Ee,onClick:yk((function*(){yield w.removeListener(),i.setState({notifEventSub:void 0})})),fadeIn:!0}):e.createElement(et,{title:"Run query",iconPath:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M10,16.5L16,12L10,7.5V16.5Z",onClick:()=>this.runSQL(),fadeIn:!0}),!m&&e.createElement("div",{className:"p-p5 mr-1 noselect fade-in",title:"Query running time"},w?"LISTEN...":"".concat((a/1e3).toFixed(3)||0,"s"))),!m&&e.createElement("div",{ref:e=>{e&&(this.refRowCount=e)},className:" p-p5 noselect",style:{marginRight:"1em"}},u," rows"),e.createElement(Fe,{error:ke(m,"message"),style:{padding:0}}),e.createElement("div",{className:"ml-auto p-p5 flex-row ai-center",style:{marginRight:"1em"}},e.createElement("div",{className:"mr-p5"},"limit"),e.createElement("input",{id:"dd"+T.limit,type:"number",style:{width:"55px"},defaultValue:T.limit,onChange:e=>{T.$update({limit:+e.target.value})}})),e.createElement(et,{title:"Show/Hide table",iconPath:_e,className:"mr-1",onClick:()=>{var e=this.d.w.options;e.hideTable&&!u?this.refRowCount&&(this.refRowCount.classList.remove("rubberBand"),this.refRowCount.offsetWidth,this.refRowCount.classList.add("rubberBand")):T.$update({options:mk(mk({},e),{},{hideTable:!e.hideTable})})}}),e.createElement(et,{title:"Show/Hide notices",iconPath:Q,color:E?"action":void 0,className:"mr-1",onClick:function(){var e=yk((function*(){if(E)yield E.removeListener(),i.setState({notices:void 0,noticeSub:void 0});else{var e=(yield O.sql("",{},{returnType:"noticeSubscription"})).addListener(i.noticeEventListener);i.setState({noticeSub:e})}}));return function(){return e.apply(this,arguments)}}()}))),e.createElement("div",{className:"flex-col oy-auto relative bt b-gray-300 "+(y?" f-0 ":" f-1 ")+(R.hideTable&&!x&&!w||p||!_?" hidden ":"")},p?e.createElement(Xe,{variant:"cover"}):null,x?e.createElement("div",{className:"p-1 ws-pre text-gray-600"},x.slice(0).map((e=>JSON.stringify(e,null,2))).join("\n")):y?e.createElement("div",{className:"p-1 text-gray-400"},y):e.createElement(UM,{maxCharsPerCell:1e3,sort:g,onSort:e=>{this.runSQL(void 0,e)},cols:L.map(((e,t)=>{return mk(mk({},e),{},{key:t,onResize:(n=yk((function*(t){var n=L.map((n=>(n.key===e.key&&(n.width=t),n)));i.setState({cols:n})})),function(){return n.apply(this,arguments)})});var n})),rows:c,style:{flex:1,boxShadow:"unset"},tableStyle:{borderRadius:"unset",border:"unset"},pagination:{page:S,pageSize:C,totalRows:s,onPageChange:e=>{console.log(e),this.setData({page:e})},onPageSizeChange:e=>{this.setData({pageSize:e})}}}))),f?e.createElement(pt,{rootStyle:f.style,anchorEl:f.anchorEl,positioning:f.positioning,clickCatchStyle:{opacity:0},onClose:()=>{this.setState({popup:void 0})},open:!0,contentClassName:""},f.content):null);return e.createElement(Eo,{w:T,quickMenuProps:{dbs:A,onAddChart:P,tables:M,setLinkMenu:N},getMenu:t=>e.createElement(Pk,{db:O,dbs:A,onAddChart:P,w:t,joins:h})},I)}}function wk(e,t,n){var r,i,o=void 0===n?2166136261:n;for(r=0,i=e.length;r<i;r++)o^=e.charCodeAt(r),o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24);return t?("0000000"+(o>>>0).toString(16)).substr(-8):o>>>0}function xk(e,t,n){var r=new Blob([e],{type:n}),i=window.navigator;if(i.msSaveOrOpenBlob)i.msSaveOrOpenBlob(r,t);else{var o=document.createElement("a"),s=URL.createObjectURL(r);o.href=s,o.download=t,document.body.appendChild(o),o.click(),setTimeout((function(){document.body.removeChild(o),window.URL.revokeObjectURL(s)}),0)}}class Ek extends We{constructor(){super(...arguments),vk(this,"state",{sec:0})}onMount(){var{from:e}=this.props;setInterval((()=>{this.mounted&&this.setState({sec:Math.round((Date.now()-+e)/1e3)})}),1e3)}render(){var{sec:t}=this.state,{className:n,title:r}=this.props;return e.createElement("div",{title:r,className:"text-gray-400 "+n},t,"s")}}function _k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?_k(Object(t),!0).forEach((function(n){Ok(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Ck(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Tk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Ck(a,r,i,o,s,"next",e)}function s(e){Ck(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function Ok(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pk extends We{constructor(){var e;super(...arguments),e=this,Ok(this,"state",{l1Key:void 0,l2Key:void 0,query:void 0,running:void 0,error:void 0,initError:void 0,hint:void 0,indexes:void 0,columnsConfig:void 0,infoQuery:void 0,autoRefreshSeconds:void 0}),Ok(this,"d",{w:void 0}),Ok(this,"onUnmount",Tk((function*(){e.wSub&&(yield e.wSub.$unsync())}))),Ok(this,"loading",!1),Ok(this,"onDelta",function(){var t=Tk((function*(t,n){var r=e.d.w||e.props.w;null!=r&&r.$cloneSync&&!e.loading&&(e.loading=!0,e.wSub=yield r.$cloneSync(((t,n)=>{e.setData({w:t},{w:n})}))),n&&"query"in n&&e.setState({error:void 0})}));return function(){return t.apply(this,arguments)}}()),Ok(this,"saveQuery",Tk((function*(){function t(){return(t=Tk((function*(e){var t=(new TextEncoder).encode(e),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}))).apply(this,arguments)}var n,r,i=e.props.w,o=(null==i||null===(n=i.$get())||void 0===n?void 0:n.sql)||"",s=((null==i||null===(r=i.$get())||void 0===r?void 0:r.name)||"Query_".concat(yield function(){return t.apply(this,arguments)}(o)))+".sql";xk(o,s,"text/sql")})))}render(){var{onAddChart:t,w:n}=this.props,{l1Key:r,initError:i}=this.state;if(i)return e.createElement("div",{className:"p-1"},e.createElement(Fe,{error:i}));if(!n)return null;var o=Ir.getChartCols(n),s={leftIconPath:"M22 5V7H19V10H17V7H14V5H17V2H19V5H22M19 19H5V5H11V3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V13H19V19M15 13V17H17V13H15M11 17H13V9H11V17M9 17V11H7V17H9Z",disabledText:o.dateCols.length||o.geoCols.length?void 0:"No date or geo columns to chart",content:e.createElement("div",{className:"text-gray-800 noselect flex-row ai-center"},e.createElement(Ir,{w:n,onAddChart:e=>{var n;t(e),null===(n=this.d.w)||void 0===n||n.$update({show_menu:!1})}}))},a={Query:{leftIconPath:ue,content:e.createElement("div",{className:"flex-col ai-start"},e.createElement(aN,{label:"Edit name",className:"ml-1 mb-1",value:n.name,asColumn:!0,type:"text",onChange:e=>{n.$update({name:e,options:Sk(Sk({},n.options||{}),{},{sqlWasSaved:!0})},{deepMerge:!0})}}),e.createElement(et,{title:"Save query as file",iconPath:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z",onClick:this.saveQuery},"Save query as file"),e.createElement("label",{title:"Open SQL file",htmlFor:"sql-open",className:"f-0 bg-transparent p-p5 bg-active-hover text-gray-400 undefined round pointer ml-p5 mt-1 flex-row ai-center"},e.createElement(Ae(),{size:1,path:ue}),e.createElement("input",{id:"sql-open",name:"sql-open",title:"Open query from file",type:"file",accept:"text/*, .sql, .txt",style:{display:"none"},onChange:e=>{e.currentTarget.files&&e.currentTarget.files[0]&&Ak(e.currentTarget.files[0]).then((e=>{n.$update({sql:e,show_menu:!1})}))}}),e.createElement("div",{className:" text-gray-500  ml-p5",style:{fontWeight:500,fontSize:".875rem"}},"Open SQL file")))},"Add chart":s,Delete:{leftIconPath:le,content:e.createElement("div",{className:"flex-col ai-start"},e.createElement(et,{title:"Delete this query",color:"danger",iconPath:le,onClick:()=>{n.$update({closed:!0,deleted:!0})}},"Delete query"))}};return e.createElement("div",{className:"table-menu c--fit flex-row",style:{maxHeight:"100vh",maxWidth:"100vw"}},e.createElement(yr,{variant:"vertical",contentClass:" o-auto min-h-0 max-h-100v "+("Alter"===r?" ":" p-1"),items:a,compactMode:!0,activeKey:r}))}}function Ak(e){return new Promise((t=>{var n=new FileReader;n.addEventListener("load",(function(e){t(e.target.result)})),n.readAsBinaryString(e)}))}function kk(){return kk=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},kk.apply(this,arguments)}function Mk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?Mk(Object(t),!0).forEach((function(n){Ik(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mk(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Lk(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Rk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Lk(a,r,i,o,s,"next",e)}function s(e){Lk(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function Ik(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dk(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return Dk=function(e){this.s=e,this.n=e.next},Dk.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Dk(e)}var jk=["Single text value","JSONB Rows","Properties with Geometry"];class Fk extends We{constructor(){var e;super(...arguments),e=this,Ik(this,"state",{streamColumnDataType:"TEXT",streamBatchMb:10,insertAs:"JSONB Rows",bytesPerRow:0,json:void 0,selectedFile:void 0,config:{header:!0},destination:{newTable:!0,newTableName:void 0,existingTable:void 0},importing:void 0,allowedTables:void 0,escapedColnames:void 0,open:!0,error:void 0,reCreateTable:!1,headerType:"First row",customHeaders:void 0,customHeadersError:void 0,results:void 0,colNo:"",streamColDelimiter:"_$_"}),Ik(this,"getExitMessage",(()=>this.isImporting?"Currently importing into table ".concat(this.isImporting.table,". Data might be lost"):void 0)),Ik(this,"onBeforeUnload",(e=>{var t=this.getExitMessage();if(t)return(e||window.event).returnValue=t,t})),Ik(this,"onDelta",function(){var t=Rk((function*(t,n,r){var{allowedTables:i,results:o,selectedFile:s}=e.state,{db:a}=e.props,l=Nk(Nk(Nk({},t),n),r);if(window.__prglIsImporting=!!e.state.importing,!i&&a){var c=yield Promise.all(Object.keys(a).filter((e=>a[e].insert)).map(function(){var e=Rk((function*(e){return{table:e,cols:yield a[e].getColumns()}}));return function(){return e.apply(this,arguments)}}()));e.setState({allowedTables:c})}s&&l&&(l.customHeaders||l.headerType)}));return function(){return t.apply(this,arguments)}}()),Ik(this,"rowsToJson",(e=>{var{config:t,headerType:n,customHeaders:r=""}=this.state,i=Nk({},e),o=i.data,s=[],a=[];if(o&&o.length)if("Custom"===n){var l=Object.keys(i.data[0]),c=Array(l.length).fill(null).map(((e,t)=>"c".concat(t+1))).join(", ");r||this.setState({customHeaders:c});var u=r.split(", ").map((e=>e.trim())),h={colNo:" (".concat(l.length,")"),customHeadersError:""};l.length===u.length?Array.from(new Set(u)).length===u.length?(s=u.map((e=>({key:e,label:e,dataType:"text",escapedName:(0,Cr.asName)(e),sortable:!1}))),a=o.map((e=>{var t={};return(Array.isArray(e)?e:Object.values(e)).map(((e,n)=>{t[u[n]]=e})),t}))):h.customHeadersError="Duplicate column names":h.customHeadersError="Extra/missing column names",this.setState(h)}else"First row"===n?(s=i.meta.fields.map((e=>({key:e,label:e,dataType:"text",escapedName:(0,Cr.asName)(e),sortable:!1}))),a=i.data):(s=Array(o[0].length).fill(null).map(((e,t)=>({key:"c".concat(t),label:"Column ".concat(t),dataType:"text",escapedName:(0,Cr.asName)("c".concat(t)),sortable:!1}))),a=o.map((e=>{var t={};return e.map(((e,n)=>{t["c".concat(n)]=e})),t})));return{cols:s,rows:a}})),Ik(this,"castColumns",Rk((function*(){var{db:t}=e.props,{escapedColnames:n}=e.state;n.map(function(){var e=Rk((function*(){}));return function(){return e.apply(this,arguments)}}())}))),Ik(this,"parseFiles",function(){var t=Rk((function*(t){var n,r=[],i=!1,o=!1;try{for(var s,a,l=function(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Dk(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}(t);i=!(s=yield l.next()).done;i=!1){a=s.value,e.setState({loadingFileName:a.name,importing:void 0});var c=yield Ak(a);r.push({fileName:a.name,content:c})}}catch(e){o=!0,n=e}finally{try{i&&null!=l.return&&(yield l.return())}finally{if(o)throw n}}return e.setState({loadingFileName:void 0}),r}));return function(){return t.apply(this,arguments)}}()),Ik(this,"setFiles",function(){var t=Rk((function*(t){if(1<t.length){var n=["txt","svg","html"],r=Array.from(t);if(r.every((e=>n.find((t=>e.name.toLowerCase().endsWith(".".concat(t))))&&1e6>e.size))){e.setState({files:t});var i=yield e.parseFiles(r.slice(0,40));e.setState({files:r,multiImport:i,selectedFile:{file:r[0],type:"csv",rowsPerBatch:1e3,preview:{cols:[{key:"fileName",dataType:"TEXT",escapedName:"fileName",label:"fileName",sortable:!1},{key:"content",dataType:"TEXT",escapedName:"content",label:"content",sortable:!1}],rows:i.slice(0,40)}},loadingFileName:void 0})}else alert("Multi import is only allowed for text files (".concat(n,") less than 1Mb each"))}else t.length&&e.setFile(t[0])}));return function(){return t.apply(this,arguments)}}()),Ik(this,"setFile",(e=>{var t=e.name.toLowerCase(),n=t.endsWith(".geojson")?"geojson":t.endsWith(".json")?"json":"csv",{headerType:r,customHeaders:i,streamColumnDataType:o,streamBatchMb:s}=this.state;if(this.setState({loadingFileName:e.name,importing:void 0}),e.size>5e7){var a=[];Hk(e,s,((t,r)=>{100<(a=a.concat(t)).length&&(a=a.map(((e,t)=>({id:t+1,value:e}))),r.abort(),this.setState({loadingFileName:void 0,selectedFile:{fileTooBig:!0,file:e,type:n,rowsPerBatch:10,preview:{rows:a,cols:[{key:"id",label:"id",dataType:"BIGSERIAL",subLabel:"BIGSERIAL",sortable:!1,escapedName:"id",width:50},{key:"value",label:"value",dataType:o,subLabel:o,sortable:!1,escapedName:"value"}]}}}))}),console.log,this.state.streamColDelimiter)}else if(n.endsWith("json"))(function(){return Vk.apply(this,arguments)})(e).then((t=>{var{rows:n,cols:r,srid:i,type:o,rowsPerBatch:s}=t;this.setState({loadingFileName:void 0,selectedFile:{file:e,type:o,srid:i,rowsPerBatch:s,preview:{allRows:n,cols:r.map((e=>Nk(Nk({},e),{},{label:e.key,subLabel:e.dataType,sortable:!1}))),rows:n.slice(0,50).map((e=>Nk({},e)))}}})})).catch((e=>{this.setState({error:e})}));else{var{config:l}=this.state;try{var c="First row"!==r;(function(){return qk.apply(this,arguments)})(e,Nk(Nk({},l),{},{header:!c})).then((t=>{var{rows:n,cols:r,rowsPerBatch:o}=t,s=c?i.split(",").map((e=>{var t=e.trim();return{key:t,dataType:"text",escapedName:(0,Cr.asName)(t)}})):r;this.setState({loadingFileName:void 0,selectedFile:{file:e,type:"csv",rowsPerBatch:o,preview:{allRows:n,cols:s.map((e=>Nk(Nk({},e),{},{label:e.key,subLabel:e.dataType,sortable:!1}))),rows:n.slice(0,50).map((e=>Nk({},e)))}}})})).catch((e=>{this.setState({error:e})}))}catch(e){console.error(e)}}})),Ik(this,"createTable",(()=>{var{selectedFile:t,config:n,destination:r,reCreateTable:i,insertAs:o}=this.state;return new Promise(function(){var n=Rk((function*(n,o){try{var{db:s}=e.props;if(!s||!s.sql)throw"Cannot create new table";var a=r.newTableName||t.file.name,l=yield s.sql("$1:name",[a],{returnType:"statement"});i&&s[a]&&(yield s.sql("DROP TABLE IF EXISTS "+l));var c=t.preview.cols,u=c.map((e=>e.escapedName+" "+e.dataType)).join(",\n"),h=c.filter((e=>"BIGSERIAL"!==e.dataType)).map((e=>e.escapedName)),d=yield s.sql("INSERT INTO "+l+" (${colTypes:raw}) VALUES ",{colTypes:h.join(", ")},{returnType:"statement"}),f=yield s.sql("CREATE TABLE "+l+" ( \n"+u+" \n);");console.log(f),n({tableName:a,escapedTableName:l,insertQueryPrefix:d})}catch(e){o(e)}}));return function(){return n.apply(this,arguments)}}())})),Ik(this,"canceled",!1),Ik(this,"importFile",Rk((function*(){var t,n,{selectedFile:r,insertAs:i,destination:o,streamBatchMb:s,streamColumnDataType:a}=e.state,{db:l}=e.props;e.canceled=!1;try{if(null==r||!r.file)throw"No file to import";if(null==r||!r.preview)throw"Preview missing";var c={};if(null!=o&&o.newTable){var{escapedTableName:u,insertQueryPrefix:h}=yield e.createTable();n=u;var d=r.preview.cols,f=d.map((e=>e.escapedName));c={importing:{table:u},escapedColnames:f,error:void 0},t=function(){var t=Rk((function*(t){if("Single text value"===i)return e.props.db.sql("INSERT INTO ".concat(u," ( all_data ) VALUES ($1) "),[t[0].all_data]);var n=e.state.selectedFile.srid;n&&(t=t.map((e=>{var t=Nk({},e),r=t;return r.geometry.crs=r.geometry.crs||{},r.geometry.crs.type=r.geometry.crs.type||{},r.geometry.crs.type.name=r.geometry.crs.type.name||{},r.geometry.crs.type.name.properties=r.geometry.crs.type.name.properties||{},r.geometry.crs.type.name.properties.name=n,t.geometry=r.geometry,t})));var r={},o=d.filter((e=>"BIGSERIAL"!==e.dataType));t.forEach(((e,t)=>o.map(((n,i)=>{n.key in e&&void 0!==e[n.key]?"BIGSERIAL"===n.dataType&&(e[n.key]=null):e[n.key]=null;var o="r".concat(t),s="c".concat(i);r[o]=r[o]||{},r[o][s]=e[n.key]}))));var s=t.map(((e,t)=>"(".concat(o.map(((e,n)=>{var r="${r"+t+".c"+n+"}";return"geometry"===e.dataType?" ST_GeomFromGeoJSON(".concat(r,") "):r})).join(", "),") ")));return s.length?e.props.db.sql(h+s.join(", "),r):[]}));return function(){return t.apply(this,arguments)}}()}else o.existingTable&&(n=o.existingTable,c={importing:{table:o.existingTable},error:void 0},t=e=>l[o.existingTable].insert(e));e.setState(c),e.isImporting=c.importing,e.elapsedCounter||(e.elapsedCounter={timeStarted:Date.now(),interval:setInterval((()=>{if(e.mounted&&e.elapsedCounter&&e.elapsedCounter.timeStarted&&e.isImporting){var t=e.elapsedCounter.timeStarted,n=Math.round((Date.now()-t)/1e3),r=Math.floor(n/60);e.state&&e.state.importing&&e.setState({importing:Nk(Nk({},e.state.importing),{},{timeElapsed:[r,n-60*r].map((e=>e.toString().padStart(2,"0"))).join(":")})})}else e.elapsedCounter&&clearInterval(e.elapsedCounter.interval)}),1e3)});var p=e.state.selectedFile.rowsPerBatch;e.setState({importing:Nk(Nk({},e.state.importing),{},{progress:0,progressRows:0})});var m,g=0;try{if(0>=p)throw"Bad stepSize";if(r.fileTooBig){var y=0,v=0,b=[];Hk(r.file,s,function(){var n=Rk((function*(n,i){if(b=n.map((e=>({value:"TEXT"===a?e:JSON.parse(e)}))),!e.mounted||e.state.error)i.abort();else{i.pause();try{yield t(b)}catch(t){e.setState({error:t}),console.error(t)}v+=4*b.join("").length,y+=b.length,e.setState({importing:Nk(Nk({},e.state.importing),{},{progress:100*v/r.file.size,progressRows:y})}),b=[],i.resume()}}));return function(){return n.apply(this,arguments)}}(),(()=>{e.setState({importing:Nk(Nk({},e.state.importing),{},{progress:100,imported:n,importedRows:y,finished:!0})})}),e.state.streamColDelimiter)}else{var w=e.state.files?yield e.parseFiles(e.state.files):e.state.selectedFile.preview.allRows,x=w.length;do{m=w.slice(g,g+p),yield t(m),e.setState({importing:Nk(Nk({table:n},e.state.importing),{},{progress:Math.round(100*(g+p)/x),progressRows:g+p})}),g+=p}while((!g||g<x)&&!e.canceled);e.setState({importing:Nk(Nk({},e.state.importing),{},{progress:100,imported:n,importedRows:null==w?void 0:w.length,finished:!0})})}}catch(e){throw console.log(m),{startRow:g,batchSize:p,err:e}}e.isImporting=void 0}catch(t){console.error(t),e.isImporting=void 0,e.setState({error:t,importing:void 0})}}))),Ik(this,"cancel",Rk((function*(){e.canceled=!0;var{onClose:t,db:n}=e.props,{importing:r}=e.state;r&&!r.finished&&(yield n.sql("DROP TABLE IF EXISTS "+r.table)),e.setState({importing:void 0,open:!1,selectedFile:void 0}),t()})))}onMount(){window.addEventListener("beforeunload",this.onBeforeUnload)}onUnmount(){var e=this.getExitMessage();e?window.confirm(e):window.removeEventListener("beforeunload",this.onBeforeUnload),window.__prglIsImporting=!1}render(){var t,n,r=this,{selectedFile:i,colNo:o,destination:s,importing:a,headerType:l,error:c,open:u,reCreateTable:h,customHeadersError:d,customHeaders:f,insertAs:p,loadingFileName:m,streamColDelimiter:g,streamBatchMb:y,files:v}=this.state,{openTable:b,parentDiv:w,db:x}=this.props,{newTableName:E}=s,_=E;return!E&&i&&(_=i.file.name),e.createElement(pt,{title:null!=i&&i.file?v?"Import ".concat(v.length," files"):"Import ".concat(i.file.name):"Import data from file",open:u,onClose:this.cancel,positioning:"as-is",rootStyle:{top:window.isMobileDevice?0:"2em",left:window.isMobileDevice?0:"2em",maxHeight:window.isIOSDevice?"calc(100vh - 100px)":"calc(100% - 3em)",maxWidth:window.isIOSDevice?"calc(100vw - 2em)":"100%"},contentClassName:"p-1",footer:e.createElement(e.Fragment,null,e.createElement("div",{className:"p-1 ai-center flex-row f-1",style:{justifyContent:"sspace-between"}},e.createElement(et,{onClick:this.cancel,className:"mr-auto",style:{border:"1px solid var(--gray-300)",padding:"8px 16px"}},"Cancel"),!i||null!=a&&a.progress?null:e.createElement(et,{className:"ml-auto",onClick:this.importFile,disabledInfo:d,style:{background:"var(--blue-600)",color:"white",padding:"8px 16px"}},"Import"),null!=a&&a.finished?e.createElement("div",{className:"ml-1 f-1"},e.createElement("span",{style:{color:"var(--green-500)"}},a.importedRows)," rows imported into ",e.createElement("span",{style:{color:"var(--yellow-500)"}},a.table)):null,null!=a&&a.imported&&x[a.imported]?e.createElement(et,{className:"ml-1",onClick:Rk((function*(){b(a.imported),r.cancel()})),disabledInfo:d,style:{background:"var(--blue-600)",color:"white",padding:"8px 16px"}},"Open table"):null,a&&!a.progress?e.createElement("div",{className:"flex-row ai-center ml-auto ta-right"},"Loading file ..."):null,a&&!a.finished?e.createElement("div",{className:"flex-row ai-center ml-auto ta-right"},e.createElement("div",{className:"mr-1 flex-col "+(a.progress||a.progressRows?"":" hidden ")},e.createElement("div",{style:{fontSize:"1.5em"}},null===(t=a.progress)||void 0===t?void 0:t.toFixed(2),"%"),e.createElement("div",null,(a.progressRows||0).toLocaleString()," rows")),e.createElement("div",{className:"flex-col ai-center"},e.createElement(Xe,{key:"elapsed-loader"}),e.createElement("div",{className:"text-gray-500 mt-p5",style:{fontSize:"1em"}},a.timeElapsed))):null),c?e.createElement(Fe,{error:c.err_msg||c,pre:!0}):null)},e.createElement("div",{className:"flex-col o-auto"},m?e.createElement("div",{className:"flex-row mt-2"},e.createElement(Xe,{className:"mr-1"}),e.createElement("div",{className:"text-gray-500 mt-p5",style:{fontSize:"1em"}},"Loading ",m)):null,a&&!a.finished||m?null:e.createElement(aN,{asColumn:!0,className:"mb-1 ",label:"File (csv/txt/json/geojson)",type:"file",inputProps:{multiple:!0},onChange:e=>{this.setFiles(e)}}),i?e.createElement(e.Fragment,null,e.createElement(aN,{asColumn:!0,key:"new-table-name",readOnly:a&&!a.finished,className:"mb-1 ",label:"Table name",value:_,onChange:e=>{this.setState({destination:Nk(Nk({},s),{},{newTableName:e})})},rightIcons:e.createElement(et,{iconPath:de,onClick:()=>{return this.setState({destination:Nk(Nk({},s),{},{newTableName:(e=_,(e=>{var t="",n=e.trim().split("");return n.map(((e,r)=>{r&&"_"!==t.slice(-1)&&(!n[r-1].match(/[A-Z]/)||e.match(/[\W_]+/))&&(t+="_"),e.match(/[\W_]+/)||(t+=e.toLowerCase())})),t})(e))})});var e},title:"Transform name to snake case"})}),null!=a&&a.finished?null:e.createElement(e.Fragment,null,e.createElement(aN,{asColumn:!0,className:"mb-1 ",label:"Drop table if exists",type:"checkbox",value:h,onChange:e=>{this.setState({reCreateTable:e})}}),"csv"===i.type?null:e.createElement(aN,{asColumn:!0,className:"mb-1 ",label:"Insert as",value:p,options:jk,onChange:e=>{this.setState({insertAs:e})}}),"geojson"===i.type?e.createElement(aN,{asColumn:!0,className:"mb-1 ",label:"SRID",value:i.srid,type:"text",onChange:e=>{this.setState({selectedFile:Nk(Nk({},this.state.selectedFile),{},{srid:e})})}}):null,i.fileTooBig&&e.createElement("div",{className:"f-1 flex-col ai-start p-1 ta-left"},e.createElement(Ae(),{className:"f-0 mt-p5 text-yellow-400",path:me,size:1.25}),e.createElement("div",null,e.createElement("p",null," The file you have selected is over the 50Mb limit. "),e.createElement("p",null," It can only be imported as a stream into a TEXT column. "),e.createElement("p",null," An incrementing BIGSERIAL column will be added "))),i.fileTooBig&&e.createElement("div",{className:"f-1 flex-row ai-center mt-1 ta-left"},e.createElement(aN,{asColumn:!0,inputProps:{min:1,max:Math.round(i.file.size/1048576)},className:"mb-1 mr-1",label:"Stream batch size in Megabytes",type:"number",value:y,onChange:e=>{e>i.file.size/1048576?alert("Must be less than file size"):this.setState({streamBatchMb:e})}}),e.createElement(aN,{asColumn:!0,className:"mb-1 mr-1",label:"Delimiter",type:"text",value:g,onChange:e=>{this.setState({streamColDelimiter:e})}})))):null,!i||a&&!a.finished?null:e.createElement("div",{className:"f-1 flex-col",style:{maxHeight:"400px",maxWidth:"900px"}},m?e.createElement(Xe,{key:"preview-loader"}):e.createElement("div",{className:"flex-col f-1 min-w-0 min-h-0"},e.createElement("div",{className:"divider-h"}),i.fileTooBig?e.createElement("div",{className:"f-0 mb-1 noselect"},"File size: ",Math.round(i.file.size/1e6).toLocaleString()," Megabytes"):e.createElement("div",{className:"f-0 mb-1 noselect"},"TotalRows: ",null===(n=i.preview.allRows)||void 0===n?void 0:n.length),e.createElement("div",{className:"f-0 mb-1 noselect"},"Preview"),e.createElement(UM,kk({maxCharsPerCell:500,className:"f-1 o-auto b-gray-400 "},i.preview))))))}}function zk(e){var t=4*(e+100)*8;if(t>Bk)throw"100Mb row size limit exceeded. Cannot send upload data";return Math.floor(Math.min(1500,Math.max(Uk/t,Bk/t)))}var Bk=1e8,Uk=2e7;function Vk(){return Vk=Rk((function*(e){var t,n="json",r=yield Ak(e),i=JSON.parse(r),o=[],s={},a=0,l=e=>{Object.keys(e).map((t=>{var n="number"==typeof e[t]?"numeric":"text",r=s[t];r&&("numeric"!==r||"text"!==n)||(s[t]=n)}))};if("FeatureCollection"===i.type&&i.features&&Array.isArray(i.features)){n="geojson",s={geometry:"geometry"};var c=!1;i.features.map(((e,t)=>{if("Feature"!==e.type)console.warn("Could not import feature number ".concat(t,'. Feature.type is not "Feature"'),e);else{var n=e.properties;(c=c||void 0!==e.id)&&(n=Nk(Nk({},n),{},{dI:e.id})),l(n)}}));var u=Object.keys(s);o=i.features.map(((e,n)=>{if("Feature"===e.type){var r,i,o,s,l;t=t||(null===(r=e.geometry)||void 0===r||null===(i=r.crs)||void 0===i||null===(o=i.type)||void 0===o||null===(s=o.name)||void 0===s||null===(l=s.properties)||void 0===l?void 0:l.name)||"EPSG:4326";var h={};return u.map((t=>{var n;if("id"===t&&c)h[t]=null!==(n=e.id)&&void 0!==n?n:null;else if("geometry"===t){var r;h[t]=null!==(r=e.geometry)&&void 0!==r?r:null}else{var i;h[t]=null!==(i=e.properties[t])&&void 0!==i?i:null}})),a=Math.max(a,JSON.stringify(h).length),h}console.warn("Could not import feature number ".concat(n,'. Feature.type is not "Feature"'),e)}))}else if(Array.isArray(i)){o=i.map((e=>{l(e)}));var h=Object.keys(s);o=i.map((e=>(h.map((t=>{var n;e[t]=null!==(n=e[t])&&void 0!==n?n:null})),a=Math.max(a,JSON.stringify(e).length),e)))}return{type:n,rows:o,srid:t,cols:Object.keys(s).map((e=>({key:e,escapedName:(0,Cr.asName)(e),dataType:s[e]}))),rowsPerBatch:zk(a)}})),Vk.apply(this,arguments)}function Hk(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return YP().parse(e,{chunkSize:1048576*t,chunk:function(e,t){n(e.data.map((e=>Array.isArray(e)?e.join(i):e)),t)},error:console.error,complete:function(){r()}})}function qk(){return qk=Rk((function*(e,t){return new Promise(function(){var n=Rk((function*(n,r){try{YP().parse(e,{header:!1,worker:!0,preview:4,skipEmptyLines:!0,complete:i=>{var o,{data:s}=i,a=!0,l=s[0],c=s[1];return null!=s&&s.length?(a=l.some(((e,t)=>{if(!c)return!1;var n=Re(e).map((e=>e.type)).join(),r=Re(c[t]).map((e=>e.type)).join();return e&&n!==r})),void YP().parse(e,Nk(Nk({},t),{},{header:a,worker:!0,skipEmptyLines:!0,complete:(o=Rk((function*(e){var t=e.data||[];if(t.length){var i=[],o=t[0].length;t=t.filter(((e,t)=>e.length===o||(i.push({row_number:t,row_value:e}),!1))),i.length&&console.error("Some rows have been ommited due to the number of columns not coinciding with first row:",i)}var s=[];if(a){var l;s=((null===(l=e.meta)||void 0===l?void 0:l.fields)||[]).map((e=>({key:e,dataType:"text",escapedName:(0,Cr.asName)(e)})))}else{if(!t.length)return void r("Could not import: No data to import");s=t[0].map(((e,t)=>({key:"c".concat(t+1),dataType:"text",escapedName:(0,Cr.asName)("c".concat(t+1))}))),t=t.map((e=>s.reduce(((t,n,r)=>Nk(Nk({},t),{},{[n.key]:e[r]})),{})))}var c=0;t.map((e=>{c=Math.max(c,JSON.stringify(e).length)})),n({rows:t,cols:s,rowsPerBatch:zk(c)})})),function(){return o.apply(this,arguments)})}))):void r("File is empty or could not be parsed")}})}catch(e){r(e)}}));return function(){return n.apply(this,arguments)}}())})),qk.apply(this,arguments)}function Wk(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Gk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Wk(a,r,i,o,s,"next",e)}function s(e){Wk(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function $k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yk(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?$k(Object(t),!0).forEach((function(n){Xk(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function Xk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kk=[{key:"all",label:"All tables"},{key:"relations",label:"With relations"},{key:"leaf",label:"Without relations"}];class Zk extends We{constructor(){super(...arguments),Xk(this,"state",{nodes:[],links:[],displayMode:"all"}),Xk(this,"loaded",!1),Xk(this,"onDelta",((e,t)=>{null!=t&&t.displayMode&&this.setChart()})),Xk(this,"setChart",(()=>{var{displayMode:e,nodes:t,links:n}=this.state,r=t.map((e=>Yk({},e))),i=n.map((e=>Yk({},e)));"leaf"===e?(r=r.filter((e=>!e.hasLinks)),i=[]):"relations"===e&&(r=r.filter((e=>e.hasLinks))),function(e){var t,n,{svgNode:r,data:i,onClickNode:o}=e,s=r;s.d3Sim&&(null===(t=(n=s.d3Sim).stop)||void 0===t||t.call(n));var a=iC(r),l=+a.attr("width"),c=+a.attr("height"),u=(Math.sqrt(61200),a.select("g.everything")),h=u.select("g.links"),d=u.select("g.nodes"),f=h.selectAll("path.link").data(i.links,(e=>e.id)),p=f.enter().append("path").attr("class","link").attr("stroke-width",2).attr("fill","none").attr("stroke",(e=>e.color)).merge(f);f.exit().remove();var m=d.selectAll("g.node").data(i.nodes,(e=>e.id)),g=m.enter().append("g").attr("class","node").merge(m);m.exit().remove(),g.on("click",(function(e,t){o(t.id)})),g.on("mouseover",(function(){iC(this).select("rect").style("fill","#f3f3f3")})).on("mouseout",(function(){iC(this).select("rect").style("fill","white")})),g.append("rect").attr("x",(e=>-e.width/2)).attr("y",(e=>-e.height/2)).attr("width",(e=>e.width)).attr("height",(e=>e.height)).attr("fill","white").attr("stroke","grey"),g.append("rect").attr("x",(e=>-e.width/2)).attr("y",(e=>-e.height/2)).attr("width",(e=>e.width)).attr("height",(()=>30)).attr("fill","#e1e1e1"),g.append("text").attr("x",(e=>5+-e.width/2)).attr("y",(()=>0)).style("text-anchor","start").each((function(e){var{width:t,height:n,id:r}=e;iC(this).selectAll("tspan").data([e.header,...e.text]).enter().append("tspan").attr("x",5+-t/2).attr("y",((e,t)=>Jk(t,n))).text((e=>e.label)).style("dominant-baseline","hanging").style("fill",(e=>e.color)).style("font-size",((e,t)=>t?14:18))})),function(e){var t=[];i.nodes.forEach((e=>{t[e.cluster]?(t[e.cluster].width<e.width&&(t[e.cluster].width=e.width),t[e.cluster].height<e.height&&(t[e.cluster].height=e.height)):t[e.cluster]=e}));var n=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,l=rS(h),c=W_("tick","end"),u=function(){let e=1;return()=>(e=(1664525*e+1013904223)%kC)/kC}();function h(){d(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function d(r){var l,c,u=e.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,a.forEach((function(e){e(n)})),l=0;l<u;++l)null==(c=e[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return t}function f(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+n),o=n*LC;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,u),t}return null==e&&(e=[]),f(),t={tick:d,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,f(),a.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(s=1-e,t):1-s},randomSource:function(e){return arguments.length?(u=e,a.forEach(p),t):u},force:function(e,n){return arguments.length>1?(null==n?a.delete(e):a.set(e,p(n)),t):a.get(e)},find:function(t,n,r){var i,o,s,a,l,c=0,u=e.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(s=(i=t-(a=e[c]).x)*i+(o=n-a.y)*o)<r&&(l=a,r=s);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}().nodes(i.nodes);e.d3Sim=n;var r=function(e){var t,n,r,i,o,s,a=wC,l=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},c=vC(30),u=1;function h(r){for(var i=0,a=e.length;i<u;++i)for(var l,c,h,d,f,p,m,g=0;g<a;++g)c=(l=e[g]).source,d=(h=l.target).x+h.vx-c.x-c.vx||bC(s),f=h.y+h.vy-c.y-c.vy||bC(s),d*=p=((p=Math.sqrt(d*d+f*f))-n[g])/p*r*t[g],f*=p,h.vx-=d*(m=o[g]),h.vy-=f*m,c.vx+=d*(m=1-m),c.vy+=f*m}function d(){if(r){var s,l,c=r.length,u=e.length,h=new Map(r.map(((e,t)=>[a(e,t,r),e])));for(s=0,i=new Array(c);s<u;++s)(l=e[s]).index=s,"object"!=typeof l.source&&(l.source=xC(h,l.source)),"object"!=typeof l.target&&(l.target=xC(h,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(s=0,o=new Array(u);s<u;++s)l=e[s],o[s]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);t=new Array(u),f(),n=new Array(u),p()}}function f(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+l(e[n],n,e)}function p(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),h.initialize=function(e,t){r=e,s=t,d()},h.links=function(t){return arguments.length?(e=t,d(),h):e},h.id=function(e){return arguments.length?(a=e,h):a},h.iterations=function(e){return arguments.length?(u=+e,h):u},h.strength=function(e){return arguments.length?(l="function"==typeof e?e:vC(+e),f(),h):l},h.distance=function(e){return arguments.length?(c="function"==typeof e?e:vC(+e),p(),h):c},h}(i.links).id((function(e){return e.id})).distance((e=>Math.max(e.sourceNode.width,e.sourceNode.height)/2+Math.max(e.targetNode.width,e.targetNode.height)/2)).strength(1),o=function(){var e,t,n,r,i,o=vC(-30),s=1,a=1/0,l=.81;function c(n){var i,o=e.length,s=TC(e,MC,NC).visitAfter(h);for(r=n,i=0;i<o;++i)t=e[i],s.visit(d)}function u(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+o(n,t,e)}}function h(e){var t,n,r,o,s,a=0,l=0;if(e.length){for(r=o=s=0;s<4;++s)(t=e[s])&&(n=Math.abs(t.value))&&(a+=t.value,l+=n,r+=n*t.x,o+=n*t.y);e.x=r/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{a+=i[t.data.index]}while(t=t.next)}e.value=a}function d(e,o,c,u){if(!e.value)return!0;var h=e.x-t.x,d=e.y-t.y,f=u-o,p=h*h+d*d;if(f*f/l<p)return p<a&&(0===h&&(p+=(h=bC(n))*h),0===d&&(p+=(d=bC(n))*d),p<s&&(p=Math.sqrt(s*p)),t.vx+=h*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=a)){(e.data!==t||e.next)&&(0===h&&(p+=(h=bC(n))*h),0===d&&(p+=(d=bC(n))*d),p<s&&(p=Math.sqrt(s*p)));do{e.data!==t&&(f=i[e.data.index]*r/p,t.vx+=h*f,t.vy+=d*f)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,u()},c.strength=function(e){return arguments.length?(o="function"==typeof e?e:vC(+e),u(),c):o},c.distanceMin=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.distanceMax=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c}().strength((e=>e.hasLinks?-1200:-200)),s=function(e,t){var n,r=1;function i(){var i,o,s=n.length,a=0,l=0;for(i=0;i<s;++i)a+=(o=n[i]).x,l+=o.y;for(a=(a/s-e)*r,l=(l/s-t)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i}(l/2,c/2);n.force("charge_force",o).force("center_force",s).force("links",r).force("x",RC(((e,t)=>e.hasLinks?l/2:l/(t+1))).strength(.1)).force("y",RC((e=>e.hasLinks?c/2:0)).strength(.1)).force("collide",function(){function e(){var e=TC(t,(e=>e.x),(e=>e.y)),n=function(t){e.visit((e=>{var n=!1;if(e.data&&e.data!==t){var r,i,o,s=t.x-e.data.x,a=t.y-e.data.y,l=95+(e.data.width+t.width)/2,c=95+(e.data.height+t.height)/2,u=Math.abs(s),h=Math.abs(a);u<l&&h<c&&(i=(u-l)/(r=Math.sqrt(s*s+a*a)),o=(h-c)/r,Math.abs(i)>Math.abs(o)?i=0:o=0,t.x-=s*=i,t.y-=a*=o,e.data.x+=s,e.data.y+=a,n=!0)}return n}))};for(var r of t)n(r)}var t;return e.initialize=e=>t=e,e}()),e.style("opacity",.5),e.attr("transform",(function(e){return"translate("+e.x+","+e.y+")"}));var h=function(){var e,t,n,r,i=pC,o=mC,s=gC,a=yC,l={},c=W_("start","drag","end"),u=0,h=0;function d(e){e.on("mousedown.drag",f).filter(a).on("touchstart.drag",g).on("touchmove.drag",y,sC).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!r&&i.call(this,s,a)){var l=b(this,o.call(this,s,a),s,a,"mouse");l&&(iC(s.view).on("mousemove.drag",p,aC).on("mouseup.drag",m,aC),uC(s.view),lC(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function p(r){if(cC(r),!n){var i=r.clientX-e,o=r.clientY-t;n=i*i+o*o>h}l.mouse("drag",r)}function m(e){iC(e.view).on("mousemove.drag mouseup.drag",null),hC(e.view,n),cC(e),l.mouse("end",e)}function g(e,t){if(i.call(this,e,t)){var n,r,s=e.changedTouches,a=o.call(this,e,t),l=s.length;for(n=0;n<l;++n)(r=b(this,a,e,t,s[n].identifier,s[n]))&&(lC(e),r("start",e,s[n]))}}function y(e){var t,n,r=e.changedTouches,i=r.length;for(t=0;t<i;++t)(n=l[r[t].identifier])&&(cC(e),n("drag",e,r[t]))}function v(e){var t,n,i=e.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<o;++t)(n=l[i[t].identifier])&&(lC(e),n("end",e,i[t]))}function b(e,t,n,r,i,o){var a,h,f,p=c.copy(),m=oC(o||n,t);if(null!=(f=s.call(e,new fC("beforestart",{sourceEvent:n,target:d,identifier:i,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),r)))return a=f.x-m[0]||0,h=f.y-m[1]||0,function n(o,s,c){var g,y=m;switch(o){case"start":l[i]=n,g=u++;break;case"end":delete l[i],--u;case"drag":m=oC(c||s,t),g=u}p.call(o,e,new fC(o,{sourceEvent:s,subject:f,target:d,identifier:i,active:g,x:m[0]+a,y:m[1]+h,dx:m[0]-y[0],dy:m[1]-y[1],dispatch:p}),r)}}return d.filter=function(e){return arguments.length?(i="function"==typeof e?e:dC(!!e),d):i},d.container=function(e){return arguments.length?(o="function"==typeof e?e:dC(e),d):o},d.subject=function(e){return arguments.length?(s="function"==typeof e?e:dC(e),d):s},d.touchable=function(e){return arguments.length?(a="function"==typeof e?e:dC(!!e),d):a},d.on=function(){var e=c.on.apply(c,arguments);return e===c?d:e},d.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,d):Math.sqrt(h)},d}().on("start",(function(e){e.active||n.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y})).on("drag",(function(e){e.fx=e.x,e.fy=e.y})).on("end",(function(e){e.active||n.alphaTarget(0),e.fx=null,e.fy=null}));e.call(h);var d=function(){var e,t,n,r=MO,i=NO,o=DO,s=RO,a=IO,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=SO,d=W_("start","zoom","end"),f=500,p=0,m=10;function g(e){e.property("__zoom",LO).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",C).filter(a).on("touchstart.zoom",T).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new OO(t,e.x,e.y)}function v(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new OO(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function w(e,t,n,r){e.on("start.zoom",(function(){x(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,o=arguments,s=x(e,o).event(r),a=i.apply(e,o),l=null==n?b(a):"function"==typeof n?n.apply(e,o):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,d="function"==typeof t?t.apply(e,o):t,f=h(u.invert(l).concat(c/u.k),d.invert(l).concat(c/d.k));return function(e){if(1===e)e=d;else{var t=f(e),n=c/t[2];e=new OO(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}}))}function x(e,t,n){return!n&&e.__zooming||new E(e,t)}function E(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=i.apply(e,t),this.taps=0}function _(e,...t){if(r.apply(this,arguments)){var n=x(this,t).event(e),i=this.__zoom,a=Math.max(l[0],Math.min(l[1],i.k*Math.pow(2,s.apply(this,arguments)))),u=oC(e);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=i.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(i.k===a)return;n.mouse=[u,i.invert(u)],pS(this),n.start()}kO(e),n.wheel=setTimeout(h,150),n.zoom("mouse",o(v(y(i,a),n.mouse[0],n.mouse[1]),n.extent,c))}function h(){n.wheel=null,n.end()}}function S(e,...t){if(!n&&r.apply(this,arguments)){var i=e.currentTarget,s=x(this,t,!0).event(e),a=iC(e.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),l=oC(e,i),u=e.clientX,h=e.clientY;uC(e.view),AO(e),s.mouse=[l,this.__zoom.invert(l)],pS(this),s.start()}function d(e){if(kO(e),!s.moved){var t=e.clientX-u,n=e.clientY-h;s.moved=t*t+n*n>p}s.event(e).zoom("mouse",o(v(s.that.__zoom,s.mouse[0]=oC(e,i),s.mouse[1]),s.extent,c))}function f(e){a.on("mousemove.zoom mouseup.zoom",null),hC(e.view,s.moved),kO(e),s.event(e).end()}}function C(e,...t){if(r.apply(this,arguments)){var n=this.__zoom,s=oC(e.changedTouches?e.changedTouches[0]:e,this),a=n.invert(s),l=n.k*(e.shiftKey?.5:2),h=o(v(y(n,l),s,a),i.apply(this,t),c);kO(e),u>0?iC(this).transition().duration(u).call(w,h,s,e):iC(this).call(g.transform,h,s,e)}}function T(n,...i){if(r.apply(this,arguments)){var o,s,a,l,c=n.touches,u=c.length,h=x(this,i,n.changedTouches.length===u).event(n);for(AO(n),s=0;s<u;++s)l=[l=oC(a=c[s],this),this.__zoom.invert(l),a.identifier],h.touch0?h.touch1||h.touch0[2]===l[2]||(h.touch1=l,h.taps=0):(h.touch0=l,o=!0,h.taps=1+!!e);e&&(e=clearTimeout(e)),o&&(h.taps<2&&(t=l[0],e=setTimeout((function(){e=null}),f)),pS(this),h.start())}}function O(e,...t){if(this.__zooming){var n,r,i,s,a=x(this,t).event(e),l=e.changedTouches,u=l.length;for(kO(e),n=0;n<u;++n)i=oC(r=l[n],this),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=i);if(r=a.that.__zoom,a.touch1){var h=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],m=(m=f[0]-h[0])*m+(m=f[1]-h[1])*m,g=(g=p[0]-d[0])*g+(g=p[1]-d[1])*g;r=y(r,Math.sqrt(m/g)),i=[(h[0]+f[0])/2,(h[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(v(r,i,s),a.extent,c))}}function P(e,...r){if(this.__zooming){var i,o,s=x(this,r).event(e),a=e.changedTouches,l=a.length;for(AO(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),f),i=0;i<l;++i)o=a[i],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=oC(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<m)){var c=iC(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return g.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property("__zoom",LO),e!==i?w(e,t,n,r):i.interrupt().each((function(){x(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},g.scaleBy=function(e,t,n,r){g.scaleTo(e,(function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)}),n,r)},g.scaleTo=function(e,t,n,r){g.transform(e,(function(){var e=i.apply(this,arguments),r=this.__zoom,s=null==n?b(e):"function"==typeof n?n.apply(this,arguments):n,a=r.invert(s),l="function"==typeof t?t.apply(this,arguments):t;return o(v(y(r,l),s,a),e,c)}),n,r)},g.translateBy=function(e,t,n,r){g.transform(e,(function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},g.translateTo=function(e,t,n,r,s){g.transform(e,(function(){var e=i.apply(this,arguments),s=this.__zoom,a=null==r?b(e):"function"==typeof r?r.apply(this,arguments):r;return o(PO.translate(a[0],a[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)}),r,s)},E.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=iC(this.that).datum();d.call(e,this.that,new TO(e,{sourceEvent:this.sourceEvent,target:g,type:e,transform:this.that.__zoom,dispatch:d}),t)}},g.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:CO(+e),g):s},g.filter=function(e){return arguments.length?(r="function"==typeof e?e:CO(!!e),g):r},g.touchable=function(e){return arguments.length?(a="function"==typeof e?e:CO(!!e),g):a},g.extent=function(e){return arguments.length?(i="function"==typeof e?e:CO([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):i},g.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],g):[l[0],l[1]]},g.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(e){return arguments.length?(o=e,g):o},g.duration=function(e){return arguments.length?(u=+e,g):u},g.interpolate=function(e){return arguments.length?(h=e,g):h},g.on=function(){var e=d.on.apply(d,arguments);return e===d?g:e},g.clickDistance=function(e){return arguments.length?(p=(e=+e)*e,g):Math.sqrt(p)},g.tapDistance=function(e){return arguments.length?(m=+e,g):m},g}().on("zoom",(function(e){u.attr("transform",e.transform)}));d(a),n.on("tick",(function(){e.attr("transform",(function(e){var{x:t,y:n}=e;return"translate("+t+","+n+")"}));var t=wO(xO).source((e=>{var t=e.source.x<e.target.x;return{x:e.source.x+(t?.5:-.5)*e.source.width,y:e.source.y+25+Jk(e.sourceColIndex,e.source.height)}})).target((e=>{var t=e.source.x<e.target.x;return{x:e.target.x-(t?.5:-.5)*e.target.width,y:e.target.y+30+Jk(e.targetColIndex,e.target.height)}})).x((e=>e.x)).y((e=>e.y));wO(EO).x((e=>e.x)).y((e=>e.y)),p.attr("d",(e=>t(e)))})),n.on("end",(()=>{d.scaleTo(a,.5)}));var{nodes:f}=i}(g)}({svgNode:this.svgRef,data:{nodes:r,links:i},onClickNode:this.props.onClickTable})}))}onMount(){var e=this;return Gk((function*(){var{db:t}=e.props;if(!e.loaded){e.loaded=!0;var n={nodes:[],links:[]},r={};yield Promise.all(Object.keys(t).map(function(){var e=Gk((function*(e){if("getColumns"in t[e]){var n=yield t[e].getColumns();n.length&&(r[e]=n)}}));return function(){return e.apply(this,arguments)}}()));var i=Object.keys(r);i.map((e=>{var t={id:e,header:{label:e,color:"black"},text:r[e].map((e=>({color:"gray",label:"".concat(e.name," ").concat(e.udt_name.toUpperCase())}))),height:0,width:0,hasLinks:!1,cluster:0};t.height=Math.max(80,Jk(t.text.length+1,0)),t.width=Math.min(400,10+10*Math.max(t.header.label.length,...t.text.map((e=>e.label.length)))),n.nodes.push(t)})),i.map((e=>{r[e].filter((e=>{var t;return i.includes(null===(t=e.references)||void 0===t?void 0:t.ftable)})).map((t=>{var i=t.references.ftable,o=t.references.fcols[0];n.links.find((t=>[t.source,t.target].sort()===[e,i].sort()))||n.links.push({color:"blue",id:[i,e].sort().join(),source:i,target:e,sourceNode:n.nodes.find((e=>e.id===i)),targetNode:n.nodes.find((t=>t.id===e)),text:{label:t.name,color:"black"},sourceColIndex:r[i].findIndex((e=>e.name===o)),targetColIndex:r[e].findIndex((e=>e.name===t.name)),sourceCol:o,targetCol:t.name})}))})),n.nodes.forEach((e=>{n.links.filter((t=>[t.source,t.target].includes(e.id))).length&&(e.hasLinks=!0,e.cluster=1)})),e.svgRef.setAttribute("width",e.svgRef.clientWidth+""),e.svgRef.setAttribute("height",e.svgRef.clientHeight+""),e.setState(n,(()=>{e.setChart()}))}}))()}render(){return e.createElement("div",{className:"flex-col f-1",style:{minWidth:"80vw",minHeight:"80vh"}},e.createElement(eN,{value:this.state.displayMode,label:"Display",fullOptions:Kk,style:{top:"10px",left:"10px",position:"absolute"},onChange:e=>{this.setState({displayMode:e})}}),e.createElement("svg",{className:"f-1",style:{width:"100%",height:"100%"},ref:e=>{e&&(this.svgRef=e)}},e.createElement("g",{className:"everything pointer"},e.createElement("g",{className:"nodes"}),e.createElement("g",{className:"links"}))))}}function Jk(e,t){return(e?16:8)+20*e-t/2}function Qk(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function eM(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Qk(a,r,i,o,s,"next",e)}function s(e){Qk(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function tM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nM extends We{constructor(){var e;super(...arguments),e=this,tM(this,"state",{loading:!0,showSearchAll:null,showImportFile:!1,showSchemaDiagram:!1,queries:[],showSettings:!1}),tM(this,"d",{}),tM(this,"fileSelected",function(){var t=eM((function*(t){var n=t.target.files[0];n&&e.props.loadTable({sql:yield Ak(n),type:"sql"})}));return function(){return t.apply(this,arguments)}}()),tM(this,"onkeyDown",(e=>{var t,n,r=null===(t=window.getSelection())||void 0===t||null===(n=t.toString())||void 0===n?void 0:n.trim();"o"===e.key&&e.ctrlKey?(e.preventDefault(),this.inptRef&&this.inptRef.click(),console.log(this.inptRef)):"p"===e.key&&e.ctrlKey?(e.preventDefault(),this.setState({showSearchAll:{mode:"views and queries",term:r}})):"k"===e.key&&e.ctrlKey?(e.preventDefault(),this.setState({showSearchAll:{mode:"commands",term:r}})):"F"===e.key&&e.shiftKey&&e.ctrlKey?(e.preventDefault(),this.setState({showSearchAll:{mode:"rows",term:r}})):"Escape"===e.key&&this.setState({showSearchAll:null,showImportFile:!1})})),tM(this,"onDelta",function(){var t=eM((function*(){var{dbs:t,workspace:n}=e.props;if(n&&!e.windowsSync){var r,i=null!=n&&null!==(r=n.options)&&void 0!==r&&r.showAllMyQueries?{}:{workspace_id:n.id};e.windowsSync=yield t.windows.sync(i,{handlesOnData:!0,select:"*",patchText:!1},(t=>{if(e.mounted){var n=t.sort(((e,t)=>+e.last_updated-+t.last_updated)).filter((e=>"sql"===e.type&&!e.deleted));e.setState({queries:n})}}))}}));return function(){return t.apply(this,arguments)}}())}onMount(){window.addEventListener("keydown",this.onkeyDown,!0)}onUnmount(){window.removeEventListener("keydown",this.onkeyDown,!0)}render(){var t,{showSchemaDiagram:n,showSearchAll:r,showImportFile:i,queries:o,showSettings:s}=this.state,{searchAll:a,db:l,tables:c,loadTable:u,anchorEl:h,workspace:d}=this.props,f=o.filter((e=>e.closed));if(n)t=e.createElement(pt,{open:!0,title:"Schema diagram",positioning:"top-center",onClose:()=>this.setState({showSchemaDiagram:!1})},e.createElement(Zk,{db:l,onClickTable:e=>{u({type:"table",table:e,name:e}),this.setState({showSchemaDiagram:!1})}}));else if(s){var p,m;t=e.createElement(pt,{open:!0,positioning:"top-center",onClose:()=>this.setState({showSettings:!1}),title:"Workspace settings"},e.createElement(it,{label:"Hide all counts",checked:!(null===(p=d.options)||void 0===p||!p.hideCounts),onChange:e=>{d.$update({options:{hideCounts:e.target.checked}},{deepMerge:!0})}}),e.createElement("p",{className:"text-gray-600"},"This will disable counts for left menu and table headers. Usefull when there is a performance downgrade"),e.createElement(it,{label:"Show all my queries",className:"mt-2",checked:!(null===(m=d.options)||void 0===m||!m.showAllMyQueries),onChange:e=>{d.$update({options:{showAllMyQueries:e.target.checked}},{deepMerge:!0}),setTimeout((()=>{window.location.reload()}),500)}}),e.createElement("p",{className:"text-gray-600 ta-left"},"Will allow using queries from all your connections and not just the current one. Requires a page refresh"))}return window.innerHeight,e.createElement(e.Fragment,null,t,r?e.createElement(mi,{db:l,tables:c,searchType:r.mode,defaultTerm:r.term,suggestions:a,queries:o,anchorEl:h,loadTable:u,onOpenDBObject:e=>{if("function"===e.type)u({type:"sql",sql:e.definition,name:e.subLabel||e.label});else{if("table"!==e.type)throw e;l[e.label]?u({type:"table",table:e.label,name:e.label}):u({type:"sql",sql:"SELECT *\nFROM ".concat(e.escapedIdentifier,"\nLIMIT 25"),name:e.label})}},onOpen:e=>{var{filter:t,table:n}=e;u({type:"table",table:n,filter:t})},onClose:()=>{this.setState({showSearchAll:void 0})}}):null,i?e.createElement(Fk,{tables:c,db:l,onClose:()=>{this.setState({showImportFile:!1})},openTable:e=>{u({type:"table",table:e})}}):null,e.createElement("input",{ref:e=>{e&&(this.inptRef=e)},type:"file",accept:"text/*, .sql, .txt",className:"hidden",onChange:this.fileSelected}),e.createElement(Tt,{title:" ",rootStyle:{top:0,left:0,maxHeight:"100%"},positioning:"as-is",button:e.createElement(et,{title:"Menu",style:{border:"1px solid #00d0ff",background:"rgb(240 254 255)",borderRadius:"4px",padding:"2px",marginBottom:"4px"},"data-command":"menu"},e.createElement("img",{src:"/prostgles-logo.svg"})),contentStyle:{overflow:"hidden",padding:0},render:t=>e.createElement("div",{className:"flex-col f-1 min-h-0 "+(window.isMobileDevice?" p-p25 ":" p-1  "),onKeyDown:e=>{"Escape"===e.key&&t()}},e.createElement("div",{className:"flex-row f-0"},l&&l.sql?e.createElement(et,{key:"sql",style:{marginLeft:"6px"},onClick:()=>{u({type:"sql",name:"SQL Query"}),t()},"data-command":"sql-editor",variant:"outline",iconPath:"M8,3A2,2 0 0,0 6,5V9A2,2 0 0,1 4,11H3V13H4A2,2 0 0,1 6,15V19A2,2 0 0,0 8,21H10V19H8V14A2,2 0 0,0 6,12A2,2 0 0,0 8,10V5H10V3M16,3A2,2 0 0,1 18,5V9A2,2 0 0,0 20,11H21V13H20A2,2 0 0,0 18,15V19A2,2 0 0,1 16,21H14V19H16V14A2,2 0 0,1 18,12A2,2 0 0,1 16,10V5H14V3H16Z"},"SQL Editor"):null,e.createElement(et,{iconPath:"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,4.5L8.95,4.53C8.71,5.05 8.34,5.93 8.07,7H10.93C10.66,5.93 10.29,5.05 10.05,4.53C9.87,4.5 9.69,4.5 9.5,4.5M13.83,7C13.24,5.97 12.29,5.17 11.15,4.78C11.39,5.31 11.7,6.08 11.93,7H13.83M5.17,7H7.07C7.3,6.08 7.61,5.31 7.85,4.78C6.71,5.17 5.76,5.97 5.17,7M4.5,9.5C4.5,10 4.58,10.53 4.73,11H6.87L6.75,9.5L6.87,8H4.73C4.58,8.47 4.5,9 4.5,9.5M14.27,11C14.42,10.53 14.5,10 14.5,9.5C14.5,9 14.42,8.47 14.27,8H12.13C12.21,8.5 12.25,9 12.25,9.5C12.25,10 12.21,10.5 12.13,11H14.27M7.87,8L7.75,9.5L7.87,11H11.13C11.21,10.5 11.25,10 11.25,9.5C11.25,9 11.21,8.5 11.13,8H7.87M9.5,14.5C9.68,14.5 9.86,14.5 10.03,14.47C10.28,13.95 10.66,13.07 10.93,12H8.07C8.34,13.07 8.72,13.95 8.97,14.47L9.5,14.5M13.83,12H11.93C11.7,12.92 11.39,13.69 11.15,14.22C12.29,13.83 13.24,13.03 13.83,12M5.17,12C5.76,13.03 6.71,13.83 7.85,14.22C7.61,13.69 7.3,12.92 7.07,12H5.17Z",title:"Show quick search menu",className:"ml-auto",onClick:()=>{this.setState({showSearchAll:{mode:"views and queries",term:void 0}}),t()}}),e.createElement(et,{iconPath:se,title:"Show settings",className:"ml-p25",onClick:()=>{this.setState({showSettings:!0}),t()}})),f.length?e.createElement(_t,{id:"search-list-queries",className:" mt-p5 ",style:{minHeight:"120px",maxHeight:"30vh"},placeholder:"Queries",items:f.sort(((e,t)=>+t.last_updated-+e.last_updated)).map(((n,r)=>({key:r,contentLeft:e.createElement("div",{className:"flex-col ai-start f-0 mr-p5 text-gray-500"},e.createElement(Ae(),{path:xe,size:1})),label:n.name,contentRight:e.createElement("span",{className:"text-gray-400 ml-auto italic"},n.sql.slice(0,10),"..."),onPress:()=>{n.$update({closed:!1}),t()}})))}):null,c.length?e.createElement(_t,{limit:100,id:"search-list-tables",className:" mt-p5 ",style:{minHeight:"120px",height:"50%"},placeholder:"Tables and views",items:c.sort(((e,t)=>{var n;return null!=d&&null!==(n=d.options)&&void 0!==n&&n.hideCounts?e.name.localeCompare(t.name):+t.count-+e.count})).map((n=>{var r;return{contentLeft:e.createElement("div",{className:"flex-col ai-start f-0 mr-p5 text-gray-500"},e.createElement(Ae(),{path:null!=l&&null!==(r=l[n.name])&&void 0!==r&&r.insert?Se:_e,size:1})),key:n.name,label:n.name,contentRight:0<n.count?e.createElement("span",{className:"text-gray-400 ml-auto"},Fo(+n.count)):null,onPress:()=>{u({type:"table",table:n.name}),t()}}}))}):e.createElement("div",{className:"text-gray-500 p-1"},"0 tables/views"),e.createElement("div",{className:"flex-row-wrap f-0 m-p5"},e.createElement(et,{iconPath:we,className:"fit",size:"small",title:"Import data from file","data-command":"import-data",variant:"outline",onClick:()=>{this.setState({showImportFile:!0}),t()}},"Import data"),e.createElement(et,{iconPath:"M22 13V19H21L19 17H11V9H5L3 11H2V5H3L5 7H13V15H19L21 13Z",className:"fit ml-2",size:"small",style:{opacity:.05},title:"Show schema diagram","data-command":"schema-diagram",variant:"outline",onClick:()=>{this.setState({showSchemaDiagram:!0}),t()}},"Schema diagram")))}))}}function rM(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function iM(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){rM(a,r,i,o,s,"next",e)}function s(e){rM(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function oM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sM(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?oM(Object(t),!0).forEach((function(n){aM(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oM(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function aM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lM={c1:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"css",n=[0,129,167,"css"===t?e:Math.round(255*e)];return"deck"===t?n:"rgba(".concat(n.join(", "),")")}},c2:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"css",n=[240,113,103,"css"===t?e:Math.round(255*e)];return"deck"===t?n:"rgba(".concat(n.join(", "),")")}},c3:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"css",n=[58,134,255,"css"===t?e:Math.round(255*e)];return"deck"===t?n:"rgba(".concat(n.join(", "),")")}},c4:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"css",n=[131,56,236,"css"===t?e:Math.round(255*e)];return"deck"===t?n:"rgba(".concat(n.join(", "),")")}},c5:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"css",n=[203,149,0,"css"===t?e:Math.round(255*e)];return"deck"===t?n:"rgba(".concat(n.join(", "),")")}}};function cM(e){return{i:e,x:1,y:0,w:4,h:2}}var uM=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:15;try{navigator.vibrate(e)}catch(e){console.error(e)}};class hM extends We{constructor(){var e;super(...arguments),e=this,aM(this,"state",{tables:void 0,suggestions:void 0,searchAll:void 0,loading:!0,minimised:!1,namePopupWindow:null,imported:0}),aM(this,"d",{closedWindows:[],allWindows:[],windows:[],windowsSync:void 0,workspace:null,workspaceSync:null,links:[],linksSync:null}),aM(this,"getTableChain",((e,t)=>{var n=this.getLinkChain(e,t);if(n){var{windows:r}=this.d,i=n.map((e=>{var t=r.find((t=>t.id===e));return ke(t,"table_name")}));if(!i.find((e=>!e)))return i}})),aM(this,"loadingSuggestions",!1),aM(this,"loadingTables",!1),aM(this,"syncsSet",!1),aM(this,"onDelta",function(){var t=iM((function*(t,n,r){var i=sM(sM(sM({},t),n),r),{db:o,dbs:s,workspaceName:a="none"}=e.props,{windows:l,workspace:c,windowsSync:u,workspaceSync:h}=e.d,{tables:d}=e.state,f={};if(o&&s&&!e.syncsSet){e.syncsSet=!0,+(yield s.workspaces.count({name:a}))||(yield s.workspaces.insert({name:a,options:{hideCounts:!0}},{returning:"*"}));var p=yield s.workspaces.findOne({name:a}),m=yield s.workspaces.syncOne({id:p.id},{handlesOnData:!0},((t,n)=>{e.mounted&&e.setData({workspace:t},{workspace:n})})),g=yield s.links.sync({workspace_id:p.id},{handlesOnData:!0},((t,n)=>{e.mounted&&e.setData({links:t},{links:n})})),y=yield s.windows.sync({workspace_id:p.id},{handlesOnData:!0,select:"*",patchText:!1},((t,n)=>{if(e.mounted){var r=t.sort(((e,t)=>+e.last_updated-+t.last_updated)),i=r.filter((e=>e.closed&&!e.table_name&&e.name)),o=r.filter((e=>!e.closed));e.d.windows&&e.d.windows.map((e=>"".concat(e.id," ").concat(e.type," ").concat(e.fullscreen))).sort().join()===o.map((e=>"".concat(e.id," ").concat(e.type," ").concat(e.fullscreen))).sort().join()||e.setData({allWindows:r,windows:o,closedWindows:i},{windows:n})}}));e.setData({windowsSync:y,workspaceSync:m,linksSync:g},{windowsSync:y,workspaceSync:m,linksSync:g})}if(o&&c&&(i.workspace&&"hideCounts"in i.workspace||i.db||i.imported||!d)){var v,b,w=Object.keys(o).filter((e=>o[e].find));if(yield Promise.all(w.map(function(){var e=iM((function*(e){try{var t,n,r;return{name:e,info:yield o[e].getInfo(),columns:(yield null===(t=(n=o[e]).getColumns)||void 0===t?void 0:t.call(n))||[],count:null!=c&&null!==(r=c.options)&&void 0!==r&&r.hideCounts?"":yield o[e].count()}}catch(e){return void console.error(e)}}));return function(){return e.apply(this,arguments)}}())).then((e=>{var t=e.filter((e=>e));f={tables:t.map((e=>sM(sM({},e),{},{joins:jo.getJoinedTables(t,e.name)}))),loading:!1}})),!e.loadingSuggestions&&null!=o&&o.sql&&(null===(v=e.state)||void 0===v||!v.suggestions||i.db)){try{e.loadingSuggestions=!0,b=yield function(){return Xo.apply(this,arguments)}(o)}catch(e){console.error("Issue with getSuggestions:",e)}e.loadingSuggestions=!1,f.suggestions=b,f.searchAll=b.suggestions.filter((e=>["table","function"].includes(e.type)))}}r&&["windows","workspace","links"].map((e=>{r[e]&&(f[e]=sM({},r[e]))})),dM(f)||e.setState(f)}));return function(){return t.apply(this,arguments)}}()),aM(this,"loadTable",function(){var t=iM((function*(t){var{db:n,dbs:r}=e.props,{workspace:i}=e.d,{type:o,table:s=null,fullscreen:a=!0,filter:l=null,sql:c="",name:u}=t,h=null;if(s&&n){if(!n[s]||!n[s].find){var d="Table not found";throw alert(d),d}"getInfo"in n[s]&&(h=(yield n[s].getInfo()).oid)}return(yield r.windows.insert({sql:c,filter:l,options:{hideTable:!0},type:o,table_name:s,table_oid:h,name:u,layout:cM("111"),fullscreen:!1,workspace_id:i.id},{returning:"*"})).id}));return function(){return t.apply(this,arguments)}}())}onUnmount(){var{workspaceSync:e,windowsSync:t,linksSync:n}=this.d;[e,t,n].map((e=>{e&&e.unsync&&e.unsync()}))}getLinkChain(e,t){var{links:n}=this.d,r=((e,t,n)=>{var r={};r[n]="Infinity",r=Object.assign(r,e[t]);var i={endNode:null};for(var o in e[t])i[o]=t;for(var s=[],a=fP(r,s);a;){var l=r[a],c=e[a];for(var u in c)if(u+""!=t+""){var h=l+c[u];(!r[u]||r[u]>h)&&(r[u]=h,i[u]=a)}s.push(a),a=fP(r,s)}for(var d=[n],f=i[n];f;)d.push(f),f=i[f];return d.reverse(),{distance:r[n],path:d}})((e=>{var t={};return e.map((e=>{var[n,r]=e;t[n]=t[n]||{},t[n][r]=1,t[r]=t[r]||{},t[r][n]=1})),t})(n.map((e=>[e.w1_id,e.w2_id]))),e,t);return r.distance<1/0?r.path:void 0}getLinksAndWindows(){var{links:e,windows:t}=this.d,n=t.filter((e=>!e.deleted&&!e.closed));return{links:e.filter((e=>[e.w1_id,e.w2_id].every((e=>n.some((t=>t.id===e)))))),windows:n}}render(){var t=this,{db:n,dbs:r,dbMethods:i}=this.props,{tables:o=[],loading:s,namePopupWindow:a,suggestions:l,searchAll:c=[],linkMenuWindow:u}=this.state,{links:h,windows:d,closedWindows:f,windowsSync:p,workspace:m}=this.d,{links:g,windows:y}=this.getLinksAndWindows();if(!p||!m)return e.createElement(Xe,{className:"mt-4 mx-auto"});var v,b=a?y.find((e=>e.id===a.id)):null,w=e=>{var t,i,o,s,a,l,c,{links:u,windows:h}=this.getLinksAndWindows(),{w1_id:d,w2_id:f,linkOpts:p}=e,{geomColumn:g,dateColumn:y,fromSelected:v,tablePath:b,sql:w}=p,x=u.filter((e=>h.find((t=>[e.w1_id,e.w2_id].includes(t.id))))),E=function(e){return e.reduce(((e,t)=>sM(sM({},e),{},{[t]:(e[t]||0)+1})),{})}([...Object.keys(lM).sort((()=>.5-Math.random())),...x.map((e=>ke(e,"options.colorKey"))).filter((e=>e))]),_=Object.keys(E).pop(),S=u.filter((e=>[e.w1_id,e.w2_id].find((e=>[d,f].includes(e))))),C=S.find((e=>ke(e,"options.color")));C&&(a={color:null==C||null===(l=C.options)||void 0===l?void 0:l.color,colorKey:null==C||null===(c=C.options)||void 0===c?void 0:c.colorKey});var T={colorKey:null!==(t=null===(i=a)||void 0===i?void 0:i.colorKey)&&void 0!==t?t:_,color:null!==(o=null===(s=a)||void 0===s?void 0:s.color)&&void 0!==o?o:lM[_].get(),tablePath:b,sql:w};if(g&&(T=sM(sM({},T),{},{geomColumn:g})),y&&(T=sM(sM({},T),{},{dateColumn:y,fromSelected:v})),!m||!n)throw"no workspace or db";return r.links.insert({w1_id:d,w2_id:f,workspace_id:m.id,options:T},{returning:"*"})},x=function(){var e=iM((function*(e,n,r){var i=yield t.loadTable({type:"table",table:n,fullscreen:!1});yield w({w1_id:e.id,w2_id:i,linkOpts:{tablePath:r}}),e.fullscreen&&e.$update({fullscreen:!1})}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=iM((function*(e,t){var{type:n,name:i,linkOpts:o}=e,s={};"map"===n&&(s={options:{tileAttribution:{title:" OpenStreetMap",url:"https://www.openstreetmap.org/"}}});var a=yield(e=>{var{type:t,table_name:n,options:i={},name:o}=e;return r.windows.insert({name:o,type:t,table_name:n,options:i,layout:cM("111"),fullscreen:!1,workspace_id:m.id},{returning:"*"})})(sM({name:i,type:n},s));w({w1_id:t.id,w2_id:a.id,linkOpts:o})}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=iM((function*(e,n,r){var i,s;if(!e||!n||t.state.active_row&&(null===(i=t.state.active_row)||void 0===i?void 0:i.window_id)!==r)t.state.active_row&&t.setState({active_row:null});else{var a={},l=null===(s=o.find((e=>e.name===n)))||void 0===s?void 0:s.columns,c=l.filter((e=>e.is_pkey));c.length&&c.every((t=>t.name in e))?c.map((t=>{a[t.name]=e[t.name]})):"$rowhash"in e?a.$rowhash=e.$rowhash:l.map((t=>{("number"===t.tsDataType||"string"===t.tsDataType||t.is_pkey)&&(a[t.name]=e[t.name])}));var u=g.filter((e=>[e.w1_id,e.w2_id].includes(r)&&y.filter((e=>e.id!==r)).find((t=>[e.w1_id,e.w2_id].includes(t.id))))),h=e&&u.length?{window_id:r,table_name:n,row_filter:a}:null;e&&h&&!dM(t.state.active_row)&&t.state.active_row.window_id===h.window_id&&zo(t.state.active_row.row_filter,h.row_filter)&&(h=null),t.state.active_row!==h&&t.setState({active_row:h})}}));return function(){return e.apply(this,arguments)}}(),S=y.map((i=>{var s=function(){var e=iM((function*(){var e,n,o,s;null!==(e=i=i.$get())&&void 0!==e&&e.$get||console.error(t.d.windows),t.setState({active_row:void 0}),"sql"===i.type&&null!==(n=i.options)&&void 0!==n&&n.sqlWasSaved?yield i.$update({closed:!0}):null===(o=i.sql)||void 0===o||!o.trim().length||"sql"!==i.type||null!==(s=i.options)&&void 0!==s&&s.sqlWasSaved?(yield i.$update({closed:!0,deleted:!0}),yield r.links.update({$or:[{w1_id:i.id},{w2_id:i.id}]},{closed:!0,deleted:!0})):ai.some((e=>e.sql.trim()===i.sql.trim()))?yield i.$update({closed:!0,deleted:!0}):t.setState({namePopupWindow:i})}));return function(){return e.apply(this,arguments)}}(),a=i.id+i.fullscreen,c=null,u=null;if("sql"===i.type)c=e.createElement(bk,{key:a,"data-key":i.id,db:n,dbs:r,w:i,tables:o,titleIcon:u,suggestions:l,onAddChart:e=>E(e,i),onClose:s,setLinkMenu:e=>this.setState({linkMenuWindow:e})});else if("card"===i.type)c=e.createElement(GP,{id:i.id,key:a,"data-key":i.id,db:n,dbs:r,w:i,tables:o,table:o.find((e=>e.name===i.table_name)),titleIcon:u,onClose:s});else{var h,{links:d,windows:f}=this.getLinksAndWindows(),p=d.filter((e=>[e.w1_id,e.w2_id].includes(i.id))),g=p.find((e=>ke(e,"options.color")));if(g){var y=lM[g.options.colorKey];y&&(h=y)}if("map"===i.type){var v=[];d&&(v=p.map((e=>{var t=f.find((t=>t.id!==i.id&&[e.w1_id,e.w2_id].includes(t.id)));if(!("geomColumn"in e.options)||!e.options.geomColumn)throw"geomColumn missing from link";if(null!=t&&t.table_name){var n,{active_row:r}=this.state;(null==r?void 0:r.window_id)!==i.id&&(n=IP(t,t.table_name,r,d,f),t.id===(null==r?void 0:r.window_id)&&(n=sM({},r.row_filter)));var o=lM[e.options.colorKey];return sM(sM({wid:t.id,tableName:t.table_name,geomColumn:e.options.geomColumn,filter:ki(t.filter||[])},e.options),{},{joinFilter:n,fillColor:o.get(1,"deck"),lineColor:o.get(1,"deck"),color:o.get(1,"css"),sourceW:t})}if("sql"===(null==t?void 0:t.type)){var s=lM.c5,a=sM(sM({wid:t.id,geomColumn:e.options.geomColumn},e.options),{},{sql:e.options.sql,fillColor:s.get(1,"deck"),lineColor:s.get(1,"deck"),color:s.get(1,"css"),sourceW:t});return a.sql?a:null}console.error("Why tbl is missing?")})).filter((e=>e)));var{active_row:b}=this.state;c=e.createElement(dP,{key:a,"data-key":i.id,id:i.id,activeRow:b,db:n,dbs:r,w:i,tables:o,titleIcon:u,onClose:s,layerQueries:v,onClickRow:(e,t)=>_(e,t,i.id)})}else if("timechart"===i.type){var w=[];d&&(w=p.map((e=>{var n=f.find((t=>t.id!==i.id&&[e.w1_id,e.w2_id].includes(t.id)));if(n){var r,o=function(e){var n,r=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],{active_row:i}=t.state;if(i){var o=i.row_filter;r&&i.window_id===e&&(n={tablePath:[i.table_name],filter:o});var s=t.getTableChain(e,i.window_id);s&&(n={tablePath:s.slice(1),filter:o})}return n}(i.id),{active_row:s}=this.state;(null==s?void 0:s.window_id)!==i.id&&(r=IP(n,n.table_name,s,d,f),n.id===(null==s?void 0:s.window_id)&&(r=sM({},s.row_filter)));var a=lM[e.options.colorKey]||lM.c1;return sM(sM({sql:e.options.fromSelected?n.selected_sql:n.sql,tableName:n.table_name},e.options),{},{updateOptions:t=>e.$update({options:sM(sM({},e.options),t)}),activeRowFilter:o,joinFilter:r,color:a.get(1,"css")})}console.log("Why tbl is missing?")})).filter((e=>e))),c=e.createElement(xP,{key:a,"data-key":i.id,id:i.id,w:i,db:n,dbs:r,titleIcon:u,onClose:s,layerQueries:w})}else if("table"===i.type){var{active_row:S}=this.state,C=IP(i,i.table_name,S,d,f);c=e.createElement(jo,{key:a,"data-key":i.id,workspace:m,setLinkMenu:e=>this.setState({linkMenuWindow:e}),w:i,tables:o,db:n,dbs:r,titleIcon:u,activeRowStyle:h?{background:h.get(.2)}:{},activeRow:(null==S?void 0:S.window_id)===i.id?S:void 0,onClose:s,onAddChart:e=>E(e,i),onLinkTable:function(){var e=iM((function*(e,t){x(i,e,t)}));return function(){return e.apply(this,arguments)}}(),joinFilter:C,onClickRow:e=>_(e,i.table_name,i.id)})}}return{id:i.id,title:i.name||i.table_name||i.id,linkIcon:u,onClose:s,q:i,elem:c}}));return b&&(v={title:"Save query?",onClose:()=>this.setState({namePopupWindow:null}),content:e.createElement("div",{className:"flex-col"},e.createElement(aN,{type:"text",asColumn:!0,label:"Name",defaultValue:b.name,required:!0,onChange:e=>{b.$update({name:e,options:sM(sM({},b.options||{}),{},{sqlWasSaved:!0})})}}),e.createElement("div",{className:"flex-row w-full mt-2"},e.createElement(et,{className:"mr-2",variant:"outline",color:"danger",size:"large",onClick:iM((function*(){b.$update({closed:!0}),t.setState({namePopupWindow:null})}))},"Delete and close"),e.createElement(et,{variant:"outline",color:"action",size:"large",onClick:()=>{b.name?b.$update({closed:!0,deleted:!1,options:sM(sM({},b.options||{}),{},{sqlWasSaved:!0})}):alert("Cannot have an empty name"),setTimeout((()=>{this.setState({namePopupWindow:null})}),500)}},"Save and close")))}),e.createElement("div",{ref:e=>{e&&(this.rootRef=e)},className:"flex-col f-1 min-w-0 min-h-0 w-full "+(window.isMobileDevice?" p-p25 ":" p-p5 "),style:{maxWidth:"100vw"}},e.createElement(nM,{db:n,dbs:r,searchAll:c,loadTable:this.loadTable,tables:o,workspace:m,anchorEl:this.gridRef||this.rootRef}),v&&e.createElement(pt,{open:!0,onClose:v.onClose,title:v.title,anchorEl:v.anchorEl,clickCatchStyle:v.clickCatchStyle},v.content),e.createElement("div",{className:"min-h-0 f-1 flex-row relative",ref:e=>{e&&(this.gridWrapperRef=e)}},u&&e.createElement(UP,{w:u.w,tables:o,links:g,windows:y,anchorEl:u.anchorEl,db:n,dbs:r,onClose:()=>this.setState({linkMenuWindow:void 0}),gridRef:this.gridWrapperRef,onLinkTable:(e,t)=>x(u.w,e,t)}),e.createElement(PP,{_ref:e=>{e&&(this.gridRef=e)},className:"min-h-0 relative",layout:m.layout,onChange:e=>{JSON.stringify(e)!==JSON.stringify(m.layout)&&m.$update({layout:e})},onClose:function(){var e=iM((function*(e){var t=S.find((t=>t.id===e));return t&&(yield t.onClose()),1}));return function(){return e.apply(this,arguments)}}()},S.map((e=>e.elem)))),s?e.createElement(Xe,{className:"p-2"}):null)}}function dM(e){for(var t in e)return!1;return!0}function fM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pM(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?fM(Object(t),!0).forEach((function(n){mM(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fM(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function mM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gM=1e3,yM=60*gM,vM=60*yM,bM=24*vM,wM=30*bM,xM=365*bM;function EM(e,t,n){var r=window.devicePixelRatio,i=Math.max(30,t),o=Math.max(30,n);return e.width=i*r,e.height=o*r,e.style.width=i+"px",e.style.height=o+"px",1<r&&e.getContext("2d").scale(r,r),e}var _M={},SM=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date,t=1<arguments.length?arguments[1]:void 0,n=JSON.stringify({d:Math.round(+e),opts:t});return _M[n]||(_M[n]=e.toLocaleString(navigator.language,t)),_M[n]},CM={second:"2-digit",hour:"2-digit",minute:"2-digit"};class TM extends We{constructor(){super(...arguments),mM(this,"d",{}),mM(this,"getMargins",(()=>{var{w:e,h:t}=this.chart.getWH();return{xMin:50,xMax:e-10,yMin:60,yMax:t-50,xForYLabels:6}})),mM(this,"parseData",(()=>{var{w:e,h:t}=this.chart.getWH(),{layers:n,xExtent:r}=this.props,i=null,o=null,s=null,a=null;r&&(i=+r[0],o=+r[1]);var l=[],{xMin:c,xMax:u,yMin:h,yMax:d,xForYLabels:f}=this.getMargins(),p=n.map((e=>{var t=e.data.map((e=>{var t=+new Date(e.date),n=+e.value;return pM(pM({},e),{},{date:t,value:n,x:0,y:0})})).sort(((e,t)=>+e.date-+t.date));return e._data=t,t.length&&t.map((e=>{null===s&&(!r&&(i=e.date,o=e.date),s=e.value,a=e.value),r||(i=Math.min(i,e.date),o=Math.max(o,e.date)),s=Math.min(s,e.value),a=Math.max(a,e.value)})),e})),m=Qn().domain([i,o]).range([c,u]).clamp(!0),g=Qn().domain([i,o]).range([f,u]).clamp(!0),y=Qn().domain([a,s]).range([h,d]).clamp(!0);if(p=p.map((e=>(e._data=e._data.map((e=>{var t=m(e.date);return l.find((e=>e.v===e.date))||l.push({x:t,v:e.date,date:new Date(e.date)}),pM(pM({},e),{},{x:t,y:y(e.value)})})),e))),this.chart){var v=(+o-+i)/1e3;this.chart.opts.maxXScale=70/(e/v)}this.data={layers:p,dates:l,xScale:m,yScale:y,xScaleYLabels:g,minDate:i,maxDate:o,minVal:s,maxVal:a}})),mM(this,"mainShapes",[]),mM(this,"tooltipShapes",[]),mM(this,"panning",!1)}onMount(){}getIntersections(e){var t,n=[],[r]=this.chart.getDataXY(e,0);return this.lineLayers.map((i=>{i.coords.find(((o,s)=>{var[a,l]=o,c=!0;if(s<i.coords.length-1){var[u,h]=i.coords[s+1],[d]=this.chart.getScreenXY(a),[f]=this.chart.getScreenXY(u),p=Math.abs(e-d),m=Math.abs(e-f);p<=2?(t=a,n.push(pM(pM({},i),{},{y:l,snapped_data:i.data[s]}))):m<=2?(t=u,n.push(pM(pM({},i),{},{y:h,snapped_data:i.data[s+1]}))):r>=a&&r<u||r>=u&&r<a?n.push(pM(pM({},i),{},{y:l+(r-a)/(u-a)*(h-l)})):c=!1}return c}))})),{layers:n,snapped_x:t}}onDelta(e,t,n){var r=pM(pM(pM({},e),t),n);if(this.ref&&!this.chart){var{onExtentChange:i,chartRef:o}=this.props;this.chart=new OM({node:this.ref,canvas:this.canv,yScaleLocked:!0,yPanLocked:!0,minXScale:1,events:{onExtentChange:e=>{i&&i({leftDate:new Date(this.data.xScale.invert(e.leftX)),rightDate:new Date(this.data.xScale.invert(e.rightX))}),this.setData({extent:e})},onPan:()=>{this.panning=!0},onPanEnd:()=>{this.panning=!1}}}),o&&o(this.chart)}if(this.chart){var s=!1,{w:a,h:l}=this.chart.getWH(),{xMin:c,xMax:u,yMin:h,yMax:d}=this.getMargins();if(r&&r.layers){s=!0,this.mainShapes=[],this.lineLayers=[],this.parseData();var{layers:f}=this.data;f.map((e=>{var{_data:t}=e;if(t.length){var n=t.filter((e=>{var[t,n]=this.chart.getScreenXY(e.x,e.y);return t>=c&&t<=u&&n>=h&&n<=d})).map(((t,n)=>({id:n,type:"circle",coords:[t.x,t.y],fillStyle:e.color,strokeStyle:e.color,lineWidth:0,r:3,data:t}))),r=n.map((e=>e.coords)),i=[{id:1,type:"multiline",strokeStyle:e.color,lineWidth:2,coords:r}];this.lineLayers.push(pM(pM({},e),{},{coords:r}));var o=0;r.map(((e,t)=>{t&&(o+=Math.hypot(e[0]-r[t-1][0],e[1]-r[t-1][1]))}));var s=4>o?n:i;this.mainShapes=this.mainShapes.concat([...s])}}))}if(n||"layers"in r){s=!0;var{xCursor:p,yCursor:m}=this.d;if(!p||this.panning||m>d-14)this.tooltipShapes=[];else{var[g]=this.chart.getDataXY(p,m),{layers:y,snapped_x:v}=this.getIntersections(p);if(!y.length)return[];v&&(g=v);var b=new Date(this.data.xScale.invert(g)),{leftX:w,rightX:x}=this.chart.getExtent(),E=this.data.xScale.invert(x)-this.data.xScale.invert(w),_={id:"2111r",type:"text",fillStyle:"black",textAlign:"center",text:E<gM?SM(b,CM)+"."+b.getMilliseconds():SM(b,E<bM?CM:E<wM?{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short",year:"2-digit"}:{day:"numeric",month:"short",year:"2-digit"}),background:{fillStyle:"white",strokeStyle:"#cecece",lineWidth:1,padding:6,borderRadius:3},coords:[g,l-10]},S=this.chart.measureText(_),{xMin:C,xMax:T}=this.getMargins();p-S.width/2<C+5?_.textAlign="start":p+S.width/2>T-5&&(_.textAlign="end");var O,P,A=p+14,k=y.map((e=>{var t,n;return{id:"2111r"+Date.now(),type:"text",fillStyle:"black",text:e.getYLabel?e.getYLabel({value:+(null!==(t=null===(n=e.snapped_data)||void 0===n?void 0:n.value)&&void 0!==t?t:this.data.yScale.invert(e.y)),min:this.data.yScale.invert(h),max:this.data.yScale.invert(d),prev:this.data.yScale.invert(e.y),next:this.data.yScale.invert(e.y)}):"",textAlign:"left",background:{fillStyle:"white",strokeStyle:e.color,lineWidth:1,padding:6,borderRadius:3},coords:[this.chart.getDataXY(A)[0],e.y+5]}})),M=!1;k.map((e=>{if(void 0===O&&(O=e.coords[1],P=e.coords[1]),O=Math.min(O,e.coords[1]),P=Math.max(P,e.coords[1]),!M){var t=this.chart.measureText(e);M=A+t.width>T-5}return e}));var N=O<l-P,L=k.sort(((e,t)=>N?e.coords[1]-t.coords[1]:t.coords[1]-e.coords[1]));k=[],L.map(((e,t)=>{var n=e.coords[1];if(t){var r=k[t-1].coords[1];n=N?Math.max(n,r+22):Math.min(n,r-22)}k.push(pM(pM({},e),{},{coords:[e.coords[0],n]},M?{coords:[this.chart.getDataXY(A-28)[0],n],textAlign:"end"}:{}))})),this.tooltipShapes=[{id:"21111r",type:"multiline",lineWidth:1,strokeStyle:"#cecece",coords:[[g,0],[g,l-30]]},...y.map((e=>({id:Date.now(),type:"circle",coords:[g,e.y],fillStyle:"white",strokeStyle:"white",lineWidth:0,r:5}))),...y.map((e=>({id:Date.now(),type:"circle",coords:[g,e.y],fillStyle:e.color,strokeStyle:e.color,lineWidth:0,r:3}))),...k,_]}}s&&this.chart.render([...this.mainShapes,()=>{var{xMin:e,xMax:t,xForYLabels:n}=this.getMargins(),[r,i]=this.chart.getDataXY(e,0),[o]=this.chart.getDataXY(n,0),[s,a]=this.chart.getDataXY(t,0);if(this.data){var{minDate:c,maxDate:u,dates:h,xScale:d,yScale:f,xScaleYLabels:p,minVal:m,maxVal:g}=this.data;if(!h.length)return[];d(c)>r&&(r=d(c)),d(u)<s&&(s=d(u));var y=function(e){var{leftDate:t,rightDate:n,getX:r,leftX:i,rightX:o,height:s,measureText:a,getScreenXY:l}=e;if(!t||!n)return[];var c=[],u=function(e,t){var n=+t-+e,r=n/xM,i=n/wM,o=n/bM,s=n/vM,a=n/yM,l=n/gM;return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]?{years:r,months:i,days:o,hours:s,minutes:a,seconds:l}:1<=r?{years:r,months:i}:1<=i?{months:i,days:o}:1<=o?{days:o,hours:s}:1<=s?{hours:s,minutes:a}:{minutes:a,seconds:l}}(+t,+n,!0),h=e=>pM({type:"text",font:"12px Arial",fillStyle:"black",textAlign:"center"},e),d={type:"text",font:"12px Arial",fillStyle:"black",textAlign:"center"};if(Number.isFinite(+t)&&+t==+n){var f=SM(t,{hour:"2-digit",minute:"2-digit",second:"2-digit"}),p=SM(t,{year:"numeric",month:"2-digit",day:"2-digit"});return[pM(pM({},d),{},{font:"16px Arial",id:"t1",text:f,coords:[r(+t),s-28]}),pM(pM({},d),{},{font:"600 14px Arial",id:"t2",text:p,coords:[r(+t),s-10]})]}var m=[{id:"100 Year",getStart:e=>new Date(LM(e.getFullYear(),100,3e3),0,1),dateDelta:100*wM*12,getLabel:e=>SM(e,{year:"numeric"})},{id:"10 Year",getStart:e=>new Date(LM(e.getFullYear(),10,3e3),0,1),dateDelta:10*wM*12,getLabel:e=>SM(e,{year:"numeric"})},{id:"Yearly",getStart:e=>new Date(e.getFullYear(),0,1),dateDelta:12*wM,getLabel:e=>SM(e,{year:"numeric"})},{id:"Quarter Yearly",getStart:e=>new Date(e.getFullYear(),0,1),dateDelta:3*wM,getLabel:e=>SM(e,{month:"short"})},{id:"Monthly",getStart:e=>new Date(e.getFullYear(),e.getMonth(),1),dateDelta:wM,getLabel:e=>SM(e,{month:"short"})},{id:"Weekly",getStart:e=>new Date(e.getFullYear(),e.getMonth(),1),dateDelta:7*bM,getLabel:e=>SM(e,{day:"numeric"})},{id:"Daily",dateDelta:bM,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),getLabel:e=>SM(e,{day:"numeric"})},{id:"Quarter Daily",dateDelta:bM/4,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit"})},{id:"Hourly",dateDelta:vM,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit"})},{id:"Quarter Hourly",dateDelta:vM/4,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit"})},{id:"5 Minute",dateDelta:5*yM,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit"})},{id:"Minute",dateDelta:yM,getStart:e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit"})},{id:"Quarter Minute",dateDelta:yM/4,getStart:e=>((e=new Date(+e)).setSeconds(0),new Date(+e)),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})},{id:"Second",dateDelta:gM,getStart:e=>((e=new Date(+e)).setSeconds(0),new Date(+e)),getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})},{id:"250 Millisecond",dateDelta:gM/4,getStart:e=>{var t=(e=new Date(+e)).getMilliseconds();return e.setMilliseconds(LM(t,250,750)),new Date(+e)},getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+e.toISOString().slice(20,-1)},{id:"100 Millisecond",dateDelta:gM/10,getStart:e=>{var t=(e=new Date(+e)).getMilliseconds();return e.setMilliseconds(LM(t,100,900)),new Date(+e)},getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+e.toISOString().slice(20,-1)},{id:"10 Millisecond",dateDelta:gM/100,getStart:e=>{var t=(e=new Date(+e)).getMilliseconds();return e.setMilliseconds(LM(t,10,900)),new Date(+e)},getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+e.toISOString().slice(20,-1)},{id:"Millisecond",dateDelta:gM/1e3,getStart:e=>{var t=(e=new Date(+e)).getMilliseconds();return e.setMilliseconds(LM(t,1,999)),new Date(+e)},getLabel:e=>SM(e,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+e.toISOString().slice(20,-1)}].map((e=>{var n=e.getStart(new Date(+t)),i=new Date(+n+e.dateDelta),o=new Date(+i+e.dateDelta),s=a(h({text:e.getLabel(new Date(2001,1,1))})).width,c=l(r(+i),0)[0],u=l(r(+o),0)[0]-c-s;return{inc:e,spacing:u,diffFromIdeal:Math.abs(u-30)}}));if(!(m=m.filter((e=>e.spacing>20))).length)return[];var g=m.sort(((e,t)=>e.diffFromIdeal-t.diffFromIdeal))[0].inc,y=g.getStart(t);do{var v=+y;c.push({v:v,x:r(v),label:g.getLabel(y)}),y=new Date(+y+g.dateDelta)}while(y&&+y<+n);var b=s-20,w=s-5,x=h({id:"lt",textAlign:"start",text:SM(t,{month:"short"}),coords:[i,b]}),E=h({id:"lb",textAlign:"start",text:SM(t,{year:"numeric"}),font:"600 14px Arial",coords:[i,w]}),_=h({id:"lt",textAlign:"end",text:SM(n,{month:"short"}),coords:[o,b]}),S=h({id:"lb",textAlign:"end",text:SM(n,{year:"numeric"}),font:"600 14px Arial",coords:[o,w]});10>u.seconds?(x.text=SM(t,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+t.getMilliseconds(),_.text=SM(n,{hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+n.getMilliseconds(),E.text="".concat(t.getDate()," ").concat(SM(t,{month:"short"})," ").concat(t.getFullYear()),S.text="".concat(n.getDate()," ").concat(SM(n,{month:"short"})," ").concat(n.getFullYear())):3>u.days&&(x.text="".concat(t.getDate()," ").concat(x.text),_.text="".concat(n.getDate()," ").concat(_.text));var C=Math.max(a(x).width,a(E).width)+10,T=Math.max(a(_).width,a(S).width)+10,O=Math.max(l(i,0)[0]+C),P=Math.max(l(o,0)[0]-T);return[x,E,...c.map(((e,t)=>pM(pM({id:"midTicks"+t},d),{},{text:e.label,coords:[e.x,s-10]}))).filter((e=>{var t=l(e.coords[0],0)[0],n=a(e).width;return t-n/2>O&&t+n/2<P})),_,S]}({leftDate:new Date(d.invert(r)),rightDate:new Date(d.invert(s)),leftX:r,rightX:s,getX:d,height:l,measureText:this.chart.measureText,getScreenXY:this.chart.getScreenXY}),v=function(e){var{min:t,max:n,steps:r}=e,i=[],o=RM(t,n),s=(n-t)/r,a=1/r*s,l=RM(s-a,s+a);for(i=[o];i[0]-l>t;)i=[i[0]-l,...i];for(;i[i.length-1]+l<n;)i=[...i,i[i.length-1]+l];return i}({min:m,max:g,steps:6}).map(((e,t)=>({id:"y".concat(t),text:"".concat(Le(e,1)),type:"text",coords:[o,Math.round(f(e))],fillStyle:"black",background:{fillStyle:"white"},font:"14px Arial "})));return[...v,...y]}console.error("No data ")},...this.tooltipShapes])}}render(){var{className:t="",style:n={}}=this.props,r=e=>{e||this.setData({xCursor:null,yCursor:null});var t=e.currentTarget.getBoundingClientRect();this.setData({xCursor:e.clientX-t.x,yCursor:e.clientY-t.y})};return e.createElement("div",{ref:e=>{e&&(this.ref=e)},style:n,className:"charts-comp flex-col f-1 h-fit min-h-0 min-w-0 relative bg-white noselect "+t,onPointerMove:r,onPointerUp:r,onPointerCancel:()=>{r()}},e.createElement("canvas",{ref:e=>{e&&(this.canv=e)},className:"f-1 noselect"}))}}class OM{static clampScale(e){return Math.min(122e5,Math.max(1e-6,e))}constructor(e){mM(this,"currViewStateValid",!1),mM(this,"shapes",[]),mM(this,"view",{xScale:1,yScale:1,xO:0,yO:0}),mM(this,"getDataXY",((e,t)=>{var{view:{xScale:n,yScale:r,xO:i,yO:o}}=this;return[(e-i)/n,(t-o)/r]})),mM(this,"getScreenXY",((e,t)=>{var{view:{xScale:n,yScale:r,xO:i,yO:o}}=this,s=void 0;return void 0===t||(s=t*r+o),[e*n+i,s]})),mM(this,"getExtent",(()=>{var{w:e,h:t}=this.getWH(),[n,r]=this.getDataXY(0,0),[i,o]=this.getDataXY(e,t);return pM({leftX:n,topY:r,rightX:i,bottomY:o},this.view)})),mM(this,"measureText",(e=>{var{ctx:t}=this;t.fillStyle=e.fillStyle,t.textAlign=e.textAlign,t.font=e.font;var n=t.measureText(e.text),r=n.fontBoundingBoxAscent+n.fontBoundingBoxDescent,i=n.actualBoundingBoxAscent+n.actualBoundingBoxDescent;return{width:n.width,fontHeight:r,actualHeight:i}})),mM(this,"rawShapes",[]),this.opts=e;var{node:t,canvas:n,events:r}=e;this.init(),new ResizeObserver((()=>{if(this.ctx){var{offsetHeight:e,offsetWidth:r}=t;EM(n,r,e),this.render()}})).observe(t);var i=null;AM(t,{onPanStart:(e,t)=>{i=pM({},this.view),r&&r.onPanStart&&r.onPanStart(e,t)},onPan:(e,t)=>{this.setView(pM(pM({},this.view),{},{xO:i.xO+e.xDiff,yO:i.yO+e.yDiff})),n.style.cursor="move",r&&r.onPan&&r.onPan(e,t)},onPanEnd:(e,t)=>{n.style.cursor="default",r&&r.onPanEnd&&r.onPanEnd(e,t)},onDoubleTap:e=>{var{x:t,y:n}=e,r=this.view.xScale*Math.sign(1)*2,i=this.view.yScale*Math.sign(1)*2,o=OM.clampScale(this.view.xScale+r),s=OM.clampScale(this.view.yScale+i),a=o/this.view.xScale,l=s/this.view.yScale,c=t-a*(t-this.view.xO),u=n-l*(n-this.view.yO);this.setView(pM(pM({},this.view),{},{xScale:o,yScale:s,xO:c,yO:u}))},onSinglePinch:e=>{var{delta:t,x:n,y:r,w:i,h:o}=e,s=this.view.xScale*Math.sign(t)*.1,a=this.view.yScale*Math.sign(t)*.1,l=OM.clampScale(this.view.xScale+s),c=OM.clampScale(this.view.yScale+a),u=l/this.view.xScale,h=c/this.view.yScale,d=n-u*(n-this.view.xO),f=r-h*(r-this.view.yO);this.setView(pM(pM({},this.view),{},{xScale:l,yScale:c,xO:d,yO:f}))}})}setView(e){var{yScaleLocked:t=!1,yPanLocked:n=!1,minXScale:r,maxXScale:i,events:o}=this.opts,s=pM({},this.view);this.view=pM(pM({},this.view),e),t&&(this.view.yScale=1),n&&(this.view.yO=s.yO),("number"==typeof r&&this.view.xScale<r||"number"==typeof i&&this.view.xScale>i)&&(this.view.xO=s.xO,this.view.xScale=s.xScale),o.onExtentChange&&o.onExtentChange(pM({},this.getExtent())),JSON.stringify(this.view)!==JSON.stringify(s)&&this.render(this.rawShapes)}init(){var{node:e,canvas:t}=this.opts,{w:n,h:r}=this.getWH();this.ctx=t.getContext("2d"),this.ctx.canvas.width=n,this.ctx.canvas.height=r,EM(t,e.offsetWidth,e.offsetHeight),this.ctx.imageSmoothingEnabled=!0,e.onwheel=t=>{t.preventDefault(),t.preventDefault();var n,r,i,o,s,a,{xScale:l,yScale:c,xO:u,yO:h}=this.view,d=e.getBoundingClientRect(),f=t.pageX-d.left,p=t.pageY-d.top,m=(i=0,o=0,s=0,a=0,"detail"in(r=t)&&(o=r.detail),"wheelDelta"in r&&(o=-r.wheelDelta/120),"wheelDeltaY"in r&&(o=-r.wheelDeltaY/120),"wheelDeltaX"in r&&(i=-r.wheelDeltaX/120),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(i=o,o=0),s=10*i,a=10*o,"deltaY"in r&&(a=r.deltaY),"deltaX"in r&&(s=r.deltaX),(s||a)&&r.deltaMode&&(1==r.deltaMode?(s*=40,a*=40):(s*=NM,a*=NM)),s&&!i&&(i=1>s?-1:1),a&&!o&&(o=1>a?-1:1),{spinX:i,spinY:o,pixelX:s,pixelY:a}),g=m.pixelY,y=m.pixelX,v=(n=g,.004*Math.abs(n)),b=c*Math.exp(-Math.sign(g)*v),w=l*Math.exp(-Math.sign(g)*v);u=-y+f-(w=OM.clampScale(w))/l*(f-u),h=p-(b=OM.clampScale(b))/c*(p-h),this.setView({xO:u,yO:h,yScale:b,xScale:w})}}getWH(){var{canvas:e}=this.opts;return{w:e.offsetWidth,h:e.offsetHeight}}parseData(e){var t=[],n=this.getExtent();return e.map((e=>{"function"==typeof e?t=t.concat(e(n)):t.push(e)})),t}render(e){var t=[];e?(this.rawShapes=[...e],t=this.parseData(e),this.shapes=t):t=[...this.shapes];var{w:n,h:r}=this.getWH(),{ctx:i}=this;i.clearRect(0,0,n,r),t.map((e=>{var t,n=e=>{if(Array.isArray(e[0]))return e.map(n);var[t,r]=this.getScreenXY(e[0],e[1]);return[t,r]},r=n(e.coords);if(r)if(i.lineJoin="bevel","rectangle"===e.type)i.fillStyle=e.fillStyle,i.lineWidth=e.lineWidth,i.strokeStyle=e.strokeStyle,e.borderRadius?MM(i,r[0],r[1],e.w,e.h,e.borderRadius):(i.beginPath(),i.rect(r[0],r[1],e.w,e.h)),i.fill(),i.stroke();else if("circle"===e.type)i.fillStyle=e.fillStyle,i.lineWidth=e.lineWidth,i.strokeStyle=e.strokeStyle,i.beginPath(),i.arc(r[0],r[1],e.r,0,2*Math.PI),i.fill(),i.stroke();else if("multiline"===e.type)i.lineWidth=e.lineWidth,i.strokeStyle=e.strokeStyle,r.map(((e,t)=>{var[n,r]=e;t?i.lineTo(n,r):(i.beginPath(),i.moveTo(n,r))})),i.stroke();else if("polygon"===e.type)i.fillStyle=e.fillStyle,i.lineWidth=e.lineWidth,i.strokeStyle=e.strokeStyle,i.beginPath(),r.map(((e,t)=>{var[n,r]=e;t?i.lineTo(n,r):(i.beginPath(),i.moveTo(n,r))})),i.closePath(),i.stroke(),i.fill();else{if("text"!==e.type)throw"Unexpected shape type: "+e.type;var{textAlign:o="start"}=e;if(e.background){var s=this.measureText(e),a=e.background.padding||6;i.fillStyle=e.background.fillStyle,e.background.strokeStyle&&(i.strokeStyle=e.background.strokeStyle),i.lineWidth=e.background.lineWidth;var l=r[0]-s.width/2-a,c=r[1]-(!(t=e.text)||t.toLowerCase(),1*s.actualHeight)-a;["left","start"].includes(o)?l=r[0]-a:["right","end"].includes(o)&&(l=r[0]-s.width-a),MM(i,l,c,s.width+2*a,s.actualHeight+2*a,e.background.borderRadius||0),i.closePath(),e.background.strokeStyle&&i.stroke(),i.fill()}i.fillStyle=e.fillStyle,i.textAlign=o,i.font=e.font,i.fillText(e.text,r[0],r[1])}}))}}class PM extends We{constructor(){super(...arguments),mM(this,"d",{xCursor:null,yCursor:null}),mM(this,"panning",!1)}onMount(){var{setRef:e,onExtentChange:t}=this.props;this.chart=new OM({node:this.ref,canvas:this.canv,yScaleLocked:!0,yPanLocked:!0,minXScale:1,events:{onExtentChange:e=>{null==t||t(e),this.setData({extent:e})},onPan:()=>{this.panning=!0},onPanEnd:()=>{this.panning=!1}}}),e(this.chart)}render(){var{className:t="",style:n={}}=this.props;return e.createElement("div",{ref:e=>{e&&(this.ref=e)},style:n,className:"charts-comp flex-col f-1 min-h-0 min-w-0 relative "+t,onMouseMove:e=>{var t=e.currentTarget.getBoundingClientRect();this.setData({xCursor:e.clientX-t.x,yCursor:e.clientY-t.y})},onMouseOut:()=>{this.setData({xCursor:null,yCursor:null})}},e.createElement("canvas",{ref:e=>{e&&(this.canv=e)},className:"f-1"}))}}function AM(e,t){var n,r,{onPanStart:i,onPan:o,onPanEnd:s,threshold:a=15,doubleTapThreshold:l=100,tapThreshold:c=30,onPress:u,onRelease:h,onDoubleTap:d,onPinch:f,onSinglePinch:p}=t,m=null,g=null,y={},v={};e.style.touchAction="none",window.document.body.style.touchAction="none",window.document.documentElement.style.overscrollBehavior="none";var b=[kM(e,"pointerdown",(t=>{if(y[t.pointerId]=t,r={ev:t,started:Date.now()},!t.button||"touch"===t.pointerType){u&&u(t),t.preventDefault(),t.stopPropagation();var n=e.getBoundingClientRect(),{clientX:i,clientY:o}=t,[s,a]=[i,o],[l,c]=[n.x,n.y],h=i-n.left,d=o-n.top,[f,p]=[0,0],[g,v]=[0,0];m={node:e,x:i,y:o,xStart:s,yStart:a,xNode:i-l,yNode:o-c,xNodeStart:h,yNodeStart:d,xDiff:f,yDiff:p,xOffset:l,yOffset:c,xTravel:g,yTravel:v,triggered:!1}}})),kM(window.document.body,"pointerup",(t=>{if(y[t.pointerId]){if(delete y[t.pointerId],delete v[t.pointerId],p||d)if(d&&n&&200>n.duration&&400>Date.now()-n.ended){var i=e.getBoundingClientRect();d({x:t.clientX-i.x,y:t.clientY-i.y}),n=void 0}else n={duration:Date.now()-r.started,ended:Date.now()};h&&h(t),m&&m.triggered&&(t.preventDefault(),s&&s(pM({},g),t)),m=null}})),kM(window.document.body,"pointermove",(t=>{var s;if(y[t.pointerId]){if(p&&v[t.pointerId]&&n&&(null!==(s=r)&&void 0!==s&&s.onSinglePinch||200>n.duration&&400>Date.now()-n.ended)){r.onSinglePinch=!0,t.preventDefault(),t.stopPropagation();var l=e.getBoundingClientRect(),c=Math.hypot(t.clientX-v[t.pointerId].clientX,t.clientY-v[t.pointerId].clientY);p({x:r.ev.clientX-l.x,y:r.ev.clientY-l.y,w:l.width,h:l.height,totalDelta:Math.hypot(t.clientX-r.ev.clientX,t.clientY-r.ev.clientY),delta:(t.clientY<v[t.pointerId].clientY?1:-1)*c,goingUp:t.clientY<v[t.pointerId].clientY}),uM(15)}else if(2===Object.keys(y).length)t.preventDefault(),t.stopPropagation();else if(m){t.preventDefault(),t.stopPropagation();var{xOffset:u,yOffset:h,xStart:d,yStart:f,xDiff:b,yDiff:w,xTravel:x,yTravel:E}=m,{clientX:_,clientY:S}=t;(g=pM(pM({},m),{},{x:_,y:S,xNode:_-u,yNode:S-h,xDiff:_-d,yDiff:S-f})).xTravel=x+Math.abs(g.xDiff),g.yTravel=E+Math.abs(g.yDiff),!m.triggered&&(g.xTravel>=a||g.yTravel>a)?(m.triggered=!0,i&&i(pM({},g),t)):m.triggered&&o&&o(pM({},g),t)}v[t.pointerId]=t}}))];return function(){b.map((e=>e()))}}function kM(e,t,n){var r=function(i){e.isConnected?n(i):e.removeEventListener(t,r)};return e.removeEventListener(t,r),e.addEventListener(t,r,{passive:!1}),function(){e.removeEventListener(t,r)}}function MM(e,t,n,r,i,o){if(void 0===o&&(o=5),"number"==typeof o)o={tl:o,tr:o,br:o,bl:o};else{var s={tl:0,tr:0,br:0,bl:0};for(var a in s)o[a]=o[a]||s[a]}e.beginPath(),e.moveTo(t+o.tl,n),e.lineTo(t+r-o.tr,n),e.quadraticCurveTo(t+r,n,t+r,n+o.tr),e.lineTo(t+r,n+i-o.br),e.quadraticCurveTo(t+r,n+i,t+r-o.br,n+i),e.lineTo(t+o.bl,n+i),e.quadraticCurveTo(t,n+i,t,n+i-o.bl),e.lineTo(t,n+o.tl),e.quadraticCurveTo(t,n,t+o.tl,n),e.closePath()}var NM=800;function LM(e,t,n){return Math.min(n,Math.ceil(e/t)*t)}function RM(e,t){for(var n=t+"",r=t,i=n=>{var r=+n.split("").concat("0").join(""),i=+n.split("").concat("5").join(""),o=+n.split("").slice(0,-1).pop();return[r,i,+(n.split("").slice(0,-1).concat(["".concat(o-1)]).join("")+"0")].find((n=>Number.isFinite(n)&&n>=e&&n<=t))},o=n.length;0<=o;o--){var s=i(n.slice(0,o));void 0!==s&&(r=s)}return r}function IM(){return IM=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},IM.apply(this,arguments)}function DM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jM(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?DM(Object(t),!0).forEach((function(n){FM(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):DM(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function FM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zM=[5,10,15,20,25,50,100,200];function BM(e,t){return e.length>t?"".concat(e.slice(0,t),"..."):e}class UM extends e.Component{static parseCell(t){var n,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,o=2<arguments.length?arguments[2]:void 0;return"string"==typeof t?r=BM(t,i):"number"==typeof t?r=t.toString():null===t?(r="NULL",n=e.createElement("i",{className:"text-gray-300"},"NULL")):r=void 0===t?"":t&&Array.isArray(t)?BM("[".concat(t.map((e=>UM.parseCell(e))).join(", \n"),"]"),i):t&&"function"==typeof t.toISOString?t.toISOString():t&&"[object Object]"===Object.prototype.toString.call(t)?BM(JSON.stringify(t,null,2),i):t&&t.toString?BM(t.toString(),i):"".concat(t),o?r:n||r}render(){var t,n,{rows:r=[],cols:i=[],whiteHeader:o=!1,onSort:s,sort:a=[],onRowClick:l,onRowHover:c,tableStyle:u={},maxCharsPerCell:h=100,maxRowsPerPage:d=200,pagination:f,activeRowIndex:p=-1,bodyClass:m="",activeRowStyle:g={},className:y="",rowClass:v="",rowStyle:b={},maxRowHeight:w}=this.props,x=i.filter((e=>!e.hidden)),{page:E=1,pageSize:_=15}=f||{};_=qM(_||25,zM)||25;var S=r.map((e=>jM({},e)));f&&!f.onPageChange&&(S=S.slice(E,(E+1)*_)),S.length>d&&(console.warn("Exceeded maxRowsPerPage"),S=S.slice(0,d));var C=[];Array.isArray(a)&&(C=a.map((e=>jM({},e))));var T=e=>e.width?{flex:"none",width:"".concat(e.width,"px")}:{flex:1};return e.createElement("div",{className:"table-component o-auto flex-col f-1 min-h-0 min-w-0 "+y,ref:e=>{e&&(this.ref=e)}},e.createElement("div",{role:"table",className:"min-w-fit min-h-0 b border-gray-200 flex-col h-full bg-white ",style:u},e.createElement("div",{role:"row",className:"noselect f-0 flex-row shadow bg-gray-50",onWheel:e=>{function t(e){return e&&e.scrollWidth>e.clientWidth}for(var n,r=5,i=e.currentTarget.parentElement.closest(".table-component");0<r;)t(i)?(n=i,r=0):(i=i.parentElement,r--);n&&(n.scrollLeft-=e.nativeEvent.wheelDeltaY||-e.deltaY)}},x.map(((t,n)=>{var r,i,a,l,c=C.find((e=>e.key===t.key)),u="flex-col h-full min-w-0 px-p5 py-p5 text-left text-xs leading-4 relative  font-medium text-gray-500 uppercase tracking-wider to-ellipsis"+(s&&t.sortable?" pointer ":"")+(o?" ":" bg-gray-50  ")+(t.onContextMenu?" contextmenu ":"")+(t.width?" f-0 ":" f-1 ");return e.createElement("div",IM({key:n,className:u},t.onContextMenu?{onTouchStart:e=>{if(window.isIOSDevice){var t=e.currentTarget;e.preventDefault(),t._isPressed=setTimeout((()=>{if(t._isPressed){var e=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!1,view:window,button:2,buttons:0,clientX:t.getBoundingClientRect().x,clientY:t.getBoundingClientRect().y});t.dispatchEvent(e)}}),500)}},onTouchMove:l=e=>{if(window.isIOSDevice){var t=e.currentTarget;t._isPressed&&clearTimeout(t._isPressed),t._isPressed=null}},onTouchEnd:l}:{},{onContextMenu:t.onContextMenu?e=>{if(t.onContextMenu&&!e.currentTarget.classList.contains("resizing-ew"))return uM(25),t.onContextMenu(e,e.nativeEvent.target,t)}:void 0,role:"columnheader",style:jM(jM({},T(t)),{},{borderRight:"1px solid var(--gray-100)"}),onClick:s&&t.sortable?e=>{e.button||e.target.classList.contains("resize-handle")||(c?c.asc?c.asc=!1:c=void 0:c={key:t.key,asc:!0},s((e.shiftKey?C.filter((e=>e.key!==t.key)):[]).concat(c?[c]:[])))}:void 0}),e.createElement("div",{className:"flex-row f-shrink h-fit "+(t.sortable?"boolean"==typeof(null===(r=c)||void 0===r?void 0:r.asc)?[!1].includes(c.asc)?"sort-desc":"sort-asc":" sort-none ":"")+(t.headerClassname||"")},e.createElement("div",{className:"flex-col min-w-0 f-shrink"},e.createElement("div",{className:"table-column-label text-ellipsis",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",t.key+"")},title:"string"==typeof t.label?t.label:void 0},t.label),void 0===t.subLabel?null:e.createElement("div",{className:"table-column-sublabel text-gray-400 mt-p25 font-normal ws-nowrap text-ellipsis ",title:null===(i=t.subLabel)||void 0===i||null===(a=i.toString)||void 0===a?void 0:a.call(i)},t.subLabel))),n<=x.length-1?e.createElement(HM,{className:"resize-handle noselect",style:{position:"absolute",right:0,top:0,bottom:0,width:"30px",cursor:"ew-resize",marginRight:"-15px"},onDoubleTap:()=>{var e=this.ref.querySelector('[role="rowgroup"]');console.log(n,e)},threshold:0,onPanStart:e=>{var t=e.node.closest('[role="columnheader"]');t&&(e.node._w=t.offsetWidth)},onPan:e=>{var t=e.node.closest('[role="columnheader"]');if(t){var{xDiff:r}=e,i=Math.max(30,e.node._w+r);t.style.width="".concat(i,"px"),t.style.flex="none",this.ref.querySelector('[role="rowgroup"]').querySelectorAll('[role="row"] > *:nth-child('.concat(n+1,")")).forEach((e=>{e.style.width="".concat(i,"px"),e.style.flex="none"}))}},onPanEnd:e=>{var n=e.node.closest('[role="columnheader"]');n&&t.onResize&&t.onResize(n.offsetWidth)},onPress:e=>{var t,n,r=null===(t=e.target)||void 0===t||null===(n=t.closest)||void 0===n?void 0:n.call(t,'[role="columnheader"]');r&&(r.classList.toggle("resizing-ew",!0),uM(15),e.preventDefault(),e.stopPropagation())},onRelease:e=>{var t,n,r=null===(t=e.target)||void 0===t||null===(n=t.closest)||void 0===n?void 0:n.call(t,'[role="columnheader"]');r&&r.classList.toggle("resizing-ew",!1)}}):null)}))),e.createElement("div",{className:"b-y border-gray-200 f-1 oy-auto ox-hidden no-scroll-bar flex-col min-w-fit "+m,role:"rowgroup",onPointerUp:l?e=>{e.target===e.currentTarget&&l(void 0,e)}:void 0},S.length?S.map(((t,n)=>e.createElement("div",{key:n+" "+Date.now(),role:"row",className:"d-row flex-row f-0 "+(v||" ")+(c?" hover ":""),style:jM(jM(jM({},p===n?g:{}),b),{},{maxHeight:"".concat(w||100,"px")}),onClick:l?e=>{e.currentTarget.contains(e.target)&&!window.getSelection().toString().trim()&&l(t,e)}:void 0},x.map(((n,r)=>{var i;if(n.onRenderNode)return n.onRenderNode(t,t[n.key]);var o=UM.parseCell(t[n.key],h,!0),s=n.onRender?null:UM.parseCell(t[n.key],h);return e.createElement("div",{key:r,className:" bt  text-sm leading-5 text-gray-500 o-auto no-scroll-bar ta-left br b-gray-100"+(n.className||"")+(n.blur?" blur ":" ")+(n.width?" f-0 ":" f-1 ")+(n.onClick?"  ":" p-p5 "),style:jM(jM({},T(n)),(null===(i=n.getCellStyle)||void 0===i?void 0:i.call(n,t,t[n.key],o))||{}),role:"cell",title:o},n.onClick?e.createElement(et,{onClick:e=>{n.onClick&&n.onClick(t,n,e)},className:"text-indigo-600 hover:text-indigo-900 h-fit w-fit b-gray-400"},s):n.onRender?n.onRender(t,t[n.key],o):s)}))))):e.createElement("div",{className:"text-gray-300 p-2 noselect"},"No data"),f?e.createElement(VM,IM({},this.props.pagination,{totalRows:null!==(t=null===(n=this.props.pagination)||void 0===n?void 0:n.totalRows)&&void 0!==t?t:r.length})):null)))}}class VM extends e.Component{render(){var{onPageChange:t,page:n,onPageSizeChange:r,pageSize:i,totalRows:o}=this.props,s=e=>{n!==e&&t(e)},a=0;return o&&(a=Math.floor(o/i)),a?e.createElement("div",{className:"flex-row p-p5 mt-auto ai-center"},e.createElement(et,{iconPath:"M18.41,16.59L13.82,12L18.41,7.41L17,6L11,12L17,18L18.41,16.59M6,6H8V18H6V6Z",disabledInfo:1===n?"Already at first page":void 0,onClick:()=>{s(1)}}),e.createElement(et,{iconPath:re,disabledInfo:1===n?"Already at first page":void 0,onClick:()=>{s(Math.max(1,n-1))}}),e.createElement("input",{type:"number",key:Date.now(),className:"h-fit min-w-0 p-p5",style:{width:"".concat((n||0).toString().length+5,"ch")},value:n,onChange:e=>{var t=+e.target.value;0<t&&t<=a&&s(t)}}),e.createElement(et,{iconPath:ie,disabledInfo:n===a?"Already at last page":void 0,onClick:()=>{s(Math.min(a,n+1))}}),e.createElement(et,{iconPath:"M5.59,7.41L10.18,12L5.59,16.59L7,18L13,12L7,6L5.59,7.41M16,6H18V18H16V6Z",disabledInfo:n===a?"Already at last page":void 0,onClick:()=>{s(a)}}),r?e.createElement(aN,{title:"Page size",asColumn:!0,value:i,options:zM.map((e=>"".concat(e))),onChange:e=>{r(+e)}}):null,e.createElement("div",{className:"text-gray-400 text-sm p-p5 noselect"},(+a).toLocaleString()," pages "," (".concat((+o).toLocaleString()," rows)"))):null}}class HM extends e.Component{constructor(){super(...arguments),FM(this,"setListeners",(()=>{if(this.ref){var{onPanStart:e,onPan:t,onPanEnd:n,onRelease:r,onPress:i,onDoubleTap:o,threshold:s}=this.props;AM(this.ref,{onPanStart:e,onPan:t,onPanEnd:n,onRelease:r,onPress:i,threshold:s,onDoubleTap:o})}}))}componentDidMount(){this.setListeners()}render(){var{style:t={},className:n="",children:r}=this.props;return e.createElement("div",{ref:e=>{e&&(this.ref=e)},style:t,className:n},r)}}function qM(e,t){var n;return null===(n=t.map((t=>({av:t,diff:Math.abs(e-t)}))).sort(((e,t)=>e.diff-t.diff))[0])||void 0===n?void 0:n.av}function WM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GM(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?WM(Object(t),!0).forEach((function(n){XM(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):WM(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function $M(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function YM(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){$M(a,r,i,o,s,"next",e)}function s(e){$M(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function XM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class KM extends We{constructor(){var e;super(...arguments),e=this,XM(this,"state",{columnName:void 0,error:null,column:void 0,options:void 0,showDateInput:!0,onSearchOptions:void 0,insertMode:!1,loaded:!1}),XM(this,"wasChanged",!1),XM(this,"onDelta",function(){var t=YM((function*(){var{tableName:t,db:n,column:r,showSuggestions:i,tables:o}=e.props,{columnName:s}=e.state,a={};if(n&&r&&s!==r.name){var l,c,u=function(){var e=YM((function*(e){var{term:t,col:r,table:i}=e;return KM.getSuggestions({db:n,table:i,col:r,term:t})}));return function(){return e.apply(this,arguments)}}();if(r.references){var h,{fcols:d,ftable:f}=r.references;if(f&&1===d.length&&null!=n&&null!==(h=n[f])&&void 0!==h&&h.find){var p,m=d[0],g=null===(p=o.find((e=>e.name===f)))||void 0===p?void 0:p.columns.find((e=>e.name===m));1<(l=yield u({term:"",col:g,table:f})).length&&l.length>=20&&(c=function(){var t=YM((function*(t){var n=yield u({term:t,col:g,table:f});e.setState({options:n})}));return function(){return t.apply(this,arguments)}}())}}else"string"===r.tsDataType&&i&&n[t].find&&(e.onSuggest=function(){var e=YM((function*(e){return yield u({term:e,col:r,table:t})}));return function(){return e.apply(this,arguments)}}());a={columnName:r.name,options:l,onSearchOptions:c}}e.state.loaded||(a.loaded=!0),a&&e.setState(a)}));return function(){return t.apply(this,arguments)}}()),XM(this,"onChange",function(){var t=YM((function*(t){var{column:n,tableInfo:r,onChange:i}=e.props;if(e.wasChanged=!0,n||r){var o=t;if(null!=r&&r.has_media?o=Array.from(t).map((e=>({data:e,name:e.name}))):""===t&&["Date","number","boolean","Object"].includes(n.tsDataType)&&n.is_nullable&&(o=null),"string"==typeof t&&(null!=n&&n.udt_name.startsWith("json")||null!=n&&n.udt_name.startsWith("geo")&&t.includes("ST_")))try{o=JSON.parse(t)}catch(t){e.setState({error:t.toString()})}n&&(null==r||!r.has_media)&&("number"==typeof n.min&&"number"==typeof o&&o<n.min?o=Math.max(o,n.min):"number"==typeof n.max&&"number"==typeof o&&o>n.max&&(o=Math.min(o,n.max)));try{e.setState({error:null}),yield i(o),e.setState({error:null,newValue:o})}catch(t){e.setState({error:t.toString()})}}}));return function(){return t.apply(this,arguments)}}())}static getInputType(e){return e.data_type.startsWith("timestamp")?"datetime-local":["email"].includes(e.name)?"email":["phone","telephone","phone_number","tel"].includes(e.name)?"tel":["zip_code","zipcode","post_code","postcode"].includes(e.name)?"postal-code":["given-name","first_name"].includes(e.name)?"given-name":["family-name","last_name"].includes(e.name)?"family-name":"boolean"===e.tsDataType?"checkbox":"string"===e.tsDataType?"text":e.tsDataType}static getInputAutocomplete(e){var t=["address-line1","address-line2","address-line3","street_address","street","address","address-level1","address-level2","address-level3","address-level4","organization","organization-title","country","country-name","postal-code","tel","given-name","family-name","email"];return t.concat(t.map((e=>e.replaceAll("-","_")))).includes(e.name.toLowerCase())?e.name.replaceAll("_","-").toLowerCase():"on"}static renderValue(t,n){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(n&&null!=t&&t.udt_name.startsWith("json"))return JSON.stringify(n);if(n&&["geography","geometry"].includes(null==t?void 0:t.udt_name))return"object"!=typeof n||Array.isArray(n)?BM(n,6):BM(JSON.stringify(n),15);if(n&&"Date"===(null==t?void 0:t.tsDataType)){var i=n,o={day:"2-digit",month:"2-digit",year:"numeric",weekday:"short"};t.udt_name.startsWith("timestamp")&&(o=GM(GM({},o),{},{hour:"numeric",minute:"numeric"}));try{i=new Intl.DateTimeFormat(void 0,o).format(new Date(n))}catch(e){console.error(e)}return e.createElement(e.Fragment,null,i)}return[null,void 0].includes(n)?e.createElement("i",{className:"text-gray-400",title:r?"NULL":void 0},"NULL"):"boolean"==typeof n?e.createElement(e.Fragment,null,n.toString()):"string"==typeof n&&""===n?e.createElement("i",{className:"text-gray-400",title:r?"&quot;&quot;":void 0},"Empty String"):e.createElement(e.Fragment,null,n)}static parseValue(e,t){if(t){if(e.udt_name.startsWith("geo")&&"object"==typeof t&&!Array.isArray(t))return JSON.stringify(t);var n="string"==typeof t?t:+t;if("date"===e.udt_name)return new Date(n).toISOString().split("T")[0];if("timestamp"===e.udt_name)return new Date(n).toISOString().slice(0,-5);if("timestamptz"===e.udt_name)return new Date(n).toISOString()}return t}static parseDefaultValue(e,t,n){if(!e||n)return t;if(![null,void 0].includes(t))return t;if(e.is_nullable&&null===t)return t;if(e.has_default&&"string"==typeof e.column_default){if(e.column_default.endsWith("::text"))return e.column_default.slice(1,-7);if(["now()","CURRENT_TIMESTAMP"].includes(e.column_default))return"date"===e.udt_name?(new Date).toISOString().split("T")[0]:(new Date).toISOString().slice(0,-5);if("number"===e.tsDataType)return+e.column_default}else if(t)return KM.parseValue(e,t);return t}render(){var t,{action:n,value:r,inputStyle:i={},placeholder:o="",variant:s,multiSelect:a,column:l,tableInfo:c,rightContent:u,hideNullBtn:h,sectionHeader:d,style:f,tableName:p}=this.props,m="rawValue"in this.props?this.props.rawValue:r,{error:g,options:y,showDateInput:v,onSearchOptions:b,loaded:w}=this.state;if(!l&&!c||!w)return e.createElement(Xe,null);if(!l)return e.createElement(Xe,null);var x,E=null,_=null;try{x=KM.parseValue(l,r)}catch(e){_=e.toString()}_!==g&&setTimeout((()=>{this.setState({error:_})}),0);var S="geometry"===(null==l?void 0:l.udt_name)||"geography"===(null==l?void 0:l.udt_name);if(null!=l&&l.udt_name.startsWith("json")&&r)try{x=JSON.stringify("object"==typeof r?r:JSON.parse(r),null,2)}catch(e){x="string"==typeof r?r:""}else"Date"===(null==l?void 0:l.tsDataType)?E=e.createElement(et,{title:v?"Edit as text":"Edit with picker",iconPath:v?de:te,className:"h-full",onClick:()=>this.setState({showDateInput:!v}),size:"small"}):S&&(E=e.createElement(Tt,{style:{height:"100%",borderRight:"1px solid var(--gray-300)"},button:e.createElement(et,{title:"Use my current location",iconPath:"M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z",className:"h-full",onClick:()=>this.setState({showDateInput:!v}),size:"small"}),content:e.createElement("p",null,"You will have to allow your browser to use your location data"),footerButtons:[{isPrimary:!0,label:"OK",onClick:()=>{try{navigator.geolocation.getCurrentPosition((e=>{var t=e.coords.latitude,n=e.coords.longitude;null==t?alert("GPS not activated!"):this.onChange({ST_GeomFromEWKT:["SRID=4326;POINT(".concat(n," ").concat(t,")")]})}))}catch(e){alert("Something went wrong: "+e.toString())}}},{label:"No thanks",onClickClose:!0}]}));var C="compact"===s,T="view"===n||"update"===n&&!l.update||"insert"===n&&!l.insert;T&&(E=null);var O=KM.getInputType(l).toLowerCase();O.startsWith("date")&&!v&&(O="text");var P=KM.getInputAutocomplete(l);return e.createElement(e.Fragment,null,d?e.createElement("h4",{className:"noselect",style:{marginBottom:"0.5em"}},d):null,e.createElement(aN,{id:p+"-"+l.name,style:f,className:C?"":"mt-1",maxWidth:"600px",inputStyle:GM(GM({},i),{},{minWidth:0},"checkbox"===O?{padding:"1px"}:C?{padding:"2px 6px"}:{padding:"4px 6px"}),key:l.name,placeholder:o,type:O,autoComplete:P,label:C?void 0:l.label,value:x,rawValue:m,options:y,asTextArea:(null===(t=l.udt_name)||void 0===t?void 0:t.startsWith("json"))||"string"===l.tsDataType&&"string"==typeof r&&(50<r.length||1<r.split("\n").length),readOnly:T,multiSelect:a,onChange:this.onChange,error:this.props.error||g,rightIcons:E,rightContent:u,labelAsValue:!0,onSearchOptions:b,onSuggest:this.onSuggest,nullable:l.is_nullable,inputProps:{min:l.min,max:l.max},hint:l.hint,hideNullBtn:h,asColumn:"column"===s}))}}function ZM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function JM(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ZM(Object(t),!0).forEach((function(n){QM(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ZM(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function QM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}XM(KM,"getSuggestions",function(){var e=YM((function*(e){var t,{db:n,table:r,term:i,col:o,groupBy:s=!0,filter:a}=e;if(null===(t=n[r])||void 0===t||!t.find)return console.error("Invalid column provided"),[];var l=(i||"").trimStart();try{var c={$and:[a,l?{[o.name]:{$ilike:"%".concat(l,"%")}}:{}].filter((e=>e))},u=yield n[r].find(c,{select:{[o.name]:1},groupBy:s,returnType:"values",limit:20});return u.includes("")||"string"!==o.tsDataType||"uuid"===o.udt_name||(yield n[r].findOne({[o.name]:""},{select:{[o.name]:"$trim"}}))&&u.unshift(""),u.includes(null)||+(yield n[r].count({[o.name]:null}))&&u.unshift(null),u}catch(e){return console.error(e),[]}}));return function(){return e.apply(this,arguments)}}());class eN extends We{constructor(){super(...arguments),QM(this,"state",{popupAnchor:null,defaultSearch:void 0}),QM(this,"onDelta",(()=>{var{onSearch:e}=this.props}))}render(){var{onChange:t,className:n="",title:r="",value:i,id:o="select-"+Date.now(),style:s={},required:a,label:l,variant:c="div",onSearch:u,multiSelect:h,labelAsValue:d,emptyLabel:f="Select...",asRow:p,iconPath:m,buttonClassName:g="",size:y,limit:v}=this.props,b=(e,n)=>{JSON.stringify(i)!==JSON.stringify(e)&&t(e,n)},w=e.createElement(Ae(),{path:"M7,10L12,15L17,10H7Z",size:1,style:{position:"absolute",right:".25em",top:".25em",color:"#cacaca",pointerEvents:"none",touchAction:"none"}}),x=[],E=(x=(x="options"in this.props?this.props.options.map((e=>JM({key:e,label:e},h?{checked:!(!i||!i.includes(e))}:{}))):this.props.fullOptions.map((e=>{var t,n;return JM(JM({},e),{},{label:null!==(t=e.label)&&void 0!==t?t:null===(n=e.key)||void 0===n?void 0:n.toString()},h?{checked:!(!i||!i.includes(e.key))}:{})}))).map((e=>JM(JM({},e),{},{label:e.label||(null===e.label?"NULL":"")})))).map((e=>{var{key:t}=e;return t})),_=l?{}:s,S=null;if("pill"===c)S=e.createElement("div",{className:"flex-row rounded bg-gray-100 o-hidden b b-gray-300",style:_},x.map(((t,n)=>e.createElement(et,{key:n,color:"inherit",style:JM({borderRadius:0,color:"var(--gray-600)"},i===t.key?{color:"white",background:"rgb(0, 183, 255)"}:{}),onClick:e=>{b(t.key,e)}},t.label||t.key))));else if("div"===c||u||h){var C,{popupAnchor:T,defaultSearch:O}=this.state,P=()=>{this.setState({popupAnchor:void 0}),this.btnRef&&this.btnRef.focus()},A="Select...";if(Array.isArray(i)){if(i.length){var k=i[0];A=(null===k?"NULL":k)+(1<i.length?" + ".concat(i.length-1):"")}}else A=(null===(C=x.find((e=>e.key===i)))||void 0===C?void 0:C.label)||i;var M=!(null!=E&&E.length)||1===(null==E?void 0:E.length)&&i===(null==E?void 0:E[0]);S=e.createElement(e.Fragment,null,e.createElement(et,{title:M?"No other option":r,_ref:e=>{e&&(this.btnRef=e)},style:JM({borderRadius:"6px",border:"none",color:"var(--gray-800)",position:"relative",padding:".5rem .75rem",width:l?"auto":"fit-content",minHeight:"32px"},_),size:y,className:" f-0 select-button bg-gray-100 "+(M?" disabled ":" ")+(l?"  ":n)+" "+g,onKeyDown:M?void 0:e=>{if(1!==e.key.length||T){if(["ArrowUp","ArrowDown"].includes(e.key)){var t="ArrowUp"===e.key?-1:1,n=E.indexOf(i)+t;0>n?n=E.length-1:n>E.length-1&&(n=0),b(E[n],e),e.preventDefault()}}else this.setState({popupAnchor:e.currentTarget,defaultSearch:e.key})},onClick:M?void 0:e=>{this.setState({popupAnchor:e.currentTarget})},iconPath:m},m?null:e.createElement(e.Fragment,null,e.createElement("div",{className:"pr-1 "+(i?"":" text-gray-600")},(d?KM.renderValue(void 0,A,!M):A)||f),w)),T?e.createElement(pt,{open:!0,rootStyle:{padding:0},anchorEl:T,positioning:"beneath-left-minfill",clickCatchStyle:{opacity:0},onClose:P,contentClassName:"rounded"},e.createElement(_t,{id:o,placeholder:"Search...",defaultSearch:O,noSearch:!u&&15>E.length,onSearch:u,multiSelect:h,onChange:b,limit:v,items:x.map((e=>{var{key:t,label:n,subLabel:r,checked:o}=e;return h?{key:t,label:n,subLabel:r,onPress:e=>{var n=(i||[]).slice(0);"string"==typeof i&&(n=[i]),n.includes(t)?n=n.filter((e=>e!==t)):n.push(t),b(n,e)},checked:o}:{key:t,label:n,subLabel:r,onPress:e=>{b(t,e),P()},selected:n===i}}))})):null)}else S=e.createElement("div",{className:"select-wrapper relative rounded-md "+(l?" f-1 ":n)},e.createElement("select",{id:o,title:r,style:JM({appearance:"none",paddingRight:"2em",background:"transparent"},_),value:i,required:a,onChange:b?e=>{b(e.target.value,e)}:void 0},x.map(((t,n)=>{var{key:r,label:i}=t;return e.createElement("option",{key:n,value:r},i)}))),w);return l?e.createElement("div",{className:" w-fit "+(p?" flex-row ai-center ":" flex-col ")+n,style:s},e.createElement("label",{htmlFor:o,className:"noselect f-0 text-gray-500 ta-left "+(p?" mr-p5 ":" mb-p5 ")},l),S):S}}function tN(){return tN=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},tN.apply(this,arguments)}function nN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rN(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?nN(Object(t),!0).forEach((function(n){sN(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nN(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function iN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function oN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){iN(a,r,i,o,s,"next",e)}function s(e){iN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function sN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aN extends e.Component{constructor(){var e;super(...arguments),e=this,sN(this,"state",{activeSuggestionIdx:void 0,suggestions:void 0,options:void 0}),sN(this,"setResizer",(()=>{var{asTextArea:e,autoResize:t=!0}=this.props;if(this.rootDiv&&e&&t&&!this.textArea){var n=this.rootDiv.querySelector("textarea");n&&(this.textArea=n,n.addEventListener("input",this.resize,!1),setTimeout((()=>{this.resize()}),10))}})),sN(this,"resize",(()=>{if(this.textArea){var e=this.textArea,t=Math.min(100,e.scrollHeight),n=e.scrollWidth,r=e.offsetWidth;r=Number.isFinite(r)&&r>=e.offsetWidth?r:e.offsetWidth;var i=e.offsetHeight;i=Number.isFinite(i)&&i>=e.offsetWidth?i:e.offsetHeight,r<n&&(e.style.width="",e.style.width=n+"px"),i<t&&(e.style.height="",e.style.height=t+"px")}})),sN(this,"searchOptions",(e=>{this.props.onSearchOptions&&this.props.onSearchOptions(e).then((e=>{this.setState({options:e})}))})),sN(this,"mounted",!1),sN(this,"focus",(()=>{})),sN(this,"blur",(()=>{})),sN(this,"onChange",(t=>{var{onChange:n,onSuggest:r}=this.props;if(n){var i="file"===t.type?t.files:"checkbox"===t.type?t.checked:t.value;if(n(i),r){this.changing&&clearTimeout(this.changing.timeout);var o=this.changing?100:0;this.changing={value:i,timeout:setTimeout(oN((function*(){if(e.mounted&&e.changing){var{onSuggest:t}=e.props,{value:n}=e.changing;if(t){var r=yield t(e.changing.value);e.setState({suggestions:1===r.length&&r[0]===n?void 0:r})}e.changing=void 0}})),o)}}}})),sN(this,"cursorPosition",0)}componentDidMount(){this.mounted=!0,this.setResizer()}componentWillUnmount(){this.mounted=!1,this.textArea&&this.textArea.removeEventListener("input",this.resize,!1)}componentDidUpdate(e){var t=this.props.error,n=e.error;this.rootDiv&&e&&this.props&&(t||n)&&t!==n&&(this.rootDiv.scrollIntoViewIfNeeded?this.rootDiv.scrollIntoViewIfNeeded({block:"end",behavior:"smooth"}):this.rootDiv.scrollIntoView({block:"end",behavior:"smooth"})),this.setResizer(),e.value!==this.props.value&&(this.resize(),this.inputRef&&/text|password|search|tel|url/.test(this.inputRef.type)&&(this.inputRef.selectionStart=this.cursorPosition,this.inputRef.selectionEnd=this.cursorPosition))}render(){var t,n,r,i,o=this,{onChange:s,label:a,value:l,defaultValue:c,id:u,options:h,required:d=!1,readOnly:f=!1,type:p="text",autoComplete:m="on",error:g,hint:y,placeholder:v,className:b="",inputClassName:w="",style:x={},inputStyle:E={},asTextArea:_=!1,accept:S,onInput:C,asColumn:T,rightIcons:O=null,rightContent:P=null,title:A,nullable:k=!1,multiSelect:M,labelAsValue:N,onSuggest:L,options:R=(null===(t=this.state)||void 0===t?void 0:t.options),name:I=(null===(n=this.props)||void 0===n?void 0:n.type),inputProps:D={},hideNullBtn:j=!1,maxWidth:F="400px",rawValue:z,labelClass:B="",labelStyle:U={}}=this.props,{suggestions:V,activeSuggestionIdx:H=0}=this.state,q=[z,c,l].find((e=>void 0!==e)),W=R?{width:"fit-content",minWidth:0}:{},G={pointerEvents:"none",touchAction:"none"};(R||"checkbox"===p)&&f&&(W=rN(rN({},W),{},{backgroundColor:"var(--gray-100)"},G));var $={value:[void 0,null].includes(l)?"":l};f&&($={value:l}),c&&($={defaultValue:c});var Y=" font-semibold ";"checkbox"!==p&&(Y+=f?" bg-gray-100":" bg-white "),p.startsWith("file")&&(Y+=" pointer ");var X={};"color"===p&&l&&(W=rN(rN({},W),{},{backgroundColor:l||"white",cursor:"pointer"}),X={opacity:0}),"checkbox"===p&&($={checked:!(!l&&!c)},W=rN(rN({},W),{},{minWidth:0,width:"fit-content",border:"none",overflow:"visible"})),_&&(W=rN(rN({},W),{},{border:"none",overflow:"visible"}));var K,Z,Q=rN(rN(rN({id:u,key:u,ref:e=>{e&&(this.inputRef=e)},required:d,readOnly:f,className:Y+=" "+w,type:p,accept:S},$),{},{autoComplete:m,onInput:C,placeholder:v,name:I},D),{},{style:rN(rN(rN({},X),E),D.style),onChange:e=>{var{currentTarget:t}=e;return this.cursorPosition=t.selectionStart,this.onChange(t)},onFocus:e=>{var t;null==D||null===(t=D.onFocus)||void 0===t||t.call(D,e)}},p.startsWith("file")?{onDragOver:e=>{e.currentTarget.classList.toggle("active-drop-target",!0)},onDrop:e=>{e.currentTarget.classList.toggle("active-drop-target",!1)},onDragEnd:e=>{e.currentTarget.classList.toggle("active-drop-target",!1)},onDragExit:e=>{e.currentTarget.classList.toggle("active-drop-target",!1)},onDragLeave:e=>{e.currentTarget.classList.toggle("active-drop-target",!1)}}:{}),ee=e=>{s(e),this.setState({suggestions:void 0})},te=function(){var e=oN((function*(){if(L){var e=yield L(l);o.setState({suggestions:e})}}));return function(){return e.apply(this,arguments)}}(),ne=_?e.createElement("textarea",tN({},Q,{style:rN({width:"100%",minWidth:"5em",minHeight:"2em",whiteSpace:"pre-line",borderRadius:".5em"},Q.style)})):"checkbox"===p?e.createElement(it,Q):e.createElement("input",tN({},Q,{style:rN(rN(rN({},Q.style),"file"===Q.type?{paddingBottom:"4px"}:{paddingBottom:0}),{},{minHeight:"28px"})}));return O&&(K=O),!f&&s&&k&&!j&&(Z=e.createElement(et,{color:null===q?"action":void 0,title:null===q?"Value is NULL":"Change to NULL",onClick:e=>{null!==q&&s(null,e)}},"NULL")),e.createElement("div",{className:"form-field pl-p25 min-w-0 "+b,style:x,ref:e=>{e&&(this.rootDiv=e)},onBlur:()=>{V&&this.setState({suggestions:void 0})},onKeyDown:e=>{if(["text","search"].includes(p)&&"INPUT"===document.activeElement.nodeName&&this.refWrapper.contains(document.activeElement))if("Enter"===e.key)null!=V&&V.length&&-1<H?ee(V[H]):V&&this.setState({suggestions:void 0});else if(["ArrowUp","ArrowDown"].includes(e.key)){if(null!=V&&V.length){var t=-1;["ArrowDown"].includes(e.key)&&(t=1);var n=Number.isFinite(H)?Math.max(0,H+t):0;n>V.length-1&&(n=0),this.setState({activeSuggestionIdx:n})}else if(["ArrowDown"].includes(e.key)&&!l&&L)te();else{var r=document.activeElement;if("number"!=typeof r.selectionStart)return;var i=Re(r.value),o=r.selectionStart,s=i.find((e=>"n"===e.type&&e.idx<=o&&e.idx+e.len>=o));if(s){this.inputSelStart=o;var a="ArrowUp"===e.key;r.value=i.map((t=>{if(t.idx===s.idx){var n=e.altKey?.1:e.ctrlKey?10:1,r=e.altKey?1:0,i=+s.val+(a?n:-n),o=(i=Math.max(i,0)).toFixed(s.decimalPlaces||r).padStart(s.len,"0");return s.decimalPlaces&&o.endsWith("."+Array(s.decimalPlaces).fill("0").join(""))&&(o=o.slice(0,-s.decimalPlaces-1)),o}return t.val})).join(""),this.onChange(r)}else this.inputSelStart=void 0}e.preventDefault(),e.stopPropagation()}}},e.createElement("div",{className:("checkbox"===p||T?" ":" ai-center ")+(T?" flex-col ":" flex-row-wrap "),title:A},a?e.createElement("label",{htmlFor:u,className:"main-label ta-left noselect text-gray-500 "+(u?" pointer ":" ")+B,style:rN(rN({flex:.5},f?G:{}),U)},a):null,e.createElement("div",{className:"flex-row f-1 ai-center min-w-0"},e.createElement("div",{className:"flex-col f-1 min-w-0",style:{maxWidth:"100%"}},e.createElement("div",{className:"input-wrapper focus-border  flex-row relative w-full "+(g?" error ":""),ref:e=>{e&&(this.refWrapper=e)},style:rN(rN({},W),{},{maxWidth:_?"100%":F})},Array.isArray(R)?e.createElement(eN,{className:"noselect f-1 bg-white",style:{background:"white"},options:R,onSearch:null!==(r=this.props)&&void 0!==r&&r.onSearchOptions?e=>this.searchOptions(e):void 0,onChange:s?e=>{s(e)}:void 0,value:q,required:d,multiSelect:M,labelAsValue:N}):ne,null!==(i=this.props)&&void 0!==i&&i.onSuggest&&V?e.createElement(UO,{anchorRef:this.refWrapper,selectedValue:V[H],items:V.map((t=>({key:t,node:null===t?e.createElement("i",null,"NULL"):""===t.trim()?e.createElement("i",null,"Empty"):null,onPress:()=>{ee(t)}}))),onClose:()=>{this.setState({suggestions:void 0})}}):null,K||Z?e.createElement("div",{className:"flex-row ai-start jc-center "+("checkbox"===p||_?" ":"  bl b-gray-300 "),style:{right:"2px",top:0,bottom:0,background:"white"}},K,Z):null,g?e.createElement(Ae(),{size:1,className:"text-red-500 absolute",path:J,style:{top:"2px",right:"6px",backgroundColor:"white"}}):null),g?e.createElement(Fe,{error:g,style:{padding:0,marginTop:".5em"}}):null,y&&e.createElement("p",{className:"text-gray-400 mx-0 text-sm noselect"},y)),P?e.createElement("div",{className:"f-0"},P):null)))}}function lN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function uN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){cN(a,r,i,o,s,"next",e)}function s(e){cN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function hN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dN extends e.Component{constructor(){var e;super(...arguments),e=this,hN(this,"state",{name:"",email:"",password:"",passwordConfirmation:"",registered:!1,registering:!1,acceptedTOS:!1,acceptedTOSErr:"",error:"",name_err:"",email_err:"",password_err:"",passwordConfirmation_err:""}),hN(this,"submit",uN((function*(){var{name:t,email:n,password:r,passwordConfirmation:i,registered:o=!1,registering:s=!1,acceptedTOS:a=!1,acceptedTOSErr:l="",error:c="",name_err:u,email_err:h,password_err:d,passwordConfirmation_err:f}=e.state,{db:p,methods:m}=e.props,g=!0;if(a?e.setState({acceptedTOSErr:""}):(g=!1,e.setState({acceptedTOSErr:"You must agree to our terms"})),g){e.setState({registering:!0});try{yield m.register({name:t,email:n,password:r,acceptedTOS:a}),e.setState({registering:!1,registered:"Registration has been received. You will soon be contacted to attend an interview. Thank you!"})}catch(t){e.setState({error:ke(t,"err")||t,registering:!1})}}})))}render(){var t="card my-1 flex-col max-w m-auto bg-white",{name:n,email:r,password:i,passwordConfirmation:o,registered:s=!1,registering:a=!1,acceptedTOS:l=!1,acceptedTOSErr:c="",error:u="",name_err:h,email_err:d,password_err:f,passwordConfirmation_err:p}=this.state,{db:m,methods:g}=this.props;return s?e.createElement("div",{className:t},e.createElement("p",{className:"text-lg font-bold text-gray-600"},"Thank you, registration has been received!"),e.createElement("p",{className:"text-lg font-bold text-gray-600"},"You will soon be contacted to schedule an interview"),e.createElement(K,{to:"/"},"Home")):e.createElement("form",{className:t+(a?" no-interaction ":" "),onSubmit:e=>{e.preventDefault(),this.submit()}},e.createElement("h1",{style:{marginTop:"12px"}},"Register"),e.createElement(aN,{label:"Name",id:"name",className:"mt-1",type:"name",error:h,onChange:e=>{this.setState({name:e})}}),e.createElement(aN,{label:"Email",id:"email",className:"mt-1",type:"email",error:d,onChange:e=>{this.setState({email:e})}}),e.createElement(aN,{label:"Password",id:"password",className:"mt-1",type:"password",error:f,onChange:e=>{this.setState({email:e})}}),e.createElement(aN,{label:"Repeat password",id:"repeat_password",className:"mt-1",type:"password",error:p,onChange:e=>{this.setState({passwordConfirmation:e})}}),e.createElement("h4",{className:"mt-2 mb-0"},"Terms"),e.createElement("div",{className:"mt-1"},e.createElement("div",{className:"flex items-center pointer pt-2"},e.createElement("input",{checked:l,onChange:e=>{var t=e.target.checked?{}:{acceptedTOSErr:""};this.setState(function(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?lN(Object(t),!0).forEach((function(n){hN(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lN(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}({acceptedTOS:e.target.checked},t))},id:"tos",type:"checkbox",className:"pointer"}),e.createElement("label",{htmlFor:"tos",className:"ml-p5 pointer noselect"},"I've read and accepted your ",e.createElement(K,{to:"/tos",className:"link-anchor"},"terms and conditions")," and ",e.createElement(K,{to:"/privacy",className:"link-anchor"},"privacy policy"))),e.createElement("p",{className:"mt-2 text-sm text-red-600 "+(c?" block ":" hidden "),id:"tos-error"},c)),e.createElement("p",{className:"mt-2 text-sm text-red-600 "+(u?" block ":" hidden ")},u),e.createElement("div",{className:"flex-row-wrap",style:{justifyContent:"flex-end",marginTop:"2em"}},e.createElement("button",{type:"button",className:"secondary mt-1 mr-1"},"Cancel"),e.createElement("button",{type:"submit",className:"mt-1"},a?e.createElement(Xe,{style:{margin:"-4px 10px"}}):"Submit")))}}function fN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pN(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?fN(Object(t),!0).forEach((function(n){yN(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fN(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function mN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function gN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){mN(a,r,i,o,s,"next",e)}function s(e){mN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function yN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vN=["disable","allow","prefer","require","verify-ca","verify-full"];class bN extends e.Component{constructor(){var e;super(...arguments),e=this,yN(this,"state",{conNotFound:!1,editMode:!1,nameErr:"",connection:{id:void 0,name:void 0,type:"Standard",db_user:"postgres",db_pass:"",db_name:"postgres",db_host:"localhost",db_port:5432,db_ssl:vN[0],prgl_url:"",prgl_params:"",db_conn:"",db_watch_shema:!0},status:"",statusOK:!1}),yN(this,"componentDidMount",gN((function*(){var t,n,r,i=null===(t=e.props)||void 0===t||null===(n=t.match)||void 0===n||null===(r=n.params)||void 0===r?void 0:r.id,{db:o}=e.props;if(i&&o){var s=yield o.connections.findOne({id:i});s?e.setState({connection:pN(pN({},s),{},{type:s.db_conn?"Connection URI":"Standard"}),editMode:!0}):e.setState({conNotFound:!0})}}))),yN(this,"testConnection",gN((function*(){var{connection:t}=e.state,{methods:n}=e.props;try{yield n.testDBConnection(t),e.setState({status:"OK",statusOK:!0})}catch(t){console.log(t),e.setState({status:t.err_msg,statusOK:!1})}})))}render(){var t=this,{nameErr:n,connection:r,status:i,statusOK:o,conNotFound:s,editMode:a}=this.state,{type:l,db_host:c,db_name:u,db_user:h,db_pass:d,db_port:f,db_ssl:p,db_conn:m,prgl_url:g,prgl_params:y,db_watch_shema:v}=r,{db:b,methods:w,history:x}=this.props;if(s)return e.createElement("div",null,e.createElement("p",null,"Connection not found"),e.createElement(K,{to:"/"},"Go back"));var E=e=>{this.setState({nameErr:"",status:"",statusOK:!1,connection:pN(pN({},this.state.connection),e)})};return e.createElement("div",{className:"flex-col w-fit as-center min-h-0",style:{maxWidth:"100%"}},e.createElement(K,{className:"p-1  b-gray-400 round flex-row ai-center",to:"/"},e.createElement(Ae(),{path:ee,size:1}),e.createElement("div",{className:"ml-p5"},"Connections")),e.createElement("div",{className:"card m-1 flex-col bg-white  min-h-0 ",style:{maxWidth:"100%"}},e.createElement("div",{className:"flex-col f-1 o-auto min-h-0"},e.createElement(aN,{label:"Connection name",type:"text",className:"mt-1",required:!0,error:n,value:r.name,hint:"Optional",asColumn:!0,onChange:e=>{E({name:e})}}),e.createElement("h4",{className:"my-1"},"Connection type"),e.createElement("div",{className:"flex-row c--spaced "},e.createElement("button",{className:"toggle "+("Standard"===l?" toggled ":""),onClick:()=>{E({type:"Standard"})}},"Standard"),e.createElement("button",{className:"toggle "+("Connection URI"===l?" toggled ":""),onClick:()=>{E({type:"Connection URI"})}},"URL")),"Prostgles"===l?e.createElement(e.Fragment,null,e.createElement(aN,{label:"Socket URL",type:"url",className:"mt-1",required:!0,value:g,onChange:e=>{E({prgl_url:e})}}),e.createElement(aN,{label:"Socket params (JSON)",type:"text",className:"mt-1",required:!0,value:y,onChange:e=>{E({prgl_params:e})},hint:'{ "path": "/socket" } '})):"Connection URI"===l?e.createElement(e.Fragment,null,e.createElement(aN,{label:"Connection URI",type:"text",className:"mt-1",required:!0,value:m,onChange:e=>{E({db_conn:e})},hint:"postgres://user:pass@host:port/database?ssl=true"})):e.createElement(e.Fragment,null,e.createElement("div",{className:"flex-col "},e.createElement("div",{className:"flex-col c--spaced p-1"},e.createElement(aN,{id:"u",value:h,label:"User",type:"text",autoComplete:"off",onChange:e=>E({db_user:e})}),e.createElement(aN,{id:"pass",value:d,label:"Password",type:"text",autoComplete:"off",onChange:e=>E({db_pass:e})}),e.createElement(aN,{id:"d",value:u,label:"Database",type:"text",autoComplete:"off",onChange:e=>E({db_name:e})}),e.createElement(aN,{id:"h",value:c,label:"Host",type:"text",autoComplete:"off",onChange:e=>E({db_host:e})}),e.createElement(aN,{id:"p",value:f,label:"Port",type:"number",autoComplete:"off",onChange:e=>E({db_port:e})}),e.createElement(aN,{id:"s",label:"SSL Mode",options:vN,className:"mt-1",required:!0,value:p,onChange:e=>{E({db_ssl:e})}}),e.createElement(aN,{id:"swatch",label:"Watch schema",className:"mt-1 ",hint:"Will reload on schema change. Requires superuser",required:!0,type:"checkbox",labelStyle:{flex:"unset"},value:v,onChange:e=>{E({db_watch_shema:e})}})))),"Prostgles"===l?null:e.createElement("div",{className:"flex-row-wrap my-1 jc-center"},e.createElement(et,{className:"b rounded b-gray-400 mr-1",onClick:this.testConnection},"Test"),i?e.createElement("div",{style:{padding:"1em",borderRadius:"8px"},className:"chip flex-col p-1 "+(o?"green":"red")},e.createElement("span",null,"Connection status:"),e.createElement("span",null,i)):null)),e.createElement("div",{className:"flex-row ai-center mt-1 "},a?e.createElement(et,{color:"danger",className:"b rounded b-red-400 mr-1",onClick:function(){var e=gN((function*(){try{yield w.deleteConnection(r.id),x.push("/")}catch(n){console.log(n);var e=ke(n,"err.err_msg")||ke(n,"err.constraint")||ke(n,"err.txt")||n.err_msg||JSON.stringify(n);t.setState({nameErr:e})}}));return function(){return e.apply(this,arguments)}}()},"Delete"):null,a&&e.createElement(et,{variant:"outline",color:"action",title:"Clone connection",className:"f-0 mx-1 w-fit ",onClick:function(){var e=gN((function*(){t.setState({editMode:!1})}));return function(){return e.apply(this,arguments)}}()},"Clone"),e.createElement("button",{className:"f-1  ",onClick:function(){var e=gN((function*(){try{var e=pN({},r);a||delete e.id;var n=yield w.createConnection(e);x.push("/connections/"+n.id)}catch(e){console.log(e);var i=ke(e,"err.err_msg")||ke(e,"err.constraint")||ke(e,"err.txt")||e.err_msg||JSON.stringify(e);t.setState({status:i,statusOK:!1})}}));return function(){return e.apply(this,arguments)}}()},a?"Update":"Create"))))}}function wN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function xN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){wN(a,r,i,o,s,"next",e)}function s(e){wN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}class EN extends e.Component{constructor(){super(...arguments),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",{password:"",username:"",usernameErr:"",passErr:"",remember_me:!1,forgotPassword:!1,resetusername:"",resetusernameErr:"",didReset:!1})}componentDidMount(){}signIn(){var e=this;return xN((function*(){var{username:t,password:n,remember_me:r}=e.state;if(t)if(n)try{var{pathname:i,search:o}=window.location,s=yield _N(i+o,{username:t,password:n,remember_me:r});s&&200===s.status&&(window.location.href=s.url)}catch(t){console.error(t),t&&t.content&&"pending"===t.content.reason?e.setState({usernameErr:"Your account has not been approved yet"}):e.setState({usernameErr:"Username and/or password is incorrect"})}else e.setState({passErr:"Cannot be empty"});else e.setState({usernameErr:"Cannot be empty"})}))()}render(){var t=this,{username:n,password:r,remember_me:i,usernameErr:o,passErr:s,forgotPassword:a,resetusername:l,resetusernameErr:c,didReset:u}=this.state;return e.createElement("div",{className:"card m-auto w-fit bg-white flex"},e.createElement("div",{style:{maxWidth:"400px"},className:"flex-col "},e.createElement("div",{className:" "},e.createElement("div",null,e.createElement("h2",{className:"mt-0"},"Sign in")),e.createElement("form",{onSubmit:e=>{e.preventDefault()}},e.createElement(aN,{id:"username",value:n,type:"username",label:"Username",asColumn:!0,onChange:e=>{this.setState({username:e,usernameErr:"",passErr:""})},error:o}),e.createElement(aN,{id:"password",value:r,type:"password",label:"Password",asColumn:!0,onChange:e=>{this.setState({password:e,usernameErr:"",passErr:""})},error:s}),e.createElement("div",{className:"mt-2"},e.createElement("span",{className:"block w-full rounded-md shadow-sm"},e.createElement("button",{onClick:()=>{this.signIn()},className:"w-full flex justify-center border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:border-indigo-700 focus:shadow-outline-indigo active:bg-indigo-700 transition duration-150 ease-in-out"},"Sign in")))))),(()=>{if(!a)return null;var n,r=[];return u&&r.push({label:"Reset Password",onClick:(n=xN((function*(){if(!u)if(l&&l.trim())try{t.setState({didReset:!0})}catch(e){console.error(e),t.setState({resetusernameErr:"Something went wrong"})}else t.setState({resetusernameErr:"Required"})})),function(){return n.apply(this,arguments)}),isPrimary:!0}),r.push({label:"Cancel",onClickClose:!0}),e.createElement(pt,{open:!0,title:"Forgot your password?",footerButtons:r,onClose:()=>{this.setState({forgotPassword:!1,didReset:!1,resetusername:""})}},e.createElement("div",{className:"mb-1"},e.createElement(aN,{id:"username-reset-pwd",type:"username",label:"Enter the username address associated with your account, and we'll send you a link to reset your password.",asColumn:!0,onChange:e=>{this.setState({resetusername:e,resetusernameErr:"",passErr:""})},error:c}),u&&e.createElement("div",{className:"mt-1 text-green-600"},"Thanks, we've sent you a password reset link to this username address (unless there is no account associated with it)")))})())}}function _N(){return SN.apply(this,arguments)}function SN(){return SN=xN((function*(e,t){return yield fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})),SN.apply(this,arguments)}var CN=n(208);CN.Manager;var TN=CN;function ON(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PN(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?ON(Object(t),!0).forEach((function(n){MN(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ON(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function AN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function kN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){AN(a,r,i,o,s,"next",e)}function s(e){AN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function MN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class NN extends We{constructor(){var e;super(...arguments),e=this,MN(this,"state",{loading:!0,error:"",dbProject:void 0,dbMethods:void 0,connection:void 0,showFeedback:!1,feedback:{email:"",details:""}}),MN(this,"loaded",!1),MN(this,"sub",null),MN(this,"getDashboardDB",function(){var t=kN((function*(t){try{e.dashboardSocket&&e.dashboardSocket.disconnect();var{db:n,methods:r}=e.props,i=yield r.startConnection(t.id);if(!i)return void e.setState({dbProject:n});e.dashboardSocket=TN({path:i,reconnectionDelay:1e3,reconnection:!0}),$i()({socket:e.dashboardSocket,onReconnect:()=>{console.log("dashboardSocket onReconnect"),window.__prglIsImporting||e.setState({dbKey:"dbs"+Date.now()})},onReady:(t,n)=>{e.setState({dbProject:t,dbMethods:n,dbKey:"dbs"+Date.now()}),window.db=t}}).catch(console.error)}catch(t){console.error(t),e.setState({error:t})}}));return function(){return t.apply(this,arguments)}}())}onMount(){}onDelta(e,t,n){var r=this;return kN((function*(){var{dbProject:i}=r.state,{db:o,methods:s}=r.props;if(PN(PN(PN({},e),t),n).db&&(r.loaded=!1,r.setState({dbProject:void 0})),o&&0<Object.keys(s).length&&!r.loaded){window.dbs=o,r.loaded=!0;var a=ke(r.props,"match.params.id"),l=yield o.connections.findOne({id:a});l&&!i&&r.getDashboardDB(l),r.setState({connection:l,loading:!1})}}))()}onUnmount(){this.sub&&this.sub.unsubscribe(),this.dashboardSocket&&this.dashboardSocket.disconnect()}render(){var t,n,r=this,{error:i,loading:o=!0,dbProject:s,showFeedback:a,dbMethods:l,connection:c,feedback:u}=this.state,{db:h}=this.props;return o?e.createElement("div",{className:"f-1 flex-col bg-gray-700 h-full w-full ai-center jc-center"},e.createElement(Xe,{className:"mt-4 mx-auto"})):!c||i?e.createElement("div",{className:"flex-col w-full h-full ai-center "},c?e.createElement(Fe,{error:i,findMsg:!0}):e.createElement("div",{className:"p-1 mt-2"},"This project was not found"),e.createElement(K,{to:"/"},"Go back")):e.createElement("div",{className:"f-1 flex-col bg-gray-700 h-full w-full min-h-0 min-w-0 relative",style:{maxWidth:"100vw",maxHeight:"100vh"}},e.createElement("div",{style:{right:0,top:0,maxWidth:"80vw"},className:"f-0 flex-row text-gray-500 w-fit min-h-0 min-w-0  ai-center noselect absolute o-hidden"},e.createElement("div",{className:"flex-col w-full"},e.createElement("div",{className:"flex-row ai-center"},e.createElement(K,{className:"text-gray-300 ndo-decor b-gray-400 round flex-row ai-center",to:"/"},e.createElement(Ae(),{path:ee,size:1}),e.createElement("div",{className:"ml-p5"},"Connections")),e.createElement("div",{className:"f-1 ml-1 p-p25 font-12 text-ellipsis"},NN.getConnectionTitle(c,!0)),e.createElement(et,{className:"ml-1 text-white bg-gray-800",style:{margin:"6px"},variant:"outline",onClick:()=>{this.setState({showFeedback:!0})}},"Feedback"),a&&e.createElement(pt,{open:!0,title:"Send feedback",positioning:"top-center",onClose:()=>{this.setState({showFeedback:!1})}},u.success&&e.createElement("div",{className:"flex-col"},e.createElement(no,null),e.createElement("p",null,"Feedback was sent! Thanks a lot!")),u.error&&e.createElement(Fe,{error:u.error}),e.createElement(aN,{id:"email",type:"email",label:"Email (optional)",asColumn:!0,value:u.email,onChange:e=>{this.setState({feedback:PN(PN({},u),{},{email:e})})}}),e.createElement(aN,{id:"text",type:"text",label:"Details",asColumn:!0,className:"mt-1",value:u.details,asTextArea:!0,onChange:e=>{500>e.length&&this.setState({feedback:PN(PN({},u),{},{details:e})})},hint:"".concat(500-"".concat(u.details).length,"/500")}),e.createElement("p",null,"Other options: ",e.createElement("a",{target:"_blank",href:"https://github.com/prostgles/ui/issues/new"},"open an issue")," or ",e.createElement("a",{href:"mailto:prostgles@protonmail.com"},"email us")),e.createElement("div",{className:"flex-row pt-1 jc-around"},!u.success&&e.createElement(et,{color:"action",variant:"filled",disabledInfo:u.details?void 0:"Must provide some details",onClick:kN((function*(){try{var e=yield _N("https://prostgles.com/feedback",u),t=yield e.json();if(t.error)throw t.error;r.setState({feedback:PN(PN({},u),{},{success:!0})}),setTimeout((()=>{r.mounted&&r.setState({showFeedback:!1,feedback:{email:"",details:""}})}),3e3)}catch(e){r.setState({feedback:PN(PN({},u),{},{error:e})})}}))},"Send"),e.createElement(et,{variant:"filled",onClick:()=>{this.setState({showFeedback:!1,feedback:{email:"",details:""}})}},"Cancel")))))),e.createElement("div",{className:"f-1 w-full h-full flex-col"},e.createElement(hM,{db:s,dbs:h,dbMethods:l,workspaceName:null===(t=this.props.match)||void 0===t||null===(n=t.params)||void 0===n?void 0:n.id})))}}function LN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function RN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){LN(a,r,i,o,s,"next",e)}function s(e){LN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function IN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}MN(NN,"getConnectionTitle",(function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return t?e.db_conn||"".concat(e.db_user,"@").concat(e.db_host,":").concat(e.db_port||"5432","/").concat(e.db_name):e.db_conn||"postgres://".concat(e.db_user,":***@").concat(e.db_host,":").concat(e.db_port||"5432","/").concat(e.db_name)}));class DN extends We{constructor(){super(...arguments),IN(this,"state",{projects:[]}),IN(this,"loaded",!1)}onDelta(){var{db:e}=this.props;e&&!this.loaded&&(this.loaded=!0,e.connections.find({},{select:{"*":1,crtd:{$datetime:["created"]}}}).then((e=>{this.mounted&&this.setState({projects:e})})))}render(){var{db:t}=this.props,{projects:n}=this.state;return this.loaded?e.createElement("div",{className:"flex-col p-p5 f-1 w-full min-h-0",style:{maxWidth:"500px"}},e.createElement("div",{className:"flex-col"},e.createElement(K,{className:"button mb-1 mt-1 flex-row ai-center w-fit rounded b b-gray-300 p-p5 no-decor",to:"/new-connection",title:"Create a new connection"},e.createElement(Ae(),{path:we,size:1}),"New connection")),e.createElement("div",{className:"flex-col noselect o-auto min-h-0 pb-1"},n.map(((n,r)=>e.createElement("div",{key:r,className:"flex-row card p-1 bg-white text-black "+(r?"mt-p5":""),title:"Connect to this",style:{minWidth:"250px"}},e.createElement(K,{key:r,to:"/connections/"+n.id,className:"no-decor  min-w-0 text-ellipsis f-1 "+(r?"mt-p5":"")},e.createElement("div",{className:"flex-col pr-1"},e.createElement("div",{className:"text-ellipsis"},n.name||NN.getConnectionTitle(n,!0)),e.createElement("div",{className:"flex-row mt-1 ws-pre"},e.createElement("div",{className:"font-12"},"Created: "),e.createElement("div",{className:"font-12 capitalize text-xl font-medium"},n.crtd)))),e.createElement("div",{className:"flex-col ai-center c--fit"},e.createElement(K,{to:"/edit-connection/"+n.id,title:"Edit connection",className:"no-decor text-black"},e.createElement(Ae(),{path:ye,size:1})),e.createElement(et,{title:"Close all windows",className:"mt-p5 text-gray-300",iconPath:"M12,5C12.74,5 13.47,5.1 14.15,5.29L15.78,2.46C16.06,2 16.67,1.82 17.15,2.1C17.63,2.37 17.79,3 17.5,3.46L16,6.07C17.22,6.78 18.23,7.79 18.93,9H5.07C5.77,7.79 6.78,6.78 8,6.07L6.5,3.46C6.21,3 6.37,2.37 6.85,2.1C7.33,1.82 7.94,2 8.22,2.46L9.85,5.29C10.53,5.1 11.26,5 12,5M20,13C20,17.17 16.82,20.59 12.75,20.97V10.5H19.6C19.86,11.29 20,12.13 20,13M4,13C4,12.13 4.14,11.29 4.4,10.5H11.25V20.97C7.18,20.59 4,17.17 4,13Z",onClick:RN((function*(){var e=yield t.workspaces.findOne({name:n.id});e&&(t.windows.update({workspace_id:e.id},{closed:!0}),alert("Windows have been closed"))}))}))))))):e.createElement(Xe,null)}}function jN(){return jN=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},jN.apply(this,arguments)}function FN(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function zN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){FN(a,r,i,o,s,"next",e)}function s(e){FN(a,r,i,o,s,"throw",e)}var a=e.apply(t,n);o(void 0)}))}}function BN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.isIOSDevice=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,window.isMobileDevice=/Mobi/i.test(window.navigator.userAgent);class UN extends e.Component{constructor(){var e;super(...arguments),e=this,BN(this,"state",{dbsKey:"",title:"",db:null,methods:null,auth:void 0,isAdminOrSupport:!1,socket:null,dbsInfo:{},dbsConnected:!1}),BN(this,"componentDidMount",zN((function*(){var t=yield(yield fetch("/dbs")).json();if(t.ok){var n=TN({path:"/iosckt",reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5});n.on("reconnect",(()=>{console.log("reconnect")})),n.on("pls-restart",(()=>{setTimeout((()=>window.location.reload()),2e3)})),n.on("redirect",(e=>{window.location=e})),$i()({socket:n,onReconnect:()=>{e.setState({dbsKey:"dbs"+Date.now()})},onReady:(t,r,i,o)=>{window.dbs=t,window.dbsSocket=n,window.methods=r;var s=ke(o,"user.type");e.setState({dbsKey:"dbs"+Date.now(),db:t,methods:r,socket:n,auth:o,isAdminOrSupport:["admin","support"].includes(s),dbsConnected:!0})}})}e.setState({dbsInfo:t})})))}render(){var{isAdminOrSupport:t,db:n,methods:r,auth:i,socket:o,dbsInfo:s,dbsKey:a,dbsConnected:l}=this.state,c={setTitle:e=>{this.state.title!==e&&this.setState({title:e})},db:n,socket:o,methods:r,user:null==i?void 0:i.user};return t&&[{label:"Home",href:"/",exact:!0},{label:"Connections",to:"/connections",exact:!0}].push({label:"Dashboard",to:"/dashboard",exact:!1}),s||l?s.err?e.createElement("div",{className:"flex-col m-auto ai-center jc-center  p-2"},e.createElement("div",{className:"ml-1 text-lg font-bold mb-1 pre"},"Could not connect to state database. Ensure /server/.env file (or environment variables) point to a running and accessible postgres server database"),e.createElement(Fe,{error:s.err,withIcon:!0})):e.createElement(U,{key:a},e.createElement(B,{className:"flex-col f-1"},e.createElement(z,{path:"/login",component:()=>e.createElement(EN,c)}),e.createElement(z,{path:"/register",component:()=>e.createElement(dN,c)}),e.createElement(z,{path:"/",exact:!0,render:t=>c.user?e.createElement("div",{className:"flex-col ai-center jc-center f-1 min-h-0"},e.createElement("h3",null,"Database connections"),e.createElement(DN,jN({},c,t))):e.createElement("div",{className:"flex-col jc-center ai-center h-full"},e.createElement(K,{to:"login"},"Login"),e.createElement(K,{to:"register"},"Register"))}),e.createElement(z,{path:"/connections/:id",render:t=>e.createElement(NN,jN({},c,t))}),e.createElement(z,{path:"/new-connection",render:t=>e.createElement(bN,jN({},c,t))}),e.createElement(z,{path:"/edit-connection/:id",render:t=>e.createElement(bN,jN({},c,t))}),e.createElement(z,{path:"*",component:Z}))):e.createElement("div",{className:"flex-row m-auto ai-center jc-center  p-2"},e.createElement(Xe,{className:""}),e.createElement("div",{className:"ml-1"},"Connecting to database..."))}}t.render(e.createElement(UN,null),document.getElementById("root"))}()}();